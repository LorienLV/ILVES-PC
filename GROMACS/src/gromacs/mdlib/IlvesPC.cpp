#include "IlvesPC.h"

#include <omp.h>
#include <pthread.h>
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>

#include <algorithm>

#include "gromacs/math/vec.h"

// 1 to print each step final matrix and to perform avoidable writes.
// 0 to print nothing and to avoid every avoidable write.
// An avoidable write is a write in a matrix entry that will be used no more.
#define DEBUG 0
// Show detailed stopwatch info after each execution of Ilves.
#define STOPWATCH_DETAILED_INFO 0

// Perf events to print if stopwatch-detailed-info enabled.
#if STOPWATCH_DETAILED_INFO

static const std::vector<PerfStopwatch::Event> perf_events_to_print =
    {PerfStopwatch::Event::CPU_CYCLES,
     PerfStopwatch::Event::INSTRUCTIONS,
     PerfStopwatch::Event::CACHE_REFERENCES,
     PerfStopwatch::Event::CACHE_MISSES,
     PerfStopwatch::Event::BRANCH_INSTRUCTIONS};
#endif

/*
 * Side-chain specific constants.
 */

//
// Glycine
//

#define SC_TO_SC_GLYCINE_MATRIX_SIZE 0
#define SC_TO_BB_GLYCINE_MATRIX_SIZE 0

#define SC_TO_SC_GLYCINE_FILLINS_SIZE 0

#define BB_TO_SC_GLYCINE_MATRIX_SIZE 0

//
// PROLINE
//

#define SC_TO_SC_PROLINE_MATRIX_SIZE 39
#define SC_TO_BB_PROLINE_MATRIX_SIZE 4

#define SC_TO_SC_PROLINE_FILLINS_SIZE 0
#define SC_TO_BB_PROLINE_FILLINS_SIZE 2

#define BB_TO_SC_PROLINE_MATRIX_SIZE 4

#define BB_TO_SC_PROLINE_FILLINS_SIZE 2

//
// Cysteine
//

#define SC_TO_SC_CYSTEINE_MATRIX_SIZE 12
#define SC_TO_BB_CYSTEINE_MATRIX_SIZE 3

#define SC_TO_SC_CYSTEINE_FILLINS_SIZE 0

#define BB_TO_SC_CYSTEINE_MATRIX_SIZE 3

//
// Methionine
//

#define SC_TO_SC_METHIONINE_MATRIX_SIZE 42
#define SC_TO_BB_METHIONINE_MATRIX_SIZE 3

#define SC_TO_SC_METHIONINE_FILLINS_SIZE 0

#define BB_TO_SC_METHIONINE_MATRIX_SIZE 3

//
// Alaline
//

#define SC_TO_SC_ALALINE_MATRIX_SIZE 9
#define SC_TO_BB_ALALINE_MATRIX_SIZE 3

#define SC_TO_SC_ALALINE_FILLINS_SIZE 0

#define BB_TO_SC_ALALINE_MATRIX_SIZE 3

//
// Valine
//

#define SC_TO_SC_VALINE_MATRIX_SIZE 39
#define SC_TO_BB_VALINE_MATRIX_SIZE 3

#define SC_TO_SC_VALINE_FILLINS_SIZE 0

#define BB_TO_SC_VALINE_MATRIX_SIZE 3

//
// Leucine
//

#define SC_TO_SC_LEUCINE_MATRIX_SIZE 54
#define SC_TO_BB_LEUCINE_MATRIX_SIZE 3

#define SC_TO_SC_LEUCINE_FILLINS_SIZE 0

#define BB_TO_SC_LEUCINE_MATRIX_SIZE 3

//
// Isoleucine
//

#define SC_TO_SC_ISOLEUCINE_MATRIX_SIZE 54
#define SC_TO_BB_ISOLEUCINE_MATRIX_SIZE 3

#define SC_TO_SC_ISOLEUCINE_FILLINS_SIZE 0

#define BB_TO_SC_ISOLEUCINE_MATRIX_SIZE 3

//
// Aspartic acid
//

#define SC_TO_SC_ASPARTIC_ACID_MATRIX_SIZE 17
#define SC_TO_BB_ASPARTIC_ACID_MATRIX_SIZE 3

#define SC_TO_SC_ASPARTIC_ACID_FILLINS_SIZE 0

#define BB_TO_SC_ASPARTIC_ACID_MATRIX_SIZE 3

//
// Aspartic acid
//

#define SC_TO_SC_GLUTAMIC_ACID_MATRIX_SIZE 32
#define SC_TO_BB_GLUTAMIC_ACID_MATRIX_SIZE 3

#define SC_TO_SC_GLUTAMIC_ACID_FILLINS_SIZE 0

#define BB_TO_SC_GLUTAMIC_ACID_MATRIX_SIZE 3

//
// Asparagine
//

#define SC_TO_SC_ASPARAGINE_MATRIX_SIZE 25
#define SC_TO_BB_ASPARAGINE_MATRIX_SIZE 3

#define SC_TO_SC_ASPARAGINE_FILLINS_SIZE 0

#define BB_TO_SC_ASPARAGINE_MATRIX_SIZE 3

//
// Glutamine
//

#define SC_TO_SC_GLUTAMINE_MATRIX_SIZE 40
#define SC_TO_BB_GLUTAMINE_MATRIX_SIZE 3

#define SC_TO_SC_GLUTAMINE_FILLINS_SIZE 0

#define BB_TO_SC_GLUTAMINE_MATRIX_SIZE 3

//
// Histidine
//

#define SC_TO_SC_HISTIDINE_MATRIX_SIZE 43
#define SC_TO_BB_HISTIDINE_MATRIX_SIZE 3

#define SC_TO_SC_HISTIDINE_FILLINS_SIZE 4

#define BB_TO_SC_HISTIDINE_MATRIX_SIZE 3

//
// Lysine
//

#define SC_TO_SC_LYSINE_MATRIX_SIZE 69
#define SC_TO_BB_LYSINE_MATRIX_SIZE 3

#define SC_TO_SC_LYSINE_FILLINS_SIZE 0

#define BB_TO_SC_LYSINE_MATRIX_SIZE 3

//
// Arginine
//

#define SC_TO_SC_ARGININE_MATRIX_SIZE 71
#define SC_TO_BB_ARGININE_MATRIX_SIZE 3

#define SC_TO_SC_ARGININE_FILLINS_SIZE 0

#define BB_TO_SC_ARGININE_MATRIX_SIZE 3

//
// Serine
//

#define SC_TO_SC_SERINE_MATRIX_SIZE 12
#define SC_TO_BB_SERINE_MATRIX_SIZE 3

#define SC_TO_SC_SERINE_FILLINS_SIZE 0

#define BB_TO_SC_SERINE_MATRIX_SIZE 3

//
// Phenylaline
//

#define SC_TO_SC_PHENYLALINE_MATRIX_SIZE 56
#define SC_TO_BB_PHENYLALINE_MATRIX_SIZE 3

#define SC_TO_SC_PHENYLALINE_FILLINS_SIZE 6

#define BB_TO_SC_PHENYLALINE_MATRIX_SIZE 3

//
// Tyrosine
//

#define SC_TO_SC_TYROSINE_MATRIX_SIZE 59
#define SC_TO_BB_TYROSINE_MATRIX_SIZE 3

#define SC_TO_SC_TYROSINE_FILLINS_SIZE 6

#define BB_TO_SC_TYROSINE_MATRIX_SIZE 3

//
// Tryptophan
//

#define SC_TO_SC_TRYPTOPHAN_MATRIX_SIZE 79
#define SC_TO_BB_TRYPTOPHAN_MATRIX_SIZE 3

#define SC_TO_SC_TRYPTOPHAN_FILLINS_SIZE 14

#define BB_TO_SC_TRYPTOPHAN_MATRIX_SIZE 3

//
// Threonine
//

#define SC_TO_SC_THREONINE_MATRIX_SIZE 27
#define SC_TO_BB_THREONINE_MATRIX_SIZE 3

#define SC_TO_SC_THREONINE_FILLINS_SIZE 0

#define BB_TO_SC_THREONINE_MATRIX_SIZE 3

/*
 * sc_to_sc sub-matrix sizes by side-chain type.
 */
static const int sc_to_sc_matrix_sizes[NUM_TYPES] = {
    // Special
    SC_TO_SC_GLYCINE_MATRIX_SIZE,   // GLYCINE
    SC_TO_SC_PROLINE_MATRIX_SIZE,   // PROLINE

    // Sulfur-containing
    SC_TO_SC_CYSTEINE_MATRIX_SIZE,     // CYSTEINE
    SC_TO_SC_METHIONINE_MATRIX_SIZE,   // METHIONINE

    // Aliphatic
    SC_TO_SC_ALALINE_MATRIX_SIZE,      // ALALINE
    SC_TO_SC_VALINE_MATRIX_SIZE,       // VALINE
    SC_TO_SC_LEUCINE_MATRIX_SIZE,      // LEUCINE
    SC_TO_SC_ISOLEUCINE_MATRIX_SIZE,   // ISOLEUCINE

    // Acid
    SC_TO_SC_ASPARTIC_ACID_MATRIX_SIZE,   // ASPARTIC ACID
    SC_TO_SC_GLUTAMIC_ACID_MATRIX_SIZE,   // GLUTAMIC ACID

    // Amides
    SC_TO_SC_ASPARAGINE_MATRIX_SIZE,   // ASPARAGINE
    SC_TO_SC_GLUTAMINE_MATRIX_SIZE,    // GLUTAMINE

    // Basic
    SC_TO_SC_HISTIDINE_MATRIX_SIZE,   // HISTIDINE
    SC_TO_SC_LYSINE_MATRIX_SIZE,      // LYSINE
    SC_TO_SC_ARGININE_MATRIX_SIZE,    // ARGININE

    // Alcohols
    SC_TO_SC_SERINE_MATRIX_SIZE,   // SERINE

    // Aromatic
    SC_TO_SC_PHENYLALINE_MATRIX_SIZE,   // PHENYLALINE
    SC_TO_SC_TYROSINE_MATRIX_SIZE,      // TYROSINE
    SC_TO_SC_TRYPTOPHAN_MATRIX_SIZE,    // TRYPTOPHAN
    SC_TO_SC_THREONINE_MATRIX_SIZE,     // THREONINE
};

/*
 * sc_to_bb sub-matrix sizes by side-chain type.
 */
static const int sc_to_bb_matrix_sizes[NUM_TYPES] = {
    // Special
    SC_TO_BB_GLYCINE_MATRIX_SIZE,   // GLYCINE
    SC_TO_BB_PROLINE_MATRIX_SIZE,   // PROLINE

    // Sulfur-containing
    SC_TO_BB_CYSTEINE_MATRIX_SIZE,     // CYSTEINE
    SC_TO_BB_METHIONINE_MATRIX_SIZE,   // METHIONINE

    // Aliphatic
    SC_TO_BB_ALALINE_MATRIX_SIZE,      // ALALINE
    SC_TO_BB_VALINE_MATRIX_SIZE,       // VALINE
    SC_TO_BB_LEUCINE_MATRIX_SIZE,      // LEUCINE
    SC_TO_BB_ISOLEUCINE_MATRIX_SIZE,   // ISOLEUCINE

    // Acid
    SC_TO_BB_ASPARTIC_ACID_MATRIX_SIZE,   // ASPARTIC ACID
    SC_TO_BB_GLUTAMIC_ACID_MATRIX_SIZE,   // GLUTAMIC ACID

    // Amides
    SC_TO_BB_ASPARAGINE_MATRIX_SIZE,   // ASPARAGINE
    SC_TO_BB_GLUTAMINE_MATRIX_SIZE,    // GLUTAMINE

    // Basic
    SC_TO_BB_HISTIDINE_MATRIX_SIZE,   // HISTIDINE
    SC_TO_BB_LYSINE_MATRIX_SIZE,      // LYSINE
    SC_TO_BB_ARGININE_MATRIX_SIZE,    // ARGININE

    // Alcohols
    SC_TO_BB_SERINE_MATRIX_SIZE,   // SERINE

    // Aromatic
    SC_TO_BB_PHENYLALINE_MATRIX_SIZE,   // PHENYLALINE
    SC_TO_BB_TYROSINE_MATRIX_SIZE,      // TYROSINE
    SC_TO_BB_TRYPTOPHAN_MATRIX_SIZE,    // TRYPTOPHAN
    SC_TO_BB_THREONINE_MATRIX_SIZE,     // THREONINE
};

/*
 * sc_to_sep sub-matrix defines.
 */
#define SC_TO_SEP_PROLINE_MATRIX_SIZE 1

/*
 * sc_g matrix sizes by side-chain type.
 */
// Actually the same as the number of bonds of each type.
static const int *sc_g_matrix_sizes = side_chain_bonds;

/*
 * sc_to_sc fillins sub-matrix sizes by side-chain type.
 */
static const int sc_to_sc_fillins_sizes[NUM_TYPES] = {
    // Special
    SC_TO_SC_GLYCINE_FILLINS_SIZE,   // GLYCINE
    SC_TO_SC_PROLINE_FILLINS_SIZE,   // PROLINE

    // Sulfur-containing
    SC_TO_SC_CYSTEINE_FILLINS_SIZE,     // CYSTEINE
    SC_TO_SC_METHIONINE_FILLINS_SIZE,   // METHIONINE

    // Aliphatic
    SC_TO_SC_ALALINE_FILLINS_SIZE,      // ALALINE
    SC_TO_SC_VALINE_FILLINS_SIZE,       // VALINE
    SC_TO_SC_LEUCINE_FILLINS_SIZE,      // LEUCINE
    SC_TO_SC_ISOLEUCINE_FILLINS_SIZE,   // ISOLEUCINE

    // Acid
    SC_TO_SC_ASPARTIC_ACID_FILLINS_SIZE,   // ASPARTIC ACID
    SC_TO_SC_GLUTAMIC_ACID_FILLINS_SIZE,   // GLUTAMIC ACID

    // Amides
    SC_TO_SC_ASPARAGINE_FILLINS_SIZE,   // ASPARAGINE
    SC_TO_SC_GLUTAMINE_FILLINS_SIZE,    // GLUTAMINE

    // Basic
    SC_TO_SC_HISTIDINE_FILLINS_SIZE,   // HISTIDINE
    SC_TO_SC_LYSINE_FILLINS_SIZE,      // LYSINE
    SC_TO_SC_ARGININE_FILLINS_SIZE,    // ARGININE

    // Alcohols
    SC_TO_SC_SERINE_FILLINS_SIZE,   // SERINE

    // Aromatic
    SC_TO_SC_PHENYLALINE_FILLINS_SIZE,   // PHENYLALINE
    SC_TO_SC_TYROSINE_FILLINS_SIZE,      // TYROSINE
    SC_TO_SC_TRYPTOPHAN_FILLINS_SIZE,    // TRYPTOPHAN
    SC_TO_SC_THREONINE_FILLINS_SIZE,     // THREONINE
};

/*
 * bb_to_sc sub-matrix sizes by side-chain type.
 */
static const int bb_to_sc_matrix_sizes[NUM_TYPES] = {
    // Special
    BB_TO_SC_GLYCINE_MATRIX_SIZE,   // GLYCINE
    BB_TO_SC_PROLINE_MATRIX_SIZE,   // PROLINE

    // Sulfur-containing
    BB_TO_SC_CYSTEINE_MATRIX_SIZE,     // CYSTEINE
    BB_TO_SC_METHIONINE_MATRIX_SIZE,   // METHIONINE

    // Aliphatic
    BB_TO_SC_ALALINE_MATRIX_SIZE,      // ALALINE
    BB_TO_SC_VALINE_MATRIX_SIZE,       // VALINE
    BB_TO_SC_LEUCINE_MATRIX_SIZE,      // LEUCINE
    BB_TO_SC_ISOLEUCINE_MATRIX_SIZE,   // ISOLEUCINE

    // Acid
    BB_TO_SC_ASPARTIC_ACID_MATRIX_SIZE,   // ASPARTIC_ACID
    BB_TO_SC_GLUTAMIC_ACID_MATRIX_SIZE,   // GLUTAMIC_ACID

    // Amides
    BB_TO_SC_ASPARAGINE_MATRIX_SIZE,   // ASPARAGINE
    BB_TO_SC_GLUTAMINE_MATRIX_SIZE,    // GLUTAMINE

    // Basic
    BB_TO_SC_HISTIDINE_MATRIX_SIZE,   // HISTIDINE
    BB_TO_SC_LYSINE_MATRIX_SIZE,      // LYSINE,
    BB_TO_SC_ARGININE_MATRIX_SIZE,    // ARGININE

    // Alcohols
    BB_TO_SC_SERINE_MATRIX_SIZE,   // SERINE

    // Aromatic
    BB_TO_SC_PHENYLALINE_MATRIX_SIZE,   // PHENYLALINE
    BB_TO_SC_TYROSINE_MATRIX_SIZE,      // TYROSINE
    BB_TO_SC_TRYPTOPHAN_MATRIX_SIZE,    // TRYPTOPHAN
    BB_TO_SC_THREONINE_MATRIX_SIZE,     // THREONINE
};

/*
 * bb_to_bb submatrices defines.
 */

// Sizes of each backbone to backbone sub-matrix row.
#define BB_TO_BB_MATRIX_LINE_1_SIZE 2
#define BB_TO_BB_MATRIX_LINE_2_SIZE 5
#define BB_TO_BB_MATRIX_LINE_3_SIZE 4
#define BB_TO_BB_MATRIX_LINE_4_SIZE 4
#define BB_TO_BB_MATRIX_LINE_5_SIZE 5
#define BB_TO_BB_PROLINE_MATRIX_LINE_5_SIZE 4
#define BB_TO_BB_MATRIX_LINE_6_SIZE 2

// Total size of a backbone to backbone sub-matrix.
#define BB_TO_BB_MATRIX_SIZE                                     \
    (BB_TO_BB_MATRIX_LINE_1_SIZE + BB_TO_BB_MATRIX_LINE_2_SIZE + \
     BB_TO_BB_MATRIX_LINE_3_SIZE + BB_TO_BB_MATRIX_LINE_4_SIZE + \
     BB_TO_BB_MATRIX_LINE_5_SIZE + BB_TO_BB_MATRIX_LINE_6_SIZE)

// Total size of a backbone to backbone sub-matrix (proline-specific).
#define BB_TO_BB_PROLINE_MATRIX_SIZE                             \
    (BB_TO_BB_MATRIX_LINE_1_SIZE + BB_TO_BB_MATRIX_LINE_2_SIZE + \
     BB_TO_BB_MATRIX_LINE_3_SIZE + BB_TO_BB_MATRIX_LINE_4_SIZE + \
     BB_TO_BB_PROLINE_MATRIX_LINE_5_SIZE)

/*
 * bb_to_sep submatrices defines.
 */
#define BB_TO_SEP_MATRIX_SIZE 4
#define BB_TO_SEP_PROLINE_MATRIX_SIZE 3

/*
 * bb_g submatrices defines
 */
#define BB_G_MATRIX_SIZE 6
#define BB_G_PROLINE_MATRIX_SIZE 5

/*
 * bb_to_sep_fillins sub-matrix defines.
 */
#define BB_TO_SEP_FILLINS_SIZE 4

/*
 * sep_to_sc sub-matrix defines.
 */
#define SEP_TO_SC_PROLINE_MATRIX_SIZE 1

/*
 * sep_to_bb sub-matrix defines.
 */
#define SEP_TO_BB_MATRIX_SIZE 4
#define SEP_TO_BB_PROLINE_MATRIX_SIZE 3

/*
 * sep_to_sep sub-matrix defines.
 */
#define SEP_TO_SEP_MATRIX_SIZE 1

/*
 * sep_g sub-matrix defines.
 */
#define SEP_G_MATRIX_SIZE 1

/*
 * sep_to_bb_fillins sub-matrix defines.
 */
#define SEP_TO_BB_FILLINS_SIZE 4

// Could be 4 for some rows, but it's easier this way.
#define SEP_TO_BB_PROLINE_FILLINS_SIZE 5

/*
 * sep_to_sep_fillins sub-matrix defines.
 */
#define SEP_TO_SEP_FILLINS_SIZE 2

/*
 * all_to_spl_matrix sub-matrix defines.
 */
#define ALL_TO_SPL_MATRIX_SIZE_A 2
#define ALL_TO_SPL_MATRIX_SIZE_B 2

/*
 * all_to_spr_matrix sub-matrix defines.
 */
#define ALL_TO_SPR_MATRIX_SIZE_A 3
#define ALL_TO_SPR_MATRIX_SIZE_B 0

/*
 * spl_to_all_matrix sub-matrix defines.
 */
#define SPL_TO_ALL_MATRIX_SIZE_A 3
#define SPL_TO_ALL_MATRIX_SIZE_B 6

/*
 * spl_g submatrices defines
 */
#define SPL_G_MATRIX_SIZE_A 1
#define SPL_G_MATRIX_SIZE_B 2

/*
 * spr_to_all sub-matrix defines.
 */
#define SPR_TO_ALL_MATRIX_SIZE_A 4
#define SPR_TO_ALL_MATRIX_SIZE_B 0

/*
 * spr_g submatrices defines
 */
#define SPR_G_MATRIX_SIZE_A 1
#define SPR_G_MATRIX_SIZE_B 0

// Defines for printing data.

#define HLINE3                                                         \
    "****************************************************************" \
    "****************************************************************"

#define HLINE2                                                         \
    "----------------------------------------------------------------" \
    "----------------------------------------------------------------"

#define HLINE1                                                         \
    "<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<" \
    ">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>"

// #define ARRAY_ENTRY_SPEC "%8.4f"
#define ARRAY_ENTRY_SPEC "%10.6f"
// #define ARRAY_ENTRY_SPEC "%100.50f"

#define PADDING "      "

#define DETAILED_RESULT_PAD 35

#define MAX_N_PRINT_DATA_PRETTIFIED 100

/**
 * Returns the dot product between vector VIN1 and vector VIN2 of size DIM.
 * 
 * @param vin1 Input vector 1.
 * @param vin2 Input vector 2.
 * @return real The dot product between both input vectors.
 */
static real posvectors_dotproduct(const rvec vin1, const rvec vin2) {
    return vin1[XX] * vin2[XX] +
           vin1[YY] * vin2[YY] +
           vin1[ZZ] * vin2[ZZ];
}

/**
 * Computes the vector substraction of VIN1 and VIN2 into VOUT. If PBC is not
 * NULL, the container information will be used to ensure that the output vector
 * of coordinates is inside the container: "The existence of PBC means that any
 * atom that leaves a simulation box by, say, the right-hand face, then enters
 * the simulation box by the left-hand face."
 *
 * @param pbc PBC (container) information.
 * @param vin1 Input vector 1.
 * @param vin2 Input vector 2.
 * @param vout Output vector.
 */
static void posvectors_sub(const t_pbc *const pbc, const rvec vin1,
                    const rvec vin2, rvec vout) {
    if (pbc) {
        pbc_dx(pbc, vin1, vin2, vout);
    }
    else {
        rvec_sub(vin1, vin2, vout);
    }
}

gmx::IlvesPC::IlvesPC(molecule_t *const mol, const int threads) : mol(mol) {
    ilves_peptides_reorder(mol);

    make_weights(mol, mol->bond_graph);

    nthreads = threads;

    if (mol->num_side_chains <= 0) {
        fprintf(stderr,
            "ERROR: The number of side chains of the molecule must be "
            "> 0 in order to use Ilves.\n");
        exit(2);
    }

    if (mol->num_side_chains < nthreads) {
        nthreads = mol->num_side_chains;

        fprintf(stdout,
            "The number of side-chains is less than the number of threads, "
            "so the new value for NTHREADS is %d\n",
            mol->num_side_chains);
    }

    x_ab.resize(mol->n);
    xprime_ab.resize(mol->n);

    /*
     * Init special data.
     */

    special_data = (special_data_t *)malloc(1 * sizeof(special_data_t));

    // Special matrices.
    special_data->spl_to_all_matrix.max_size = (mol->ends_type == TYPE_A)
                                                   ? SPL_TO_ALL_MATRIX_SIZE_A
                                                   : SPL_TO_ALL_MATRIX_SIZE_B;
    init_A(&special_data->spl_to_all_matrix, false);

    special_data->spr_to_all_matrix.max_size = (mol->ends_type == TYPE_A)
                                                   ? SPR_TO_ALL_MATRIX_SIZE_A
                                                   : SPR_TO_ALL_MATRIX_SIZE_B;
    init_A(&special_data->spr_to_all_matrix, false);

    special_data->all_to_spl_matrix.max_size = (mol->ends_type == TYPE_A)
                                                   ? ALL_TO_SPL_MATRIX_SIZE_A
                                                   : ALL_TO_SPL_MATRIX_SIZE_B;
    init_A(&special_data->all_to_spl_matrix, false);

    special_data->all_to_spr_matrix.max_size = (mol->ends_type == TYPE_A)
                                                   ? ALL_TO_SPR_MATRIX_SIZE_A
                                                   : ALL_TO_SPR_MATRIX_SIZE_B;
    init_A(&special_data->all_to_spr_matrix, false);

    special_data->spl_g_matrix.max_size = (mol->ends_type == TYPE_A)
                                              ? SPL_G_MATRIX_SIZE_A
                                              : SPL_G_MATRIX_SIZE_B;
    init_g(&special_data->spl_g_matrix);

    special_data->spr_g_matrix.max_size = (mol->ends_type == TYPE_A)
                                              ? SPR_G_MATRIX_SIZE_A
                                              : SPR_G_MATRIX_SIZE_B;
    init_g(&special_data->spr_g_matrix);

    // spl A and g initialization.
    initialize_matrices(0, 0, &special_data->spl_g_matrix);

    // spr A and g initialization.
    if (mol->ends_type == TYPE_A) {
        initialize_matrices(nthreads - 1,
                            SPL_G_MATRIX_SIZE_A,
                            &special_data->spr_g_matrix);
    }

    /*
     * Init shared data.
     */

    // Mutexes and Schur rows.
    if (nthreads > 1) {
        shared_data = (shared_data_t *)malloc((nthreads - 1) * sizeof(shared_data_t));
        boundary_sems = (safe_sem_pair_t *)malloc(nthreads * sizeof(safe_sem_pair_t));

        for (int i = 0; i < nthreads - 1; ++i) {
            shared_data_t *sd = &shared_data[i];

            pthread_mutex_init(&sd->lock, 0);

            sd->sep_to_sc_matrix.max_size = SEP_TO_SC_PROLINE_MATRIX_SIZE;
            init_A(&sd->sep_to_sc_matrix, true);

            sd->sep_to_bb_matrix.max_size = SEP_TO_BB_MATRIX_SIZE;
            init_A(&sd->sep_to_bb_matrix, true);

            sd->sep_to_sep_matrix.max_size = SEP_TO_SEP_MATRIX_SIZE;
            init_A(&sd->sep_to_sep_matrix, true);

            sd->sep_g_matrix.max_size = SEP_G_MATRIX_SIZE;
            init_g(&sd->sep_g_matrix);

            sd->sep_to_bb_fillins.max_size = SEP_TO_BB_PROLINE_FILLINS_SIZE;
            init_A(&sd->sep_to_bb_fillins, true);

            sd->sep_to_sep_fillins.max_size = SEP_TO_SEP_FILLINS_SIZE;
            init_A(&sd->sep_to_sep_fillins, true);
        }
        // Semaphores
        for (int i = 0; i < nthreads; ++i) {
            sem_init(&boundary_sems[i].left, 0, 0);
            sem_init(&boundary_sems[i].right, 0, 0);
        }
    }

    /*
     * Init private data
     */

    private_data = (private_data_t *)malloc(nthreads * sizeof(private_data_t));

    int goal_entries_per_cpu = get_num_entries_mol() / nthreads;

    int side_chain_idx = 0;
    int first_bb_bond = mol->n_sc + 2;   // The first two bonds are the special
                                         // ones.
    int first_sc_bond = 2;   // The first two bonds are the special ones.
    int first_sep_bond = mol->n - mol->num_side_chains;

    // int first_bb_atom =

    // Compute which side-chains are assigned to each thread.
    for (int i = 0; i < nthreads; ++i) {
        private_data_t *pd = &private_data[i];

        pd->first_side_chain = side_chain_idx;
        pd->num_side_chains = 0;

        pd->first_sc_bond = first_sc_bond;
        pd->first_bb_bond = first_bb_bond;
        pd->first_sep_bond = first_sep_bond;

        pd->sc_num_bonds = 0;
        pd->bb_num_bonds = 0;

        pd->sc_to_sc_matrix.max_size = 0;
        pd->sc_to_bb_matrix.max_size = 0;
        pd->sc_to_sep_matrix.max_size = 0;
        pd->sc_g_matrix.max_size = 0;

        pd->sc_to_sc_fillins.max_size = 0;
        pd->sc_to_bb_fillins.max_size = 0;

        pd->bb_to_sc_matrix.max_size = 0;
        pd->bb_to_bb_matrix.max_size = 0;
        pd->bb_to_sep_matrix.max_size = 0;
        pd->bb_g_matrix.max_size = 0;

        pd->bb_to_sc_fillins.max_size = 0;
        pd->bb_to_sep_fillins.max_size = 0;

        pd->sep_to_sc_matrix.max_size = 0;
        pd->sep_to_bb_matrix.max_size = 0;
        pd->sep_to_sep_matrix.max_size = 0;
        pd->sep_g_matrix.max_size = 0;

        pd->sep_to_bb_fillins.max_size = 0;
        pd->sep_to_sep_fillins.max_size = 0;

        int total_entries_cpu = 0;

        if (i == 0) {   // The first thread computes spl atoms.
            total_entries_cpu += mol->ends_type == TYPE_A
                                     ? SPL_TO_ALL_MATRIX_SIZE_A +
                                           ALL_TO_SPL_MATRIX_SIZE_A +
                                           SPL_G_MATRIX_SIZE_A
                                     : SPL_TO_ALL_MATRIX_SIZE_B +
                                           ALL_TO_SPL_MATRIX_SIZE_B +
                                           SPL_G_MATRIX_SIZE_B;
        }
        if (i == nthreads - 1) {   // The last thread computes spr atoms.
            total_entries_cpu += mol->ends_type == TYPE_A
                                     ? SPR_TO_ALL_MATRIX_SIZE_A +
                                           ALL_TO_SPR_MATRIX_SIZE_A +
                                           SPR_G_MATRIX_SIZE_A
                                     : SPR_TO_ALL_MATRIX_SIZE_B +
                                           ALL_TO_SPR_MATRIX_SIZE_B +
                                           SPR_G_MATRIX_SIZE_B;
        }

        for (; side_chain_idx < mol->num_side_chains; ++side_chain_idx) {
            side_chain_type_t type = mol->side_chain_types[side_chain_idx];

            int entries_side_chain = get_num_entries_side_chain(type);

            // Add this side-chain to CPU i?
            if (
                // This CPU does not have any side-chain assigned.
                pd->num_side_chains == 0 ||
                // Last CPU, no other choice.
                i == nthreads - 1 ||
                // Add current side-chain to balance work.
                ((abs((total_entries_cpu + entries_side_chain) - goal_entries_per_cpu) <
                  abs(total_entries_cpu - goal_entries_per_cpu)) &&
                 // At least one side-chain for each ramaining CPU
                 (nthreads - (i + 1) <=
                  mol->num_side_chains - (side_chain_idx + 1)))) {
                total_entries_cpu += entries_side_chain;
                ++pd->num_side_chains;

                first_sc_bond += side_chain_bonds[type];
                first_bb_bond += (type == PROLINE ? BB_G_PROLINE_MATRIX_SIZE
                                                  : BB_G_MATRIX_SIZE);

                first_sep_bond += SEP_G_MATRIX_SIZE;

                pd->sc_num_bonds += side_chain_bonds[type];
                pd->bb_num_bonds += (type == PROLINE ? BB_G_PROLINE_MATRIX_SIZE
                                                     : BB_G_MATRIX_SIZE);

                // Matrix sizes
                pd->sc_to_sc_matrix.max_size += sc_to_sc_matrix_sizes[type];
                pd->sc_to_bb_matrix.max_size += sc_to_bb_matrix_sizes[type];
                pd->sc_to_sep_matrix.max_size += (type == PROLINE
                                                      ? SC_TO_SEP_PROLINE_MATRIX_SIZE
                                                      : 0);

                pd->sc_g_matrix.max_size += sc_g_matrix_sizes[type];

                pd->sc_to_sc_fillins.max_size += sc_to_sc_fillins_sizes[type];
                pd->sc_to_bb_fillins.max_size += (type == PROLINE
                                                      ? SC_TO_BB_PROLINE_FILLINS_SIZE
                                                      : 0);

                pd->bb_to_sc_matrix.max_size += bb_to_sc_matrix_sizes[type];
                pd->bb_to_bb_matrix.max_size += (type == PROLINE
                                                     ? BB_TO_BB_PROLINE_MATRIX_SIZE
                                                     : BB_TO_BB_MATRIX_SIZE);
                pd->bb_to_sep_matrix.max_size += (type == PROLINE
                                                      ? BB_TO_SEP_PROLINE_MATRIX_SIZE
                                                      : BB_TO_SEP_MATRIX_SIZE);

                pd->bb_g_matrix.max_size += (type == PROLINE ? BB_G_PROLINE_MATRIX_SIZE
                                                             : BB_G_MATRIX_SIZE);

                pd->bb_to_sc_fillins.max_size += (type == PROLINE
                                                      ? BB_TO_SC_PROLINE_FILLINS_SIZE
                                                      : 0);
                pd->bb_to_sep_fillins.max_size += BB_TO_SEP_FILLINS_SIZE;

                pd->sep_to_sc_matrix.max_size += (type == PROLINE
                                                      ? SEP_TO_SC_PROLINE_MATRIX_SIZE
                                                      : 0);

                pd->sep_to_bb_matrix.max_size += (type == PROLINE
                                                      ? SEP_TO_BB_PROLINE_MATRIX_SIZE
                                                      : SEP_TO_BB_MATRIX_SIZE);
                pd->sep_to_sep_matrix.max_size += SEP_TO_SEP_MATRIX_SIZE;

                pd->sep_g_matrix.max_size += SEP_G_MATRIX_SIZE;

                pd->sep_to_bb_fillins.max_size += (type == PROLINE
                                                       ? SEP_TO_BB_PROLINE_FILLINS_SIZE
                                                       : SEP_TO_BB_FILLINS_SIZE);
                pd->sep_to_sep_fillins.max_size += SEP_TO_SEP_FILLINS_SIZE;
            }
            // Better DON'T add current side-chain.
            else {
                break;
            }
        }
    }

    // Alloc private data.
    // Each thread must allocate their data in order to exploit NUMA
    // architectures, if not, all data will be allocated in the local memory of
    // the master thread. Also the affinity policy of OpenMP must assure that
    // each thread is always assigned to the same core (set the enviromental
    // variables accordingly).
    #pragma omp parallel for
    for (int i = 0; i < nthreads; ++i) {
        private_data_t *pd = &private_data[i];

        // SC
        init_A(&pd->sc_to_sc_matrix, 0);
        init_A(&pd->sc_to_bb_matrix, 0);
        init_A(&pd->sc_to_sep_matrix, 0);

        init_g(&pd->sc_g_matrix);

        init_A(&pd->sc_to_sc_fillins, 1);
        init_A(&pd->sc_to_bb_fillins, 1);

        // BB
        init_A(&pd->bb_to_sc_matrix, 0);
        init_A(&pd->bb_to_bb_matrix, 0);
        init_A(&pd->bb_to_sep_matrix, 0);

        init_g(&pd->bb_g_matrix);

        init_A(&pd->bb_to_sc_fillins, 1);
        init_A(&pd->bb_to_sep_fillins, 1);

        // SEP
        init_A(&pd->sep_to_sc_matrix, 0);
        init_A(&pd->sep_to_bb_matrix, 0);
        init_A(&pd->sep_to_sep_matrix, 0);

        init_g(&pd->sep_g_matrix);

        init_A(&pd->sep_to_bb_fillins, 1);
        init_A(&pd->sep_to_sep_fillins, 1);

        pd->num_bonds = pd->sc_num_bonds + pd->bb_num_bonds + pd->num_side_chains;

        if (i == 0) {
            pd->num_bonds += mol->ends_type == TYPE_A ? SPL_G_MATRIX_SIZE_A
                                                      : SPL_G_MATRIX_SIZE_B;
        }
        if (i == nthreads - 1) {
            pd->num_bonds += mol->ends_type == TYPE_A ? SPR_G_MATRIX_SIZE_A
                                                      : SPR_G_MATRIX_SIZE_B;
        }

        // SC A and g.
        initialize_matrices(i, pd->first_sc_bond, &pd->sc_g_matrix);

        // BB A and g.
        initialize_matrices(i, pd->first_bb_bond, &pd->bb_g_matrix);

        // SEP A and g.
        initialize_matrices(i, pd->first_sep_bond, &pd->sep_g_matrix);
    }
}

gmx::IlvesPC::~IlvesPC() {
    /*
     * Destroy special data.
     */

    // spl
    destroy_A(&special_data->spl_to_all_matrix);
    destroy_A(&special_data->all_to_spl_matrix);

    destroy_g(&special_data->spl_g_matrix);

    // spr
    destroy_A(&special_data->spr_to_all_matrix);
    destroy_A(&special_data->all_to_spr_matrix);

    destroy_g(&special_data->spr_g_matrix);

    free(special_data);

    /*
     * Destroy shared data.
     */

    if (nthreads > 1) {
        // Mutexes and Schur rows.
        for (int i = 0; i < nthreads - 1; ++i) {
            shared_data_t *sd = &shared_data[i];

            pthread_mutex_destroy(&sd->lock);

            destroy_A(&sd->sep_to_sc_matrix);
            destroy_A(&sd->sep_to_bb_matrix);
            destroy_A(&sd->sep_to_sep_matrix);

            destroy_A(&sd->sep_to_bb_fillins);
            destroy_A(&sd->sep_to_sep_fillins);

            destroy_g(&sd->sep_g_matrix);
        }
        // Semaphores
        for (int i = 0; i < nthreads; ++i) {
            sem_destroy(&boundary_sems[i].left);
            sem_destroy(&boundary_sems[i].right);
        }

        free(shared_data);
        free(boundary_sems);
    }

    // Destroy private data.
    for (int i = 0; i < nthreads; i++) {
        private_data_t *pd = &private_data[i];

        destroy_A(&pd->sc_to_sc_matrix);
        destroy_A(&pd->sc_to_bb_matrix);
        destroy_A(&pd->sc_to_sep_matrix);

        destroy_g(&pd->sc_g_matrix);

        destroy_A(&pd->sc_to_sc_fillins);
        destroy_A(&pd->sc_to_bb_fillins);

        destroy_A(&pd->bb_to_sc_matrix);
        destroy_A(&pd->bb_to_bb_matrix);
        destroy_A(&pd->bb_to_sep_matrix);

        destroy_g(&pd->bb_g_matrix);

        destroy_A(&pd->bb_to_sc_fillins);
        destroy_A(&pd->bb_to_sep_fillins);

        destroy_A(&pd->sep_to_sc_matrix);
        destroy_A(&pd->sep_to_bb_matrix);
        destroy_A(&pd->sep_to_sep_matrix);

        destroy_g(&pd->sep_g_matrix);

        destroy_A(&pd->sep_to_bb_fillins);
        destroy_A(&pd->sep_to_sep_fillins);
    }

    free(private_data);
}

bool gmx::IlvesPC::solve(const ArrayRef<const RVec> x,
                         const ArrayRef<RVec> xprime,
                         const ArrayRef<RVec> vprime,
                         int &numit,
                         real &error,
                         const real tol,
                         const int maxit,
                         const real deltat,
                         const bool constraint_virial,
                         tensor virial,
                         const bool constraint_velocities,
                         const t_pbc *const pbc,
                         const bool compute_fep,
                         const real fep_lambda,
                         real &fep_force,
                         t_nrnb *const perf_stats) {
    /*
    Since we know that MOL is a protein and its bonds are numbered following the
    rules explained in docs, we know that after performing
    evaluate_constraint_function_ilves() and make_matrix_ilves() the resulting
    matrix structure will always be the same:

               | | |
               v v v
     sp          sc             bb               sep       g
     1 2       1 2 3       1 2 3 4 5 6           1 2
    -----     -------     -------------         -----
    |x  | ... |     | ... |x x        |   ...   |   | ... |x| spl  1 **
    -----     -------     -------------         -----
    -----     -------     -------------         -----
    |  x| ... |     |     |        x x|         |  x|     |x| spr  2 **
    -----     -------     -------------         -----
      .          .              .                 .
      .          .              .                 .
    -----     -------     -------------         -----
    |   |     |x x  |     |           |         |   |     |x|      1      <--
    |   | ... |x x x| ... |           |   ...   |   | ... |x| sc   2 ***  <--
    |   |     |  x x|     |       x   |         |   |     |x|      3      <--
    -----     -------     -------------         -----
      .          .              .                 .
      .          .              .                 .
    -----     -------     -------------         -----
    |x  |     |     |     |x x        |         |x  |     |x|      1
    |x  |     |     |     |x x x x x  |         |x  |     |x|      2
    |   |     |     |     |  x x x x  |         |   |     |x| bb   3
    |   |     |    x|     |  x x x x  |   ...   |   | ... |x|      4
    |  x|     |     |     |  x x x x x|         |  x|     |x|      5
    |  x|     |     |     |        x x|         |  x|     |x|      6
    -----     -------     -------------         -----
                               OR                 OR  ****
                          -----------           -----
                          |x x      |           |x  |
                          |x x x x x|           |x  |
      .          .        |  x x x x|           |   |
                          |  x x x x|           |   |
      .          .        |  x x x x|           |  x|
                          -----------           -----
      .          .              .                 .
                                .                 .
    -----     -------     -----------------     -----
    |  x| ... |     | ... |        x x x x| ... |x  |     |x| sep  1
    -----     -------     -----------------     -----
                OR               OR  *****
              -------     ---------------
              |    x|     |        x x x|
              -------     ---------------

    spl = special left      sep = separation bonds
    sc = side-chain         g = independent terms
    bb = backbone

    There are several submatrix types, one for each correspondence X-to-Y,
    for example sc-to-sc, this is the submatrix formed by the rows and columns
    marked with [<-, |]
                [    v]

    (**) The ends of a molecule do not match the pattern of the rest of the
    molecule. There are two types of ends, type-A and type-B, furthermore if the
    first or last side-chains of the matrix is a proline, the ends are a little
    bit different. The special atoms that appear at the ends of the molecules
    are part of the  special matrices, and are divided into special-left (spl,
    for the special atoms at the left of the molecule), and special-right (spr,
    for the special atoms at the right of the molecule). In the picture below,
    the special matrix correcponds to a molecule with ends of type-A and neither
    the first nor the last side-chain is a proline. To see every possible type
    of special matrix, go to solve_1().

    (***) In the picture, the sc-to-X and bb-to-sc submatrices correspond to a
    linear side-chain of 3 atoms (unrealistic), in reality there are 20
    different types of these submatrices, corresponding to the different types
    of aminoacids (side-chains), defined in molecule.h. This translates in 20
    different step 2, 3, 16 and 17, one for each aminoacid.

    (****, *****) There is one special type of aminoacid (proline) that messes
    up things a bit. This aminoacid is two times connected with the backbone,
    and the backbone block corresponding to this side-chain lacks one atom. This
    translates in different bb-to-bb, bb-to-sep, sep-to-sc and sep-to-bb
    submatrices.

    WARNING: Note that the first two rows of the first bb-to-sep sub-matrix
    and the last two columns of the last sep-to-bb submatrix do not exist, but
    are made-up (with value 0.0) to ease indexing.

    The linear system is solved using thread level parallelism, Gaussian
    elimination and the Schur method for solving the part of the system
    corresponding to the sep-to-X submatrices.
    */

    // Total number Newton's method iterations.
    numit = 0;

#if STOPWATCH_DETAILED_INFO
    // Step descriptor.
    std::vector<const char *> stopwatch_detailed_steps =
        {"make_g",     "make_A",   "solve_1",  "solve_2",  "solve_3",
         "solve_4",    "solve_5",  "solve_6",  "solve_7",  "solve_8",
         "solve_9_10", "solve_11", "solve_12", "solve_13", "solve_14",
         "solve_15",   "solve_16", "solve_17", "solve_18", "update_positions"};

    std::vector<PerfStopwatch> psw_det(stopwatch_detailed_steps.size(),
                                       PerfStopwatch(perf_events_to_print));
    std::vector<TimeStopwatch> sw_det(stopwatch_detailed_steps.size());

#endif

    real tau = 0;

    #pragma omp parallel num_threads(nthreads)
    {
        const int thread = omp_get_thread_num();

#if STOPWATCH_DETAILED_INFO
        #pragma omp barrier
        #pragma omp master
        {
            psw_det[0].play();
            sw_det[0].play();
        }
        #pragma omp barrier
#endif

        #pragma omp for reduction(max:tau)
        for (int j = 0; j < nthreads; ++j) {
            // Compute g(x).
            tau = make_g(thread, pbc, x, xprime, false, true);
        }

#if STOPWATCH_DETAILED_INFO
        #pragma omp barrier
        #pragma omp master
        {
            sw_det[0].pause();
            psw_det[0].pause();
        }
        #pragma omp barrier
#endif

#if DEBUG
        #pragma omp barrier
        #pragma omp master
        {
            printf("After outer make_g =>\n");
            // print_data();
            print_data_prettified(mol);
        }
        #pragma omp barrier
#endif

        // Do at most MAXIT Newton steps.
        for (int i = 0; i < maxit && tol < tau; ++i) {
            #pragma omp master
            { ++numit; }

            if (nthreads > 1) {
                // Lock every mutex to avoid using a barrier after calling
                // make_matrix_ilves(), the mutexes will be released after
                // setting each shared Schur row inside make_matrix_ilves().
                #pragma omp for
                for (int j = 0; j < nthreads - 1; j++) {
                    pthread_mutex_lock(&shared_data[j].lock);
                }
            }

#if STOPWATCH_DETAILED_INFO
            #pragma omp barrier
            #pragma omp master
            {
                psw_det[1].play();
                sw_det[1].play();
            }
            #pragma omp barrier
#endif

            // Compute the coefficient matrix.
            make_A(thread);

#if STOPWATCH_DETAILED_INFO
            #pragma omp barrier
            #pragma omp master
            {
                sw_det[1].pause();
                psw_det[1].pause();
            }
            #pragma omp barrier
#endif

#if DEBUG
            #pragma omp barrier
            #pragma omp master
            {
                printf("\nAfter make_A =>\n");
                // print_data();
                print_data_prettified(mol);
            }
            #pragma omp barrier
#endif

            //------------------------------------------------------------------------------

#if STOPWATCH_DETAILED_INFO
            #pragma omp barrier
            #pragma omp master
            {
                psw_det[2].play();
                sw_det[2].play();
            }
            #pragma omp barrier
#endif
            solve_1(thread);

#if STOPWATCH_DETAILED_INFO
            #pragma omp barrier
            #pragma omp master
            {
                sw_det[2].pause();
                psw_det[2].pause();
            }
            #pragma omp barrier
#endif

#if DEBUG
            #pragma omp barrier
            #pragma omp master
            {
                printf("After solve_1 =>\n");
                // print_data();
                print_data_prettified(mol);
            }
            #pragma omp barrier
#endif

            //------------------------------------------------------------------------------

#if STOPWATCH_DETAILED_INFO
            #pragma omp barrier
            #pragma omp master
            {
                psw_det[3].play();
                sw_det[3].play();
            }
            #pragma omp barrier
#endif

            solve_2(thread);

#if STOPWATCH_DETAILED_INFO
            #pragma omp barrier
            #pragma omp master
            {
                sw_det[3].pause();
                psw_det[3].pause();
            }
            #pragma omp barrier
#endif

#if DEBUG
            #pragma omp barrier
            #pragma omp master
            {
                printf("After solve_2 =>\n");
                // print_data();
                print_data_prettified(mol);
            }
            #pragma omp barrier
#endif

            //------------------------------------------------------------------------------

#if STOPWATCH_DETAILED_INFO
            #pragma omp barrier
            #pragma omp master
            {
                psw_det[4].play();
                sw_det[4].play();
            }
            #pragma omp barrier
#endif

            solve_3(thread);

#if STOPWATCH_DETAILED_INFO
            #pragma omp barrier
            #pragma omp master
            {
                sw_det[4].pause();
                psw_det[4].pause();
            }
            #pragma omp barrier
#endif

#if DEBUG
            #pragma omp barrier
            #pragma omp master
            {
                printf("After solve_3 =>\n");
                // print_data();
                print_data_prettified(mol);
            }
            #pragma omp barrier
#endif

            //------------------------------------------------------------------------------

#if STOPWATCH_DETAILED_INFO
            #pragma omp barrier
            #pragma omp master
            {
                psw_det[5].play();
                sw_det[5].play();
            }
            #pragma omp barrier
#endif

            solve_4(thread);

#if STOPWATCH_DETAILED_INFO
            #pragma omp barrier
            #pragma omp master
            {
                sw_det[5].pause();
                psw_det[5].pause();
            }
            #pragma omp barrier
#endif

#if DEBUG
            #pragma omp barrier
            #pragma omp master
            {
                printf("After solve_4 =>\n");
                // print_data();
                print_data_prettified(mol);
            }
            #pragma omp barrier
#endif

            //------------------------------------------------------------------------------

#if STOPWATCH_DETAILED_INFO
            #pragma omp barrier
            #pragma omp master
            {
                psw_det[6].play();
                sw_det[6].play();
            }
            #pragma omp barrier
#endif

            solve_5(thread);

#if STOPWATCH_DETAILED_INFO
            #pragma omp barrier
            #pragma omp master
            {
                sw_det[6].pause();
                psw_det[6].pause();
            }
            #pragma omp barrier
#endif

#if DEBUG
            #pragma omp barrier
            #pragma omp master
            {
                printf("After solve_5 =>\n");
                // print_data();
                print_data_prettified(mol);
            }
            #pragma omp barrier
#endif

            //------------------------------------------------------------------------------

#if STOPWATCH_DETAILED_INFO
            #pragma omp barrier
            #pragma omp master
            {
                psw_det[7].play();
                sw_det[7].play();
            }
            #pragma omp barrier
#endif

            solve_6(thread);

#if STOPWATCH_DETAILED_INFO
            #pragma omp barrier
            #pragma omp master
            {
                sw_det[7].pause();
                psw_det[7].pause();
            }
            #pragma omp barrier
#endif

#if DEBUG
            #pragma omp barrier
            #pragma omp master
            {
                printf("After solve_6 =>\n");
                // print_data();
                print_data_prettified(mol);
            }
            #pragma omp barrier
#endif

            //------------------------------------------------------------------------------

#if STOPWATCH_DETAILED_INFO
            #pragma omp barrier
            #pragma omp master
            {
                psw_det[8].play();
                sw_det[8].play();
            }
            #pragma omp barrier
#endif

            solve_7(thread);

#if STOPWATCH_DETAILED_INFO
            #pragma omp barrier
            #pragma omp master
            {
                sw_det[8].pause();
                psw_det[8].pause();
            }
            #pragma omp barrier
#endif

#if DEBUG
            #pragma omp barrier
            #pragma omp master
            {
                printf("After solve_7 =>\n");
                // print_data();
                print_data_prettified(mol);
            }
            #pragma omp barrier
#endif

            //------------------------------------------------------------------------------

#if STOPWATCH_DETAILED_INFO
            #pragma omp barrier
            #pragma omp master
            {
                psw_det[9].play();
                sw_det[9].play();
            }
            #pragma omp barrier
#endif

            solve_8(thread);

#if STOPWATCH_DETAILED_INFO
            #pragma omp barrier
            #pragma omp master
            {
                sw_det[9].pause();
                psw_det[9].pause();
            }
            #pragma omp barrier
#endif

#if DEBUG
            #pragma omp barrier
            #pragma omp master
            {
                printf("After solve_8 =>\n");
                // print_data();
                print_data_prettified(mol);
            }
            #pragma omp barrier
#endif

            //------------------------------------------------------------------------------

#if STOPWATCH_DETAILED_INFO
            #pragma omp barrier
            #pragma omp master
            {
                psw_det[10].play();
                sw_det[10].play();
            }
            #pragma omp barrier
#endif

            #pragma omp barrier
            #pragma omp master
            {
                tau = 0;   // Reset tau for the following reduction.

                solve_9();
                solve_10();
            }
            #pragma omp barrier

#if STOPWATCH_DETAILED_INFO
            #pragma omp barrier
            #pragma omp master
            {
                sw_det[10].pause();
                psw_det[10].pause();
            }
            #pragma omp barrier
#endif

#if DEBUG
            #pragma omp barrier
            #pragma omp master
            {
                printf("After solve_9_10 (Schur matrix) =>\n");
                // print_data();
                print_data_prettified(mol);
            }
            #pragma omp barrier
#endif

            //------------------------------------------------------------------------------

#if STOPWATCH_DETAILED_INFO
            #pragma omp barrier
            #pragma omp master
            {
                psw_det[11].play();
                sw_det[11].play();
            }
            #pragma omp barrier
#endif

            solve_11(thread);

#if STOPWATCH_DETAILED_INFO
            #pragma omp barrier
            #pragma omp master
            {
                sw_det[11].pause();
                psw_det[11].pause();
            }
            #pragma omp barrier
#endif

#if DEBUG
            #pragma omp barrier
            #pragma omp master
            {
                printf("After solve_11 =>\n");
                // print_data();
                print_data_prettified(mol);
            }
            #pragma omp barrier
#endif

            //------------------------------------------------------------------------------

#if STOPWATCH_DETAILED_INFO
            #pragma omp barrier
            #pragma omp master
            {
                psw_det[12].play();
                sw_det[12].play();
            }
            #pragma omp barrier
#endif

            solve_12(thread);

#if STOPWATCH_DETAILED_INFO
            #pragma omp barrier
            #pragma omp master
            {
                sw_det[12].pause();
                psw_det[12].pause();
            }
            #pragma omp barrier
#endif

#if DEBUG
            #pragma omp barrier
            #pragma omp master
            {
                printf("After solve_12 =>\n");
                // print_data();
                print_data_prettified(mol);
            }
            #pragma omp barrier
#endif

            //------------------------------------------------------------------------------

#if STOPWATCH_DETAILED_INFO
            #pragma omp barrier
            #pragma omp master
            {
                psw_det[13].play();
                sw_det[13].play();
            }
            #pragma omp barrier
#endif

            solve_13(thread);

#if STOPWATCH_DETAILED_INFO
            #pragma omp barrier
            #pragma omp master
            {
                sw_det[13].pause();
                psw_det[13].pause();
            }
            #pragma omp barrier
#endif

#if DEBUG
            #pragma omp barrier
            #pragma omp master
            {
                printf("After solve_13 =>\n");
                // print_data();
                print_data_prettified(mol);
            }
            #pragma omp barrier
#endif

            //------------------------------------------------------------------------------

#if STOPWATCH_DETAILED_INFO
            #pragma omp barrier
            #pragma omp master
            {
                psw_det[14].play();
                sw_det[14].play();
            }
            #pragma omp barrier
#endif

            solve_14(thread);

#if STOPWATCH_DETAILED_INFO
            #pragma omp barrier
            #pragma omp master
            {
                sw_det[14].pause();
                psw_det[14].pause();
            }
            #pragma omp barrier
#endif

#if DEBUG
            #pragma omp barrier
            #pragma omp master
            {
                printf("After solve_14 =>\n");
                // print_data();
                print_data_prettified(mol);
            }
            #pragma omp barrier
#endif

            //------------------------------------------------------------------------------

#if STOPWATCH_DETAILED_INFO
            #pragma omp barrier
            #pragma omp master
            {
                psw_det[15].play();
                sw_det[15].play();
            }
            #pragma omp barrier
#endif

            solve_15(thread);

#if STOPWATCH_DETAILED_INFO
            #pragma omp barrier
            #pragma omp master
            {
                sw_det[15].pause();
                psw_det[15].pause();
            }
            #pragma omp barrier
#endif

#if DEBUG
            #pragma omp barrier
            #pragma omp master
            {
                printf("After solve_15 =>\n");
                // print_data();
                print_data_prettified(mol);
            }
            #pragma omp barrier
#endif

            //------------------------------------------------------------------------------

#if STOPWATCH_DETAILED_INFO
            #pragma omp barrier
            #pragma omp master
            {
                psw_det[16].play();
                sw_det[16].play();
            }
            #pragma omp barrier
#endif

            solve_16(thread);

#if STOPWATCH_DETAILED_INFO
            #pragma omp barrier
            #pragma omp master
            {
                sw_det[16].pause();
                psw_det[16].pause();
            }
            #pragma omp barrier
#endif

#if DEBUG
            #pragma omp barrier
            #pragma omp master
            {
                printf("After solve_16 =>\n");
                // print_data();
                print_data_prettified(mol);
            }
            #pragma omp barrier
#endif

            //------------------------------------------------------------------------------

#if STOPWATCH_DETAILED_INFO
            #pragma omp barrier
            #pragma omp master
            {
                psw_det[17].play();
                sw_det[17].play();
            }
            #pragma omp barrier
#endif

            solve_17(thread);

#if STOPWATCH_DETAILED_INFO
            #pragma omp barrier
            #pragma omp master
            {
                sw_det[17].pause();
                psw_det[17].pause();
            }
            #pragma omp barrier
#endif

#if DEBUG
            #pragma omp barrier
            #pragma omp master
            {
                printf("After solve_17 =>\n");
                // print_data();
                print_data_prettified(mol);
            }
            #pragma omp barrier
#endif

            //------------------------------------------------------------------------------

#if STOPWATCH_DETAILED_INFO
            #pragma omp barrier
            #pragma omp master
            {
                psw_det[18].play();
                sw_det[18].play();
            }
            #pragma omp barrier
#endif

            solve_18(thread);

#if STOPWATCH_DETAILED_INFO
            #pragma omp barrier
            #pragma omp master
            {
                sw_det[18].pause();
                psw_det[18].pause();
            }
            #pragma omp barrier
#endif

#if DEBUG
            #pragma omp barrier
            #pragma omp master
            {
                printf("After solve_18 =>\n");
                // print_data();
                print_data_prettified(mol);
            }
            #pragma omp barrier
#endif

            //------------------------------------------------------------------------------

#if STOPWATCH_DETAILED_INFO
            #pragma omp barrier
            #pragma omp master
            {
                psw_det[19].play();
                sw_det[19].play();
            }
            #pragma omp barrier
#endif
            update_positions(thread, xprime, i == 0);

#if STOPWATCH_DETAILED_INFO
            #pragma omp barrier
            #pragma omp master
            {
                sw_det[19].pause();
                psw_det[19].pause();
            }
            #pragma omp barrier
#endif

            //------------------------------------------------------------------------------

#if STOPWATCH_DETAILED_INFO
            #pragma omp barrier
            #pragma omp master
            {
                psw_det[0].play();
                sw_det[0].play();
            }
            #pragma omp barrier
#endif

            #pragma omp for reduction(max:tau)
            for (int j = 0; j < nthreads; ++j) {
                // Compute g(x)
                tau = make_g(thread, pbc, x, xprime, true, false);
            }

            // fprintf(stderr, "tau = %lf\n", tau);

#if STOPWATCH_DETAILED_INFO
            #pragma omp barrier
            #pragma omp master
            {
                sw_det[0].pause();
                psw_det[0].pause();
            }
            #pragma omp barrier
#endif

#if DEBUG
            #pragma omp barrier
            #pragma omp master
            {
                printf("Inner make_g =>\n");
                // print_data();
                print_data_prettified(mol);
                printf("\ntau => %f\n", tau);
            }
            #pragma omp barrier
#endif
        }

        #pragma omp master
        {
            // Save the final relative constraint violation for the kth equation
            error = tau;
        }

        // Update the virial.
        if (constraint_virial) {
            update_virial(thread, virial);
        }
        // Update the velocities.
        if (constraint_velocities) {
            update_velocities(thread, vprime, 1 / deltat);
        }
    }

    // double sum_x = 0;
    // double sum_v = 0;
    // for (int i = 0; i < mol->m * DIM; ++i) {
    //     sum_x += xprime[i];
    //     sum_v += vprime[i];
    // }

    // fprintf(stderr, "sum_x = %.10lf, sum_v = %.10lf\n", sum_x, sum_v);

    /*
     * Update GROMACS performance statistics.
     */

    // The number of iterations.
    inc_nrnb(perf_stats, eNR_SHAKE, numit);
    // The number of constraints.
    inc_nrnb(perf_stats, eNR_SHAKE_RIJ, mol->n);
    if (constraint_velocities) {
        // The number of constrained velocities (TODO: I have not idea why * 2).
        inc_nrnb(perf_stats, eNR_CONSTR_V, mol->n * 2);
    }
    if (constraint_virial) {
        // The number of constrained virials.
        inc_nrnb(perf_stats, eNR_CONSTR_VIR, mol->n);
    }

#if STOPWATCH_DETAILED_INFO

    printf("\n" PADDING "Detailed information: \n\n");

    double total_time = 0;
    std::vector<unsigned int> total_perf_counters(perf_events_to_print.size());

    // Get total execution counters.
    for (size_t i = 0; i < stopwatch_detailed_steps.size(); i++) {
        total_time += sw_det[i].get_s();

        for (unsigned int j = 0; j < perf_events_to_print.size(); ++j) {
            try {
                uint64_t event_count = psw_det[i].get_counter(perf_events_to_print[j]);

                total_perf_counters[j] += event_count;
            }
            catch (...) {
            }
        }
    }

    /*
     * Print table headers.
     */

    // Time.
    printf(PADDING "%*s", DETAILED_RESULT_PAD, "time (s)");

    // Perf counters.
    for (unsigned int i = 0; i < perf_events_to_print.size(); ++i) {
        printf("%*s",
                   DETAILED_RESULT_PAD,
                   PerfStopwatch::get_descriptor(perf_events_to_print[i]));
    }

    printf("\n" PADDING);

    for (unsigned int i = 0; i < perf_events_to_print.size() + 1; ++i) {
        printf("%.*s",
                   DETAILED_RESULT_PAD,
                   "----------------------------------------------------------"
                   "-");
    }

    printf("\n");

    char time_descriptor_string[] = "%lf (%6.2lf%%)";
    char perf_descriptor_string[] = "%" PRId64 " (%6.2lf%%)";

    char result_string[50];

    // Print results.
    for (size_t i = 0; i < stopwatch_detailed_steps.size(); i++) {
        // time (s)
        sprintf(result_string,
                time_descriptor_string,
                sw_det[i].get_s(),
                (sw_det[i].get_s() / total_time) * 100);

        printf(PADDING "%*s", DETAILED_RESULT_PAD, result_string);

        // Perf events
        for (unsigned int j = 0; j < perf_events_to_print.size(); ++j) {
            try {
                uint64_t event_count = psw_det[i].get_counter(perf_events_to_print[j]);

                sprintf(result_string,
                        perf_descriptor_string,
                        event_count,
                        ((double)event_count / total_perf_counters[j]) * 100);

                printf("%*s", DETAILED_RESULT_PAD, result_string);
            }
            catch (...) {
                printf("%*s", DETAILED_RESULT_PAD, "NULL");
            }
        }

        // Step descriptor.
        printf(PADDING "%s\n", stopwatch_detailed_steps[i]);
    }

    // Total counters.

    // time (s)
    sprintf(result_string, time_descriptor_string, total_time, 100.0);

    printf(PADDING "%*s", DETAILED_RESULT_PAD, result_string);

    // Perf events
    for (unsigned int j = 0; j < perf_events_to_print.size(); ++j) {
        sprintf(result_string, perf_descriptor_string, total_perf_counters[j], 100.0);

        printf("%*s", DETAILED_RESULT_PAD, result_string);
    }

    // Descriptor.
    printf(PADDING "%s\n", "TOTAL");

    printf("\n");
#endif

    return error < tol;
}

/*
 * g_t functions.
 */

void gmx::IlvesPC::init_g(g_t *const g) {
    g->size = 0;
    size_t max_size = g->max_size;

    g->data = (real *)malloc(max_size * sizeof(real));
    g->current_lagr = (real *)malloc(max_size * sizeof(real));

    g->a = (int *)malloc(max_size * sizeof(real));
    g->b = (int *)malloc(max_size * sizeof(real));
    g->sigma2 = (real *)malloc(max_size * sizeof(real));
}

void gmx::IlvesPC::destroy_g(g_t *g) {
    free(g->data);
    free(g->current_lagr);

    free(g->a);
    free(g->b);
    free(g->sigma2);
}

/*
 * A_t functions.
 */

void gmx::IlvesPC::init_A(A_t *const A, const bool is_fillins) {
    size_t max_size = A->max_size;

    A->data = (real *)malloc(max_size * sizeof(real));

    if (!is_fillins) {
        A->size = 0;
        A->weight = (real *)malloc(max_size * sizeof(real));
        A->row = (int *)malloc(max_size * sizeof(int));
        A->col = (int *)malloc(max_size * sizeof(int));
    }
    else {
        A->size = A->max_size;   // If is fillins, we don't need to populate its
                                 // entries.
        A->weight = nullptr;
        A->row = nullptr;
        A->col = nullptr;
    }
}

void gmx::IlvesPC::destroy_A(A_t *A) {
    free(A->data);

    if (A->weight) {
        free(A->weight);
    }
    if (A->row) {
        free(A->row);
    }
    if (A->col) {
        free(A->col);
    }
}

void gmx::IlvesPC::A_push_back(const int row,
                               const int col,
                               const real weight,
                               A_t *const A) {
    A->row[A->size] = row;
    A->col[A->size] = col;

    A->weight[A->size] = weight;

    ++A->size;
}

/*
 * Initialization.
 */

void gmx::IlvesPC::initialize_matrices(const int thread,
                                       const int first_bond,
                                       g_t *const g) {
    private_data_t *pd = &private_data[thread];

    g->first_row = first_bond;

    for (size_t j = first_bond; j < first_bond + g->max_size; ++j) {
        // Which atoms are involved in bond j?
        int a = mol->bonds[2 * j];
        int b = mol->bonds[2 * j + 1];

        g->a[g->size] = a;
        g->b[g->size] = b;

        g->sigma2[g->size] = mol->sigma2[j];

        for (int l = mol->bond_graph->xadj[j]; l < mol->bond_graph->xadj[j + 1];
             ++l) {
            // Determine bond of the lth entry.
            size_t m = mol->bond_graph->adj[l];

            // Get the weight of the lth entry.
            real weight = mol->weights[l];

            // Determine in which sub-matrix-type are we.

            size_t spl_first_bond = 0;
            size_t spl_last_bond = (mol->ends_type == TYPE_A)
                                       ? SPL_G_MATRIX_SIZE_A - 1
                                       : SPL_G_MATRIX_SIZE_B - 1;

            size_t spr_first_bond = (mol->ends_type == TYPE_A) ? SPL_G_MATRIX_SIZE_A
                                                               : 1 /* No spr */;
            size_t spr_last_bond = (mol->ends_type == TYPE_A)
                                       ? SPL_G_MATRIX_SIZE_A
                                       : 0 /* No spr (1 > 0)*/;

            size_t sc_first_bond = (mol->ends_type == TYPE_A)
                                       ? SPL_G_MATRIX_SIZE_A + SPR_G_MATRIX_SIZE_A
                                       : SPL_G_MATRIX_SIZE_B;
            size_t sc_last_bond = mol->n_sc + sc_first_bond - 1;

            size_t bb_first_bond = sc_last_bond + 1;
            size_t bb_last_bond = mol->n - mol->num_side_chains - 1;

            size_t sep_first_bond = mol->n - mol->num_side_chains;
            size_t sep_last_bond = mol->n - 1;

            // spl to X sub-matrix.
            if (j >= spl_first_bond && j <= spl_last_bond) {
                A_push_back(j, m, weight, &special_data->spl_to_all_matrix);
            }
            // spr to X sub-matrix.
            else if (j >= spr_first_bond && j <= spr_last_bond) {
                A_push_back(j, m, weight, &special_data->spr_to_all_matrix);
            }
            // SC to X sub-matrix.
            else if (j >= sc_first_bond && j <= sc_last_bond) {
                // SC to spr.
                if (m >= spr_first_bond && m <= spr_last_bond) {
                    A_push_back(j, m, weight, &special_data->all_to_spr_matrix);
                }
                // SC to SC sub-matrix.
                else if (m >= sc_first_bond && m <= sc_last_bond) {
                    A_push_back(j, m, weight, &pd->sc_to_sc_matrix);
                }
                // SC to BB sub-matrix.
                else if (m >= bb_first_bond && m <= bb_last_bond) {
                    A_push_back(j, m, weight, &pd->sc_to_bb_matrix);
                }
                // SC to SEP sub-matrix
                else if (m >= sep_first_bond && m <= sep_last_bond) {
                    A_push_back(j, m, weight, &pd->sc_to_sep_matrix);
                }
            }
            // BB to X sub-matrix
            else if (j >= bb_first_bond && j <= bb_last_bond) {
                // BB to spl
                if (m >= spl_first_bond && m <= spl_last_bond) {
                    A_push_back(j, m, weight, &special_data->all_to_spl_matrix);
                }
                // BB to spr.
                else if (m >= spr_first_bond && m <= spr_last_bond) {
                    A_push_back(j, m, weight, &special_data->all_to_spr_matrix);
                }
                // BB to SC sub-matrix.
                else if (m >= sc_first_bond && m <= sc_last_bond) {
                    A_push_back(j, m, weight, &pd->bb_to_sc_matrix);
                }
                // BB to BB sub-matrix.
                else if (m >= bb_first_bond && m <= bb_last_bond) {
                    A_push_back(j, m, weight, &pd->bb_to_bb_matrix);

                    // Special case: first two rows of the first BB to SEP
                    // sub-matrix of the first thread, there must be 0s in order
                    // to mantain the pattern.

                    if (j <= bb_first_bond + 1 &&
                        l == mol->bond_graph->xadj[j + 1] - 1) {
                        // WARNING: To avoid overwriting A[0][0] (special),
                        // this entries must be printed before the special
                        // submatrix.
                        A_push_back(0, 0, 0, &pd->bb_to_sep_matrix);
                    }
                }
                // BB to SEP sub-matrix.
                else if (m >= sep_first_bond) {
                    A_push_back(j, m, weight, &pd->bb_to_sep_matrix);
                }
            }
            // SEP to X sub-matrix
            else if (j >= sep_first_bond) {
                // SEP to spr.
                if (m >= spr_first_bond && m <= spr_last_bond) {
                    A_push_back(j, m, weight, &special_data->all_to_spr_matrix);
                }
                // SEP to SC sub-matrix
                else if (m >= sc_first_bond && m <= sc_last_bond) {
                    A_push_back(j, m, weight, &pd->sep_to_sc_matrix);
                }
                // SEP to BB sub-matrix.
                else if (m >= bb_first_bond && m <= bb_last_bond) {
                    A_push_back(j, m, weight, &pd->sep_to_bb_matrix);

                    // Special case: last two columns of the last SEP to BB
                    // sub-matrix of the last thread, there must be 0s in order
                    // to mantain the pattern.
                    if (j == sep_last_bond &&
                        l == mol->bond_graph->xadj[j + 1] - 2) {
                        for (int i = 0; i < 2; i++) {
                            // WARNING To avoid overwriting A[0][0] (special),
                            // this entries must be printed before the special
                            // submatrix.
                            A_push_back(0, 0, 0, &pd->sep_to_bb_matrix);
                        }
                    }
                }
                // SEP to SEP sub-matrix.
                else if (m >= sep_first_bond) {
                    A_push_back(j, m, weight, &pd->sep_to_sep_matrix);
                }
            }
        }
        ++g->size;
    }
}

int gmx::IlvesPC::get_num_entries_side_chain(const side_chain_type_t type) {
    int entries = 0;

    entries += sc_to_sc_matrix_sizes[type];
    entries += sc_to_bb_matrix_sizes[type];
    entries += (type == PROLINE) ? SC_TO_SEP_PROLINE_MATRIX_SIZE : 0;
    entries += sc_g_matrix_sizes[type];

    entries += sc_to_sc_fillins_sizes[type];
    entries += (type == PROLINE) ? SC_TO_BB_PROLINE_FILLINS_SIZE : 0;

    entries += bb_to_sc_matrix_sizes[type];
    entries += (type == PROLINE) ? BB_TO_BB_PROLINE_MATRIX_SIZE
                                 : BB_TO_BB_MATRIX_SIZE;
    entries += (type == PROLINE) ? BB_TO_SEP_PROLINE_MATRIX_SIZE
                                 : BB_TO_SEP_MATRIX_SIZE;
    entries += (type == PROLINE) ? BB_G_PROLINE_MATRIX_SIZE : BB_G_MATRIX_SIZE;

    entries += (type == PROLINE) ? BB_TO_SC_PROLINE_FILLINS_SIZE : 0;
    entries += BB_TO_SEP_FILLINS_SIZE;

    entries += (type == PROLINE) ? SEP_TO_SC_PROLINE_MATRIX_SIZE : 0;
    entries += (type == PROLINE) ? SEP_TO_BB_PROLINE_MATRIX_SIZE
                                 : SEP_TO_BB_MATRIX_SIZE;
    entries += SEP_TO_SEP_MATRIX_SIZE;
    entries += SEP_G_MATRIX_SIZE;

    entries += (type == PROLINE) ? SEP_TO_BB_PROLINE_FILLINS_SIZE
                                 : SEP_TO_BB_FILLINS_SIZE;
    entries += SEP_TO_SEP_FILLINS_SIZE;

    return entries;
}

int gmx::IlvesPC::get_num_entries_mol() {
    int entries = 0;

    for (int i = 0; i < mol->num_side_chains; ++i) {
        entries += get_num_entries_side_chain(mol->side_chain_types[i]);
    }

    entries += (mol->ends_type == TYPE_A)
                   ? SPL_TO_ALL_MATRIX_SIZE_A + SPR_TO_ALL_MATRIX_SIZE_A
                   : SPL_TO_ALL_MATRIX_SIZE_B + SPR_TO_ALL_MATRIX_SIZE_B;

    entries += (mol->ends_type == TYPE_A)
                   ? ALL_TO_SPL_MATRIX_SIZE_A + ALL_TO_SPR_MATRIX_SIZE_A
                   : ALL_TO_SPL_MATRIX_SIZE_B + ALL_TO_SPR_MATRIX_SIZE_B;

    entries += (mol->ends_type == TYPE_A)
                   ? SPL_G_MATRIX_SIZE_A + SPR_G_MATRIX_SIZE_A
                   : SPL_G_MATRIX_SIZE_B + SPR_G_MATRIX_SIZE_B;

    return entries;
}

/*
 * ILVES kernels.
 */

real gmx::IlvesPC::make_g_loop(const t_pbc *const pbc,
                               const size_t first_element,
                               const size_t num_elements,
                               const int first_row,
                               g_t *const __restrict__ g,
                               const ArrayRef<const RVec> x,
                               const ArrayRef<const RVec> xprime,
                               const bool compute_x_ab) {
    real rel = 0;   // Max relative error.

#pragma GCC ivdep
#pragma ivdep
    for (size_t i = first_element; i < first_element + num_elements; ++i) {
        // Isolate the square of the length of the kth bond.
        real sigma2 = g->sigma2[i];

        // Get bond idx.
        int row = first_row + i;

        // Get atom involved in bond row.
        int a = g->a[i];
        int b = g->b[i];

        // Compute the vectors from atom a to atom b.
        if (compute_x_ab) {
            posvectors_sub(pbc, x[b], x[a], x_ab[row].as_vec());
        }
        posvectors_sub(pbc, xprime[b], xprime[a], xprime_ab[row].as_vec());

        // Compute the square of the length of xprime_ab.
        real scalar = posvectors_dotproduct(xprime_ab[row].as_vec(),
                                            xprime_ab[row].as_vec());
        // real scalar = xprime_ab[DIM * row + XX] * xprime_ab[DIM * row + XX] +
        //               xprime_ab[DIM * row + YY] * xprime_ab[DIM * row + YY] +
        //               xprime_ab[DIM * row + ZZ] * xprime_ab[DIM * row + ZZ];

        // Compute the constraint violation.
        g->data[i] = 0.5 * (scalar - sigma2);

        // Update the relative error.
        rel = std::max(rel, std::abs(g->data[i]) / sigma2);
    }

    return rel;
}

real gmx::IlvesPC::make_g_inm(const int thread,
                              const t_pbc *const pbc,
                              g_t *const __restrict__ g,
                              const ArrayRef<const RVec> x,
                              const ArrayRef<const RVec> xprime,
                              const bool wait_start,
                              const bool wait_end,
                              const bool compute_x_ab) {
    real rel = 0;

    if (g->size == 0) {
        return rel;
    }

    if (wait_start) {
        // Wait if x[a[0]] or x[b[0]] is not ready yet.
        sem_wait(&boundary_sems[thread].left);
    }

    rel = make_g_loop(pbc,
                      0,
                      (wait_end) ? g->size - 1 : g->size,
                      g->first_row,
                      g,
                      x,
                      xprime,
                      compute_x_ab);

    if (wait_end) {
        // Wait if x[a[size - 1]] or x[b[size - 1]] is not ready yet.
        sem_wait(&boundary_sems[thread].right);

        real rel_aux = make_g_loop(pbc, g->size - 1, 1, g->first_row, g, x, xprime, compute_x_ab);

        rel = std::max(rel, rel_aux);
    }

    return rel;
}

real gmx::IlvesPC::make_g(const int thread,
                          const t_pbc *const pbc,
                          const ArrayRef<const RVec> x,
                          const ArrayRef<const RVec> xprime,
                          const bool must_wait,
                          const bool compute_x_ab) {
    // Reference to thread private data.
    private_data_t *pd = &private_data[thread];

    real rel = 0;   // Max relative error.

    // Compute SC g.
    rel = make_g_inm(thread, pbc, &pd->sc_g_matrix, x, xprime, false, false, compute_x_ab);

    // Compute BB g.
    real rel_aux = make_g_inm(thread,
                              pbc,
                              &pd->bb_g_matrix,
                              x,
                              xprime,
                              thread > 0 && must_wait,
                              false,
                              compute_x_ab);

    rel = std::max(rel, rel_aux);

    // Compute SEP g.
    rel_aux = make_g_inm(thread,
                         pbc,
                         &pd->sep_g_matrix,
                         x,
                         xprime,
                         false,
                         (thread < nthreads - 1) && must_wait,
                         compute_x_ab);

    rel = std::max(rel, rel_aux);

    // Compute spl g.
    if (thread == 0) {
        rel_aux = make_g_inm(thread,
                             pbc,
                             &special_data->spl_g_matrix,
                             x,
                             xprime,
                             false,
                             false,
                             compute_x_ab);

        rel = std::max(rel, rel_aux);
    }
    // Compute spr g.
    if (thread == nthreads - 1) {
        rel_aux = make_g_inm(thread,
                             pbc,
                             &special_data->spr_g_matrix,
                             x,
                             xprime,
                             false,
                             false,
                             compute_x_ab);

        rel = std::max(rel, rel_aux);
    }

    // Update shared Schur row.
    if (nthreads > 1) {
        if (thread < nthreads - 1) {
            shared_data[thread]
                .sep_g_matrix.data[0] = pd->sep_g_matrix.data[pd->sep_g_matrix.size - 1];
        }
    }

    return rel;
}

void gmx::IlvesPC::make_A_loop(A_t *const __restrict__ A) {
    for (size_t i = 0; i < A->size; ++i) {
        int row = A->row[i];
        int col = A->col[i];

        real weight = A->weight[i];

        // x_ab and xprime_ab previously calculated in make_g().
        real scalar = posvectors_dotproduct(xprime_ab[row].as_vec(),
                                            x_ab[col].as_vec());

        A->data[i] = weight * scalar;
    }
}

void gmx::IlvesPC::make_A(const int thread) {
    // Reference to thread private data.
    private_data_t *pd = &private_data[thread];

    // SC to SC sub-matrix.
    make_A_loop(&pd->sc_to_sc_matrix);

    // SC to BB sub-matrix.
    make_A_loop(&pd->sc_to_bb_matrix);

    // SC to SEP sub-matrix.
    make_A_loop(&pd->sc_to_sep_matrix);

    // BB to SC sub-matrix.
    make_A_loop(&pd->bb_to_sc_matrix);

    // BB to BB sub-matrix.
    make_A_loop(&pd->bb_to_bb_matrix);

    // BB to SEP sub-matrix.
    make_A_loop(&pd->bb_to_sep_matrix);

    // SEP to SC sub-matrix.
    make_A_loop(&pd->sep_to_sc_matrix);

    // SEP to BB sub-matrix.
    make_A_loop(&pd->sep_to_bb_matrix);

    // SEP to SEP sub-matrix.
    make_A_loop(&pd->sep_to_sep_matrix);

    if (thread == 0) {
        // spl to all sub-matrix.
        make_A_loop(&special_data->spl_to_all_matrix);

        // all to spl sub-matrix.
        make_A_loop(&special_data->all_to_spl_matrix);
    }
    if (thread == nthreads - 1) {
        // spr to all sub-matrix.
        make_A_loop(&special_data->spr_to_all_matrix);

        // all to spr sub-matrix.
        make_A_loop(&special_data->all_to_spr_matrix);
    }

#if DEBUG
    // Set fillins of the thread to 0.
    for (size_t i = 0; i < pd->sc_to_sc_fillins.size; i++) {
        pd->sc_to_sc_fillins.data[i] = 0;
    }
    for (size_t i = 0; i < pd->sc_to_bb_fillins.size; i++) {
        pd->sc_to_bb_fillins.data[i] = 0;
    }
    for (size_t i = 0; i < pd->bb_to_sc_fillins.size; i++) {
        pd->bb_to_sc_fillins.data[i] = 0;
    }
    for (size_t i = 0; i < pd->bb_to_sep_fillins.size; i++) {
        pd->bb_to_sep_fillins.data[i] = 0;
    }
    for (size_t i = 0; i < pd->sep_to_bb_fillins.size; i++) {
        pd->sep_to_bb_fillins.data[i] = 0;
    }
    for (size_t i = 0; i < pd->sep_to_sep_fillins.size; i++) {
        pd->sep_to_sep_fillins.data[i] = 0;
    }
#endif

    /*
     * Update shared Schur row.
     */

    if (nthreads > 1) {
        if (thread < nthreads - 1) {
            shared_data_t *sd = &shared_data[thread];

            // If shared Schur row is a proline Shared Schur row.
            if (mol->side_chain_types[pd->first_side_chain + pd->num_side_chains - 1] ==
                PROLINE) {
                // SEP to SC proline marginal entry.
                sd->sep_to_sc_matrix.data[0] = pd->sep_to_sc_matrix
                                                   .data[pd->sep_to_sc_matrix.size - 1];

#if DEBUG
                pd->sep_to_sc_matrix.data[pd->sep_to_sc_matrix.size - 1] = 0;
                sd->sep_to_bb_fillins.data[0] = 0;
                sd->sep_to_bb_matrix.data[0] = 0;   // Not populated in proline
                                                    // side-chains.
#endif

                // SEP to BB data.
                for (int i = 0; i < SEP_TO_BB_PROLINE_MATRIX_SIZE; ++i) {
                    int pd_idx = (pd->sep_to_bb_matrix.size - 3) + i;

                    sd->sep_to_bb_matrix.data[i + 1] = pd->sep_to_bb_matrix.data[pd_idx];

#if DEBUG
                    pd->sep_to_bb_matrix.data[pd_idx] = 0;
#endif
                }
            }
            else {
#if DEBUG
                // SEP to SC proline marginal entry (0 for non-proline rows).
                sd->sep_to_sc_matrix.data[0] = 0;
#endif
                // SEP to BB data.
                for (int i = 0; i < SEP_TO_BB_MATRIX_SIZE; ++i) {
                    int pd_idx = (pd->sep_to_bb_matrix.size - 4) + i;

                    sd->sep_to_bb_matrix.data[i] = pd->sep_to_bb_matrix.data[pd_idx];

#if DEBUG
                    pd->sep_to_bb_matrix.data[pd_idx] = 0;
#endif
                }
            }

            // SEP to SEP diagonal entry.
            sd->sep_to_sep_matrix.data[0] = pd->sep_to_sep_matrix
                                                .data[pd->sep_to_sep_matrix.size - 1];

#if DEBUG
            pd->sep_to_sep_matrix.data[pd->sep_to_sep_matrix.size - 1] = 1;

            // SEP to BB fillins
            for (int i = 0; i < SEP_TO_BB_PROLINE_FILLINS_SIZE; ++i) {
                sd->sep_to_bb_fillins.data[i] = 0;
            }

            // SEP to SEP left fillin.
            sd->sep_to_sep_fillins.data[0] = 0;

            // SEP to SEP right fillin.
            sd->sep_to_sep_fillins.data[1] = 0;
#endif

            // Release Schur row mutex.
            pthread_mutex_unlock(&sd->lock);
        }
    }
}

void gmx::IlvesPC::solve_1_spl_ends_A(real *const bb_to_bb_matrix,
                                      real *const bb_g_matrix) {
    /*
     *
     * Row 1
     *
     */

    real pivot = special_data->spl_to_all_matrix.data[0];

    // row-1 = row-1 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    special_data->spl_to_all_matrix.data[0] = 1;
#endif

    special_data->spl_to_all_matrix.data[1] /= pivot;
    special_data->spl_to_all_matrix.data[2] /= pivot;

    special_data->spl_g_matrix.data[0] /= pivot;

    /*
    Resulting matrix:

    spl          bb              sep      g
    -----     -------------     -----
    |1  | ... |M M        | ... |   | ... |M| spl    1
    -----     -------------     -----
                    .
                    .
                    .
    -----     -------------     -----
    |x  |     |x x        |     |x  |     |x|       1
    |x  | ... |x x x x x  | ... |x  |     |x|       2
    -----     |  x x x x  |     |   | ... |x| bb    3
              |  x x x x  |     |   |     |x|       4
              |  x x x x x|     |  x|     |x|       5
              |        x x|     |  x|     |x|       6
              -------------     -----
    */

    pivot = special_data->all_to_spl_matrix.data[0];

    // bb-row-1 = bb-row-1 - (special-row-1 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    special_data->all_to_spl_matrix.data[0] = 0;
#endif

    bb_to_bb_matrix[0] -= special_data->spl_to_all_matrix.data[1] * pivot;
    bb_to_bb_matrix[1] -= special_data->spl_to_all_matrix.data[2] * pivot;

    bb_g_matrix[0] -= special_data->spl_g_matrix.data[0] * pivot;

    /*
    Resulting matrix:

    spl          bb              sep      g
    -----     -------------     -----
    |1  | ... |M M        | ... |   | ... |M| spl    1
    -----     -------------     -----
                    .
                    .
                    .
    -----     -------------     -----
    |0  |     |M M        |     |x  |     |M|       1
    |x  | ... |x x x x x  | ... |x  |     |x|       2
    -----     |  x x x x  |     |   | ... |x| bb    3
              |  x x x x  |     |   |     |x|       4
              |  x x x x x|     |  x|     |x|       5
              |        x x|     |  x|     |x|       6
              -------------     -----
    */

    pivot = special_data->all_to_spl_matrix.data[1];

    // bb-row-2 = bb-row-2 - (special-row-1 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    special_data->all_to_spl_matrix.data[1] = 0;
#endif

    bb_to_bb_matrix[2] -= special_data->spl_to_all_matrix.data[1] * pivot;
    bb_to_bb_matrix[3] -= special_data->spl_to_all_matrix.data[2] * pivot;

    bb_g_matrix[1] -= special_data->spl_g_matrix.data[0] * pivot;

    /*
    Resulting matrix:

    spl          bb              sep      g
    -----     -------------     -----
    |1  | ... |M M        | ... |   | ... |M| spl    1
    -----     -------------     -----
                    .
                    .
                    .
    -----     -------------     -----
    |0  |     |M M        |     |x  |     |M|       1
    |0  | ... |M M x x x  | ... |x  |     |M|       2
    -----     |  x x x x  |     |   | ... |x| bb    3
              |  x x x x  |     |   |     |x|       4
              |  x x x x x|     |  x|     |x|       5
              |        x x|     |  x|     |x|       6
              -------------     -----
    */
}

void gmx::IlvesPC::solve_1_spl_ends_B(real *const bb_to_bb_matrix,
                                      real *const bb_g_matrix) {
    /*
     *
     * Row 1
     *
     */

    real pivot = special_data->spl_to_all_matrix.data[0];

    // spl-row-1 = spl-row-1 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    special_data->spl_to_all_matrix.data[0] = 1;
#endif

    special_data->spl_to_all_matrix.data[1] /= pivot;

    special_data->spl_g_matrix.data[0] /= pivot;

    /*
    Resulting matrix:

      sp          bb             sep       g
    -----     -------------     -----
    |1 M| ... |           | ... |   | ... |M| spl   1
    |x x|     |x x        |     |   |     |x|       2
    -----     -------------     -----
                    .
                    .
                    .
    -----     -------------     -----
    |  x|     |x x        |     |x  |     |x|       1
    |  x| ... |x x x x x  | ... |x  |     |x|       2
    -----     |  x x x x  |     |   | ... |x| bb    3 First block.
              |  x x x x  |     |   |     |x|       4
              |  x x x x x|     |  x|     |x|       5
              |        x x|     |  x|     |x|       6
              -------------     -----
    */

    /*
     *
     * Row 2
     *
     */

    pivot = special_data->spl_to_all_matrix.data[2];

    // spl-row-2 = spl-row-2 (spl-row-1 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    special_data->spl_to_all_matrix.data[2] = 0;
#endif

    special_data->spl_to_all_matrix.data[3] -= special_data->spl_to_all_matrix.data[1] *
                                               pivot;

    special_data->spl_g_matrix.data[1] -= special_data->spl_g_matrix.data[0] * pivot;

    /*
    Resulting matrix:

      sp          bb             sep       g
    -----     -------------     -----
    |1 M| ... |           | ... |   | ... |M| spl   1
    |0 M|     |x x        | ... |   | ... |M|       2
    -----     -------------     -----
                    .
                    .
                    .
    -----     -------------     -----
    |  x|     |x x        |     |x  |     |x|       1
    |  x| ... |x x x x x  | ... |x  |     |x|       2
    -----     |  x x x x  |     |   | ... |x| bb    3 First block.
              |  x x x x  |     |   |     |x|       4
              |  x x x x x|     |  x|     |x|       5
              |        x x|     |  x|     |x|       6
              -------------     -----
    */

    pivot = special_data->spl_to_all_matrix.data[3];

    // spl-row-2 = spl-row-2 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    special_data->spl_to_all_matrix.data[3] = 1;
#endif

    special_data->spl_to_all_matrix.data[4] /= pivot;
    special_data->spl_to_all_matrix.data[5] /= pivot;

    special_data->spl_g_matrix.data[1] /= pivot;

    /*
    Resulting matrix:

      sp          bb             sep       g
    -----     -------------     -----
    |1 M| ... |           | ... |   | ... |M| spl   1
    |0 1|     |M M        | ... |   | ... |M|       2
    -----     -------------     -----
                    .
                    .
                    .
    -----     -------------     -----
    |  x|     |x x        |     |x  |     |x|       1
    |  x| ... |x x x x x  | ... |x  |     |x|       2
    -----     |  x x x x  |     |   | ... |x| bb    3 First block.
              |  x x x x  |     |   |     |x|       4
              |  x x x x x|     |  x|     |x|       5
              |        x x|     |  x|     |x|       6
              -------------     -----
    */

    /*
     *
     * BB row 1
     *
     */

    pivot = special_data->all_to_spl_matrix.data[0];

    // bb-row-1 = bb-row-1 - (spl-row-2 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    special_data->all_to_spl_matrix.data[0] = 0;
#endif

    bb_to_bb_matrix[0] -= special_data->spl_to_all_matrix.data[4] * pivot;
    bb_to_bb_matrix[1] -= special_data->spl_to_all_matrix.data[5] * pivot;

    bb_g_matrix[0] -= special_data->spl_g_matrix.data[1] * pivot;

    /*
    Resulting matrix:

      sp          bb             sep       g
    -----     -------------     -----
    |1 M| ... |           | ... |   | ... |M| spl   1
    |0 1|     |M M        | ... |   | ... |M|       2
    -----     -------------     -----
                    .
                    .
                    .
    -----     -------------     -----
    |  0|     |M M        |     |x  |     |M|       1
    |  x| ... |x x x x x  | ... |x  |     |x|       2
    -----     |  x x x x  |     |   | ... |x| bb    3 First block.
              |  x x x x  |     |   |     |x|       4
              |  x x x x x|     |  x|     |x|       5
              |        x x|     |  x|     |x|       6
              -------------     -----
    */

    /*
     *
     * BB row 2
     *
     */

    pivot = special_data->all_to_spl_matrix.data[1];

    // bb-row-2 = bb-row-2 - (spl-row-2 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    special_data->all_to_spl_matrix.data[1] = 0;
#endif

    bb_to_bb_matrix[2] -= special_data->spl_to_all_matrix.data[4] * pivot;
    bb_to_bb_matrix[3] -= special_data->spl_to_all_matrix.data[5] * pivot;

    bb_g_matrix[1] -= special_data->spl_g_matrix.data[1] * pivot;

    /*
    Resulting matrix:

      sp          bb             sep       g
    -----     -------------     -----
    |1 M| ... |           | ... |   | ... |M| spl   1
    |0 1|     |M M        | ... |   | ... |M|       2
    -----     -------------     -----
                    .
                    .
                    .
    -----     -------------     -----
    |  0|     |M M        |     |x  |     |M|       1
    |  0| ... |M M x x x  | ... |x  |     |M|       2
    -----     |  x x x x  |     |   | ... |x| bb    3 First block.
              |  x x x x  |     |   |     |x|       4
              |  x x x x x|     |  x|     |x|       5
              |        x x|     |  x|     |x|       6
              -------------     -----
    */
}

void gmx::IlvesPC::solve_1_spr_proline(real *const sc_to_sc_matrix,
                                       real *const sc_to_bb_matrix,
                                       real *const sc_to_sep_matrix,
                                       real *const sc_g_matrix,
                                       real *const bb_to_sc_matrix,
                                       real *const bb_to_bb_matrix,
                                       real *const bb_to_sep_matrix,
                                       real *const bb_g_matrix,
                                       real *const sep_to_sc_matrix,
                                       real *const sep_to_bb_matrix,
                                       real *const sep_to_sep_matrix,
                                       real *const sep_g_matrix) {
    /*
     *
     * Row 1
     *
     */

    real pivot = special_data->spr_to_all_matrix.data[0];

    // row-1 = row-1 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    special_data->spr_to_all_matrix.data[0] = 1;
#endif

    special_data->spr_to_all_matrix.data[1] /= pivot;
    special_data->spr_to_all_matrix.data[2] /= pivot;
    special_data->spr_to_all_matrix.data[3] /= pivot;

    special_data->spr_g_matrix.data[0] /= pivot;

    /*
    Resulting matrix:

    spr                sc                   bb            sep      g
    -----     -------------------     -------------     -----
    |  1|     |                M|     |        M  |     |  M|     |M| spr   2
    -----     -------------------     -------------     -----
                       .
                       .
                       .
              -------------------     -------------     -----
              |x x         x    |     |      x    |     |   |     |x|      1
              |x x         x    |     |      x    |     |   |     |x|      2
              |    x x     x x  |     |           |     |   |     |x|      3
              |    x x     x x  |     |           |     |   |     |x|      4
              |        x x   x x| ... |           | ... |   | ... |x| sc   5
              |        x x   x x|     |           |     |   |     |x|      6
              |x x x x     x x  |     |      x    |     |   |     |x|      7
    -----     |    x x x x x x x|     |           |     |   |     |x|      8
    |  x| ... |        x x   x x|     |        x  |     |  x|     |x|      9
    -----     -------------------     -------------     -----
                                             .
                                             .
                                             .
              -------------------     -------------     -----
              |                 |     |x x        |     |x  |     |x|      1
              |                 |     |x x x x x  | ... |x  |     |x|      2
              |                 | ... |  x x x x  |     |   | ... |x| bb   3
    -----     |x x         x    |     |  x x x x  |     |   |     |x|      4
    |  x| ... |                x|     |  x x x x  |     |  x|     |x|      5
    -----     -------------------     -------------     -----

    -----     -------------------     -------------     -----
    |  x|     |                x| ... |      x x  | ... |  x|     |x| sep  1
    -----     -------------------     -------------     -----
    */

    pivot = special_data->all_to_spr_matrix.data[0];

    // sc-row-9 = sc-row-9 - (spr-row-1 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    special_data->all_to_spr_matrix.data[0] = 0;
#endif

    sc_to_sc_matrix[38] -= special_data->spr_to_all_matrix.data[1] * pivot;

    sc_to_bb_matrix[3] -= special_data->spr_to_all_matrix.data[2] * pivot;

    sc_to_sep_matrix[0] -= special_data->spr_to_all_matrix.data[3] * pivot;

    sc_g_matrix[8] -= special_data->spr_g_matrix.data[0] * pivot;

    /*
    Resulting matrix:

    spr                sc                   bb            sep      g
    -----     -------------------     -------------     -----
    |  1|     |                M|     |        M  |     |  M|     |M| spr   2
    -----     -------------------     -------------     -----
                       .
                       .
                       .
              -------------------     -------------     -----
              |x x         x    |     |      x    |     |   |     |x|      1
              |x x         x    |     |      x    |     |   |     |x|      2
              |    x x     x x  |     |           |     |   |     |x|      3
              |    x x     x x  |     |           |     |   |     |x|      4
              |        x x   x x| ... |           | ... |   | ... |x| sc   5
              |        x x   x x|     |           |     |   |     |x|      6
              |x x x x     x x  |     |      x    |     |   |     |x|      7
    -----     |    x x x x x x x|     |           |     |   |     |x|      8
    |  0| ... |        x x   x M|     |        M  |     |  M|     |M|      9
    -----     -------------------     -------------     -----
                                             .
                                             .
                                             .
              -------------------     -------------     -----
              |                 |     |x x        |     |x  |     |x|      1
              |                 |     |x x x x x  | ... |x  |     |x|      2
              |                 | ... |  x x x x  |     |   | ... |x| bb   3
    -----     |x x         x    |     |  x x x x  |     |   |     |x|      4
    |  x| ... |                x|     |  x x x x  |     |  x|     |x|      5
    -----     -------------------     -------------     -----

    -----     -------------------     -------------     -----
    |  x|     |                x| ... |      x x  | ... |  x|     |x| sep  1
    -----     -------------------     -------------     -----
    */

    pivot = special_data->all_to_spr_matrix.data[1];

    // bb-row-5 = bb-row-5 - (spr-row-1 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    special_data->all_to_spr_matrix.data[1] = 0;
#endif

    bb_to_sc_matrix[3] -= special_data->spr_to_all_matrix.data[1] * pivot;

    bb_to_bb_matrix[18] -= special_data->spr_to_all_matrix.data[2] * pivot;

    bb_to_sep_matrix[2] -= special_data->spr_to_all_matrix.data[3] * pivot;

    bb_g_matrix[4] -= special_data->spr_g_matrix.data[0] * pivot;

    /*
    Resulting matrix:

    spr                sc                   bb            sep      g
    -----     -------------------     -------------     -----
    |  1|     |                M|     |        M  |     |  M|     |M| spr   2
    -----     -------------------     -------------     -----
                       .
                       .
                       .
              -------------------     -------------     -----
              |x x         x    |     |      x    |     |   |     |x|      1
              |x x         x    |     |      x    |     |   |     |x|      2
              |    x x     x x  |     |           |     |   |     |x|      3
              |    x x     x x  |     |           |     |   |     |x|      4
              |        x x   x x| ... |           | ... |   | ... |x| sc   5
              |        x x   x x|     |           |     |   |     |x|      6
              |x x x x     x x  |     |      x    |     |   |     |x|      7
    -----     |    x x x x x x x|     |           |     |   |     |x|      8
    |  0| ... |        x x   x M|     |        M  |     |  M|     |M|      9
    -----     -------------------     -------------     -----
                                             .
                                             .
                                             .
              -------------------     -------------     -----
              |                 |     |x x        |     |x  |     |x|      1
              |                 |     |x x x x x  | ... |x  |     |x|      2
              |                 | ... |  x x x x  |     |   | ... |x| bb   3
    -----     |x x         x    |     |  x x x x  |     |   |     |x|      4
    |  0| ... |                M|     |  x x x M  |     |  M|     |M|      5
    -----     -------------------     -------------     -----

    -----     -------------------     -------------     -----
    |  x|     |                x| ... |      x x  | ... |  x|     |x| sep  1
    -----     -------------------     -------------     -----
    */

    pivot = special_data->all_to_spr_matrix.data[2];

    // sep-row = sep-row - (spr-row-1 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    special_data->all_to_spr_matrix.data[2] = 0;
#endif

    sep_to_sc_matrix[0] -= special_data->spr_to_all_matrix.data[1] * pivot;

    sep_to_bb_matrix[0] -= special_data->spr_to_all_matrix.data[2] * pivot;

    sep_to_sep_matrix[0] -= special_data->spr_to_all_matrix.data[3] * pivot;

    sep_g_matrix[0] -= special_data->spr_g_matrix.data[0] * pivot;

    /*
    Resulting matrix:

    spr                sc                   bb            sep      g
    -----     -------------------     -------------     -----
    |  1|     |                M|     |        M  |     |  M|     |M| spr   2
    -----     -------------------     -------------     -----
                       .
                       .
                       .
              -------------------     -------------     -----
              |x x         x    |     |      x    |     |   |     |x|      1
              |x x         x    |     |      x    |     |   |     |x|      2
              |    x x     x x  |     |           |     |   |     |x|      3
              |    x x     x x  |     |           |     |   |     |x|      4
              |        x x   x x| ... |           | ... |   | ... |x| sc   5
              |        x x   x x|     |           |     |   |     |x|      6
              |x x x x     x x  |     |      x    |     |   |     |x|      7
    -----     |    x x x x x x x|     |           |     |   |     |x|      8
    |  0| ... |        x x   x M|     |        M  |     |  M|     |M|      9
    -----     -------------------     -------------     -----
                                             .
                                             .
                                             .
              -------------------     -------------     -----
              |                 |     |x x        |     |x  |     |x|      1
              |                 |     |x x x x x  | ... |x  |     |x|      2
              |                 | ... |  x x x x  |     |   | ... |x| bb   3
    -----     |x x         x    |     |  x x x x  |     |   |     |x|      4
    |  0| ... |                M|     |  x x x M  |     |  M|     |M|      5
    -----     -------------------     -------------     -----

    -----     -------------------     -------------     -----
    |  0|     |                M| ... |      x M  | ... |  x|     |x| sep  1
    -----     -------------------     -------------     -----
    */
}

void gmx::IlvesPC::solve_1_spr_general(real *const bb_to_bb_matrix,
                                       real *const bb_to_sep_matrix,
                                       real *const bb_g_matrix,
                                       real *const sep_to_bb_matrix,
                                       real *const sep_to_sep_matrix,
                                       real *const sep_g_matrix) {
    /*
     *
     * Row 2
     *
     */

    real pivot = special_data->spr_to_all_matrix.data[0];

    // row-1 = row-1 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    special_data->spr_to_all_matrix.data[0] = 1;
#endif

    special_data->spr_to_all_matrix.data[1] /= pivot;
    special_data->spr_to_all_matrix.data[2] /= pivot;
    special_data->spr_to_all_matrix.data[3] /= pivot;

    special_data->spr_g_matrix.data[0] /= pivot;

    /*
    Resulting matrix:

    spr            bb            sep        g
    -----     -------------     -----
    |  1|     |        M M|     |  M|     |M|       2
    -----     -------------     -----
                    .
                    .
                    .
              -------------     -----
              |x x        |     |x  |     |x|       1
              |x x x x x  | ... |x  |     |x|       2
              |  x x x x  |     |   | ... |x| bb    3
    -----     |  x x x x  |     |   |     |x|       4
    |  x|     |  x x x x x|     |  x|     |x|       5
    |  x| ... |        x x|     |  x|     |x|       6
    -----     -------------     -----

    -----     -------------     -----
    |  x|     |        x x|     |  x|     |x| sep   1
    -----     -------------     -----
    */

    pivot = special_data->all_to_spr_matrix.data[0];

    // bb-row-5 = bb-row-5 - (spr-row-1 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    special_data->all_to_spr_matrix.data[0] = 0;
#endif

    bb_to_bb_matrix[18] -= special_data->spr_to_all_matrix.data[1] * pivot;
    bb_to_bb_matrix[19] -= special_data->spr_to_all_matrix.data[2] * pivot;

    bb_to_sep_matrix[2] -= special_data->spr_to_all_matrix.data[3] * pivot;

    bb_g_matrix[4] -= special_data->spr_g_matrix.data[0] * pivot;

    /*
    Resulting matrix:

    spr            bb            sep        g
    -----     -------------     -----
    |  1|     |        M M|     |  M|     |M|       2
    -----     -------------     -----
                    .
                    .
                    .
              -------------     -----
              |x x        |     |x  |     |x|       1
              |x x x x x  | ... |x  |     |x|       2
              |  x x x x  |     |   | ... |x| bb    3
    -----     |  x x x x  |     |   |     |x|       4
    |  0|     |  x x x M M|     |  M|     |M|       5
    |  x| ... |        x x|     |  x|     |x|       6
    -----     -------------     -----

    -----     -------------     -----
    |  x|     |        x x|     |  x|     |x| sep   1
    -----     -------------     -----
    */

    pivot = special_data->all_to_spr_matrix.data[1];

    // bb-row-6 = bb-row-6 - (spr-row-1 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    special_data->all_to_spr_matrix.data[1] = 0;
#endif

    bb_to_bb_matrix[20] -= special_data->spr_to_all_matrix.data[1] * pivot;
    bb_to_bb_matrix[21] -= special_data->spr_to_all_matrix.data[2] * pivot;

    bb_to_sep_matrix[3] -= special_data->spr_to_all_matrix.data[3] * pivot;

    bb_g_matrix[5] -= special_data->spr_g_matrix.data[0] * pivot;

    /*
    Resulting matrix:

    spr            bb            sep        g
    -----     -------------     -----
    |  1|     |        M M|     |  M|     |M|       2
    -----     -------------     -----
                    .
                    .
                    .
              -------------     -----
              |x x        |     |x  |     |x|       1
              |x x x x x  | ... |x  |     |x|       2
              |  x x x x  |     |   | ... |x| bb    3
    -----     |  x x x x  |     |   |     |x|       4
    |  0|     |  x x x M M|     |  M|     |M|       5
    |  0| ... |        M M|     |  M|     |M|       6
    -----     -------------     -----

    -----     -------------     -----
    |  x|     |        x x|     |  x|     |x| sep   1
    -----     -------------     -----
    */

    pivot = special_data->all_to_spr_matrix.data[2];

    // sep-row = sep-row - (spr-row-2 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    special_data->all_to_spr_matrix.data[2] = 0;
#endif

    sep_to_bb_matrix[0] -= special_data->spr_to_all_matrix.data[1] * pivot;
    sep_to_bb_matrix[1] -= special_data->spr_to_all_matrix.data[2] * pivot;

    sep_to_sep_matrix[0] -= special_data->spr_to_all_matrix.data[3] * pivot;

    sep_g_matrix[0] -= special_data->spr_g_matrix.data[0] * pivot;

    /*
    Resulting matrix:

    spr            bb            sep        g
    -----     -------------     -----
    |  1|     |        M M|     |  M|     |M|       2
    -----     -------------     -----
                    .
                    .
                    .
              -------------     -----
              |x x        |     |x  |     |x|       1
              |x x x x x  | ... |x  |     |x|       2
              |  x x x x  |     |   | ... |x| bb    3
    -----     |  x x x x  |     |   |     |x|       4
    |  0|     |  x x x M M|     |  M|     |M|       5
    |  0| ... |        M M|     |  M|     |M|       6
    -----     -------------     -----

    -----     -------------     -----
    |  0|     |        M M|     |  M|     |M| sep   1
    -----     -------------     -----
    */
}

void gmx::IlvesPC::solve_1(const int thread) {
    // Reference to thread private data.

    // Clean data assigned to first thread
    if (thread == 0) {
        private_data_t *pd = &private_data[0];

        if (mol->ends_type == TYPE_A) {
            solve_1_spl_ends_A(pd->bb_to_bb_matrix.data, pd->bb_g_matrix.data);
        }
        else {   // Type B
            solve_1_spl_ends_B(pd->bb_to_bb_matrix.data, pd->bb_g_matrix.data);
        }
    }
    if (thread == nthreads - 1 && mol->ends_type == TYPE_A) {   // Only on
                                                                // molecules
                                                                // with ends
                                                                // type A.
        private_data_t *pd = &private_data[nthreads - 1];

        side_chain_type_t
            last_side_chain = mol->side_chain_types[pd->first_side_chain +
                                                    pd->num_side_chains - 1];

        if (last_side_chain == PROLINE) {
            real *last_sc_to_sc_matrix = &pd->sc_to_sc_matrix
                                              .data[pd->sc_to_sc_matrix.size -
                                                    sc_to_sc_matrix_sizes[last_side_chain]];
            real *last_sc_to_bb_matrix = &pd->sc_to_bb_matrix
                                              .data[pd->sc_to_bb_matrix.size -
                                                    sc_to_bb_matrix_sizes[last_side_chain]];
            real *last_sc_to_sep_matrix = &pd->sc_to_sep_matrix
                                               .data[pd->sc_to_sep_matrix.size -
                                                     SC_TO_SEP_PROLINE_MATRIX_SIZE];

            real *last_sc_g_matrix = &pd->sc_g_matrix
                                          .data[pd->sc_g_matrix.size -
                                                sc_g_matrix_sizes[last_side_chain]];

            real *last_bb_to_sc_matrix = &pd->bb_to_sc_matrix
                                              .data[pd->bb_to_sc_matrix.size -
                                                    BB_TO_SC_PROLINE_MATRIX_SIZE];
            real *last_bb_to_bb_matrix = &pd->bb_to_bb_matrix
                                              .data[pd->bb_to_bb_matrix.size -
                                                    BB_TO_BB_PROLINE_MATRIX_SIZE];
            real *last_bb_to_sep_matrix = &pd->bb_to_sep_matrix
                                               .data[pd->bb_to_sep_matrix.size -
                                                     BB_TO_SEP_PROLINE_MATRIX_SIZE];

            real *last_bb_g_matrix = &pd->bb_g_matrix.data[pd->bb_g_matrix.size -
                                                           BB_G_PROLINE_MATRIX_SIZE];

            real *last_sep_to_sc_matrix = &pd->sep_to_sc_matrix
                                               .data[pd->sep_to_sc_matrix.size -
                                                     SEP_TO_SC_PROLINE_MATRIX_SIZE];
            real *last_sep_to_bb_matrix = &pd->sep_to_bb_matrix
                                               .data[pd->sep_to_bb_matrix.size -
                                                     SEP_TO_BB_PROLINE_MATRIX_SIZE];
            real *last_sep_to_sep_matrix = &pd->sep_to_sep_matrix
                                                .data[pd->sep_to_sep_matrix.size -
                                                      SEP_TO_SEP_MATRIX_SIZE];

            real *last_sep_g_matrix = &pd->sep_g_matrix.data[pd->sep_g_matrix.size -
                                                             SEP_G_MATRIX_SIZE];

            solve_1_spr_proline(last_sc_to_sc_matrix,
                                last_sc_to_bb_matrix,
                                last_sc_to_sep_matrix,
                                last_sc_g_matrix,
                                last_bb_to_sc_matrix,
                                last_bb_to_bb_matrix,
                                last_bb_to_sep_matrix,
                                last_bb_g_matrix,
                                last_sep_to_sc_matrix,
                                last_sep_to_bb_matrix,
                                last_sep_to_sep_matrix,
                                last_sep_g_matrix);
        }
        else {
            real *last_bb_to_bb_matrix = &pd->bb_to_bb_matrix
                                              .data[pd->bb_to_bb_matrix.size -
                                                    BB_TO_BB_MATRIX_SIZE];
            real *last_bb_to_sep_matrix = &pd->bb_to_sep_matrix
                                               .data[pd->bb_to_sep_matrix.size -
                                                     BB_TO_SEP_MATRIX_SIZE];

            real *last_bb_g_matrix = &pd->bb_g_matrix.data[pd->bb_g_matrix.size -
                                                           BB_G_MATRIX_SIZE];

            real *last_sep_to_bb_matrix = &pd->sep_to_bb_matrix
                                               .data[pd->sep_to_bb_matrix.size -
                                                     SEP_TO_BB_MATRIX_SIZE];
            real *last_sep_to_sep_matrix = &pd->sep_to_sep_matrix
                                                .data[pd->sep_to_sep_matrix.size -
                                                      SEP_TO_SEP_MATRIX_SIZE];

            real *last_sep_g_matrix = &pd->sep_g_matrix.data[pd->sep_g_matrix.size -
                                                             SEP_G_MATRIX_SIZE];

            solve_1_spr_general(last_bb_to_bb_matrix,
                                last_bb_to_sep_matrix,
                                last_bb_g_matrix,
                                last_sep_to_bb_matrix,
                                last_sep_to_sep_matrix,
                                last_sep_g_matrix);
        }
    }
}

void gmx::IlvesPC::solve_2_glycine(__attribute__((unused))
                                   real *const sc_to_sc_matrix,
                                   __attribute__((unused))
                                   real *const sc_to_bb_matrix,
                                   __attribute__((unused))
                                   real *const sc_to_sep_matrix,
                                   __attribute__((unused)) real *const sc_g_matrix,
                                   __attribute__((unused))
                                   real *const sc_to_sc_fillins,
                                   __attribute__((unused))
                                   real *const sc_to_bb_fillins) {}

void gmx::IlvesPC::solve_2_proline(real *const sc_to_sc_matrix,
                                   real *const sc_to_bb_matrix,
                                   real *const sc_to_sep_matrix,
                                   real *const sc_g_matrix,
                                   __attribute__((unused))
                                   real *const sc_to_sc_fillins,
                                   real *const sc_to_bb_fillins) {
    /*
     *
     * Row 1
     *
     */

    real pivot = sc_to_sc_matrix[0];

    // sc-row-1 = sc-row-1 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[0] = 1;
#endif

    sc_to_sc_matrix[1] /= pivot;
    sc_to_sc_matrix[2] /= pivot;

    sc_to_bb_matrix[0] /= pivot;

    sc_g_matrix[0] /= pivot;

    /*
    Resulting matrix:

            sc                  bb          sep      g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------     ---
    |1 M         M    |     |      M  |     | |     |M|  1
    |x x         x    |     |      x  |     | |     |x|  2
    |    x x     x x  |     |         |     | |     |x|  3
    |    x x     x x  |     |         |     | |     |x|  4
    |        x x   x x| ... |         | ... | | ... |x|  5 sc
    |        x x   x x|     |         |     | |     |x|  6
    |x x x x     x x  |     |      x  |     | |     |x|  7
    |    x x x x x x x|     |         |     | |     |x|  8
    |        x x   x x|     |        x|     |x|     |x|  9
    -------------------     -----------     ---
    */

    /*
     *
     * Row 2
     *
     */

    pivot = sc_to_sc_matrix[3];

    // sc-row-2 = sc-row-2 - sc-row-1 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[3] = 0;
#endif

    sc_to_sc_matrix[4] -= sc_to_sc_matrix[1] * pivot;
    sc_to_sc_matrix[5] -= sc_to_sc_matrix[2] * pivot;

    sc_to_bb_matrix[1] -= sc_to_bb_matrix[0] * pivot;

    sc_g_matrix[1] -= sc_g_matrix[0] * pivot;

    /*
    Resulting matrix:

            sc                  bb          sep      g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------     ---
    |1 M         M    |     |      M  |     | |     |M|  1
    |0 M         M    |     |      M  |     | |     |M|  2
    |    x x     x x  |     |         |     | |     |x|  3
    |    x x     x x  |     |         |     | |     |x|  4
    |        x x   x x| ... |         | ... | | ... |x|  5 sc
    |        x x   x x|     |         |     | |     |x|  6
    |x x x x     x x  |     |      x  |     | |     |x|  7
    |    x x x x x x x|     |         |     | |     |x|  8
    |        x x   x x|     |        x|     |x|     |x|  9
    -------------------     -----------     ---
    */

    pivot = sc_to_sc_matrix[4];

    // sc-row-2 = sc-row-2 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[4] = 1;
#endif

    sc_to_sc_matrix[5] /= pivot;

    sc_to_bb_matrix[1] /= pivot;

    sc_g_matrix[1] /= pivot;

    /*
    Resulting matrix:

            sc                  bb          sep      g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------     ---
    |1 M         M    |     |      M  |     | |     |M|  1
    |0 1         M    |     |      M  |     | |     |M|  2
    |    x x     x x  |     |         |     | |     |x|  3
    |    x x     x x  |     |         |     | |     |x|  4
    |        x x   x x| ... |         | ... | | ... |x|  5 sc
    |        x x   x x|     |         |     | |     |x|  6
    |x x x x     x x  |     |      x  |     | |     |x|  7
    |    x x x x x x x|     |         |     | |     |x|  8
    |        x x   x x|     |        x|     |x|     |x|  9
    -------------------     -----------     ---
    */

    /*
     *
     * Row 3
     *
     */

    pivot = sc_to_sc_matrix[6];

    // sc-row-3 = sc-row-3 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[6] = 1;
#endif

    sc_to_sc_matrix[7] /= pivot;
    sc_to_sc_matrix[8] /= pivot;
    sc_to_sc_matrix[9] /= pivot;

    sc_g_matrix[2] /= pivot;

    /*
    Resulting matrix:

            sc                  bb          sep      g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------     ---
    |1 M         M    |     |      M  |     | |     |M|  1
    |0 1         M    |     |      M  |     | |     |M|  2
    |    1 M     M M  |     |         |     | |     |M|  3
    |    x x     x x  |     |         |     | |     |x|  4
    |        x x   x x| ... |         | ... | | ... |x|  5 sc
    |        x x   x x|     |         |     | |     |x|  6
    |x x x x     x x  |     |      x  |     | |     |x|  7
    |    x x x x x x x|     |         |     | |     |x|  8
    |        x x   x x|     |        x|     |x|     |x|  9
    -------------------     -----------     ---
    */

    /*
     *
     * Row 4
     *
     */

    pivot = sc_to_sc_matrix[10];

    // sc-row-4 = sc-row-4 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[10] = 0;
#endif

    sc_to_sc_matrix[11] -= sc_to_sc_matrix[7] * pivot;
    sc_to_sc_matrix[12] -= sc_to_sc_matrix[8] * pivot;
    sc_to_sc_matrix[13] -= sc_to_sc_matrix[9] * pivot;

    sc_g_matrix[3] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

            sc                  bb          sep      g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------     ---
    |1 M         M    |     |      M  |     | |     |M|  1
    |0 1         M    |     |      M  |     | |     |M|  2
    |    1 M     M M  |     |         |     | |     |M|  3
    |    0 M     M M  |     |         |     | |     |M|  4
    |        x x   x x| ... |         | ... | | ... |x|  5 sc
    |        x x   x x|     |         |     | |     |x|  6
    |x x x x     x x  |     |      x  |     | |     |x|  7
    |    x x x x x x x|     |         |     | |     |x|  8
    |        x x   x x|     |        x|     |x|     |x|  9
    -------------------     -----------     ---
    */

    pivot = sc_to_sc_matrix[11];

    // sc-row-4 = sc-row-4 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[11] = 1;
#endif

    sc_to_sc_matrix[12] /= pivot;
    sc_to_sc_matrix[13] /= pivot;

    sc_g_matrix[3] /= pivot;

    /*
    Resulting matrix:

            sc                  bb          sep      g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------     ---
    |1 M         M    |     |      M  |     | |     |M|  1
    |0 1         M    |     |      M  |     | |     |M|  2
    |    1 M     M M  |     |         |     | |     |M|  3
    |    0 1     M M  |     |         |     | |     |M|  4
    |        x x   x x| ... |         | ... | | ... |x|  5 sc
    |        x x   x x|     |         |     | |     |x|  6
    |x x x x     x x  |     |      x  |     | |     |x|  7
    |    x x x x x x x|     |         |     | |     |x|  8
    |        x x   x x|     |        x|     |x|     |x|  9
    -------------------     -----------     ---
    */

    /*
     *
     * Row 5
     *
     */

    pivot = sc_to_sc_matrix[14];

    // sc-row-5 = sc-row-5 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[14] = 1;
#endif

    sc_to_sc_matrix[15] /= pivot;
    sc_to_sc_matrix[16] /= pivot;
    sc_to_sc_matrix[17] /= pivot;

    sc_g_matrix[4] /= pivot;

    /*
    Resulting matrix:

            sc                  bb          sep      g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------     ---
    |1 M         M    |     |      M  |     | |     |M|  1
    |0 1         M    |     |      M  |     | |     |M|  2
    |    1 M     M M  |     |         |     | |     |M|  3
    |    0 1     M M  |     |         |     | |     |M|  4
    |        1 M   M M| ... |         | ... | | ... |M|  5 sc
    |        x x   x x|     |         |     | |     |x|  6
    |x x x x     x x  |     |      x  |     | |     |x|  7
    |    x x x x x x x|     |         |     | |     |x|  8
    |        x x   x x|     |        x|     |x|     |x|  9
    -------------------     -----------     ---
    */

    /*
     *
     * Row 6
     *
     */

    pivot = sc_to_sc_matrix[18];

    // sc-row-6 = sc-row-6 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[18] = 0;
#endif

    sc_to_sc_matrix[19] -= sc_to_sc_matrix[15] * pivot;
    sc_to_sc_matrix[20] -= sc_to_sc_matrix[16] * pivot;
    sc_to_sc_matrix[21] -= sc_to_sc_matrix[17] * pivot;

    sc_g_matrix[5] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

            sc                  bb          sep      g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------     ---
    |1 M         M    |     |      M  |     | |     |M|  1
    |0 1         M    |     |      M  |     | |     |M|  2
    |    1 M     M M  |     |         |     | |     |M|  3
    |    0 1     M M  |     |         |     | |     |M|  4
    |        1 M   M M| ... |         | ... | | ... |M|  5 sc
    |        0 M   M M|     |         |     | |     |M|  6
    |x x x x     x x  |     |      x  |     | |     |x|  7
    |    x x x x x x x|     |         |     | |     |x|  8
    |        x x   x x|     |        x|     |x|     |x|  9
    -------------------     -----------     ---
    */

    pivot = sc_to_sc_matrix[19];

    // sc-row-6 = sc-row-6 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[19] = 1;
#endif

    sc_to_sc_matrix[20] /= pivot;
    sc_to_sc_matrix[21] /= pivot;

    sc_g_matrix[5] /= pivot;

    /*
    Resulting matrix:

            sc                  bb          sep      g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------     ---
    |1 M         M    |     |      M  |     | |     |M|  1
    |0 1         M    |     |      M  |     | |     |M|  2
    |    1 M     M M  |     |         |     | |     |M|  3
    |    0 1     M M  |     |         |     | |     |M|  4
    |        1 M   M M| ... |         | ... | | ... |M|  5 sc
    |        0 1   M M|     |         |     | |     |M|  6
    |x x x x     x x  |     |      x  |     | |     |x|  7
    |    x x x x x x x|     |         |     | |     |x|  8
    |        x x   x x|     |        x|     |x|     |x|  9
    -------------------     -----------     ---
    */

    /*
     *
     * Row 7
     *
     */

    pivot = sc_to_sc_matrix[22];

    // sc-row-7 = sc-row-7 - sc-row-1 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[22] = 0;
#endif

    sc_to_sc_matrix[23] -= sc_to_sc_matrix[1] * pivot;
    sc_to_sc_matrix[26] -= sc_to_sc_matrix[2] * pivot;

    sc_to_bb_matrix[2] -= sc_to_bb_matrix[0] * pivot;

    sc_g_matrix[6] -= sc_g_matrix[0] * pivot;

    /*
    Resulting matrix:

            sc                  bb          sep      g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------     ---
    |1 M         M    |     |      M  |     | |     |M|  1
    |0 1         M    |     |      M  |     | |     |M|  2
    |    1 M     M M  |     |         |     | |     |M|  3
    |    0 1     M M  |     |         |     | |     |M|  4
    |        1 M   M M| ... |         | ... | | ... |M|  5 sc
    |        0 1   M M|     |         |     | |     |M|  6
    |0 M x x     M x  |     |      M  |     | |     |M|  7
    |    x x x x x x x|     |         |     | |     |x|  8
    |        x x   x x|     |        x|     |x|     |x|  9
    -------------------     -----------     ---
    */

    pivot = sc_to_sc_matrix[23];

    // sc-row-7 = sc-row-7 - sc-row-2 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[23] = 0;
#endif

    sc_to_sc_matrix[26] -= sc_to_sc_matrix[5] * pivot;

    sc_to_bb_matrix[2] -= sc_to_bb_matrix[1] * pivot;

    sc_g_matrix[6] -= sc_g_matrix[1] * pivot;

    /*
    Resulting matrix:

            sc                  bb          sep      g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------     ---
    |1 M         M    |     |      M  |     | |     |M|  1
    |0 1         M    |     |      M  |     | |     |M|  2
    |    1 M     M M  |     |         |     | |     |M|  3
    |    0 1     M M  |     |         |     | |     |M|  4
    |        1 M   M M| ... |         | ... | | ... |M|  5 sc
    |        0 1   M M|     |         |     | |     |M|  6
    |0 0 x x     M x  |     |      M  |     | |     |M|  7
    |    x x x x x x x|     |         |     | |     |x|  8
    |        x x   x x|     |        x|     |x|     |x|  9
    -------------------     -----------     ---
    */

    pivot = sc_to_sc_matrix[24];

    // sc-row-7 = sc-row-7 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[24] = 0;
#endif

    sc_to_sc_matrix[25] -= sc_to_sc_matrix[7] * pivot;
    sc_to_sc_matrix[26] -= sc_to_sc_matrix[8] * pivot;
    sc_to_sc_matrix[27] -= sc_to_sc_matrix[9] * pivot;

    sc_g_matrix[6] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

            sc                  bb          sep      g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------     ---
    |1 M         M    |     |      M  |     | |     |M|  1
    |0 1         M    |     |      M  |     | |     |M|  2
    |    1 M     M M  |     |         |     | |     |M|  3
    |    0 1     M M  |     |         |     | |     |M|  4
    |        1 M   M M| ... |         | ... | | ... |M|  5 sc
    |        0 1   M M|     |         |     | |     |M|  6
    |0 0 0 M     M M  |     |      M  |     | |     |M|  7
    |    x x x x x x x|     |         |     | |     |x|  8
    |        x x   x x|     |        x|     |x|     |x|  9
    -------------------     -----------     ---
    */

    pivot = sc_to_sc_matrix[25];

    // sc-row-7 = sc-row-7 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[25] = 0;
#endif

    sc_to_sc_matrix[26] -= sc_to_sc_matrix[12] * pivot;
    sc_to_sc_matrix[27] -= sc_to_sc_matrix[13] * pivot;

    sc_g_matrix[6] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

            sc                  bb          sep      g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------     ---
    |1 M         M    |     |      M  |     | |     |M|  1
    |0 1         M    |     |      M  |     | |     |M|  2
    |    1 M     M M  |     |         |     | |     |M|  3
    |    0 1     M M  |     |         |     | |     |M|  4
    |        1 M   M M| ... |         | ... | | ... |M|  5 sc
    |        0 1   M M|     |         |     | |     |M|  6
    |0 0 0 0     M M  |     |      M  |     | |     |M|  7
    |    x x x x x x x|     |         |     | |     |x|  8
    |        x x   x x|     |        x|     |x|     |x|  9
    -------------------     -----------     ---
    */

    pivot = sc_to_sc_matrix[26];

    // sc-row-7 = sc-row-7 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[26] = 1;
#endif

    sc_to_sc_matrix[27] /= pivot;

    sc_to_bb_matrix[2] /= pivot;

    sc_g_matrix[6] /= pivot;

    /*
    Resulting matrix:

            sc                  bb          sep      g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------     ---
    |1 M         M    |     |      M  |     | |     |M|  1
    |0 1         M    |     |      M  |     | |     |M|  2
    |    1 M     M M  |     |         |     | |     |M|  3
    |    0 1     M M  |     |         |     | |     |M|  4
    |        1 M   M M| ... |         | ... | | ... |M|  5 sc
    |        0 1   M M|     |         |     | |     |M|  6
    |0 0 0 0     1 M  |     |      M  |     | |     |M|  7
    |    x x x x x x x|     |         |     | |     |x|  8
    |        x x   x x|     |        x|     |x|     |x|  9
    -------------------     -----------     ---
    */

    /*
     *
     * Row 8
     *
     */

    pivot = sc_to_sc_matrix[28];

    // sc-row-8 = sc-row-8 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[28] = 0;
#endif

    sc_to_sc_matrix[29] -= sc_to_sc_matrix[7] * pivot;
    sc_to_sc_matrix[32] -= sc_to_sc_matrix[8] * pivot;
    sc_to_sc_matrix[33] -= sc_to_sc_matrix[9] * pivot;

    sc_g_matrix[7] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

            sc                  bb          sep      g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------     ---
    |1 M         M    |     |      M  |     | |     |M|  1
    |0 1         M    |     |      M  |     | |     |M|  2
    |    1 M     M M  |     |         |     | |     |M|  3
    |    0 1     M M  |     |         |     | |     |M|  4
    |        1 M   M M| ... |         | ... | | ... |M|  5 sc
    |        0 1   M M|     |         |     | |     |M|  6
    |0 0 0 0     1 M  |     |      M  |     | |     |M|  7
    |    0 M x x M M x|     |         |     | |     |M|  8
    |        x x   x x|     |        x|     |x|     |x|  9
    -------------------     -----------     ---
    */

    pivot = sc_to_sc_matrix[29];

    // sc-row-8 = sc-row-8 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[29] = 0;
#endif

    sc_to_sc_matrix[32] -= sc_to_sc_matrix[12] * pivot;
    sc_to_sc_matrix[33] -= sc_to_sc_matrix[13] * pivot;

    sc_g_matrix[7] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

            sc                  bb          sep      g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------     ---
    |1 M         M    |     |      M  |     | |     |M|  1
    |0 1         M    |     |      M  |     | |     |M|  2
    |    1 M     M M  |     |         |     | |     |M|  3
    |    0 1     M M  |     |         |     | |     |M|  4
    |        1 M   M M| ... |         | ... | | ... |M|  5 sc
    |        0 1   M M|     |         |     | |     |M|  6
    |0 0 0 0     1 M  |     |      M  |     | |     |M|  7
    |    0 0 x x M M x|     |         |     | |     |M|  8
    |        x x   x x|     |        x|     |x|     |x|  9
    -------------------     -----------     ---
    */

    pivot = sc_to_sc_matrix[30];

    // sc-row-8 = sc-row-8 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[30] = 0;
#endif

    sc_to_sc_matrix[31] -= sc_to_sc_matrix[15] * pivot;
    sc_to_sc_matrix[33] -= sc_to_sc_matrix[16] * pivot;
    sc_to_sc_matrix[34] -= sc_to_sc_matrix[17] * pivot;

    sc_g_matrix[7] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

            sc                  bb          sep      g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------     ---
    |1 M         M    |     |      M  |     | |     |M|  1
    |0 1         M    |     |      M  |     | |     |M|  2
    |    1 M     M M  |     |         |     | |     |M|  3
    |    0 1     M M  |     |         |     | |     |M|  4
    |        1 M   M M| ... |         | ... | | ... |M|  5 sc
    |        0 1   M M|     |         |     | |     |M|  6
    |0 0 0 0     1 M  |     |      M  |     | |     |M|  7
    |    0 0 0 M M M M|     |         |     | |     |M|  8
    |        x x   x x|     |        x|     |x|     |x|  9
    -------------------     -----------     ---
    */

    pivot = sc_to_sc_matrix[31];

    // sc-row-8 = sc-row-8 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[31] = 0;
#endif

    sc_to_sc_matrix[33] -= sc_to_sc_matrix[20] * pivot;
    sc_to_sc_matrix[34] -= sc_to_sc_matrix[21] * pivot;

    sc_g_matrix[7] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

            sc                  bb          sep      g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------     ---
    |1 M         M    |     |      M  |     | |     |M|  1
    |0 1         M    |     |      M  |     | |     |M|  2
    |    1 M     M M  |     |         |     | |     |M|  3
    |    0 1     M M  |     |         |     | |     |M|  4
    |        1 M   M M| ... |         | ... | | ... |M|  5 sc
    |        0 1   M M|     |         |     | |     |M|  6
    |0 0 0 0     1 M  |     |      M  |     | |     |M|  7
    |    0 0 0 0 M M M|     |         |     | |     |M|  8
    |        x x   x x|     |        x|     |x|     |x|  9
    -------------------     -----------     ---
    */

    pivot = sc_to_sc_matrix[32];

    // sc-row-8 = sc-row-8 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[32] = 0;
#endif

    sc_to_sc_matrix[33] -= sc_to_sc_matrix[27] * pivot;

    sc_to_bb_fillins[0] = -sc_to_bb_matrix[2] * pivot;

    sc_g_matrix[7] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

            sc                  bb          sep      g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------     ---
    |1 M         M    |     |      M  |     | |     |M|  1
    |0 1         M    |     |      M  |     | |     |M|  2
    |    1 M     M M  |     |         |     | |     |M|  3
    |    0 1     M M  |     |         |     | |     |M|  4
    |        1 M   M M| ... |         | ... | | ... |M|  5 sc
    |        0 1   M M|     |         |     | |     |M|  6
    |0 0 0 0     1 M  |     |      M  |     | |     |M|  7
    |    0 0 0 0 0 M M|     |      F  |     | |     |M|  8
    |        x x   x x|     |        x|     |x|     |x|  9
    -------------------     -----------     ---
    */

    pivot = sc_to_sc_matrix[33];

    // sc-row-8 = sc-row-8 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[33] = 1;
#endif

    sc_to_sc_matrix[34] /= pivot;

    sc_to_bb_fillins[0] /= pivot;

    sc_g_matrix[7] /= pivot;

    /*
    Resulting matrix:

            sc                  bb          sep      g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------     ---
    |1 M         M    |     |      M  |     | |     |M|  1
    |0 1         M    |     |      M  |     | |     |M|  2
    |    1 M     M M  |     |         |     | |     |M|  3
    |    0 1     M M  |     |         |     | |     |M|  4
    |        1 M   M M| ... |         | ... | | ... |M|  5 sc
    |        0 1   M M|     |         |     | |     |M|  6
    |0 0 0 0     1 M  |     |      M  |     | |     |M|  7
    |    0 0 0 0 0 1 M|     |      F  |     | |     |M|  8
    |        x x   x x|     |        x|     |x|     |x|  9
    -------------------     -----------     ---
    */

    /*
     *
     * Row 9
     *
     */

    pivot = sc_to_sc_matrix[35];

    // sc-row-9 = sc-row-9 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[35] = 0;
#endif

    sc_to_sc_matrix[36] -= sc_to_sc_matrix[15] * pivot;
    sc_to_sc_matrix[37] -= sc_to_sc_matrix[16] * pivot;
    sc_to_sc_matrix[38] -= sc_to_sc_matrix[17] * pivot;

    sc_g_matrix[8] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

            sc                  bb          sep      g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------     ---
    |1 M         M    |     |      M  |     | |     |M|  1
    |0 1         M    |     |      M  |     | |     |M|  2
    |    1 M     M M  |     |         |     | |     |M|  3
    |    0 1     M M  |     |         |     | |     |M|  4
    |        1 M   M M| ... |         | ... | | ... |M|  5 sc
    |        0 1   M M|     |         |     | |     |M|  6
    |0 0 0 0     1 M  |     |      M  |     | |     |M|  7
    |    0 0 0 0 0 1 M|     |      F  |     | |     |M|  8
    |        0 M   M M|     |        x|     |x|     |M|  9
    -------------------     -----------     ---
    */

    pivot = sc_to_sc_matrix[36];

    // sc-row-9 = sc-row-9 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[36] = 0;
#endif

    sc_to_sc_matrix[37] -= sc_to_sc_matrix[20] * pivot;
    sc_to_sc_matrix[38] -= sc_to_sc_matrix[21] * pivot;

    sc_g_matrix[8] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

            sc                  bb          sep      g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------     ---
    |1 M         M    |     |      M  |     | |     |M|  1
    |0 1         M    |     |      M  |     | |     |M|  2
    |    1 M     M M  |     |         |     | |     |M|  3
    |    0 1     M M  |     |         |     | |     |M|  4
    |        1 M   M M| ... |         | ... | | ... |M|  5 sc
    |        0 1   M M|     |         |     | |     |M|  6
    |0 0 0 0     1 M  |     |      M  |     | |     |M|  7
    |    0 0 0 0 0 1 M|     |      F  |     | |     |M|  8
    |        0 0   M M|     |        x|     |x|     |M|  9
    -------------------     -----------     ---
    */

    pivot = sc_to_sc_matrix[37];

    // sc-row-9 = sc-row-9 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[37] = 0;
#endif

    sc_to_sc_matrix[38] -= sc_to_sc_matrix[34] * pivot;

    sc_to_bb_fillins[1] = -sc_to_bb_fillins[0] * pivot;

    sc_g_matrix[8] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

            sc                  bb          sep      g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------     ---
    |1 M         M    |     |      M  |     | |     |M|  1
    |0 1         M    |     |      M  |     | |     |M|  2
    |    1 M     M M  |     |         |     | |     |M|  3
    |    0 1     M M  |     |         |     | |     |M|  4
    |        1 M   M M| ... |         | ... | | ... |M|  5 sc
    |        0 1   M M|     |         |     | |     |M|  6
    |0 0 0 0     1 M  |     |      M  |     | |     |M|  7
    |    0 0 0 0 0 1 M|     |      F  |     | |     |M|  8
    |        0 0   0 M|     |      F x|     |x|     |M|  9
    -------------------     -----------     ---
    */

    pivot = sc_to_sc_matrix[38];

    // sc-row-9 = sc-row-9 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[38] = 1;
#endif

    sc_to_bb_fillins[1] /= pivot;
    sc_to_bb_matrix[3] /= pivot;

    sc_to_sep_matrix[0] /= pivot;

    sc_g_matrix[8] /= pivot;

    /*
    Resulting matrix:

            sc                  bb          sep      g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------     ---
    |1 M         M    |     |      M  |     | |     |M|  1
    |0 1         M    |     |      M  |     | |     |M|  2
    |    1 M     M M  |     |         |     | |     |M|  3
    |    0 1     M M  |     |         |     | |     |M|  4
    |        1 M   M M| ... |         | ... | | ... |M|  5 sc
    |        0 1   M M|     |         |     | |     |M|  6
    |0 0 0 0     1 M  |     |      M  |     | |     |M|  7
    |    0 0 0 0 0 1 M|     |      F  |     | |     |M|  8
    |        0 0   0 1|     |      F M|     |M|     |M|  9
    -------------------     -----------     ---
    */
}

void gmx::IlvesPC::solve_2_cysteine(real *const sc_to_sc_matrix,
                                    real *const sc_to_bb_matrix,
                                    __attribute__((unused))
                                    real *const sc_to_sep_matrix,
                                    real *const sc_g_matrix,
                                    __attribute__((unused))
                                    real *const sc_to_sc_fillins,
                                    __attribute__((unused))
                                    real *const sc_to_bb_fillins) {
    /*
     *
     * Row 1
     *
     */

    real pivot = sc_to_sc_matrix[0];

    // sc-row-1 = sc-row-1 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[0] = 1;
#endif

    sc_to_sc_matrix[1] /= pivot;

    sc_g_matrix[0] /= pivot;

    /*
    Resulting matrix:

       sc              bb            g
     1 2 3 4       1 2 3 4 5 6
    ---------     -------------
    |1 M    |     |           |     |M|  1
    |x x x x|     |      x    |     |x|  2
    |  x x x| ... |      x    | ... |x|  3 sc
    |  x x x|     |      x    |     |x|  4
    ---------     -------------
    */

    /*
     *
     * Row 2
     *
     */

    pivot = sc_to_sc_matrix[2];

    // sc-row-2 = sc-row-2 - sc-row-1 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[2] = 0;
#endif

    sc_to_sc_matrix[3] -= sc_to_sc_matrix[1] * pivot;

    sc_g_matrix[1] -= sc_g_matrix[0] * pivot;

    /*
    Resulting matrix:

       sc              bb            g
     1 2 3 4       1 2 3 4 5 6
    ---------     -------------
    |1 M    |     |           |     |M|  1
    |0 M x x|     |      x    |     |M|  2
    |  x x x| ... |      x    | ... |x|  3 sc
    |  x x x|     |      x    |     |x|  4
    ---------     -------------
    */

    pivot = sc_to_sc_matrix[3];

    // sc-row-2 = sc-row-2 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[3] = 1;
#endif

    sc_to_sc_matrix[4] /= pivot;
    sc_to_sc_matrix[5] /= pivot;

    sc_to_bb_matrix[0] /= pivot;

    sc_g_matrix[1] /= pivot;

    /*
    Resulting matrix:

       sc              bb            g
     1 2 3 4       1 2 3 4 5 6
    ---------     -------------
    |1 M    |     |           |     |M|  1
    |0 1 M M|     |      M    |     |M|  2
    |  x x x| ... |      x    | ... |x|  3 sc
    |  x x x|     |      x    |     |x|  4
    ---------     -------------
    */

    /*
     *
     * Row 3
     *
     */

    pivot = sc_to_sc_matrix[6];

    // sc-row-3 = sc-row-3 - sc-row-2 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[6] = 0;
#endif

    sc_to_sc_matrix[7] -= sc_to_sc_matrix[4] * pivot;
    sc_to_sc_matrix[8] -= sc_to_sc_matrix[5] * pivot;

    sc_to_bb_matrix[1] -= sc_to_bb_matrix[0] * pivot;

    sc_g_matrix[2] -= sc_g_matrix[1] * pivot;

    /*
    Resulting matrix:

       sc              bb            g
     1 2 3 4       1 2 3 4 5 6
    ---------     -------------
    |1 M    |     |           |     |M|  1
    |0 1 M M|     |      M    |     |M|  2
    |  0 M M| ... |      M    | ... |M|  3 sc
    |  x x x|     |      x    |     |x|  4
    ---------     -------------
    */

    pivot = sc_to_sc_matrix[7];

    // sc-row-3 = sc-row-3 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[7] = 1;
#endif

    sc_to_sc_matrix[8] /= pivot;

    sc_to_bb_matrix[1] /= pivot;

    sc_g_matrix[2] /= pivot;

    /*
    Resulting matrix:

       sc              bb            g
     1 2 3 4       1 2 3 4 5 6
    ---------     -------------
    |1 M    |     |           |     |M|  1
    |0 1 M M|     |      M    |     |M|  2
    |  0 1 M| ... |      M    | ... |M|  3 sc
    |  x x x|     |      x    |     |x|  4
    ---------     -------------
    */

    /*
     *
     * Row 4
     *
     */

    pivot = sc_to_sc_matrix[9];

    // sc-row-4 = sc-row-4 - sc-row-2 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[9] = 0;
#endif

    sc_to_sc_matrix[10] -= sc_to_sc_matrix[4] * pivot;
    sc_to_sc_matrix[11] -= sc_to_sc_matrix[5] * pivot;

    sc_to_bb_matrix[2] -= sc_to_bb_matrix[0] * pivot;

    sc_g_matrix[3] -= sc_g_matrix[1] * pivot;

    /*
    Resulting matrix:

       sc              bb            g
     1 2 3 4       1 2 3 4 5 6
    ---------     -------------
    |1 M    |     |           |     |M|  1
    |0 1 M M|     |      M    |     |M|  2
    |  0 1 M| ... |      M    | ... |M|  3 sc
    |  0 M M|     |      M    |     |M|  4
    ---------     -------------
    */

    pivot = sc_to_sc_matrix[10];

    // sc-row-4 = sc-row-4 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[10] = 0;
#endif

    sc_to_sc_matrix[11] -= sc_to_sc_matrix[8] * pivot;

    sc_to_bb_matrix[2] -= sc_to_bb_matrix[1] * pivot;

    sc_g_matrix[3] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

       sc              bb            g
     1 2 3 4       1 2 3 4 5 6
    ---------     -------------
    |1 M    |     |           |     |M|  1
    |0 1 M M|     |      M    |     |M|  2
    |  0 1 M| ... |      M    | ... |M|  3 sc
    |  0 0 M|     |      M    |     |M|  4
    ---------     -------------
    */

    pivot = sc_to_sc_matrix[11];

    // sc-row-4 = sc-row-4 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[11] = 1;
#endif

    sc_to_bb_matrix[2] /= pivot;

    sc_g_matrix[3] /= pivot;

    /*
    Resulting matrix:

       sc              bb            g
     1 2 3 4       1 2 3 4 5 6
    ---------     -------------
    |1 M    |     |           |     |M|  1
    |0 1 M M|     |      M    |     |M|  2
    |  0 1 M| ... |      M    | ... |M|  3 sc
    |  0 0 1|     |      M    |     |M|  4
    ---------     -------------
    */
}

void gmx::IlvesPC::solve_2_methionine(real *const sc_to_sc_matrix,
                                      real *const sc_to_bb_matrix,
                                      __attribute__((unused))
                                      real *const sc_to_sep_matrix,
                                      real *const sc_g_matrix,
                                      __attribute__((unused))
                                      real *const sc_to_sc_fillins,
                                      __attribute__((unused))
                                      real *const sc_to_bb_fillins) {
    /*
     *
     * Row 1
     *
     */

    real pivot = sc_to_sc_matrix[0];

    // sc-row-1 = sc-row-1 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[0] = 1;
#endif

    sc_to_sc_matrix[1] /= pivot;
    sc_to_sc_matrix[2] /= pivot;
    sc_to_sc_matrix[3] /= pivot;

    sc_g_matrix[0] /= pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M M            |     |           |     |M|  1
    |x x x x            |     |           |     |x|  2
    |x x x x            |     |           |     |x|  3
    |x x x x x          |     |           |     |x|  4
    |      x x x x x    |     |           |     |x|  5
    |        x x x x    | ... |           | ... |x|  6 sc
    |        x x x x    |     |           |     |x|  7
    |        x x x x x x|     |      x    |     |x|  8
    |              x x x|     |      x    |     |x|  9
    |              x x x|     |      x    |     |x| 10
    ---------------------     -------------
    */

    /*
     *
     * Row 2
     *
     */

    pivot = sc_to_sc_matrix[4];

    // sc-row-2 = sc-row-2 - sc-row-1 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[4] = 0;
#endif

    sc_to_sc_matrix[5] -= sc_to_sc_matrix[1] * pivot;
    sc_to_sc_matrix[6] -= sc_to_sc_matrix[2] * pivot;
    sc_to_sc_matrix[7] -= sc_to_sc_matrix[3] * pivot;

    sc_g_matrix[1] -= sc_g_matrix[0] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M M            |     |           |     |M|  1
    |0 M M M            |     |           |     |M|  2
    |x x x x            |     |           |     |x|  3
    |x x x x x          |     |           |     |x|  4
    |      x x x x x    |     |           |     |x|  5
    |        x x x x    | ... |           | ... |x|  6 sc
    |        x x x x    |     |           |     |x|  7
    |        x x x x x x|     |      x    |     |x|  8
    |              x x x|     |      x    |     |x|  9
    |              x x x|     |      x    |     |x| 10
    ---------------------     -------------
    */

    pivot = sc_to_sc_matrix[5];

    // sc-row-2 = sc-row-2 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[5] = 1;
#endif

    sc_to_sc_matrix[6] /= pivot;
    sc_to_sc_matrix[7] /= pivot;

    sc_g_matrix[1] /= pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M M            |     |           |     |M|  1
    |0 1 M M            |     |           |     |M|  2
    |x x x x            |     |           |     |x|  3
    |x x x x x          |     |           |     |x|  4
    |      x x x x x    |     |           |     |x|  5
    |        x x x x    | ... |           | ... |x|  6 sc
    |        x x x x    |     |           |     |x|  7
    |        x x x x x x|     |      x    |     |x|  8
    |              x x x|     |      x    |     |x|  9
    |              x x x|     |      x    |     |x| 10
    ---------------------     -------------
    */

    /*
     *
     * Row 3
     *
     */

    pivot = sc_to_sc_matrix[8];

    // sc-row-3 = sc-row-3 - sc-row-1 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[8] = 0;
#endif

    sc_to_sc_matrix[9] -= sc_to_sc_matrix[1] * pivot;
    sc_to_sc_matrix[10] -= sc_to_sc_matrix[2] * pivot;
    sc_to_sc_matrix[11] -= sc_to_sc_matrix[3] * pivot;

    sc_g_matrix[2] -= sc_g_matrix[0] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M M            |     |           |     |M|  1
    |0 1 M M            |     |           |     |M|  2
    |0 M M M            |     |           |     |M|  3
    |x x x x x          |     |           |     |x|  4
    |      x x x x x    |     |           |     |x|  5
    |        x x x x    | ... |           | ... |x|  6 sc
    |        x x x x    |     |           |     |x|  7
    |        x x x x x x|     |      x    |     |x|  8
    |              x x x|     |      x    |     |x|  9
    |              x x x|     |      x    |     |x| 10
    ---------------------     -------------
    */

    pivot = sc_to_sc_matrix[9];

    // sc-row-3 = sc-row-3 - sc-row-2 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[9] = 0;
#endif

    sc_to_sc_matrix[10] -= sc_to_sc_matrix[6] * pivot;
    sc_to_sc_matrix[11] -= sc_to_sc_matrix[7] * pivot;

    sc_g_matrix[2] -= sc_g_matrix[1] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M M            |     |           |     |M|  1
    |0 1 M M            |     |           |     |M|  2
    |0 0 M M            |     |           |     |M|  3
    |x x x x x          |     |           |     |x|  4
    |      x x x x x    |     |           |     |x|  5
    |        x x x x    | ... |           | ... |x|  6 sc
    |        x x x x    |     |           |     |x|  7
    |        x x x x x x|     |      x    |     |x|  8
    |              x x x|     |      x    |     |x|  9
    |              x x x|     |      x    |     |x| 10
    ---------------------     -------------
    */

    pivot = sc_to_sc_matrix[10];

    // sc-row-3 = sc-row-3 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[10] = 1;
#endif

    sc_to_sc_matrix[11] /= pivot;

    sc_g_matrix[2] /= pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M M            |     |           |     |M|  1
    |0 1 M M            |     |           |     |M|  2
    |0 0 1 M            |     |           |     |M|  3
    |x x x x x          |     |           |     |x|  4
    |      x x x x x    |     |           |     |x|  5
    |        x x x x    | ... |           | ... |x|  6 sc
    |        x x x x    |     |           |     |x|  7
    |        x x x x x x|     |      x    |     |x|  8
    |              x x x|     |      x    |     |x|  9
    |              x x x|     |      x    |     |x| 10
    ---------------------     -------------
    */

    /*
     *
     * Row 4
     *
     */

    pivot = sc_to_sc_matrix[12];

    // sc-row-4 = sc-row-4 - sc-row-1 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[12] = 0;
#endif

    sc_to_sc_matrix[13] -= sc_to_sc_matrix[1] * pivot;
    sc_to_sc_matrix[14] -= sc_to_sc_matrix[2] * pivot;
    sc_to_sc_matrix[15] -= sc_to_sc_matrix[3] * pivot;

    sc_g_matrix[3] -= sc_g_matrix[0] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M M            |     |           |     |M|  1
    |0 1 M M            |     |           |     |M|  2
    |0 0 1 M            |     |           |     |M|  3
    |0 M M M x          |     |           |     |M|  4
    |      x x x x x    |     |           |     |x|  5
    |        x x x x    | ... |           | ... |x|  6 sc
    |        x x x x    |     |           |     |x|  7
    |        x x x x x x|     |      x    |     |x|  8
    |              x x x|     |      x    |     |x|  9
    |              x x x|     |      x    |     |x| 10
    ---------------------     -------------
    */

    pivot = sc_to_sc_matrix[13];

    // sc-row-4 = sc-row-4 - sc-row-2 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[13] = 0;
#endif

    sc_to_sc_matrix[14] -= sc_to_sc_matrix[6] * pivot;
    sc_to_sc_matrix[15] -= sc_to_sc_matrix[7] * pivot;

    sc_g_matrix[3] -= sc_g_matrix[1] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M M            |     |           |     |M|  1
    |0 1 M M            |     |           |     |M|  2
    |0 0 1 M            |     |           |     |M|  3
    |0 0 M M x          |     |           |     |M|  4
    |      x x x x x    |     |           |     |x|  5
    |        x x x x    | ... |           | ... |x|  6 sc
    |        x x x x    |     |           |     |x|  7
    |        x x x x x x|     |      x    |     |x|  8
    |              x x x|     |      x    |     |x|  9
    |              x x x|     |      x    |     |x| 10
    ---------------------     -------------
    */

    pivot = sc_to_sc_matrix[14];

    // sc-row-4 = sc-row-4 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[14] = 0;
#endif

    sc_to_sc_matrix[15] -= sc_to_sc_matrix[11] * pivot;

    sc_g_matrix[3] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M M            |     |           |     |M|  1
    |0 1 M M            |     |           |     |M|  2
    |0 0 1 M            |     |           |     |M|  3
    |0 0 0 M x          |     |           |     |M|  4
    |      x x x x x    |     |           |     |x|  5
    |        x x x x    | ... |           | ... |x|  6 sc
    |        x x x x    |     |           |     |x|  7
    |        x x x x x x|     |      x    |     |x|  8
    |              x x x|     |      x    |     |x|  9
    |              x x x|     |      x    |     |x| 10
    ---------------------     -------------
    */

    pivot = sc_to_sc_matrix[15];

    // sc-row-4 = sc-row-4 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[15] = 1;
#endif

    sc_to_sc_matrix[16] /= pivot;

    sc_g_matrix[3] /= pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M M            |     |           |     |M|  1
    |0 1 M M            |     |           |     |M|  2
    |0 0 1 M            |     |           |     |M|  3
    |0 0 0 1 M          |     |           |     |M|  4
    |      x x x x x    |     |           |     |x|  5
    |        x x x x    | ... |           | ... |x|  6 sc
    |        x x x x    |     |           |     |x|  7
    |        x x x x x x|     |      x    |     |x|  8
    |              x x x|     |      x    |     |x|  9
    |              x x x|     |      x    |     |x| 10
    ---------------------     -------------
    */

    /*
     *
     * Row 5
     *
     */

    pivot = sc_to_sc_matrix[17];

    // sc-row-5 = sc-row-5 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[17] = 0;
#endif

    sc_to_sc_matrix[18] -= sc_to_sc_matrix[16] * pivot;

    sc_g_matrix[4] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M M            |     |           |     |M|  1
    |0 1 M M            |     |           |     |M|  2
    |0 0 1 M            |     |           |     |M|  3
    |0 0 0 1 M          |     |           |     |M|  4
    |      0 M x x x    |     |           |     |M|  5
    |        x x x x    | ... |           | ... |x|  6 sc
    |        x x x x    |     |           |     |x|  7
    |        x x x x x x|     |      x    |     |x|  8
    |              x x x|     |      x    |     |x|  9
    |              x x x|     |      x    |     |x| 10
    ---------------------     -------------
    */

    pivot = sc_to_sc_matrix[18];

    // sc-row-5 = sc-row-5 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[18] = 1;
#endif

    sc_to_sc_matrix[19] /= pivot;
    sc_to_sc_matrix[20] /= pivot;
    sc_to_sc_matrix[21] /= pivot;

    sc_g_matrix[4] /= pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M M            |     |           |     |M|  1
    |0 1 M M            |     |           |     |M|  2
    |0 0 1 M            |     |           |     |M|  3
    |0 0 0 1 M          |     |           |     |M|  4
    |      0 1 M M M    |     |           |     |M|  5
    |        x x x x    | ... |           | ... |x|  6 sc
    |        x x x x    |     |           |     |x|  7
    |        x x x x x x|     |      x    |     |x|  8
    |              x x x|     |      x    |     |x|  9
    |              x x x|     |      x    |     |x| 10
    ---------------------     -------------
    */

    /*
     *
     * Row 6
     *
     */

    pivot = sc_to_sc_matrix[22];

    // sc-row-6 = sc-row-6 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[22] = 0;
#endif

    sc_to_sc_matrix[23] -= sc_to_sc_matrix[19] * pivot;
    sc_to_sc_matrix[24] -= sc_to_sc_matrix[20] * pivot;
    sc_to_sc_matrix[25] -= sc_to_sc_matrix[21] * pivot;

    sc_g_matrix[5] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M M            |     |           |     |M|  1
    |0 1 M M            |     |           |     |M|  2
    |0 0 1 M            |     |           |     |M|  3
    |0 0 0 1 M          |     |           |     |M|  4
    |      0 1 M M M    |     |           |     |M|  5
    |        0 M M M    | ... |           | ... |M|  6 sc
    |        x x x x    |     |           |     |x|  7
    |        x x x x x x|     |      x    |     |x|  8
    |              x x x|     |      x    |     |x|  9
    |              x x x|     |      x    |     |x| 10
    ---------------------     -------------
    */

    pivot = sc_to_sc_matrix[23];

    // sc-row-6 = sc-row-6 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[23] = 1;
#endif

    sc_to_sc_matrix[24] /= pivot;
    sc_to_sc_matrix[25] /= pivot;

    sc_g_matrix[5] /= pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M M            |     |           |     |M|  1
    |0 1 M M            |     |           |     |M|  2
    |0 0 1 M            |     |           |     |M|  3
    |0 0 0 1 M          |     |           |     |M|  4
    |      0 1 M M M    |     |           |     |M|  5
    |        0 1 M M    | ... |           | ... |M|  6 sc
    |        x x x x    |     |           |     |x|  7
    |        x x x x x x|     |      x    |     |x|  8
    |              x x x|     |      x    |     |x|  9
    |              x x x|     |      x    |     |x| 10
    ---------------------     -------------
    */

    /*
     *
     * Row 7
     *
     */

    pivot = sc_to_sc_matrix[26];

    // sc-row-7 = sc-row-7 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[26] = 0;
#endif

    sc_to_sc_matrix[27] -= sc_to_sc_matrix[19] * pivot;
    sc_to_sc_matrix[28] -= sc_to_sc_matrix[20] * pivot;
    sc_to_sc_matrix[29] -= sc_to_sc_matrix[21] * pivot;

    sc_g_matrix[6] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M M            |     |           |     |M|  1
    |0 1 M M            |     |           |     |M|  2
    |0 0 1 M            |     |           |     |M|  3
    |0 0 0 1 M          |     |           |     |M|  4
    |      0 1 M M M    |     |           |     |M|  5
    |        0 1 M M    | ... |           | ... |M|  6 sc
    |        0 M M M    |     |           |     |M|  7
    |        x x x x x x|     |      x    |     |x|  8
    |              x x x|     |      x    |     |x|  9
    |              x x x|     |      x    |     |x| 10
    ---------------------     -------------
    */

    pivot = sc_to_sc_matrix[27];

    // sc-row-7 = sc-row-7 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[27] = 0;
#endif

    sc_to_sc_matrix[28] -= sc_to_sc_matrix[24] * pivot;
    sc_to_sc_matrix[29] -= sc_to_sc_matrix[25] * pivot;

    sc_g_matrix[6] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M M            |     |           |     |M|  1
    |0 1 M M            |     |           |     |M|  2
    |0 0 1 M            |     |           |     |M|  3
    |0 0 0 1 M          |     |           |     |M|  4
    |      0 1 M M M    |     |           |     |M|  5
    |        0 1 M M    | ... |           | ... |M|  6 sc
    |        0 0 M M    |     |           |     |M|  7
    |        x x x x x x|     |      x    |     |x|  8
    |              x x x|     |      x    |     |x|  9
    |              x x x|     |      x    |     |x| 10
    ---------------------     -------------
    */

    pivot = sc_to_sc_matrix[28];

    // sc-row-7 = sc-row-7 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[28] = 1;
#endif

    sc_to_sc_matrix[29] /= pivot;

    sc_g_matrix[6] /= pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M M            |     |           |     |M|  1
    |0 1 M M            |     |           |     |M|  2
    |0 0 1 M            |     |           |     |M|  3
    |0 0 0 1 M          |     |           |     |M|  4
    |      0 1 M M M    |     |           |     |M|  5
    |        0 1 M M    | ... |           | ... |M|  6 sc
    |        0 0 1 M    |     |           |     |M|  7
    |        x x x x x x|     |      x    |     |x|  8
    |              x x x|     |      x    |     |x|  9
    |              x x x|     |      x    |     |x| 10
    ---------------------     -------------
    */

    /*
     *
     * Row 8
     *
     */

    pivot = sc_to_sc_matrix[30];

    // sc-row-8 = sc-row-8 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[30] = 0;
#endif

    sc_to_sc_matrix[31] -= sc_to_sc_matrix[19] * pivot;
    sc_to_sc_matrix[32] -= sc_to_sc_matrix[20] * pivot;
    sc_to_sc_matrix[33] -= sc_to_sc_matrix[21] * pivot;

    sc_g_matrix[7] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M M            |     |           |     |M|  1
    |0 1 M M            |     |           |     |M|  2
    |0 0 1 M            |     |           |     |M|  3
    |0 0 0 1 M          |     |           |     |M|  4
    |      0 1 M M M    |     |           |     |M|  5
    |        0 1 M M    | ... |           | ... |M|  6 sc
    |        0 0 1 M    |     |           |     |M|  7
    |        0 M M M x x|     |      x    |     |M|  8
    |              x x x|     |      x    |     |x|  9
    |              x x x|     |      x    |     |x| 10
    ---------------------     -------------
    */

    pivot = sc_to_sc_matrix[31];

    // sc-row-8 = sc-row-8 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[31] = 0;
#endif

    sc_to_sc_matrix[32] -= sc_to_sc_matrix[24] * pivot;
    sc_to_sc_matrix[33] -= sc_to_sc_matrix[25] * pivot;

    sc_g_matrix[7] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M M            |     |           |     |M|  1
    |0 1 M M            |     |           |     |M|  2
    |0 0 1 M            |     |           |     |M|  3
    |0 0 0 1 M          |     |           |     |M|  4
    |      0 1 M M M    |     |           |     |M|  5
    |        0 1 M M    | ... |           | ... |M|  6 sc
    |        0 0 1 M    |     |           |     |M|  7
    |        0 0 M M x x|     |      x    |     |M|  8
    |              x x x|     |      x    |     |x|  9
    |              x x x|     |      x    |     |x| 10
    ---------------------     -------------
    */

    pivot = sc_to_sc_matrix[32];

    // sc-row-8 = sc-row-8 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[32] = 0;
#endif

    sc_to_sc_matrix[33] -= sc_to_sc_matrix[29] * pivot;

    sc_g_matrix[7] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M M            |     |           |     |M|  1
    |0 1 M M            |     |           |     |M|  2
    |0 0 1 M            |     |           |     |M|  3
    |0 0 0 1 M          |     |           |     |M|  4
    |      0 1 M M M    |     |           |     |M|  5
    |        0 1 M M    | ... |           | ... |M|  6 sc
    |        0 0 1 M    |     |           |     |M|  7
    |        0 0 0 M x x|     |      x    |     |M|  8
    |              x x x|     |      x    |     |x|  9
    |              x x x|     |      x    |     |x| 10
    ---------------------     -------------
    */

    pivot = sc_to_sc_matrix[33];

    // sc-row-8 = sc-row-8 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[33] = 1;
#endif

    sc_to_sc_matrix[34] /= pivot;
    sc_to_sc_matrix[35] /= pivot;

    sc_to_bb_matrix[0] /= pivot;

    sc_g_matrix[7] /= pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M M            |     |           |     |M|  1
    |0 1 M M            |     |           |     |M|  2
    |0 0 1 M            |     |           |     |M|  3
    |0 0 0 1 M          |     |           |     |M|  4
    |      0 1 M M M    |     |           |     |M|  5
    |        0 1 M M    | ... |           | ... |M|  6 sc
    |        0 0 1 M    |     |           |     |M|  7
    |        0 0 0 1 M M|     |      M    |     |M|  8
    |              x x x|     |      x    |     |x|  9
    |              x x x|     |      x    |     |x| 10
    ---------------------     -------------
    */

    /*
     *
     * Row 9
     *
     */

    pivot = sc_to_sc_matrix[36];

    // sc-row-9 = sc-row-9 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[36] = 0;
#endif

    sc_to_sc_matrix[37] -= sc_to_sc_matrix[34] * pivot;
    sc_to_sc_matrix[38] -= sc_to_sc_matrix[35] * pivot;

    sc_to_bb_matrix[1] -= sc_to_bb_matrix[0] * pivot;

    sc_g_matrix[8] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M M            |     |           |     |M|  1
    |0 1 M M            |     |           |     |M|  2
    |0 0 1 M            |     |           |     |M|  3
    |0 0 0 1 M          |     |           |     |M|  4
    |      0 1 M M M    |     |           |     |M|  5
    |        0 1 M M    | ... |           | ... |M|  6 sc
    |        0 0 1 M    |     |           |     |M|  7
    |        0 0 0 1 M M|     |      M    |     |M|  8
    |              0 M M|     |      M    |     |M|  9
    |              x x x|     |      x    |     |x| 10
    ---------------------     -------------
    */

    pivot = sc_to_sc_matrix[37];

    // sc-row-9 = sc-row-9 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[37] = 1;
#endif

    sc_to_sc_matrix[38] /= pivot;

    sc_to_bb_matrix[1] /= pivot;

    sc_g_matrix[8] /= pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M M            |     |           |     |M|  1
    |0 1 M M            |     |           |     |M|  2
    |0 0 1 M            |     |           |     |M|  3
    |0 0 0 1 M          |     |           |     |M|  4
    |      0 1 M M M    |     |           |     |M|  5
    |        0 1 M M    | ... |           | ... |M|  6 sc
    |        0 0 1 M    |     |           |     |M|  7
    |        0 0 0 1 M M|     |      M    |     |M|  8
    |              0 1 M|     |      M    |     |M|  9
    |              x x x|     |      x    |     |x| 10
    ---------------------     -------------
    */

    /*
     *
     * Row 10
     *
     */

    pivot = sc_to_sc_matrix[39];

    // sc-row-10 = sc-row-10 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[39] = 0;
#endif

    sc_to_sc_matrix[40] -= sc_to_sc_matrix[34] * pivot;
    sc_to_sc_matrix[41] -= sc_to_sc_matrix[35] * pivot;

    sc_to_bb_matrix[2] -= sc_to_bb_matrix[0] * pivot;

    sc_g_matrix[9] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M M            |     |           |     |M|  1
    |0 1 M M            |     |           |     |M|  2
    |0 0 1 M            |     |           |     |M|  3
    |0 0 0 1 M          |     |           |     |M|  4
    |      0 1 M M M    |     |           |     |M|  5
    |        0 1 M M    | ... |           | ... |M|  6 sc
    |        0 0 1 M    |     |           |     |M|  7
    |        0 0 0 1 M M|     |      M    |     |M|  8
    |              0 1 M|     |      M    |     |M|  9
    |              0 M M|     |      M    |     |M| 10
    ---------------------     -------------
    */

    pivot = sc_to_sc_matrix[40];

    // sc-row-10 = sc-row-10 - sc-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[40] = 0;
#endif

    sc_to_sc_matrix[41] -= sc_to_sc_matrix[38] * pivot;

    sc_to_bb_matrix[2] -= sc_to_bb_matrix[1] * pivot;

    sc_g_matrix[9] -= sc_g_matrix[8] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M M            |     |           |     |M|  1
    |0 1 M M            |     |           |     |M|  2
    |0 0 1 M            |     |           |     |M|  3
    |0 0 0 1 M          |     |           |     |M|  4
    |      0 1 M M M    |     |           |     |M|  5
    |        0 1 M M    | ... |           | ... |M|  6 sc
    |        0 0 1 M    |     |           |     |M|  7
    |        0 0 0 1 M M|     |      M    |     |M|  8
    |              0 1 M|     |      M    |     |M|  9
    |              0 0 M|     |      M    |     |M| 10
    ---------------------     -------------
    */

    pivot = sc_to_sc_matrix[41];

    // sc-row-10 = sc-row-10 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[41] = 1;
#endif

    sc_to_bb_matrix[2] /= pivot;

    sc_g_matrix[9] /= pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M M            |     |           |     |M|  1
    |0 1 M M            |     |           |     |M|  2
    |0 0 1 M            |     |           |     |M|  3
    |0 0 0 1 M          |     |           |     |M|  4
    |      0 1 M M M    |     |           |     |M|  5
    |        0 1 M M    | ... |           | ... |M|  6 sc
    |        0 0 1 M    |     |           |     |M|  7
    |        0 0 0 1 M M|     |      M    |     |M|  8
    |              0 1 M|     |      M    |     |M|  9
    |              0 0 1|     |      M    |     |M| 10
    ---------------------     -------------
    */
}

void gmx::IlvesPC::solve_2_alaline(real *const sc_to_sc_matrix,
                                   real *const sc_to_bb_matrix,
                                   __attribute__((unused))
                                   real *const sc_to_sep_matrix,
                                   real *const sc_g_matrix,
                                   __attribute__((unused))
                                   real *const sc_to_sc_fillins,
                                   __attribute__((unused))
                                   real *const sc_to_bb_fillins) {
    /*
     *
     * Row 1
     *
     */

    real pivot = sc_to_sc_matrix[0];

    // sc-row-1 = sc-row-1 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[0] = 1;
#endif

    sc_to_sc_matrix[1] /= pivot;
    sc_to_sc_matrix[2] /= pivot;

    sc_to_bb_matrix[0] /= pivot;

    sc_g_matrix[0] /= pivot;

    /*
    Resulting matrix:

      sc             bb            g
     1 2 3       1 2 3 4 5 6
    -------     -------------
    |1 M M|     |      M    |     |M|  1
    |x x x| ... |      x    | ... |x|  2 sc
    |x x x|     |      x    |     |x|  3
    -------     -------------
    */

    /*
     *
     * Row 2
     *
     */

    pivot = sc_to_sc_matrix[3];

    // sc-row-2 = sc-row-2 - sc-row-1 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[3] = 0;
#endif

    sc_to_sc_matrix[4] -= sc_to_sc_matrix[1] * pivot;
    sc_to_sc_matrix[5] -= sc_to_sc_matrix[2] * pivot;

    sc_to_bb_matrix[1] -= sc_to_bb_matrix[0] * pivot;

    sc_g_matrix[1] -= sc_g_matrix[0] * pivot;

    /*
    Resulting matrix:

      sc             bb            g
     1 2 3       1 2 3 4 5 6
    -------     -------------
    |1 M M|     |      M    |     |M|  1
    |0 M M| ... |      M    | ... |M|  2 sc
    |x x x|     |      x    |     |x|  3
    -------     -------------
    */

    pivot = sc_to_sc_matrix[4];

    // sc-row-2 = sc-row-2 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[4] = 1;
#endif

    sc_to_sc_matrix[5] /= pivot;

    sc_to_bb_matrix[1] /= pivot;

    sc_g_matrix[1] /= pivot;

    /*
    Resulting matrix:

      sc             bb            g
     1 2 3       1 2 3 4 5 6
    -------     -------------
    |1 M M|     |      M    |     |M|  1
    |0 1 M| ... |      M    | ... |M|  2 sc
    |x x x|     |      x    |     |x|  3
    -------     -------------
    */

    /*
     *
     * Row 3
     *
     */

    pivot = sc_to_sc_matrix[6];

    // sc-row-3 = sc-row-3 - sc-row-1 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[6] = 0;
#endif

    sc_to_sc_matrix[7] -= sc_to_sc_matrix[1] * pivot;
    sc_to_sc_matrix[8] -= sc_to_sc_matrix[2] * pivot;

    sc_to_bb_matrix[2] -= sc_to_bb_matrix[0] * pivot;

    sc_g_matrix[2] -= sc_g_matrix[0] * pivot;

    /*
    Resulting matrix:

      sc             bb            g
     1 2 3       1 2 3 4 5 6
    -------     -------------
    |1 M M|     |      M    |     |M|  1
    |0 1 M| ... |      M    | ... |M|  2 sc
    |0 M M|     |      M    |     |M|  3
    -------     -------------
    */

    pivot = sc_to_sc_matrix[7];

    // sc-row-3 = sc-row-3 - sc-row-2 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[7] = 0;
#endif

    sc_to_sc_matrix[8] -= sc_to_sc_matrix[5] * pivot;

    sc_to_bb_matrix[2] -= sc_to_bb_matrix[1] * pivot;

    sc_g_matrix[2] -= sc_g_matrix[1] * pivot;

    /*
    Resulting matrix:

      sc             bb            g
     1 2 3       1 2 3 4 5 6
    -------     -------------
    |1 M M|     |      M    |     |M|  1
    |0 1 M| ... |      M    | ... |M|  2 sc
    |0 0 M|     |      M    |     |M|  3
    -------     -------------
    */

    pivot = sc_to_sc_matrix[8];

    // sc-row-3 = sc-row-3 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[8] = 1;
#endif

    sc_to_bb_matrix[2] /= pivot;

    sc_g_matrix[2] /= pivot;

    /*
    Resulting matrix:

      sc             bb            g
     1 2 3       1 2 3 4 5 6
    -------     -------------
    |1 M M|     |      M    |     |M|  1
    |0 1 M| ... |      M    | ... |M|  2 sc
    |0 0 1|     |      M    |     |M|  3
    -------     -------------
    */
}

void gmx::IlvesPC::solve_2_valine(real *const sc_to_sc_matrix,
                                  real *const sc_to_bb_matrix,
                                  __attribute__((unused))
                                  real *const sc_to_sep_matrix,
                                  real *const sc_g_matrix,
                                  __attribute__((unused))
                                  real *const sc_to_sc_fillins,
                                  __attribute__((unused))
                                  real *const sc_to_bb_fillins) {
    /*
     *
     * Row 1
     *
     */

    real pivot = sc_to_sc_matrix[0];

    // sc-row-1 = sc-row-1 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[0] = 1;
#endif

    sc_to_sc_matrix[1] /= pivot;
    sc_to_sc_matrix[2] /= pivot;
    sc_to_sc_matrix[3] /= pivot;

    sc_g_matrix[0] /= pivot;

    /*
    Resulting matrix:

            sc                   bb            g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5 6
    -------------------     -------------
    |1 M M M          |     |           |     |M|  1
    |x x x x          |     |           |     |x|  2
    |x x x x          |     |           |     |x|  3
    |x x x x       x x|     |      x    |     |x|  4
    |        x x x x  | ... |           | ... |x|  5 sc
    |        x x x x  |     |           |     |x|  6
    |        x x x x  |     |           |     |x|  7
    |      x x x x x x|     |      x    |     |x|  8
    |      x       x x|     |      x    |     |x|  9
    -------------------     -------------
    */

    /*
     *
     * Row 2
     *
     */

    pivot = sc_to_sc_matrix[4];

    // sc-row-2 = sc-row-2 - sc-row-1 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[4] = 0;
#endif

    sc_to_sc_matrix[5] -= sc_to_sc_matrix[1] * pivot;
    sc_to_sc_matrix[6] -= sc_to_sc_matrix[2] * pivot;
    sc_to_sc_matrix[7] -= sc_to_sc_matrix[3] * pivot;

    sc_g_matrix[1] -= sc_g_matrix[0] * pivot;

    /*
    Resulting matrix:

            sc                   bb            g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5 6
    -------------------     -------------
    |1 M M M          |     |           |     |M|  1
    |0 M M M          |     |           |     |M|  2
    |x x x x          |     |           |     |x|  3
    |x x x x       x x|     |      x    |     |x|  4
    |        x x x x  | ... |           | ... |x|  5 sc
    |        x x x x  |     |           |     |x|  6
    |        x x x x  |     |           |     |x|  7
    |      x x x x x x|     |      x    |     |x|  8
    |      x       x x|     |      x    |     |x|  9
    -------------------     -------------
    */

    pivot = sc_to_sc_matrix[5];

    // sc-row-2 = sc-row-2 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[5] = 1;
#endif

    sc_to_sc_matrix[6] /= pivot;
    sc_to_sc_matrix[7] /= pivot;

    sc_g_matrix[1] /= pivot;

    /*
    Resulting matrix:

            sc                   bb            g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5 6
    -------------------     -------------
    |1 M M M          |     |           |     |M|  1
    |0 1 M M          |     |           |     |M|  2
    |x x x x          |     |           |     |x|  3
    |x x x x       x x|     |      x    |     |x|  4
    |        x x x x  | ... |           | ... |x|  5 sc
    |        x x x x  |     |           |     |x|  6
    |        x x x x  |     |           |     |x|  7
    |      x x x x x x|     |      x    |     |x|  8
    |      x       x x|     |      x    |     |x|  9
    -------------------     -------------
    */

    /*
     *
     * Row 3
     *
     */

    pivot = sc_to_sc_matrix[8];

    // sc-row-3 = sc-row-3 - sc-row-1 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[8] = 0;
#endif

    sc_to_sc_matrix[9] -= sc_to_sc_matrix[1] * pivot;
    sc_to_sc_matrix[10] -= sc_to_sc_matrix[2] * pivot;
    sc_to_sc_matrix[11] -= sc_to_sc_matrix[3] * pivot;

    sc_g_matrix[2] -= sc_g_matrix[0] * pivot;

    /*
    Resulting matrix:

            sc                   bb            g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5 6
    -------------------     -------------
    |1 M M M          |     |           |     |M|  1
    |0 1 M M          |     |           |     |M|  2
    |0 M M M          |     |           |     |M|  3
    |x x x x       x x|     |      x    |     |x|  4
    |        x x x x  | ... |           | ... |x|  5 sc
    |        x x x x  |     |           |     |x|  6
    |        x x x x  |     |           |     |x|  7
    |      x x x x x x|     |      x    |     |x|  8
    |      x       x x|     |      x    |     |x|  9
    -------------------     -------------
    */

    pivot = sc_to_sc_matrix[9];

    // sc-row-3 = sc-row-3 - sc-row-2 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[9] = 0;
#endif

    sc_to_sc_matrix[10] -= sc_to_sc_matrix[6] * pivot;
    sc_to_sc_matrix[11] -= sc_to_sc_matrix[7] * pivot;

    sc_g_matrix[2] -= sc_g_matrix[1] * pivot;

    /*
    Resulting matrix:

            sc                   bb            g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5 6
    -------------------     -------------
    |1 M M M          |     |           |     |M|  1
    |0 1 M M          |     |           |     |M|  2
    |0 0 M M          |     |           |     |M|  3
    |x x x x       x x|     |      x    |     |x|  4
    |        x x x x  | ... |           | ... |x|  5 sc
    |        x x x x  |     |           |     |x|  6
    |        x x x x  |     |           |     |x|  7
    |      x x x x x x|     |      x    |     |x|  8
    |      x       x x|     |      x    |     |x|  9
    -------------------     -------------
    */

    pivot = sc_to_sc_matrix[10];

    // sc-row-3 = sc-row-3 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[10] = 1;
#endif

    sc_to_sc_matrix[11] /= pivot;

    sc_g_matrix[2] /= pivot;

    /*
    Resulting matrix:

            sc                   bb            g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5 6
    -------------------     -------------
    |1 M M M          |     |           |     |M|  1
    |0 1 M M          |     |           |     |M|  2
    |0 0 1 M          |     |           |     |M|  3
    |x x x x       x x|     |      x    |     |x|  4
    |        x x x x  | ... |           | ... |x|  5 sc
    |        x x x x  |     |           |     |x|  6
    |        x x x x  |     |           |     |x|  7
    |      x x x x x x|     |      x    |     |x|  8
    |      x       x x|     |      x    |     |x|  9
    -------------------     -------------
    */

    /*
     *
     * Row 4
     *
     */

    pivot = sc_to_sc_matrix[12];

    // sc-row-4 = sc-row-4 - sc-row-1 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[12] = 0;
#endif

    sc_to_sc_matrix[13] -= sc_to_sc_matrix[1] * pivot;
    sc_to_sc_matrix[14] -= sc_to_sc_matrix[2] * pivot;
    sc_to_sc_matrix[15] -= sc_to_sc_matrix[3] * pivot;

    sc_g_matrix[3] -= sc_g_matrix[0] * pivot;

    /*
    Resulting matrix:

            sc                   bb            g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5 6
    -------------------     -------------
    |1 M M M          |     |           |     |M|  1
    |0 1 M M          |     |           |     |M|  2
    |0 0 1 M          |     |           |     |M|  3
    |0 M M M       x x|     |      x    |     |M|  4
    |        x x x x  | ... |           | ... |x|  5 sc
    |        x x x x  |     |           |     |x|  6
    |        x x x x  |     |           |     |x|  7
    |      x x x x x x|     |      x    |     |x|  8
    |      x       x x|     |      x    |     |x|  9
    -------------------     -------------
    */

    pivot = sc_to_sc_matrix[13];

    // sc-row-4 = sc-row-4 - sc-row-2 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[13] = 0;
#endif

    sc_to_sc_matrix[14] -= sc_to_sc_matrix[6] * pivot;
    sc_to_sc_matrix[15] -= sc_to_sc_matrix[7] * pivot;

    sc_g_matrix[3] -= sc_g_matrix[1] * pivot;

    /*
    Resulting matrix:

            sc                   bb            g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5 6
    -------------------     -------------
    |1 M M M          |     |           |     |M|  1
    |0 1 M M          |     |           |     |M|  2
    |0 0 1 M          |     |           |     |M|  3
    |0 0 M M       x x|     |      x    |     |M|  4
    |        x x x x  | ... |           | ... |x|  5 sc
    |        x x x x  |     |           |     |x|  6
    |        x x x x  |     |           |     |x|  7
    |      x x x x x x|     |      x    |     |x|  8
    |      x       x x|     |      x    |     |x|  9
    -------------------     -------------
    */

    pivot = sc_to_sc_matrix[14];

    // sc-row-4 = sc-row-4 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[14] = 0;
#endif

    sc_to_sc_matrix[15] -= sc_to_sc_matrix[11] * pivot;

    sc_g_matrix[3] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

            sc                   bb            g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5 6
    -------------------     -------------
    |1 M M M          |     |           |     |M|  1
    |0 1 M M          |     |           |     |M|  2
    |0 0 1 M          |     |           |     |M|  3
    |0 0 0 M       x x|     |      x    |     |M|  4
    |        x x x x  | ... |           | ... |x|  5 sc
    |        x x x x  |     |           |     |x|  6
    |        x x x x  |     |           |     |x|  7
    |      x x x x x x|     |      x    |     |x|  8
    |      x       x x|     |      x    |     |x|  9
    -------------------     -------------
    */

    pivot = sc_to_sc_matrix[15];

    // sc-row-4 = sc-row-4 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[15] = 1;
#endif

    sc_to_sc_matrix[16] /= pivot;
    sc_to_sc_matrix[17] /= pivot;

    sc_to_bb_matrix[0] /= pivot;

    sc_g_matrix[3] /= pivot;

    /*
    Resulting matrix:

            sc                   bb            g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5 6
    -------------------     -------------
    |1 M M M          |     |           |     |M|  1
    |0 1 M M          |     |           |     |M|  2
    |0 0 1 M          |     |           |     |M|  3
    |0 0 0 1       M M|     |      M    |     |M|  4
    |        x x x x  | ... |           | ... |x|  5 sc
    |        x x x x  |     |           |     |x|  6
    |        x x x x  |     |           |     |x|  7
    |      x x x x x x|     |      x    |     |x|  8
    |      x       x x|     |      x    |     |x|  9
    -------------------     -------------
    */

    /*
     *
     * Row 5
     *
     */

    pivot = sc_to_sc_matrix[18];

    // sc-row-5 = sc-row-5 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[18] = 1;
#endif

    sc_to_sc_matrix[19] /= pivot;
    sc_to_sc_matrix[20] /= pivot;
    sc_to_sc_matrix[21] /= pivot;

    sc_g_matrix[4] /= pivot;

    /*
    Resulting matrix:

            sc                   bb            g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5 6
    -------------------     -------------
    |1 M M M          |     |           |     |M|  1
    |0 1 M M          |     |           |     |M|  2
    |0 0 1 M          |     |           |     |M|  3
    |0 0 0 1       M M|     |      M    |     |M|  4
    |        1 M M M  | ... |           | ... |M|  5 sc
    |        x x x x  |     |           |     |x|  6
    |        x x x x  |     |           |     |x|  7
    |      x x x x x x|     |      x    |     |x|  8
    |      x       x x|     |      x    |     |x|  9
    -------------------     -------------
    */

    /*
     *
     * Row 6
     *
     */

    pivot = sc_to_sc_matrix[22];

    // sc-row-6 = sc-row-6 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[22] = 0;
#endif

    sc_to_sc_matrix[23] -= sc_to_sc_matrix[19] * pivot;
    sc_to_sc_matrix[24] -= sc_to_sc_matrix[20] * pivot;
    sc_to_sc_matrix[25] -= sc_to_sc_matrix[21] * pivot;

    sc_g_matrix[5] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

            sc                   bb            g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5 6
    -------------------     -------------
    |1 M M M          |     |           |     |M|  1
    |0 1 M M          |     |           |     |M|  2
    |0 0 1 M          |     |           |     |M|  3
    |0 0 0 1       M M|     |      M    |     |M|  4
    |        1 M M M  | ... |           | ... |M|  5 sc
    |        0 M M M  |     |           |     |M|  6
    |        x x x x  |     |           |     |x|  7
    |      x x x x x x|     |      x    |     |x|  8
    |      x       x x|     |      x    |     |x|  9
    -------------------     -------------
    */

    pivot = sc_to_sc_matrix[23];

    // sc-row-6 = sc-row-6 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[23] = 1;
#endif

    sc_to_sc_matrix[24] /= pivot;
    sc_to_sc_matrix[25] /= pivot;

    sc_g_matrix[5] /= pivot;

    /*
    Resulting matrix:

            sc                   bb            g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5 6
    -------------------     -------------
    |1 M M M          |     |           |     |M|  1
    |0 1 M M          |     |           |     |M|  2
    |0 0 1 M          |     |           |     |M|  3
    |0 0 0 1       M M|     |      M    |     |M|  4
    |        1 M M M  | ... |           | ... |M|  5 sc
    |        0 1 M M  |     |           |     |M|  6
    |        x x x x  |     |           |     |x|  7
    |      x x x x x x|     |      x    |     |x|  8
    |      x       x x|     |      x    |     |x|  9
    -------------------     -------------
    */

    /*
     *
     * Row 7
     *
     */

    pivot = sc_to_sc_matrix[26];

    // sc-row-7 = sc-row-7 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[26] = 0;
#endif

    sc_to_sc_matrix[27] -= sc_to_sc_matrix[19] * pivot;
    sc_to_sc_matrix[28] -= sc_to_sc_matrix[20] * pivot;
    sc_to_sc_matrix[29] -= sc_to_sc_matrix[21] * pivot;

    sc_g_matrix[6] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

            sc                   bb            g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5 6
    -------------------     -------------
    |1 M M M          |     |           |     |M|  1
    |0 1 M M          |     |           |     |M|  2
    |0 0 1 M          |     |           |     |M|  3
    |0 0 0 1       M M|     |      M    |     |M|  4
    |        1 M M M  | ... |           | ... |M|  5 sc
    |        0 1 M M  |     |           |     |M|  6
    |        0 M M M  |     |           |     |M|  7
    |      x x x x x x|     |      x    |     |x|  8
    |      x       x x|     |      x    |     |x|  9
    -------------------     -------------
    */

    pivot = sc_to_sc_matrix[27];

    // sc-row-7 = sc-row-7 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[27] = 0;
#endif

    sc_to_sc_matrix[28] -= sc_to_sc_matrix[24] * pivot;
    sc_to_sc_matrix[29] -= sc_to_sc_matrix[25] * pivot;

    sc_g_matrix[6] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

            sc                   bb            g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5 6
    -------------------     -------------
    |1 M M M          |     |           |     |M|  1
    |0 1 M M          |     |           |     |M|  2
    |0 0 1 M          |     |           |     |M|  3
    |0 0 0 1       M M|     |      M    |     |M|  4
    |        1 M M M  | ... |           | ... |M|  5 sc
    |        0 1 M M  |     |           |     |M|  6
    |        0 0 M M  |     |           |     |M|  7
    |      x x x x x x|     |      x    |     |x|  8
    |      x       x x|     |      x    |     |x|  9
    -------------------     -------------
    */

    pivot = sc_to_sc_matrix[28];

    // sc-row-7 = sc-row-7 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[28] = 1;
#endif

    sc_to_sc_matrix[29] /= pivot;

    sc_g_matrix[6] /= pivot;

    /*
    Resulting matrix:

            sc                   bb            g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5 6
    -------------------     -------------
    |1 M M M          |     |           |     |M|  1
    |0 1 M M          |     |           |     |M|  2
    |0 0 1 M          |     |           |     |M|  3
    |0 0 0 1       M M|     |      M    |     |M|  4
    |        1 M M M  | ... |           | ... |M|  5 sc
    |        0 1 M M  |     |           |     |M|  6
    |        0 0 1 M  |     |           |     |M|  7
    |      x x x x x x|     |      x    |     |x|  8
    |      x       x x|     |      x    |     |x|  9
    -------------------     -------------
    */

    /*
     *
     * Row 8
     *
     */

    pivot = sc_to_sc_matrix[30];

    // sc-row-8 = sc-row-8 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[30] = 0;
#endif

    sc_to_sc_matrix[34] -= sc_to_sc_matrix[16] * pivot;
    sc_to_sc_matrix[35] -= sc_to_sc_matrix[17] * pivot;

    sc_to_bb_matrix[1] -= sc_to_bb_matrix[0] * pivot;

    sc_g_matrix[7] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

            sc                   bb            g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5 6
    -------------------     -------------
    |1 M M M          |     |           |     |M|  1
    |0 1 M M          |     |           |     |M|  2
    |0 0 1 M          |     |           |     |M|  3
    |0 0 0 1       M M|     |      M    |     |M|  4
    |        1 M M M  | ... |           | ... |M|  5 sc
    |        0 1 M M  |     |           |     |M|  6
    |        0 0 1 M  |     |           |     |M|  7
    |      0 x x x M M|     |      M    |     |M|  8
    |      x       x x|     |      x    |     |x|  9
    -------------------     -------------
    */

    pivot = sc_to_sc_matrix[31];

    // sc-row-8 = sc-row-8 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[31] = 0;
#endif

    sc_to_sc_matrix[32] -= sc_to_sc_matrix[19] * pivot;
    sc_to_sc_matrix[33] -= sc_to_sc_matrix[20] * pivot;
    sc_to_sc_matrix[34] -= sc_to_sc_matrix[21] * pivot;

    sc_g_matrix[7] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

            sc                   bb            g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5 6
    -------------------     -------------
    |1 M M M          |     |           |     |M|  1
    |0 1 M M          |     |           |     |M|  2
    |0 0 1 M          |     |           |     |M|  3
    |0 0 0 1       M M|     |      M    |     |M|  4
    |        1 M M M  | ... |           | ... |M|  5 sc
    |        0 1 M M  |     |           |     |M|  6
    |        0 0 1 M  |     |           |     |M|  7
    |      0 0 M M M M|     |      M    |     |M|  8
    |      x       x x|     |      x    |     |x|  9
    -------------------     -------------
    */

    pivot = sc_to_sc_matrix[32];

    // sc-row-8 = sc-row-8 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[32] = 0;
#endif

    sc_to_sc_matrix[33] -= sc_to_sc_matrix[24] * pivot;
    sc_to_sc_matrix[34] -= sc_to_sc_matrix[25] * pivot;

    sc_g_matrix[7] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

            sc                   bb            g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5 6
    -------------------     -------------
    |1 M M M          |     |           |     |M|  1
    |0 1 M M          |     |           |     |M|  2
    |0 0 1 M          |     |           |     |M|  3
    |0 0 0 1       M M|     |      M    |     |M|  4
    |        1 M M M  | ... |           | ... |M|  5 sc
    |        0 1 M M  |     |           |     |M|  6
    |        0 0 1 M  |     |           |     |M|  7
    |      0 0 0 M M M|     |      M    |     |M|  8
    |      x       x x|     |      x    |     |x|  9
    -------------------     -------------
    */

    pivot = sc_to_sc_matrix[33];

    // sc-row-8 = sc-row-8 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[33] = 0;
#endif

    sc_to_sc_matrix[34] -= sc_to_sc_matrix[29] * pivot;

    sc_g_matrix[7] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

            sc                   bb            g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5 6
    -------------------     -------------
    |1 M M M          |     |           |     |M|  1
    |0 1 M M          |     |           |     |M|  2
    |0 0 1 M          |     |           |     |M|  3
    |0 0 0 1       M M|     |      M    |     |M|  4
    |        1 M M M  | ... |           | ... |M|  5 sc
    |        0 1 M M  |     |           |     |M|  6
    |        0 0 1 M  |     |           |     |M|  7
    |      0 0 0 0 M M|     |      M    |     |M|  8
    |      x       x x|     |      x    |     |x|  9
    -------------------     -------------
    */

    pivot = sc_to_sc_matrix[34];

    // sc-row-8 = sc-row-8 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[34] = 1;
#endif

    sc_to_sc_matrix[35] /= pivot;

    sc_to_bb_matrix[1] /= pivot;

    sc_g_matrix[7] /= pivot;

    /*
    Resulting matrix:

            sc                   bb            g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5 6
    -------------------     -------------
    |1 M M M          |     |           |     |M|  1
    |0 1 M M          |     |           |     |M|  2
    |0 0 1 M          |     |           |     |M|  3
    |0 0 0 1       M M|     |      M    |     |M|  4
    |        1 M M M  | ... |           | ... |M|  5 sc
    |        0 1 M M  |     |           |     |M|  6
    |        0 0 1 M  |     |           |     |M|  7
    |      0 0 0 0 1 M|     |      M    |     |M|  8
    |      x       x x|     |      x    |     |x|  9
    -------------------     -------------
    */

    /*
     *
     * Row 9
     *
     */

    pivot = sc_to_sc_matrix[36];

    // sc-row-9 = sc-row-9 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[36] = 0;
#endif

    sc_to_sc_matrix[37] -= sc_to_sc_matrix[16] * pivot;
    sc_to_sc_matrix[38] -= sc_to_sc_matrix[17] * pivot;

    sc_to_bb_matrix[2] -= sc_to_bb_matrix[0] * pivot;

    sc_g_matrix[8] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

            sc                   bb            g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5 6
    -------------------     -------------
    |1 M M M          |     |           |     |M|  1
    |0 1 M M          |     |           |     |M|  2
    |0 0 1 M          |     |           |     |M|  3
    |0 0 0 1       M M|     |      M    |     |M|  4
    |        1 M M M  | ... |           | ... |M|  5 sc
    |        0 1 M M  |     |           |     |M|  6
    |        0 0 1 M  |     |           |     |M|  7
    |      0 0 0 0 1 M|     |      M    |     |M|  8
    |      0       M M|     |      M    |     |M|  9
    -------------------     -------------
    */

    pivot = sc_to_sc_matrix[37];

    // sc-row-9 = sc-row-9 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[37] = 0;
#endif

    sc_to_sc_matrix[38] -= sc_to_sc_matrix[35] * pivot;

    sc_to_bb_matrix[2] -= sc_to_bb_matrix[1] * pivot;

    sc_g_matrix[8] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

            sc                   bb            g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5 6
    -------------------     -------------
    |1 M M M          |     |           |     |M|  1
    |0 1 M M          |     |           |     |M|  2
    |0 0 1 M          |     |           |     |M|  3
    |0 0 0 1       M M|     |      M    |     |M|  4
    |        1 M M M  | ... |           | ... |M|  5 sc
    |        0 1 M M  |     |           |     |M|  6
    |        0 0 1 M  |     |           |     |M|  7
    |      0 0 0 0 1 M|     |      M    |     |M|  8
    |      0       0 M|     |      M    |     |M|  9
    -------------------     -------------
    */

    pivot = sc_to_sc_matrix[38];

    // sc-row-9 = sc-row-9 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[38] = 1;
#endif

    sc_to_bb_matrix[2] /= pivot;

    sc_g_matrix[8] /= pivot;

    /*
    Resulting matrix:

            sc                   bb            g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5 6
    -------------------     -------------
    |1 M M M          |     |           |     |M|  1
    |0 1 M M          |     |           |     |M|  2
    |0 0 1 M          |     |           |     |M|  3
    |0 0 0 1       M M|     |      M    |     |M|  4
    |        1 M M M  | ... |           | ... |M|  5 sc
    |        0 1 M M  |     |           |     |M|  6
    |        0 0 1 M  |     |           |     |M|  7
    |      0 0 0 0 1 M|     |      M    |     |M|  8
    |      0       0 1|     |      M    |     |M|  9
    -------------------     -------------
    */
}

void gmx::IlvesPC::solve_2_leucine(real *const sc_to_sc_matrix,
                                   real *const sc_to_bb_matrix,
                                   __attribute__((unused))
                                   real *const sc_to_sep_matrix,
                                   real *const sc_g_matrix,
                                   __attribute__((unused))
                                   real *const sc_to_sc_fillins,
                                   __attribute__((unused))
                                   real *const sc_to_bb_fillins) {
    /*
     *
     * Row 1
     *
     */

    real pivot = sc_to_sc_matrix[0];

    // sc-row-1 = sc-row-1 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[0] = 1;
#endif

    sc_to_sc_matrix[1] /= pivot;
    sc_to_sc_matrix[2] /= pivot;
    sc_to_sc_matrix[3] /= pivot;

    sc_g_matrix[0] /= pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |x x x x                |     |           |     |x|  2
    |x x x x                |     |           |     |x|  3
    |x x x x       x x x    |     |           |     |x|  4
    |        x x x x        |     |           |     |x|  5
    |        x x x x        |     |           |     |x|  6
    |        x x x x        | ... |           | ... |x|  7 sc
    |      x x x x x x x    |     |           |     |x|  8
    |      x       x x x    |     |           |     |x|  9
    |      x       x x x x x|     |      x    |     |x| 10
    |                  x x x|     |      x    |     |x| 11
    |                  x x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    /*
     *
     * Row 2
     *
     */

    pivot = sc_to_sc_matrix[4];

    // sc-row-2 = sc-row-2 - sc-row-1 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[4] = 0;
#endif

    sc_to_sc_matrix[5] -= sc_to_sc_matrix[1] * pivot;
    sc_to_sc_matrix[6] -= sc_to_sc_matrix[2] * pivot;
    sc_to_sc_matrix[7] -= sc_to_sc_matrix[3] * pivot;

    sc_g_matrix[1] -= sc_g_matrix[0] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 M M M                |     |           |     |M|  2
    |x x x x                |     |           |     |x|  3
    |x x x x       x x x    |     |           |     |x|  4
    |        x x x x        |     |           |     |x|  5
    |        x x x x        |     |           |     |x|  6
    |        x x x x        | ... |           | ... |x|  7 sc
    |      x x x x x x x    |     |           |     |x|  8
    |      x       x x x    |     |           |     |x|  9
    |      x       x x x x x|     |      x    |     |x| 10
    |                  x x x|     |      x    |     |x| 11
    |                  x x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[5];

    // sc-row-2 = sc-row-2 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[5] = 1;
#endif

    sc_to_sc_matrix[6] /= pivot;
    sc_to_sc_matrix[7] /= pivot;

    sc_g_matrix[1] /= pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |x x x x                |     |           |     |x|  3
    |x x x x       x x x    |     |           |     |x|  4
    |        x x x x        |     |           |     |x|  5
    |        x x x x        |     |           |     |x|  6
    |        x x x x        | ... |           | ... |x|  7 sc
    |      x x x x x x x    |     |           |     |x|  8
    |      x       x x x    |     |           |     |x|  9
    |      x       x x x x x|     |      x    |     |x| 10
    |                  x x x|     |      x    |     |x| 11
    |                  x x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    /*
     *
     * Row 3
     *
     */

    pivot = sc_to_sc_matrix[8];

    // sc-row-3 = sc-row-3 - sc-row-1 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[8] = 0;
#endif

    sc_to_sc_matrix[9] -= sc_to_sc_matrix[1] * pivot;
    sc_to_sc_matrix[10] -= sc_to_sc_matrix[2] * pivot;
    sc_to_sc_matrix[11] -= sc_to_sc_matrix[3] * pivot;

    sc_g_matrix[2] -= sc_g_matrix[0] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 M M M                |     |           |     |M|  3
    |x x x x       x x x    |     |           |     |x|  4
    |        x x x x        |     |           |     |x|  5
    |        x x x x        |     |           |     |x|  6
    |        x x x x        | ... |           | ... |x|  7 sc
    |      x x x x x x x    |     |           |     |x|  8
    |      x       x x x    |     |           |     |x|  9
    |      x       x x x x x|     |      x    |     |x| 10
    |                  x x x|     |      x    |     |x| 11
    |                  x x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[9];

    // sc-row-3 = sc-row-3 - sc-row-2 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[9] = 0;
#endif

    sc_to_sc_matrix[10] -= sc_to_sc_matrix[6] * pivot;
    sc_to_sc_matrix[11] -= sc_to_sc_matrix[7] * pivot;

    sc_g_matrix[2] -= sc_g_matrix[1] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 M M                |     |           |     |M|  3
    |x x x x       x x x    |     |           |     |x|  4
    |        x x x x        |     |           |     |x|  5
    |        x x x x        |     |           |     |x|  6
    |        x x x x        | ... |           | ... |x|  7 sc
    |      x x x x x x x    |     |           |     |x|  8
    |      x       x x x    |     |           |     |x|  9
    |      x       x x x x x|     |      x    |     |x| 10
    |                  x x x|     |      x    |     |x| 11
    |                  x x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[10];

    // sc-row-3 = sc-row-3 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[10] = 1;
#endif

    sc_to_sc_matrix[11] /= pivot;

    sc_g_matrix[2] /= pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |x x x x       x x x    |     |           |     |x|  4
    |        x x x x        |     |           |     |x|  5
    |        x x x x        |     |           |     |x|  6
    |        x x x x        | ... |           | ... |x|  7 sc
    |      x x x x x x x    |     |           |     |x|  8
    |      x       x x x    |     |           |     |x|  9
    |      x       x x x x x|     |      x    |     |x| 10
    |                  x x x|     |      x    |     |x| 11
    |                  x x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    /*
     *
     * Row 4
     *
     */

    pivot = sc_to_sc_matrix[12];

    // sc-row-4 = sc-row-4 - sc-row-1 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[12] = 0;
#endif

    sc_to_sc_matrix[13] -= sc_to_sc_matrix[1] * pivot;
    sc_to_sc_matrix[14] -= sc_to_sc_matrix[2] * pivot;
    sc_to_sc_matrix[15] -= sc_to_sc_matrix[3] * pivot;

    sc_g_matrix[3] -= sc_g_matrix[0] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 M M M       x x x    |     |           |     |M|  4
    |        x x x x        |     |           |     |x|  5
    |        x x x x        |     |           |     |x|  6
    |        x x x x        | ... |           | ... |x|  7 sc
    |      x x x x x x x    |     |           |     |x|  8
    |      x       x x x    |     |           |     |x|  9
    |      x       x x x x x|     |      x    |     |x| 10
    |                  x x x|     |      x    |     |x| 11
    |                  x x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[13];

    // sc-row-4 = sc-row-4 - sc-row-2 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[13] = 0;
#endif

    sc_to_sc_matrix[14] -= sc_to_sc_matrix[6] * pivot;
    sc_to_sc_matrix[15] -= sc_to_sc_matrix[7] * pivot;

    sc_g_matrix[3] -= sc_g_matrix[1] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 M M       x x x    |     |           |     |M|  4
    |        x x x x        |     |           |     |x|  5
    |        x x x x        |     |           |     |x|  6
    |        x x x x        | ... |           | ... |x|  7 sc
    |      x x x x x x x    |     |           |     |x|  8
    |      x       x x x    |     |           |     |x|  9
    |      x       x x x x x|     |      x    |     |x| 10
    |                  x x x|     |      x    |     |x| 11
    |                  x x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[14];

    // sc-row-4 = sc-row-4 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[14] = 0;
#endif

    sc_to_sc_matrix[15] -= sc_to_sc_matrix[11] * pivot;

    sc_g_matrix[3] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 0 M       x x x    |     |           |     |M|  4
    |        x x x x        |     |           |     |x|  5
    |        x x x x        |     |           |     |x|  6
    |        x x x x        | ... |           | ... |x|  7 sc
    |      x x x x x x x    |     |           |     |x|  8
    |      x       x x x    |     |           |     |x|  9
    |      x       x x x x x|     |      x    |     |x| 10
    |                  x x x|     |      x    |     |x| 11
    |                  x x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[15];

    // sc-row-4 = sc-row-4 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[15] = 1;
#endif

    sc_to_sc_matrix[16] /= pivot;
    sc_to_sc_matrix[17] /= pivot;
    sc_to_sc_matrix[18] /= pivot;

    sc_g_matrix[3] /= pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 0 1       M M M    |     |           |     |M|  4
    |        x x x x        |     |           |     |x|  5
    |        x x x x        |     |           |     |x|  6
    |        x x x x        | ... |           | ... |x|  7 sc
    |      x x x x x x x    |     |           |     |x|  8
    |      x       x x x    |     |           |     |x|  9
    |      x       x x x x x|     |      x    |     |x| 10
    |                  x x x|     |      x    |     |x| 11
    |                  x x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    /*
     *
     * Row 5
     *
     */

    pivot = sc_to_sc_matrix[19];

    // sc-row-5 = sc-row-5 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[19] = 1;
#endif

    sc_to_sc_matrix[20] /= pivot;
    sc_to_sc_matrix[21] /= pivot;
    sc_to_sc_matrix[22] /= pivot;

    sc_g_matrix[4] /= pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 0 1       M M M    |     |           |     |M|  4
    |        1 M M M        |     |           |     |M|  5
    |        x x x x        |     |           |     |x|  6
    |        x x x x        | ... |           | ... |x|  7 sc
    |      x x x x x x x    |     |           |     |x|  8
    |      x       x x x    |     |           |     |x|  9
    |      x       x x x x x|     |      x    |     |x| 10
    |                  x x x|     |      x    |     |x| 11
    |                  x x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    /*
     *
     * Row 6
     *
     */

    pivot = sc_to_sc_matrix[23];

    // sc-row-6 = sc-row-6 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[23] = 0;
#endif

    sc_to_sc_matrix[24] -= sc_to_sc_matrix[20] * pivot;
    sc_to_sc_matrix[25] -= sc_to_sc_matrix[21] * pivot;
    sc_to_sc_matrix[26] -= sc_to_sc_matrix[22] * pivot;

    sc_g_matrix[5] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 0 1       M M M    |     |           |     |M|  4
    |        1 M M M        |     |           |     |M|  5
    |        0 M M M        |     |           |     |M|  6
    |        x x x x        | ... |           | ... |x|  7 sc
    |      x x x x x x x    |     |           |     |x|  8
    |      x       x x x    |     |           |     |x|  9
    |      x       x x x x x|     |      x    |     |x| 10
    |                  x x x|     |      x    |     |x| 11
    |                  x x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[24];

    // sc-row-6 = sc-row-6 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[24] = 1;
#endif

    sc_to_sc_matrix[25] /= pivot;
    sc_to_sc_matrix[26] /= pivot;

    sc_g_matrix[5] /= pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 0 1       M M M    |     |           |     |M|  4
    |        1 M M M        |     |           |     |M|  5
    |        0 1 M M        |     |           |     |M|  6
    |        x x x x        | ... |           | ... |x|  7 sc
    |      x x x x x x x    |     |           |     |x|  8
    |      x       x x x    |     |           |     |x|  9
    |      x       x x x x x|     |      x    |     |x| 10
    |                  x x x|     |      x    |     |x| 11
    |                  x x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    /*
     *
     * Row 7
     *
     */

    pivot = sc_to_sc_matrix[27];

    // sc-row-7 = sc-row-7 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[27] = 0;
#endif

    sc_to_sc_matrix[28] -= sc_to_sc_matrix[20] * pivot;
    sc_to_sc_matrix[29] -= sc_to_sc_matrix[21] * pivot;
    sc_to_sc_matrix[30] -= sc_to_sc_matrix[22] * pivot;

    sc_g_matrix[6] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 0 1       M M M    |     |           |     |M|  4
    |        1 M M M        |     |           |     |M|  5
    |        0 1 M M        |     |           |     |M|  6
    |        0 M M M        | ... |           | ... |M|  7 sc
    |      x x x x x x x    |     |           |     |x|  8
    |      x       x x x    |     |           |     |x|  9
    |      x       x x x x x|     |      x    |     |x| 10
    |                  x x x|     |      x    |     |x| 11
    |                  x x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[28];

    // sc-row-7 = sc-row-7 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[28] = 0;
#endif

    sc_to_sc_matrix[29] -= sc_to_sc_matrix[25] * pivot;
    sc_to_sc_matrix[30] -= sc_to_sc_matrix[26] * pivot;

    sc_g_matrix[6] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 0 1       M M M    |     |           |     |M|  4
    |        1 M M M        |     |           |     |M|  5
    |        0 1 M M        |     |           |     |M|  6
    |        0 0 M M        | ... |           | ... |M|  7 sc
    |      x x x x x x x    |     |           |     |x|  8
    |      x       x x x    |     |           |     |x|  9
    |      x       x x x x x|     |      x    |     |x| 10
    |                  x x x|     |      x    |     |x| 11
    |                  x x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[29];

    // sc-row-7 = sc-row-7 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[29] = 1;
#endif

    sc_to_sc_matrix[30] /= pivot;

    sc_g_matrix[6] /= pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 0 1       M M M    |     |           |     |M|  4
    |        1 M M M        |     |           |     |M|  5
    |        0 1 M M        |     |           |     |M|  6
    |        0 0 1 M        | ... |           | ... |M|  7 sc
    |      x x x x x x x    |     |           |     |x|  8
    |      x       x x x    |     |           |     |x|  9
    |      x       x x x x x|     |      x    |     |x| 10
    |                  x x x|     |      x    |     |x| 11
    |                  x x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    /*
     *
     * Row 8
     *
     */

    pivot = sc_to_sc_matrix[31];

    // sc-row-8 = sc-row-8 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[31] = 0;
#endif

    sc_to_sc_matrix[35] -= sc_to_sc_matrix[16] * pivot;
    sc_to_sc_matrix[36] -= sc_to_sc_matrix[17] * pivot;
    sc_to_sc_matrix[37] -= sc_to_sc_matrix[18] * pivot;

    sc_g_matrix[7] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 0 1       M M M    |     |           |     |M|  4
    |        1 M M M        |     |           |     |M|  5
    |        0 1 M M        |     |           |     |M|  6
    |        0 0 1 M        | ... |           | ... |M|  7 sc
    |      0 x x x M M M    |     |           |     |M|  8
    |      x       x x x    |     |           |     |x|  9
    |      x       x x x x x|     |      x    |     |x| 10
    |                  x x x|     |      x    |     |x| 11
    |                  x x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[32];

    // sc-row-8 = sc-row-8 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[32] = 0;
#endif

    sc_to_sc_matrix[33] -= sc_to_sc_matrix[20] * pivot;
    sc_to_sc_matrix[34] -= sc_to_sc_matrix[21] * pivot;
    sc_to_sc_matrix[35] -= sc_to_sc_matrix[22] * pivot;

    sc_g_matrix[7] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 0 1       M M M    |     |           |     |M|  4
    |        1 M M M        |     |           |     |M|  5
    |        0 1 M M        |     |           |     |M|  6
    |        0 0 1 M        | ... |           | ... |M|  7 sc
    |      0 0 M M M M M    |     |           |     |M|  8
    |      x       x x x    |     |           |     |x|  9
    |      x       x x x x x|     |      x    |     |x| 10
    |                  x x x|     |      x    |     |x| 11
    |                  x x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[33];

    // sc-row-8 = sc-row-8 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[33] = 0;
#endif

    sc_to_sc_matrix[34] -= sc_to_sc_matrix[25] * pivot;
    sc_to_sc_matrix[35] -= sc_to_sc_matrix[26] * pivot;

    sc_g_matrix[7] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 0 1       M M M    |     |           |     |M|  4
    |        1 M M M        |     |           |     |M|  5
    |        0 1 M M        |     |           |     |M|  6
    |        0 0 1 M        | ... |           | ... |M|  7 sc
    |      0 0 0 M M M M    |     |           |     |M|  8
    |      x       x x x    |     |           |     |x|  9
    |      x       x x x x x|     |      x    |     |x| 10
    |                  x x x|     |      x    |     |x| 11
    |                  x x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[34];

    // sc-row-8 = sc-row-8 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[34] = 0;
#endif

    sc_to_sc_matrix[35] -= sc_to_sc_matrix[30] * pivot;

    sc_g_matrix[7] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 0 1       M M M    |     |           |     |M|  4
    |        1 M M M        |     |           |     |M|  5
    |        0 1 M M        |     |           |     |M|  6
    |        0 0 1 M        | ... |           | ... |M|  7 sc
    |      0 0 0 0 M M M    |     |           |     |M|  8
    |      x       x x x    |     |           |     |x|  9
    |      x       x x x x x|     |      x    |     |x| 10
    |                  x x x|     |      x    |     |x| 11
    |                  x x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[35];

    // sc-row-8 = sc-row-8 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[35] = 1;
#endif

    sc_to_sc_matrix[36] /= pivot;
    sc_to_sc_matrix[37] /= pivot;

    sc_g_matrix[7] /= pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 0 1       M M M    |     |           |     |M|  4
    |        1 M M M        |     |           |     |M|  5
    |        0 1 M M        |     |           |     |M|  6
    |        0 0 1 M        | ... |           | ... |M|  7 sc
    |      0 0 0 0 1 M M    |     |           |     |M|  8
    |      x       x x x    |     |           |     |x|  9
    |      x       x x x x x|     |      x    |     |x| 10
    |                  x x x|     |      x    |     |x| 11
    |                  x x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    /*
     *
     * Row 9
     *
     */

    pivot = sc_to_sc_matrix[38];

    // sc-row-9 = sc-row-9 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[38] = 0;
#endif

    sc_to_sc_matrix[39] -= sc_to_sc_matrix[16] * pivot;
    sc_to_sc_matrix[40] -= sc_to_sc_matrix[17] * pivot;
    sc_to_sc_matrix[41] -= sc_to_sc_matrix[18] * pivot;

    sc_g_matrix[8] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 0 1       M M M    |     |           |     |M|  4
    |        1 M M M        |     |           |     |M|  5
    |        0 1 M M        |     |           |     |M|  6
    |        0 0 1 M        | ... |           | ... |M|  7 sc
    |      0 0 0 0 1 M M    |     |           |     |M|  8
    |      0       M M M    |     |           |     |M|  9
    |      x       x x x x x|     |      x    |     |x| 10
    |                  x x x|     |      x    |     |x| 11
    |                  x x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[39];

    // sc-row-9 = sc-row-9 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[39] = 0;
#endif

    sc_to_sc_matrix[40] -= sc_to_sc_matrix[36] * pivot;
    sc_to_sc_matrix[41] -= sc_to_sc_matrix[37] * pivot;

    sc_g_matrix[8] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 0 1       M M M    |     |           |     |M|  4
    |        1 M M M        |     |           |     |M|  5
    |        0 1 M M        |     |           |     |M|  6
    |        0 0 1 M        | ... |           | ... |M|  7 sc
    |      0 0 0 0 1 M M    |     |           |     |M|  8
    |      0       0 M M    |     |           |     |M|  9
    |      x       x x x x x|     |      x    |     |x| 10
    |                  x x x|     |      x    |     |x| 11
    |                  x x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[40];

    // sc-row-9 = sc-row-9 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[40] = 1;
#endif

    sc_to_sc_matrix[41] /= pivot;

    sc_g_matrix[8] /= pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 0 1       M M M    |     |           |     |M|  4
    |        1 M M M        |     |           |     |M|  5
    |        0 1 M M        |     |           |     |M|  6
    |        0 0 1 M        | ... |           | ... |M|  7 sc
    |      0 0 0 0 1 M M    |     |           |     |M|  8
    |      0       0 1 M    |     |           |     |M|  9
    |      x       x x x x x|     |      x    |     |x| 10
    |                  x x x|     |      x    |     |x| 11
    |                  x x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    /*
     *
     * Row 10
     *
     */

    pivot = sc_to_sc_matrix[42];

    // sc-row-10 = sc-row-10 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[42] = 0;
#endif

    sc_to_sc_matrix[43] -= sc_to_sc_matrix[16] * pivot;
    sc_to_sc_matrix[44] -= sc_to_sc_matrix[17] * pivot;
    sc_to_sc_matrix[45] -= sc_to_sc_matrix[18] * pivot;

    sc_g_matrix[9] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 0 1       M M M    |     |           |     |M|  4
    |        1 M M M        |     |           |     |M|  5
    |        0 1 M M        |     |           |     |M|  6
    |        0 0 1 M        | ... |           | ... |M|  7 sc
    |      0 0 0 0 1 M M    |     |           |     |M|  8
    |      0       0 1 M    |     |           |     |M|  9
    |      0       M M M x x|     |      x    |     |M| 10
    |                  x x x|     |      x    |     |x| 11
    |                  x x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[43];

    // sc-row-10 = sc-row-10 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[43] = 0;
#endif

    sc_to_sc_matrix[44] -= sc_to_sc_matrix[36] * pivot;
    sc_to_sc_matrix[45] -= sc_to_sc_matrix[37] * pivot;

    sc_g_matrix[9] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 0 1       M M M    |     |           |     |M|  4
    |        1 M M M        |     |           |     |M|  5
    |        0 1 M M        |     |           |     |M|  6
    |        0 0 1 M        | ... |           | ... |M|  7 sc
    |      0 0 0 0 1 M M    |     |           |     |M|  8
    |      0       0 1 M    |     |           |     |M|  9
    |      0       0 M M x x|     |      x    |     |M| 10
    |                  x x x|     |      x    |     |x| 11
    |                  x x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[44];

    // sc-row-10 = sc-row-10 - sc-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[44] = 0;
#endif

    sc_to_sc_matrix[45] -= sc_to_sc_matrix[41] * pivot;

    sc_g_matrix[9] -= sc_g_matrix[8] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 0 1       M M M    |     |           |     |M|  4
    |        1 M M M        |     |           |     |M|  5
    |        0 1 M M        |     |           |     |M|  6
    |        0 0 1 M        | ... |           | ... |M|  7 sc
    |      0 0 0 0 1 M M    |     |           |     |M|  8
    |      0       0 1 M    |     |           |     |M|  9
    |      0       0 0 M x x|     |      x    |     |M| 10
    |                  x x x|     |      x    |     |x| 11
    |                  x x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[45];

    // sc-row-10 = sc-row-10 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[45] = 1;
#endif

    sc_to_sc_matrix[46] /= pivot;
    sc_to_sc_matrix[47] /= pivot;

    sc_to_bb_matrix[0] /= pivot;

    sc_g_matrix[9] /= pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 0 1       M M M    |     |           |     |M|  4
    |        1 M M M        |     |           |     |M|  5
    |        0 1 M M        |     |           |     |M|  6
    |        0 0 1 M        | ... |           | ... |M|  7 sc
    |      0 0 0 0 1 M M    |     |           |     |M|  8
    |      0       0 1 M    |     |           |     |M|  9
    |      0       0 0 1 M M|     |      M    |     |M| 10
    |                  x x x|     |      x    |     |x| 11
    |                  x x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    /*
     *
     * Row 11
     *
     */

    pivot = sc_to_sc_matrix[48];

    // sc-row-11 = sc-row-11 - sc-row-10 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[48] = 0;
#endif

    sc_to_sc_matrix[49] -= sc_to_sc_matrix[46] * pivot;
    sc_to_sc_matrix[50] -= sc_to_sc_matrix[47] * pivot;

    sc_to_bb_matrix[1] -= sc_to_bb_matrix[0] * pivot;

    sc_g_matrix[10] -= sc_g_matrix[9] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 0 1       M M M    |     |           |     |M|  4
    |        1 M M M        |     |           |     |M|  5
    |        0 1 M M        |     |           |     |M|  6
    |        0 0 1 M        | ... |           | ... |M|  7 sc
    |      0 0 0 0 1 M M    |     |           |     |M|  8
    |      0       0 1 M    |     |           |     |M|  9
    |      0       0 0 1 M M|     |      M    |     |M| 10
    |                  0 M M|     |      M    |     |M| 11
    |                  x x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[49];

    // sc-row-11 = sc-row-11 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[49] = 1;
#endif

    sc_to_sc_matrix[50] /= pivot;

    sc_to_bb_matrix[1] /= pivot;

    sc_g_matrix[10] /= pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 0 1       M M M    |     |           |     |M|  4
    |        1 M M M        |     |           |     |M|  5
    |        0 1 M M        |     |           |     |M|  6
    |        0 0 1 M        | ... |           | ... |M|  7 sc
    |      0 0 0 0 1 M M    |     |           |     |M|  8
    |      0       0 1 M    |     |           |     |M|  9
    |      0       0 0 1 M M|     |      M    |     |M| 10
    |                  0 1 M|     |      M    |     |M| 11
    |                  x x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    /*
     *
     * Row 12
     *
     */

    pivot = sc_to_sc_matrix[51];

    // sc-row-12 = sc-row-12 - sc-row-10 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[51] = 0;
#endif

    sc_to_sc_matrix[52] -= sc_to_sc_matrix[46] * pivot;
    sc_to_sc_matrix[53] -= sc_to_sc_matrix[47] * pivot;

    sc_to_bb_matrix[2] -= sc_to_bb_matrix[0] * pivot;

    sc_g_matrix[11] -= sc_g_matrix[9] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 0 1       M M M    |     |           |     |M|  4
    |        1 M M M        |     |           |     |M|  5
    |        0 1 M M        |     |           |     |M|  6
    |        0 0 1 M        | ... |           | ... |M|  7 sc
    |      0 0 0 0 1 M M    |     |           |     |M|  8
    |      0       0 1 M    |     |           |     |M|  9
    |      0       0 0 1 M M|     |      M    |     |M| 10
    |                  0 1 M|     |      M    |     |M| 11
    |                  0 M M|     |      M    |     |M| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[52];

    // sc-row-12 = sc-row-12 - sc-row-11 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[52] = 0;
#endif

    sc_to_sc_matrix[53] -= sc_to_sc_matrix[50] * pivot;

    sc_to_bb_matrix[2] -= sc_to_bb_matrix[1] * pivot;

    sc_g_matrix[11] -= sc_g_matrix[10] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 0 1       M M M    |     |           |     |M|  4
    |        1 M M M        |     |           |     |M|  5
    |        0 1 M M        |     |           |     |M|  6
    |        0 0 1 M        | ... |           | ... |M|  7 sc
    |      0 0 0 0 1 M M    |     |           |     |M|  8
    |      0       0 1 M    |     |           |     |M|  9
    |      0       0 0 1 M M|     |      M    |     |M| 10
    |                  0 1 M|     |      M    |     |M| 11
    |                  0 0 M|     |      M    |     |M| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[53];

    // sc-row-12 = sc-row-12 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[53] = 1;
#endif

    sc_to_bb_matrix[2] /= pivot;

    sc_g_matrix[11] /= pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 0 1       M M M    |     |           |     |M|  4
    |        1 M M M        |     |           |     |M|  5
    |        0 1 M M        |     |           |     |M|  6
    |        0 0 1 M        | ... |           | ... |M|  7 sc
    |      0 0 0 0 1 M M    |     |           |     |M|  8
    |      0       0 1 M    |     |           |     |M|  9
    |      0       0 0 1 M M|     |      M    |     |M| 10
    |                  0 1 M|     |      M    |     |M| 11
    |                  0 0 1|     |      M    |     |M| 12
    -------------------------     -------------
    */
}

void gmx::IlvesPC::solve_2_isoleucine(real *const sc_to_sc_matrix,
                                      real *const sc_to_bb_matrix,
                                      __attribute__((unused))
                                      real *const sc_to_sep_matrix,
                                      real *const sc_g_matrix,
                                      __attribute__((unused))
                                      real *const sc_to_sc_fillins,
                                      __attribute__((unused))
                                      real *const sc_to_bb_fillins) {
    /*
     *
     * Row 1
     *
     */

    real pivot = sc_to_sc_matrix[0];

    // sc-row-1 = sc-row-1 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[0] = 1;
#endif

    sc_to_sc_matrix[1] /= pivot;
    sc_to_sc_matrix[2] /= pivot;
    sc_to_sc_matrix[3] /= pivot;

    sc_g_matrix[0] /= pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |x x x x                |     |           |     |x|  2
    |x x x x                |     |           |     |x|  3
    |x x x x x x x          |     |           |     |x|  4
    |      x x x x          |     |           |     |x|  5
    |      x x x x          |     |           |     |x|  6
    |      x x x x       x x| ... |      x    | ... |x|  7 sc
    |              x x x x  |     |           |     |x|  8
    |              x x x x  |     |           |     |x|  9
    |              x x x x  |     |           |     |x| 10
    |            x x x x x x|     |      x    |     |x| 11
    |            x       x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    /*
     *
     * Row 2
     *
     */

    pivot = sc_to_sc_matrix[4];

    // sc-row-2 = sc-row-2 - sc-row-1 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[4] = 0;
#endif

    sc_to_sc_matrix[5] -= sc_to_sc_matrix[1] * pivot;
    sc_to_sc_matrix[6] -= sc_to_sc_matrix[2] * pivot;
    sc_to_sc_matrix[7] -= sc_to_sc_matrix[3] * pivot;

    sc_g_matrix[1] -= sc_g_matrix[0] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 M M M                |     |           |     |M|  2
    |x x x x                |     |           |     |x|  3
    |x x x x x x x          |     |           |     |x|  4
    |      x x x x          |     |           |     |x|  5
    |      x x x x          |     |           |     |x|  6
    |      x x x x       x x| ... |      x    | ... |x|  7 sc
    |              x x x x  |     |           |     |x|  8
    |              x x x x  |     |           |     |x|  9
    |              x x x x  |     |           |     |x| 10
    |            x x x x x x|     |      x    |     |x| 11
    |            x       x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[5];

    // sc-row-2 = sc-row-2 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[5] = 1;
#endif

    sc_to_sc_matrix[6] /= pivot;
    sc_to_sc_matrix[7] /= pivot;

    sc_g_matrix[1] /= pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |x x x x                |     |           |     |x|  3
    |x x x x x x x          |     |           |     |x|  4
    |      x x x x          |     |           |     |x|  5
    |      x x x x          |     |           |     |x|  6
    |      x x x x       x x| ... |      x    | ... |x|  7 sc
    |              x x x x  |     |           |     |x|  8
    |              x x x x  |     |           |     |x|  9
    |              x x x x  |     |           |     |x| 10
    |            x x x x x x|     |      x    |     |x| 11
    |            x       x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    /*
     *
     * Row 3
     *
     */

    pivot = sc_to_sc_matrix[8];

    // sc-row-3 = sc-row-3 - sc-row-1 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[8] = 0;
#endif

    sc_to_sc_matrix[9] -= sc_to_sc_matrix[1] * pivot;
    sc_to_sc_matrix[10] -= sc_to_sc_matrix[2] * pivot;
    sc_to_sc_matrix[11] -= sc_to_sc_matrix[3] * pivot;

    sc_g_matrix[2] -= sc_g_matrix[0] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 M M M                |     |           |     |M|  3
    |x x x x x x x          |     |           |     |x|  4
    |      x x x x          |     |           |     |x|  5
    |      x x x x          |     |           |     |x|  6
    |      x x x x       x x| ... |      x    | ... |x|  7 sc
    |              x x x x  |     |           |     |x|  8
    |              x x x x  |     |           |     |x|  9
    |              x x x x  |     |           |     |x| 10
    |            x x x x x x|     |      x    |     |x| 11
    |            x       x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[9];

    // sc-row-3 = sc-row-3 - sc-row-2 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[9] = 0;
#endif

    sc_to_sc_matrix[10] -= sc_to_sc_matrix[6] * pivot;
    sc_to_sc_matrix[11] -= sc_to_sc_matrix[7] * pivot;

    sc_g_matrix[2] -= sc_g_matrix[1] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 M M                |     |           |     |M|  3
    |x x x x x x x          |     |           |     |x|  4
    |      x x x x          |     |           |     |x|  5
    |      x x x x          |     |           |     |x|  6
    |      x x x x       x x| ... |      x    | ... |x|  7 sc
    |              x x x x  |     |           |     |x|  8
    |              x x x x  |     |           |     |x|  9
    |              x x x x  |     |           |     |x| 10
    |            x x x x x x|     |      x    |     |x| 11
    |            x       x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[10];

    // sc-row-3 = sc-row-3 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[10] = 1;
#endif

    sc_to_sc_matrix[11] /= pivot;

    sc_g_matrix[2] /= pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |x x x x x x x          |     |           |     |x|  4
    |      x x x x          |     |           |     |x|  5
    |      x x x x          |     |           |     |x|  6
    |      x x x x       x x| ... |      x    | ... |x|  7 sc
    |              x x x x  |     |           |     |x|  8
    |              x x x x  |     |           |     |x|  9
    |              x x x x  |     |           |     |x| 10
    |            x x x x x x|     |      x    |     |x| 11
    |            x       x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    /*
     *
     * Row 4
     *
     */

    pivot = sc_to_sc_matrix[12];

    // sc-row-4 = sc-row-4 - sc-row-1 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[12] = 0;
#endif

    sc_to_sc_matrix[13] -= sc_to_sc_matrix[1] * pivot;
    sc_to_sc_matrix[14] -= sc_to_sc_matrix[2] * pivot;
    sc_to_sc_matrix[15] -= sc_to_sc_matrix[3] * pivot;

    sc_g_matrix[3] -= sc_g_matrix[0] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 M M M x x x          |     |           |     |M|  4
    |      x x x x          |     |           |     |x|  5
    |      x x x x          |     |           |     |x|  6
    |      x x x x       x x| ... |      x    | ... |x|  7 sc
    |              x x x x  |     |           |     |x|  8
    |              x x x x  |     |           |     |x|  9
    |              x x x x  |     |           |     |x| 10
    |            x x x x x x|     |      x    |     |x| 11
    |            x       x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[13];

    // sc-row-4 = sc-row-4 - sc-row-2 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[13] = 0;
#endif

    sc_to_sc_matrix[14] -= sc_to_sc_matrix[6] * pivot;
    sc_to_sc_matrix[15] -= sc_to_sc_matrix[7] * pivot;

    sc_g_matrix[3] -= sc_g_matrix[1] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 M M x x x          |     |           |     |M|  4
    |      x x x x          |     |           |     |x|  5
    |      x x x x          |     |           |     |x|  6
    |      x x x x       x x| ... |      x    | ... |x|  7 sc
    |              x x x x  |     |           |     |x|  8
    |              x x x x  |     |           |     |x|  9
    |              x x x x  |     |           |     |x| 10
    |            x x x x x x|     |      x    |     |x| 11
    |            x       x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[14];

    // sc-row-4 = sc-row-4 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[14] = 0;
#endif

    sc_to_sc_matrix[15] -= sc_to_sc_matrix[11] * pivot;

    sc_g_matrix[3] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 0 M x x x          |     |           |     |M|  4
    |      x x x x          |     |           |     |x|  5
    |      x x x x          |     |           |     |x|  6
    |      x x x x       x x| ... |      x    | ... |x|  7 sc
    |              x x x x  |     |           |     |x|  8
    |              x x x x  |     |           |     |x|  9
    |              x x x x  |     |           |     |x| 10
    |            x x x x x x|     |      x    |     |x| 11
    |            x       x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[15];

    // sc-row-4 = sc-row-4 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[15] = 1;
#endif

    sc_to_sc_matrix[16] /= pivot;
    sc_to_sc_matrix[17] /= pivot;
    sc_to_sc_matrix[18] /= pivot;

    sc_g_matrix[3] /= pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 0 1 M M M          |     |           |     |M|  4
    |      x x x x          |     |           |     |x|  5
    |      x x x x          |     |           |     |x|  6
    |      x x x x       x x| ... |      x    | ... |x|  7 sc
    |              x x x x  |     |           |     |x|  8
    |              x x x x  |     |           |     |x|  9
    |              x x x x  |     |           |     |x| 10
    |            x x x x x x|     |      x    |     |x| 11
    |            x       x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    /*
     *
     * Row 5
     *
     */

    pivot = sc_to_sc_matrix[19];

    // sc-row-5 = sc-row-5 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[19] = 0;
#endif

    sc_to_sc_matrix[20] -= sc_to_sc_matrix[16] * pivot;
    sc_to_sc_matrix[21] -= sc_to_sc_matrix[17] * pivot;
    sc_to_sc_matrix[22] -= sc_to_sc_matrix[18] * pivot;

    sc_g_matrix[4] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 0 1 M M M          |     |           |     |M|  4
    |      0 M M M          |     |           |     |M|  5
    |      x x x x          |     |           |     |x|  6
    |      x x x x       x x| ... |      x    | ... |x|  7 sc
    |              x x x x  |     |           |     |x|  8
    |              x x x x  |     |           |     |x|  9
    |              x x x x  |     |           |     |x| 10
    |            x x x x x x|     |      x    |     |x| 11
    |            x       x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[20];

    // sc-row-5 = sc-row-5 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[20] = 1;
#endif

    sc_to_sc_matrix[21] /= pivot;
    sc_to_sc_matrix[22] /= pivot;

    sc_g_matrix[4] /= pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 0 1 M M M          |     |           |     |M|  4
    |      0 1 M M          |     |           |     |M|  5
    |      x x x x          |     |           |     |x|  6
    |      x x x x       x x| ... |      x    | ... |x|  7 sc
    |              x x x x  |     |           |     |x|  8
    |              x x x x  |     |           |     |x|  9
    |              x x x x  |     |           |     |x| 10
    |            x x x x x x|     |      x    |     |x| 11
    |            x       x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    /*
     *
     * Row 6
     *
     */

    pivot = sc_to_sc_matrix[23];

    // sc-row-6 = sc-row-6 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[23] = 0;
#endif

    sc_to_sc_matrix[24] -= sc_to_sc_matrix[16] * pivot;
    sc_to_sc_matrix[25] -= sc_to_sc_matrix[17] * pivot;
    sc_to_sc_matrix[26] -= sc_to_sc_matrix[18] * pivot;

    sc_g_matrix[5] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 0 1 M M M          |     |           |     |M|  4
    |      0 1 M M          |     |           |     |M|  5
    |      0 M M M          |     |           |     |M|  6
    |      x x x x       x x| ... |      x    | ... |x|  7 sc
    |              x x x x  |     |           |     |x|  8
    |              x x x x  |     |           |     |x|  9
    |              x x x x  |     |           |     |x| 10
    |            x x x x x x|     |      x    |     |x| 11
    |            x       x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[24];

    // sc-row-6 = sc-row-6 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[24] = 0;
#endif

    sc_to_sc_matrix[25] -= sc_to_sc_matrix[21] * pivot;
    sc_to_sc_matrix[26] -= sc_to_sc_matrix[22] * pivot;

    sc_g_matrix[5] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 0 1 M M M          |     |           |     |M|  4
    |      0 1 M M          |     |           |     |M|  5
    |      0 0 M M          |     |           |     |M|  6
    |      x x x x       x x| ... |      x    | ... |x|  7 sc
    |              x x x x  |     |           |     |x|  8
    |              x x x x  |     |           |     |x|  9
    |              x x x x  |     |           |     |x| 10
    |            x x x x x x|     |      x    |     |x| 11
    |            x       x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[25];

    // sc-row-6 = sc-row-6 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[25] = 1;
#endif

    sc_to_sc_matrix[26] /= pivot;

    sc_g_matrix[5] /= pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 0 1 M M M          |     |           |     |M|  4
    |      0 1 M M          |     |           |     |M|  5
    |      0 0 1 M          |     |           |     |M|  6
    |      x x x x       x x| ... |      x    | ... |x|  7 sc
    |              x x x x  |     |           |     |x|  8
    |              x x x x  |     |           |     |x|  9
    |              x x x x  |     |           |     |x| 10
    |            x x x x x x|     |      x    |     |x| 11
    |            x       x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    /*
     *
     * Row 7
     *
     */

    pivot = sc_to_sc_matrix[27];

    // sc-row-7 = sc-row-7 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[27] = 0;
#endif

    sc_to_sc_matrix[28] -= sc_to_sc_matrix[16] * pivot;
    sc_to_sc_matrix[29] -= sc_to_sc_matrix[17] * pivot;
    sc_to_sc_matrix[30] -= sc_to_sc_matrix[18] * pivot;

    sc_g_matrix[6] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 0 1 M M M          |     |           |     |M|  4
    |      0 1 M M          |     |           |     |M|  5
    |      0 0 1 M          |     |           |     |M|  6
    |      0 M M M       x x| ... |      x    | ... |M|  7 sc
    |              x x x x  |     |           |     |x|  8
    |              x x x x  |     |           |     |x|  9
    |              x x x x  |     |           |     |x| 10
    |            x x x x x x|     |      x    |     |x| 11
    |            x       x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[28];

    // sc-row-7 = sc-row-7 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[28] = 0;
#endif

    sc_to_sc_matrix[29] -= sc_to_sc_matrix[21] * pivot;
    sc_to_sc_matrix[30] -= sc_to_sc_matrix[22] * pivot;

    sc_g_matrix[6] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 0 1 M M M          |     |           |     |M|  4
    |      0 1 M M          |     |           |     |M|  5
    |      0 0 1 M          |     |           |     |M|  6
    |      0 0 M M       x x| ... |      x    | ... |M|  7 sc
    |              x x x x  |     |           |     |x|  8
    |              x x x x  |     |           |     |x|  9
    |              x x x x  |     |           |     |x| 10
    |            x x x x x x|     |      x    |     |x| 11
    |            x       x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[29];

    // sc-row-7 = sc-row-7 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[29] = 0;
#endif

    sc_to_sc_matrix[30] -= sc_to_sc_matrix[26] * pivot;

    sc_g_matrix[6] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 0 1 M M M          |     |           |     |M|  4
    |      0 1 M M          |     |           |     |M|  5
    |      0 0 1 M          |     |           |     |M|  6
    |      0 0 0 M       x x| ... |      x    | ... |M|  7 sc
    |              x x x x  |     |           |     |x|  8
    |              x x x x  |     |           |     |x|  9
    |              x x x x  |     |           |     |x| 10
    |            x x x x x x|     |      x    |     |x| 11
    |            x       x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[30];

    // sc-row-7 = sc-row-7 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[30] = 1;
#endif

    sc_to_sc_matrix[31] /= pivot;
    sc_to_sc_matrix[32] /= pivot;

    sc_to_bb_matrix[0] /= pivot;

    sc_g_matrix[6] /= pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 0 1 M M M          |     |           |     |M|  4
    |      0 1 M M          |     |           |     |M|  5
    |      0 0 1 M          |     |           |     |M|  6
    |      0 0 0 1       M M| ... |      M    | ... |M|  7 sc
    |              x x x x  |     |           |     |x|  8
    |              x x x x  |     |           |     |x|  9
    |              x x x x  |     |           |     |x| 10
    |            x x x x x x|     |      x    |     |x| 11
    |            x       x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    /*
     *
     * Row 8
     *
     */

    pivot = sc_to_sc_matrix[33];

    // sc-row-8 = sc-row-8 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[33] = 1;
#endif

    sc_to_sc_matrix[34] /= pivot;
    sc_to_sc_matrix[35] /= pivot;
    sc_to_sc_matrix[36] /= pivot;

    sc_g_matrix[7] /= pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 0 1 M M M          |     |           |     |M|  4
    |      0 1 M M          |     |           |     |M|  5
    |      0 0 1 M          |     |           |     |M|  6
    |      0 0 0 1       M M| ... |      M    | ... |M|  7 sc
    |              1 M M M  |     |           |     |M|  8
    |              x x x x  |     |           |     |x|  9
    |              x x x x  |     |           |     |x| 10
    |            x x x x x x|     |      x    |     |x| 11
    |            x       x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    /*
     *
     * Row 9
     *
     */

    pivot = sc_to_sc_matrix[37];

    // sc-row-9 = sc-row-9 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[37] = 0;
#endif

    sc_to_sc_matrix[38] -= sc_to_sc_matrix[34] * pivot;
    sc_to_sc_matrix[39] -= sc_to_sc_matrix[35] * pivot;
    sc_to_sc_matrix[40] -= sc_to_sc_matrix[36] * pivot;

    sc_g_matrix[8] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 0 1 M M M          |     |           |     |M|  4
    |      0 1 M M          |     |           |     |M|  5
    |      0 0 1 M          |     |           |     |M|  6
    |      0 0 0 1       M M| ... |      M    | ... |M|  7 sc
    |              1 M M M  |     |           |     |M|  8
    |              0 M M M  |     |           |     |M|  9
    |              x x x x  |     |           |     |x| 10
    |            x x x x x x|     |      x    |     |x| 11
    |            x       x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[38];

    // sc-row-9 = sc-row-9 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[38] = 1;
#endif

    sc_to_sc_matrix[39] /= pivot;
    sc_to_sc_matrix[40] /= pivot;

    sc_g_matrix[8] /= pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 0 1 M M M          |     |           |     |M|  4
    |      0 1 M M          |     |           |     |M|  5
    |      0 0 1 M          |     |           |     |M|  6
    |      0 0 0 1       M M| ... |      M    | ... |M|  7 sc
    |              1 M M M  |     |           |     |M|  8
    |              0 1 M M  |     |           |     |M|  9
    |              x x x x  |     |           |     |x| 10
    |            x x x x x x|     |      x    |     |x| 11
    |            x       x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    /*
     *
     * Row 10
     *
     */

    pivot = sc_to_sc_matrix[41];

    // sc-row-10 = sc-row-10 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[41] = 0;
#endif

    sc_to_sc_matrix[42] -= sc_to_sc_matrix[34] * pivot;
    sc_to_sc_matrix[43] -= sc_to_sc_matrix[35] * pivot;
    sc_to_sc_matrix[44] -= sc_to_sc_matrix[36] * pivot;

    sc_g_matrix[9] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 0 1 M M M          |     |           |     |M|  4
    |      0 1 M M          |     |           |     |M|  5
    |      0 0 1 M          |     |           |     |M|  6
    |      0 0 0 1       M M| ... |      M    | ... |M|  7 sc
    |              1 M M M  |     |           |     |M|  8
    |              0 1 M M  |     |           |     |M|  9
    |              0 M M M  |     |           |     |M| 10
    |            x x x x x x|     |      x    |     |x| 11
    |            x       x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[42];

    // sc-row-10 = sc-row-10 - sc-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[42] = 0;
#endif

    sc_to_sc_matrix[43] -= sc_to_sc_matrix[39] * pivot;
    sc_to_sc_matrix[44] -= sc_to_sc_matrix[40] * pivot;

    sc_g_matrix[9] -= sc_g_matrix[8] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 0 1 M M M          |     |           |     |M|  4
    |      0 1 M M          |     |           |     |M|  5
    |      0 0 1 M          |     |           |     |M|  6
    |      0 0 0 1       M M| ... |      M    | ... |M|  7 sc
    |              1 M M M  |     |           |     |M|  8
    |              0 1 M M  |     |           |     |M|  9
    |              0 0 M M  |     |           |     |M| 10
    |            x x x x x x|     |      x    |     |x| 11
    |            x       x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[43];

    // sc-row-10 = sc-row-10 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[43] = 1;
#endif

    sc_to_sc_matrix[44] /= pivot;

    sc_g_matrix[9] /= pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 0 1 M M M          |     |           |     |M|  4
    |      0 1 M M          |     |           |     |M|  5
    |      0 0 1 M          |     |           |     |M|  6
    |      0 0 0 1       M M| ... |      M    | ... |M|  7 sc
    |              1 M M M  |     |           |     |M|  8
    |              0 1 M M  |     |           |     |M|  9
    |              0 0 1 M  |     |           |     |M| 10
    |            x x x x x x|     |      x    |     |x| 11
    |            x       x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    /*
     *
     * Row 11
     *
     */

    pivot = sc_to_sc_matrix[45];

    // sc-row-11 = sc-row-11 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[45] = 0;
#endif

    sc_to_sc_matrix[49] -= sc_to_sc_matrix[31] * pivot;
    sc_to_sc_matrix[50] -= sc_to_sc_matrix[32] * pivot;

    sc_to_bb_matrix[1] -= sc_to_bb_matrix[0] * pivot;

    sc_g_matrix[10] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 0 1 M M M          |     |           |     |M|  4
    |      0 1 M M          |     |           |     |M|  5
    |      0 0 1 M          |     |           |     |M|  6
    |      0 0 0 1       M M| ... |      M    | ... |M|  7 sc
    |              1 M M M  |     |           |     |M|  8
    |              0 1 M M  |     |           |     |M|  9
    |              0 0 1 M  |     |           |     |M| 10
    |            0 x x x M M|     |      M    |     |M| 11
    |            x       x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[46];

    // sc-row-11 = sc-row-11 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[46] = 0;
#endif

    sc_to_sc_matrix[47] -= sc_to_sc_matrix[34] * pivot;
    sc_to_sc_matrix[48] -= sc_to_sc_matrix[35] * pivot;
    sc_to_sc_matrix[49] -= sc_to_sc_matrix[36] * pivot;

    sc_g_matrix[10] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 0 1 M M M          |     |           |     |M|  4
    |      0 1 M M          |     |           |     |M|  5
    |      0 0 1 M          |     |           |     |M|  6
    |      0 0 0 1       M M| ... |      M    | ... |M|  7 sc
    |              1 M M M  |     |           |     |M|  8
    |              0 1 M M  |     |           |     |M|  9
    |              0 0 1 M  |     |           |     |M| 10
    |            0 0 M M M M|     |      M    |     |M| 11
    |            x       x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[47];

    // sc-row-11 = sc-row-11 - sc-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[47] = 0;
#endif

    sc_to_sc_matrix[48] -= sc_to_sc_matrix[39] * pivot;
    sc_to_sc_matrix[49] -= sc_to_sc_matrix[40] * pivot;

    sc_g_matrix[10] -= sc_g_matrix[8] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 0 1 M M M          |     |           |     |M|  4
    |      0 1 M M          |     |           |     |M|  5
    |      0 0 1 M          |     |           |     |M|  6
    |      0 0 0 1       M M| ... |      M    | ... |M|  7 sc
    |              1 M M M  |     |           |     |M|  8
    |              0 1 M M  |     |           |     |M|  9
    |              0 0 1 M  |     |           |     |M| 10
    |            0 0 0 M M M|     |      M    |     |M| 11
    |            x       x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[48];

    // sc-row-11 = sc-row-11 - sc-row-10 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[48] = 0;
#endif

    sc_to_sc_matrix[49] -= sc_to_sc_matrix[44] * pivot;

    sc_g_matrix[10] -= sc_g_matrix[9] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 0 1 M M M          |     |           |     |M|  4
    |      0 1 M M          |     |           |     |M|  5
    |      0 0 1 M          |     |           |     |M|  6
    |      0 0 0 1       M M| ... |      M    | ... |M|  7 sc
    |              1 M M M  |     |           |     |M|  8
    |              0 1 M M  |     |           |     |M|  9
    |              0 0 1 M  |     |           |     |M| 10
    |            0 0 0 0 M M|     |      M    |     |M| 11
    |            x       x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[49];

    // sc-row-11 = sc-row-11 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[49] = 1;
#endif

    sc_to_sc_matrix[50] /= pivot;

    sc_to_bb_matrix[1] /= pivot;

    sc_g_matrix[10] /= pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 0 1 M M M          |     |           |     |M|  4
    |      0 1 M M          |     |           |     |M|  5
    |      0 0 1 M          |     |           |     |M|  6
    |      0 0 0 1       M M| ... |      M    | ... |M|  7 sc
    |              1 M M M  |     |           |     |M|  8
    |              0 1 M M  |     |           |     |M|  9
    |              0 0 1 M  |     |           |     |M| 10
    |            0 0 0 0 1 M|     |      M    |     |M| 11
    |            x       x x|     |      x    |     |x| 12
    -------------------------     -------------
    */

    /*
     *
     * Row 12
     *
     */

    pivot = sc_to_sc_matrix[51];

    // sc-row-12 = sc-row-12 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[51] = 0;
#endif

    sc_to_sc_matrix[52] -= sc_to_sc_matrix[31] * pivot;
    sc_to_sc_matrix[53] -= sc_to_sc_matrix[32] * pivot;

    sc_to_bb_matrix[2] -= sc_to_bb_matrix[0] * pivot;

    sc_g_matrix[11] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 0 1 M M M          |     |           |     |M|  4
    |      0 1 M M          |     |           |     |M|  5
    |      0 0 1 M          |     |           |     |M|  6
    |      0 0 0 1       M M| ... |      M    | ... |M|  7 sc
    |              1 M M M  |     |           |     |M|  8
    |              0 1 M M  |     |           |     |M|  9
    |              0 0 1 M  |     |           |     |M| 10
    |            0 0 0 0 1 M|     |      M    |     |M| 11
    |            0       M M|     |      M    |     |M| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[52];

    // sc-row-12 = sc-row-12 - sc-row-11 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[52] = 0;
#endif

    sc_to_sc_matrix[53] -= sc_to_sc_matrix[50] * pivot;

    sc_to_bb_matrix[2] -= sc_to_bb_matrix[1] * pivot;

    sc_g_matrix[11] -= sc_g_matrix[10] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 0 1 M M M          |     |           |     |M|  4
    |      0 1 M M          |     |           |     |M|  5
    |      0 0 1 M          |     |           |     |M|  6
    |      0 0 0 1       M M| ... |      M    | ... |M|  7 sc
    |              1 M M M  |     |           |     |M|  8
    |              0 1 M M  |     |           |     |M|  9
    |              0 0 1 M  |     |           |     |M| 10
    |            0 0 0 0 1 M|     |      M    |     |M| 11
    |            0       0 M|     |      M    |     |M| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[53];

    // sc-row-12 = sc-row-12 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[53] = 1;
#endif

    sc_to_bb_matrix[2] /= pivot;

    sc_g_matrix[11] /= pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 M M M                |     |           |     |M|  1
    |0 1 M M                |     |           |     |M|  2
    |0 0 1 M                |     |           |     |M|  3
    |0 0 0 1 M M M          |     |           |     |M|  4
    |      0 1 M M          |     |           |     |M|  5
    |      0 0 1 M          |     |           |     |M|  6
    |      0 0 0 1       M M| ... |      M    | ... |M|  7 sc
    |              1 M M M  |     |           |     |M|  8
    |              0 1 M M  |     |           |     |M|  9
    |              0 0 1 M  |     |           |     |M| 10
    |            0 0 0 0 1 M|     |      M    |     |M| 11
    |            0       0 1|     |      M    |     |M| 12
    -------------------------     -------------
    */
}

void gmx::IlvesPC::solve_2_aspartic_acid(real *const sc_to_sc_matrix,
                                         real *const sc_to_bb_matrix,
                                         __attribute__((unused))
                                         real *const sc_to_sep_matrix,
                                         real *const sc_g_matrix,
                                         __attribute__((unused))
                                         real *const sc_to_sc_fillins,
                                         __attribute__((unused))
                                         real *const sc_to_bb_fillins) {
    /*
     *
     * Row 1
     *
     */

    real pivot = sc_to_sc_matrix[0];

    // sc-row-1 = sc-row-1 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[0] = 1;
#endif

    sc_to_sc_matrix[1] /= pivot;
    sc_to_sc_matrix[2] /= pivot;

    sc_g_matrix[0] /= pivot;

    /*
    Resulting matrix:

        sc               bb            g
     1 2 3 4 5       1 2 3 4 5 6
    -----------     -------------
    |1 M M    |     |           |     |M|  1
    |x x x    |     |           |     |x|  2
    |x x x x x| ... |      x    | ... |x|  3 sc
    |    x x x|     |      x    |     |x|  4
    |    x x x|     |      x    |     |x|  5
    -----------     -------------
    */

    /*
     *
     * Row 2
     *
     */

    pivot = sc_to_sc_matrix[3];

    // sc-row-2 = sc-row-2 - sc-row-1 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[3] = 0;
#endif

    sc_to_sc_matrix[4] -= sc_to_sc_matrix[1] * pivot;
    sc_to_sc_matrix[5] -= sc_to_sc_matrix[2] * pivot;

    sc_g_matrix[1] -= sc_g_matrix[0] * pivot;

    /*
    Resulting matrix:

        sc               bb            g
     1 2 3 4 5       1 2 3 4 5 6
    -----------     -------------
    |1 M M    |     |           |     |M|  1
    |0 M M    |     |           |     |M|  2
    |x x x x x| ... |      x    | ... |x|  3 sc
    |    x x x|     |      x    |     |x|  4
    |    x x x|     |      x    |     |x|  5
    -----------     -------------
    */

    pivot = sc_to_sc_matrix[4];

    // sc-row-2 = sc-row-2 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[4] = 1;
#endif

    sc_to_sc_matrix[5] /= pivot;

    sc_g_matrix[1] /= pivot;

    /*
    Resulting matrix:

        sc               bb            g
     1 2 3 4 5       1 2 3 4 5 6
    -----------     -------------
    |1 M M    |     |           |     |M|  1
    |0 1 M    |     |           |     |M|  2
    |x x x x x| ... |      x    | ... |x|  3 sc
    |    x x x|     |      x    |     |x|  4
    |    x x x|     |      x    |     |x|  5
    -----------     -------------
    */

    /*
     *
     * Row 3
     *
     */

    pivot = sc_to_sc_matrix[6];

    // sc-row-3 = sc-row-3 - sc-row-1 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[6] = 0;
#endif

    sc_to_sc_matrix[7] -= sc_to_sc_matrix[1] * pivot;
    sc_to_sc_matrix[8] -= sc_to_sc_matrix[2] * pivot;

    sc_g_matrix[2] -= sc_g_matrix[0] * pivot;

    /*
    Resulting matrix:

        sc               bb            g
     1 2 3 4 5       1 2 3 4 5 6
    -----------     -------------
    |1 M M    |     |           |     |M|  1
    |0 1 M    |     |           |     |M|  2
    |0 M M x x| ... |      x    | ... |M|  3 sc
    |    x x x|     |      x    |     |x|  4
    |    x x x|     |      x    |     |x|  5
    -----------     -------------
    */

    pivot = sc_to_sc_matrix[7];

    // sc-row-3 = sc-row-3 - sc-row-2 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[7] = 0;
#endif

    sc_to_sc_matrix[8] -= sc_to_sc_matrix[5] * pivot;

    sc_g_matrix[2] -= sc_g_matrix[1] * pivot;

    /*
    Resulting matrix:

        sc               bb            g
     1 2 3 4 5       1 2 3 4 5 6
    -----------     -------------
    |1 M M    |     |           |     |M|  1
    |0 1 M    |     |           |     |M|  2
    |0 0 M x x| ... |      x    | ... |M|  3 sc
    |    x x x|     |      x    |     |x|  4
    |    x x x|     |      x    |     |x|  5
    -----------     -------------
    */

    pivot = sc_to_sc_matrix[8];

    // sc-row-3 = sc-row-3 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[8] = 1;
#endif

    sc_to_sc_matrix[9] /= pivot;
    sc_to_sc_matrix[10] /= pivot;

    sc_to_bb_matrix[0] /= pivot;

    sc_g_matrix[2] /= pivot;

    /*
    Resulting matrix:

        sc               bb            g
     1 2 3 4 5       1 2 3 4 5 6
    -----------     -------------
    |1 M M    |     |           |     |M|  1
    |0 1 M    |     |           |     |M|  2
    |0 0 1 M M| ... |      M    | ... |M|  3 sc
    |    x x x|     |      x    |     |x|  4
    |    x x x|     |      x    |     |x|  5
    -----------     -------------
    */

    /*
     *
     * Row 4
     *
     */

    pivot = sc_to_sc_matrix[11];

    // sc-row-4 = sc-row-4 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[11] = 0;
#endif

    sc_to_sc_matrix[12] -= sc_to_sc_matrix[9] * pivot;
    sc_to_sc_matrix[13] -= sc_to_sc_matrix[10] * pivot;

    sc_to_bb_matrix[1] -= sc_to_bb_matrix[0] * pivot;

    sc_g_matrix[3] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

        sc               bb            g
     1 2 3 4 5       1 2 3 4 5 6
    -----------     -------------
    |1 M M    |     |           |     |M|  1
    |0 1 M    |     |           |     |M|  2
    |0 0 1 M M| ... |      M    | ... |M|  3 sc
    |    0 M M|     |      M    |     |M|  4
    |    x x x|     |      x    |     |x|  5
    -----------     -------------
    */

    pivot = sc_to_sc_matrix[12];

    // sc-row-4 = sc-row-4 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[12] = 1;
#endif

    sc_to_sc_matrix[13] /= pivot;

    sc_to_bb_matrix[1] /= pivot;

    sc_g_matrix[3] /= pivot;

    /*
    Resulting matrix:

        sc               bb            g
     1 2 3 4 5       1 2 3 4 5 6
    -----------     -------------
    |1 M M    |     |           |     |M|  1
    |0 1 M    |     |           |     |M|  2
    |0 0 1 M M| ... |      M    | ... |M|  3 sc
    |    0 1 M|     |      M    |     |M|  4
    |    x x x|     |      x    |     |x|  5
    -----------     -------------
    */

    /*
     *
     * Row 5
     *
     */

    pivot = sc_to_sc_matrix[14];

    // sc-row-5 = sc-row-5 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[14] = 0;
#endif

    sc_to_sc_matrix[15] -= sc_to_sc_matrix[9] * pivot;
    sc_to_sc_matrix[16] -= sc_to_sc_matrix[10] * pivot;

    sc_to_bb_matrix[2] -= sc_to_bb_matrix[0] * pivot;

    sc_g_matrix[4] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

        sc               bb            g
     1 2 3 4 5       1 2 3 4 5 6
    -----------     -------------
    |1 M M    |     |           |     |M|  1
    |0 1 M    |     |           |     |M|  2
    |0 0 1 M M| ... |      M    | ... |M|  3 sc
    |    0 1 M|     |      M    |     |M|  4
    |    0 M M|     |      M    |     |M|  5
    -----------     -------------
    */

    pivot = sc_to_sc_matrix[15];

    // sc-row-5 = sc-row-5 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[15] = 0;
#endif

    sc_to_sc_matrix[16] -= sc_to_sc_matrix[13] * pivot;

    sc_to_bb_matrix[2] -= sc_to_bb_matrix[1] * pivot;

    sc_g_matrix[4] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

        sc               bb            g
     1 2 3 4 5       1 2 3 4 5 6
    -----------     -------------
    |1 M M    |     |           |     |M|  1
    |0 1 M    |     |           |     |M|  2
    |0 0 1 M M| ... |      M    | ... |M|  3 sc
    |    0 1 M|     |      M    |     |M|  4
    |    0 0 M|     |      M    |     |M|  5
    -----------     -------------
    */

    pivot = sc_to_sc_matrix[16];

    // sc-row-5 = sc-row-5 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[16] = 1;
#endif

    sc_to_bb_matrix[2] /= pivot;

    sc_g_matrix[4] /= pivot;

    /*
    Resulting matrix:

        sc               bb            g
     1 2 3 4 5       1 2 3 4 5 6
    -----------     -------------
    |1 M M    |     |           |     |M|  1
    |0 1 M    |     |           |     |M|  2
    |0 0 1 M M| ... |      M    | ... |M|  3 sc
    |    0 1 M|     |      M    |     |M|  4
    |    0 0 1|     |      M    |     |M|  5
    -----------     -------------
    */
}

void gmx::IlvesPC::solve_2_glutamic_acid(real *const sc_to_sc_matrix,
                                         real *const sc_to_bb_matrix,
                                         __attribute__((unused))
                                         real *const sc_to_sep_matrix,
                                         real *const sc_g_matrix,
                                         __attribute__((unused))
                                         real *const sc_to_sc_fillins,
                                         __attribute__((unused))
                                         real *const sc_to_bb_fillins) {
    /*
     *
     * Row 1
     *
     */

    real pivot = sc_to_sc_matrix[0];

    // sc-row-1 = sc-row-1 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[0] = 1;
#endif

    sc_to_sc_matrix[1] /= pivot;
    sc_to_sc_matrix[2] /= pivot;

    sc_g_matrix[0] /= pivot;

    /*
    Resulting matrix:

           sc                  bb            g
     1 2 3 4 5 6 7 8       1 2 3 4 5 6
    -----------------     -------------
    |1 M M          |     |           |     |M|  1
    |x x x          |     |           |     |x|  2
    |x x x x x x    |     |           |     |x|  3
    |    x x x x    |     |           |     |x|  4
    |    x x x x    | ... |           | ... |x|  5 sc
    |    x x x x x x|     |      x    |     |x|  6
    |          x x x|     |      x    |     |x|  7
    |          x x x|     |      x    |     |x|  8
    -----------------     -------------
    */

    /*
     *
     * Row 2
     *
     */

    pivot = sc_to_sc_matrix[3];

    // sc-row-2 = sc-row-2 - sc-row-1 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[3] = 0;
#endif

    sc_to_sc_matrix[4] -= sc_to_sc_matrix[1] * pivot;
    sc_to_sc_matrix[5] -= sc_to_sc_matrix[2] * pivot;

    sc_g_matrix[1] -= sc_g_matrix[0] * pivot;

    /*
    Resulting matrix:

           sc                  bb            g
     1 2 3 4 5 6 7 8       1 2 3 4 5 6
    -----------------     -------------
    |1 M M          |     |           |     |M|  1
    |0 M M          |     |           |     |M|  2
    |x x x x x x    |     |           |     |x|  3
    |    x x x x    |     |           |     |x|  4
    |    x x x x    | ... |           | ... |x|  5 sc
    |    x x x x x x|     |      x    |     |x|  6
    |          x x x|     |      x    |     |x|  7
    |          x x x|     |      x    |     |x|  8
    -----------------     -------------
    */

    pivot = sc_to_sc_matrix[4];

    // sc-row-2 = sc-row-2 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[4] = 1;
#endif

    sc_to_sc_matrix[5] /= pivot;

    sc_g_matrix[1] /= pivot;

    /*
    Resulting matrix:

           sc                  bb            g
     1 2 3 4 5 6 7 8       1 2 3 4 5 6
    -----------------     -------------
    |1 M M          |     |           |     |M|  1
    |0 1 M          |     |           |     |M|  2
    |x x x x x x    |     |           |     |x|  3
    |    x x x x    |     |           |     |x|  4
    |    x x x x    | ... |           | ... |x|  5 sc
    |    x x x x x x|     |      x    |     |x|  6
    |          x x x|     |      x    |     |x|  7
    |          x x x|     |      x    |     |x|  8
    -----------------     -------------
    */

    /*
     *
     * Row 3
     *
     */

    pivot = sc_to_sc_matrix[6];

    // sc-row-3 = sc-row-3 - sc-row-1 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[6] = 0;
#endif

    sc_to_sc_matrix[7] -= sc_to_sc_matrix[1] * pivot;
    sc_to_sc_matrix[8] -= sc_to_sc_matrix[2] * pivot;

    sc_g_matrix[2] -= sc_g_matrix[0] * pivot;

    /*
    Resulting matrix:

           sc                  bb            g
     1 2 3 4 5 6 7 8       1 2 3 4 5 6
    -----------------     -------------
    |1 M M          |     |           |     |M|  1
    |0 1 M          |     |           |     |M|  2
    |0 M M x x x    |     |           |     |M|  3
    |    x x x x    |     |           |     |x|  4
    |    x x x x    | ... |           | ... |x|  5 sc
    |    x x x x x x|     |      x    |     |x|  6
    |          x x x|     |      x    |     |x|  7
    |          x x x|     |      x    |     |x|  8
    -----------------     -------------
    */

    pivot = sc_to_sc_matrix[7];

    // sc-row-3 = sc-row-3 - sc-row-2 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[7] = 0;
#endif

    sc_to_sc_matrix[8] -= sc_to_sc_matrix[5] * pivot;

    sc_g_matrix[2] -= sc_g_matrix[1] * pivot;

    /*
    Resulting matrix:

           sc                  bb            g
     1 2 3 4 5 6 7 8       1 2 3 4 5 6
    -----------------     -------------
    |1 M M          |     |           |     |M|  1
    |0 1 M          |     |           |     |M|  2
    |0 0 M x x x    |     |           |     |M|  3
    |    x x x x    |     |           |     |x|  4
    |    x x x x    | ... |           | ... |x|  5 sc
    |    x x x x x x|     |      x    |     |x|  6
    |          x x x|     |      x    |     |x|  7
    |          x x x|     |      x    |     |x|  8
    -----------------     -------------
    */

    pivot = sc_to_sc_matrix[8];

    // sc-row-3 = sc-row-3 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[8] = 1;
#endif

    sc_to_sc_matrix[9] /= pivot;
    sc_to_sc_matrix[10] /= pivot;
    sc_to_sc_matrix[11] /= pivot;

    sc_g_matrix[2] /= pivot;

    /*
    Resulting matrix:

           sc                  bb            g
     1 2 3 4 5 6 7 8       1 2 3 4 5 6
    -----------------     -------------
    |1 M M          |     |           |     |M|  1
    |0 1 M          |     |           |     |M|  2
    |0 0 1 M M M    |     |           |     |M|  3
    |    x x x x    |     |           |     |x|  4
    |    x x x x    | ... |           | ... |x|  5 sc
    |    x x x x x x|     |      x    |     |x|  6
    |          x x x|     |      x    |     |x|  7
    |          x x x|     |      x    |     |x|  8
    -----------------     -------------
    */

    /*
     *
     * Row 4
     *
     */

    pivot = sc_to_sc_matrix[12];

    // sc-row-4 = sc-row-4 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[12] = 0;
#endif

    sc_to_sc_matrix[13] -= sc_to_sc_matrix[9] * pivot;
    sc_to_sc_matrix[14] -= sc_to_sc_matrix[10] * pivot;
    sc_to_sc_matrix[15] -= sc_to_sc_matrix[11] * pivot;

    sc_g_matrix[3] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

           sc                  bb            g
     1 2 3 4 5 6 7 8       1 2 3 4 5 6
    -----------------     -------------
    |1 M M          |     |           |     |M|  1
    |0 1 M          |     |           |     |M|  2
    |0 0 1 M M M    |     |           |     |M|  3
    |    0 M M M    |     |           |     |M|  4
    |    x x x x    | ... |           | ... |x|  5 sc
    |    x x x x x x|     |      x    |     |x|  6
    |          x x x|     |      x    |     |x|  7
    |          x x x|     |      x    |     |x|  8
    -----------------     -------------
    */

    pivot = sc_to_sc_matrix[13];

    // sc-row-4 = sc-row-4 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[13] = 1;
#endif

    sc_to_sc_matrix[14] /= pivot;
    sc_to_sc_matrix[15] /= pivot;

    sc_g_matrix[3] /= pivot;

    /*
    Resulting matrix:

           sc                  bb            g
     1 2 3 4 5 6 7 8       1 2 3 4 5 6
    -----------------     -------------
    |1 M M          |     |           |     |M|  1
    |0 1 M          |     |           |     |M|  2
    |0 0 1 M M M    |     |           |     |M|  3
    |    0 1 M M    |     |           |     |M|  4
    |    x x x x    | ... |           | ... |x|  5 sc
    |    x x x x x x|     |      x    |     |x|  6
    |          x x x|     |      x    |     |x|  7
    |          x x x|     |      x    |     |x|  8
    -----------------     -------------
    */

    /*
     *
     * Row 5
     *
     */

    pivot = sc_to_sc_matrix[16];

    // sc-row-5 = sc-row-5 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[16] = 0;
#endif

    sc_to_sc_matrix[17] -= sc_to_sc_matrix[9] * pivot;
    sc_to_sc_matrix[18] -= sc_to_sc_matrix[10] * pivot;
    sc_to_sc_matrix[19] -= sc_to_sc_matrix[11] * pivot;

    sc_g_matrix[4] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

           sc                  bb            g
     1 2 3 4 5 6 7 8       1 2 3 4 5 6
    -----------------     -------------
    |1 M M          |     |           |     |M|  1
    |0 1 M          |     |           |     |M|  2
    |0 0 1 M M M    |     |           |     |M|  3
    |    0 1 M M    |     |           |     |M|  4
    |    0 M M M    | ... |           | ... |M|  5 sc
    |    x x x x x x|     |      x    |     |x|  6
    |          x x x|     |      x    |     |x|  7
    |          x x x|     |      x    |     |x|  8
    -----------------     -------------
    */

    pivot = sc_to_sc_matrix[17];

    // sc-row-5 = sc-row-5 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[17] = 0;
#endif

    sc_to_sc_matrix[18] -= sc_to_sc_matrix[14] * pivot;
    sc_to_sc_matrix[19] -= sc_to_sc_matrix[15] * pivot;

    sc_g_matrix[4] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

           sc                  bb            g
     1 2 3 4 5 6 7 8       1 2 3 4 5 6
    -----------------     -------------
    |1 M M          |     |           |     |M|  1
    |0 1 M          |     |           |     |M|  2
    |0 0 1 M M M    |     |           |     |M|  3
    |    0 1 M M    |     |           |     |M|  4
    |    0 0 M M    | ... |           | ... |M|  5 sc
    |    x x x x x x|     |      x    |     |x|  6
    |          x x x|     |      x    |     |x|  7
    |          x x x|     |      x    |     |x|  8
    -----------------     -------------
    */

    pivot = sc_to_sc_matrix[18];

    // sc-row-5 = sc-row-5 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[18] = 1;
#endif

    sc_to_sc_matrix[19] /= pivot;

    sc_g_matrix[4] /= pivot;

    /*
    Resulting matrix:

           sc                  bb            g
     1 2 3 4 5 6 7 8       1 2 3 4 5 6
    -----------------     -------------
    |1 M M          |     |           |     |M|  1
    |0 1 M          |     |           |     |M|  2
    |0 0 1 M M M    |     |           |     |M|  3
    |    0 1 M M    |     |           |     |M|  4
    |    0 0 1 M    | ... |           | ... |M|  5 sc
    |    x x x x x x|     |      x    |     |x|  6
    |          x x x|     |      x    |     |x|  7
    |          x x x|     |      x    |     |x|  8
    -----------------     -------------
    */

    /*
     *
     * Row 6
     *
     */

    pivot = sc_to_sc_matrix[20];

    // sc-row-6 = sc-row-6 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[20] = 0;
#endif

    sc_to_sc_matrix[21] -= sc_to_sc_matrix[9] * pivot;
    sc_to_sc_matrix[22] -= sc_to_sc_matrix[10] * pivot;
    sc_to_sc_matrix[23] -= sc_to_sc_matrix[11] * pivot;

    sc_g_matrix[5] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

           sc                  bb            g
     1 2 3 4 5 6 7 8       1 2 3 4 5 6
    -----------------     -------------
    |1 M M          |     |           |     |M|  1
    |0 1 M          |     |           |     |M|  2
    |0 0 1 M M M    |     |           |     |M|  3
    |    0 1 M M    |     |           |     |M|  4
    |    0 0 1 M    | ... |           | ... |M|  5 sc
    |    0 M M M x x|     |      x    |     |M|  6
    |          x x x|     |      x    |     |x|  7
    |          x x x|     |      x    |     |x|  8
    -----------------     -------------
    */

    pivot = sc_to_sc_matrix[21];

    // sc-row-6 = sc-row-6 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[21] = 0;
#endif

    sc_to_sc_matrix[22] -= sc_to_sc_matrix[14] * pivot;
    sc_to_sc_matrix[23] -= sc_to_sc_matrix[15] * pivot;

    sc_g_matrix[5] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

           sc                  bb            g
     1 2 3 4 5 6 7 8       1 2 3 4 5 6
    -----------------     -------------
    |1 M M          |     |           |     |M|  1
    |0 1 M          |     |           |     |M|  2
    |0 0 1 M M M    |     |           |     |M|  3
    |    0 1 M M    |     |           |     |M|  4
    |    0 0 1 M    | ... |           | ... |M|  5 sc
    |    0 0 M M x x|     |      x    |     |M|  6
    |          x x x|     |      x    |     |x|  7
    |          x x x|     |      x    |     |x|  8
    -----------------     -------------
    */

    pivot = sc_to_sc_matrix[22];

    // sc-row-6 = sc-row-6 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[22] = 0;
#endif

    sc_to_sc_matrix[23] -= sc_to_sc_matrix[19] * pivot;

    sc_g_matrix[5] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

           sc                  bb            g
     1 2 3 4 5 6 7 8       1 2 3 4 5 6
    -----------------     -------------
    |1 M M          |     |           |     |M|  1
    |0 1 M          |     |           |     |M|  2
    |0 0 1 M M M    |     |           |     |M|  3
    |    0 1 M M    |     |           |     |M|  4
    |    0 0 1 M    | ... |           | ... |M|  5 sc
    |    0 0 0 M x x|     |      x    |     |M|  6
    |          x x x|     |      x    |     |x|  7
    |          x x x|     |      x    |     |x|  8
    -----------------     -------------
    */

    pivot = sc_to_sc_matrix[23];

    // sc-row-6 = sc-row-6 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[23] = 1;
#endif

    sc_to_sc_matrix[24] /= pivot;
    sc_to_sc_matrix[25] /= pivot;

    sc_to_bb_matrix[0] /= pivot;

    sc_g_matrix[5] /= pivot;

    /*
    Resulting matrix:

           sc                  bb            g
     1 2 3 4 5 6 7 8       1 2 3 4 5 6
    -----------------     -------------
    |1 M M          |     |           |     |M|  1
    |0 1 M          |     |           |     |M|  2
    |0 0 1 M M M    |     |           |     |M|  3
    |    0 1 M M    |     |           |     |M|  4
    |    0 0 1 M    | ... |           | ... |M|  5 sc
    |    0 0 0 1 M M|     |      M    |     |M|  6
    |          x x x|     |      x    |     |x|  7
    |          x x x|     |      x    |     |x|  8
    -----------------     -------------
    */

    /*
     *
     * Row 7
     *
     */

    pivot = sc_to_sc_matrix[26];

    // sc-row-7 = sc-row-7 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[26] = 0;
#endif

    sc_to_sc_matrix[27] -= sc_to_sc_matrix[24] * pivot;
    sc_to_sc_matrix[28] -= sc_to_sc_matrix[25] * pivot;

    sc_to_bb_matrix[1] -= sc_to_bb_matrix[0] * pivot;

    sc_g_matrix[6] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

           sc                  bb            g
     1 2 3 4 5 6 7 8       1 2 3 4 5 6
    -----------------     -------------
    |1 M M          |     |           |     |M|  1
    |0 1 M          |     |           |     |M|  2
    |0 0 1 M M M    |     |           |     |M|  3
    |    0 1 M M    |     |           |     |M|  4
    |    0 0 1 M    | ... |           | ... |M|  5 sc
    |    0 0 0 1 M M|     |      M    |     |M|  6
    |          0 M M|     |      M    |     |M|  7
    |          x x x|     |      x    |     |x|  8
    -----------------     -------------
    */

    pivot = sc_to_sc_matrix[27];

    // sc-row-7 = sc-row-7 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[27] = 1;
#endif

    sc_to_sc_matrix[28] /= pivot;

    sc_to_bb_matrix[1] /= pivot;

    sc_g_matrix[6] /= pivot;

    /*
    Resulting matrix:

           sc                  bb            g
     1 2 3 4 5 6 7 8       1 2 3 4 5 6
    -----------------     -------------
    |1 M M          |     |           |     |M|  1
    |0 1 M          |     |           |     |M|  2
    |0 0 1 M M M    |     |           |     |M|  3
    |    0 1 M M    |     |           |     |M|  4
    |    0 0 1 M    | ... |           | ... |M|  5 sc
    |    0 0 0 1 M M|     |      M    |     |M|  6
    |          0 1 M|     |      M    |     |M|  7
    |          x x x|     |      x    |     |x|  8
    -----------------     -------------
    */

    /*
     *
     * Row 8
     *
     */

    pivot = sc_to_sc_matrix[29];

    // sc-row-8 = sc-row-8 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[29] = 0;
#endif

    sc_to_sc_matrix[30] -= sc_to_sc_matrix[24] * pivot;
    sc_to_sc_matrix[31] -= sc_to_sc_matrix[25] * pivot;

    sc_to_bb_matrix[2] -= sc_to_bb_matrix[0] * pivot;

    sc_g_matrix[7] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

           sc                  bb            g
     1 2 3 4 5 6 7 8       1 2 3 4 5 6
    -----------------     -------------
    |1 M M          |     |           |     |M|  1
    |0 1 M          |     |           |     |M|  2
    |0 0 1 M M M    |     |           |     |M|  3
    |    0 1 M M    |     |           |     |M|  4
    |    0 0 1 M    | ... |           | ... |M|  5 sc
    |    0 0 0 1 M M|     |      M    |     |M|  6
    |          0 1 M|     |      M    |     |M|  7
    |          0 M M|     |      M    |     |M|  8
    -----------------     -------------
    */

    pivot = sc_to_sc_matrix[30];

    // sc-row-8 = sc-row-8 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[30] = 0;
#endif

    sc_to_sc_matrix[31] -= sc_to_sc_matrix[28] * pivot;

    sc_to_bb_matrix[2] -= sc_to_bb_matrix[1] * pivot;

    sc_g_matrix[7] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

           sc                  bb            g
     1 2 3 4 5 6 7 8       1 2 3 4 5 6
    -----------------     -------------
    |1 M M          |     |           |     |M|  1
    |0 1 M          |     |           |     |M|  2
    |0 0 1 M M M    |     |           |     |M|  3
    |    0 1 M M    |     |           |     |M|  4
    |    0 0 1 M    | ... |           | ... |M|  5 sc
    |    0 0 0 1 M M|     |      M    |     |M|  6
    |          0 1 M|     |      M    |     |M|  7
    |          0 0 M|     |      M    |     |M|  8
    -----------------     -------------
    */

    pivot = sc_to_sc_matrix[31];

    // sc-row-8 = sc-row-8 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[31] = 1;
#endif

    sc_to_bb_matrix[2] /= pivot;

    sc_g_matrix[7] /= pivot;

    /*
    Resulting matrix:

           sc                  bb            g
     1 2 3 4 5 6 7 8       1 2 3 4 5 6
    -----------------     -------------
    |1 M M          |     |           |     |M|  1
    |0 1 M          |     |           |     |M|  2
    |0 0 1 M M M    |     |           |     |M|  3
    |    0 1 M M    |     |           |     |M|  4
    |    0 0 1 M    | ... |           | ... |M|  5 sc
    |    0 0 0 1 M M|     |      M    |     |M|  6
    |          0 1 M|     |      M    |     |M|  7
    |          0 0 1|     |      M    |     |M|  8
    -----------------     -------------
    */
}

void gmx::IlvesPC::solve_2_asparagine(real *const sc_to_sc_matrix,
                                      real *const sc_to_bb_matrix,
                                      __attribute__((unused))
                                      real *const sc_to_sep_matrix,
                                      real *const sc_g_matrix,
                                      __attribute__((unused))
                                      real *const sc_to_sc_fillins,
                                      __attribute__((unused))
                                      real *const sc_to_bb_fillins) {
    /*
     *
     * Row 1
     *
     */

    real pivot = sc_to_sc_matrix[0];

    // sc-row-1 = sc-row-1 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[0] = 1;
#endif

    sc_to_sc_matrix[1] /= pivot;
    sc_to_sc_matrix[2] /= pivot;

    sc_g_matrix[0] /= pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 M M        |     |           |     |M|  1
    |x x x        |     |           |     |x|  2
    |x x x x x    |     |           |     |x|  3
    |    x x x    | ... |           | ... |x|  4 sc
    |    x x x x x|     |      x    |     |x|  5
    |        x x x|     |      x    |     |x|  6
    |        x x x|     |      x    |     |x|  7
    ---------------     -------------
    */

    /*
     *
     * Row 2
     *
     */

    pivot = sc_to_sc_matrix[3];

    // sc-row-2 = sc-row-2 - sc-row-1 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[3] = 0;
#endif

    sc_to_sc_matrix[4] -= sc_to_sc_matrix[1] * pivot;
    sc_to_sc_matrix[5] -= sc_to_sc_matrix[2] * pivot;

    sc_g_matrix[1] -= sc_g_matrix[0] * pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 M M        |     |           |     |M|  1
    |0 M M        |     |           |     |M|  2
    |x x x x x    |     |           |     |x|  3
    |    x x x    | ... |           | ... |x|  4 sc
    |    x x x x x|     |      x    |     |x|  5
    |        x x x|     |      x    |     |x|  6
    |        x x x|     |      x    |     |x|  7
    ---------------     -------------
    */

    pivot = sc_to_sc_matrix[4];

    // sc-row-2 = sc-row-2 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[4] = 1;
#endif

    sc_to_sc_matrix[5] /= pivot;

    sc_g_matrix[1] /= pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 M M        |     |           |     |M|  1
    |0 1 M        |     |           |     |M|  2
    |x x x x x    |     |           |     |x|  3
    |    x x x    | ... |           | ... |x|  4 sc
    |    x x x x x|     |      x    |     |x|  5
    |        x x x|     |      x    |     |x|  6
    |        x x x|     |      x    |     |x|  7
    ---------------     -------------
    */

    /*
     *
     * Row 3
     *
     */

    pivot = sc_to_sc_matrix[6];

    // sc-row-3 = sc-row-3 - sc-row-1 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[6] = 0;
#endif

    sc_to_sc_matrix[7] -= sc_to_sc_matrix[1] * pivot;
    sc_to_sc_matrix[8] -= sc_to_sc_matrix[2] * pivot;

    sc_g_matrix[2] -= sc_g_matrix[0] * pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 M M        |     |           |     |M|  1
    |0 1 M        |     |           |     |M|  2
    |0 M M x x    |     |           |     |M|  3
    |    x x x    | ... |           | ... |x|  4 sc
    |    x x x x x|     |      x    |     |x|  5
    |        x x x|     |      x    |     |x|  6
    |        x x x|     |      x    |     |x|  7
    ---------------     -------------
    */

    pivot = sc_to_sc_matrix[7];

    // sc-row-3 = sc-row-3 - sc-row-2 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[7] = 0;
#endif

    sc_to_sc_matrix[8] -= sc_to_sc_matrix[5] * pivot;

    sc_g_matrix[2] -= sc_g_matrix[1] * pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 M M        |     |           |     |M|  1
    |0 1 M        |     |           |     |M|  2
    |0 0 M x x    |     |           |     |M|  3
    |    x x x    | ... |           | ... |x|  4 sc
    |    x x x x x|     |      x    |     |x|  5
    |        x x x|     |      x    |     |x|  6
    |        x x x|     |      x    |     |x|  7
    ---------------     -------------
    */

    pivot = sc_to_sc_matrix[8];

    // sc-row-3 = sc-row-3 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[8] = 1;
#endif

    sc_to_sc_matrix[9] /= pivot;
    sc_to_sc_matrix[10] /= pivot;

    sc_g_matrix[2] /= pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 M M        |     |           |     |M|  1
    |0 1 M        |     |           |     |M|  2
    |0 0 1 M M    |     |           |     |M|  3
    |    x x x    | ... |           | ... |x|  4 sc
    |    x x x x x|     |      x    |     |x|  5
    |        x x x|     |      x    |     |x|  6
    |        x x x|     |      x    |     |x|  7
    ---------------     -------------
    */

    /*
     *
     * Row 4
     *
     */

    pivot = sc_to_sc_matrix[11];

    // sc-row-4 = sc-row-4 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[11] = 0;
#endif

    sc_to_sc_matrix[12] -= sc_to_sc_matrix[9] * pivot;
    sc_to_sc_matrix[13] -= sc_to_sc_matrix[10] * pivot;

    sc_g_matrix[3] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 M M        |     |           |     |M|  1
    |0 1 M        |     |           |     |M|  2
    |0 0 1 M M    |     |           |     |M|  3
    |    0 M M    | ... |           | ... |M|  4 sc
    |    x x x x x|     |      x    |     |x|  5
    |        x x x|     |      x    |     |x|  6
    |        x x x|     |      x    |     |x|  7
    ---------------     -------------
    */

    pivot = sc_to_sc_matrix[12];

    // sc-row-4 = sc-row-4 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[12] = 1;
#endif

    sc_to_sc_matrix[13] /= pivot;

    sc_g_matrix[3] /= pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 M M        |     |           |     |M|  1
    |0 1 M        |     |           |     |M|  2
    |0 0 1 M M    |     |           |     |M|  3
    |    0 1 M    | ... |           | ... |M|  4 sc
    |    x x x x x|     |      x    |     |x|  5
    |        x x x|     |      x    |     |x|  6
    |        x x x|     |      x    |     |x|  7
    ---------------     -------------
    */

    /*
     *
     * Row 5
     *
     */

    pivot = sc_to_sc_matrix[14];

    // sc-row-5 = sc-row-5 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[14] = 0;
#endif

    sc_to_sc_matrix[15] -= sc_to_sc_matrix[9] * pivot;
    sc_to_sc_matrix[16] -= sc_to_sc_matrix[10] * pivot;

    sc_g_matrix[4] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 M M        |     |           |     |M|  1
    |0 1 M        |     |           |     |M|  2
    |0 0 1 M M    |     |           |     |M|  3
    |    0 1 M    | ... |           | ... |M|  4 sc
    |    0 M M x x|     |      x    |     |M|  5
    |        x x x|     |      x    |     |x|  6
    |        x x x|     |      x    |     |x|  7
    ---------------     -------------
    */

    pivot = sc_to_sc_matrix[15];

    // sc-row-5 = sc-row-5 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[15] = 0;
#endif

    sc_to_sc_matrix[16] -= sc_to_sc_matrix[13] * pivot;

    sc_g_matrix[4] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 M M        |     |           |     |M|  1
    |0 1 M        |     |           |     |M|  2
    |0 0 1 M M    |     |           |     |M|  3
    |    0 1 M    | ... |           | ... |M|  4 sc
    |    0 0 M x x|     |      x    |     |M|  5
    |        x x x|     |      x    |     |x|  6
    |        x x x|     |      x    |     |x|  7
    ---------------     -------------
    */

    pivot = sc_to_sc_matrix[16];

    // sc-row-5 = sc-row-5 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[16] = 1;
#endif

    sc_to_sc_matrix[17] /= pivot;
    sc_to_sc_matrix[18] /= pivot;

    sc_to_bb_matrix[0] /= pivot;

    sc_g_matrix[4] /= pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 M M        |     |           |     |M|  1
    |0 1 M        |     |           |     |M|  2
    |0 0 1 M M    |     |           |     |M|  3
    |    0 1 M    | ... |           | ... |M|  4 sc
    |    0 0 1 M M|     |      M    |     |M|  5
    |        x x x|     |      x    |     |x|  6
    |        x x x|     |      x    |     |x|  7
    ---------------     -------------
    */

    /*
     *
     * Row 6
     *
     */

    pivot = sc_to_sc_matrix[19];

    // sc-row-6 = sc-row-6 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[19] = 0;
#endif

    sc_to_sc_matrix[20] -= sc_to_sc_matrix[17] * pivot;
    sc_to_sc_matrix[21] -= sc_to_sc_matrix[18] * pivot;

    sc_to_bb_matrix[1] -= sc_to_bb_matrix[0] * pivot;

    sc_g_matrix[5] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 M M        |     |           |     |M|  1
    |0 1 M        |     |           |     |M|  2
    |0 0 1 M M    |     |           |     |M|  3
    |    0 1 M    | ... |           | ... |M|  4 sc
    |    0 0 1 M M|     |      M    |     |M|  5
    |        0 M M|     |      M    |     |M|  6
    |        x x x|     |      x    |     |x|  7
    ---------------     -------------
    */

    pivot = sc_to_sc_matrix[20];

    // sc-row-6 = sc-row-6 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[20] = 1;
#endif

    sc_to_sc_matrix[21] /= pivot;

    sc_to_bb_matrix[1] /= pivot;

    sc_g_matrix[5] /= pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 M M        |     |           |     |M|  1
    |0 1 M        |     |           |     |M|  2
    |0 0 1 M M    |     |           |     |M|  3
    |    0 1 M    | ... |           | ... |M|  4 sc
    |    0 0 1 M M|     |      M    |     |M|  5
    |        0 1 M|     |      M    |     |M|  6
    |        x x x|     |      x    |     |x|  7
    ---------------     -------------
    */

    /*
     *
     * Row 7
     *
     */

    pivot = sc_to_sc_matrix[22];

    // sc-row-7 = sc-row-7 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[22] = 0;
#endif

    sc_to_sc_matrix[23] -= sc_to_sc_matrix[17] * pivot;
    sc_to_sc_matrix[24] -= sc_to_sc_matrix[18] * pivot;

    sc_to_bb_matrix[2] -= sc_to_bb_matrix[0] * pivot;

    sc_g_matrix[6] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 M M        |     |           |     |M|  1
    |0 1 M        |     |           |     |M|  2
    |0 0 1 M M    |     |           |     |M|  3
    |    0 1 M    | ... |           | ... |M|  4 sc
    |    0 0 1 M M|     |      M    |     |M|  5
    |        0 1 M|     |      M    |     |M|  6
    |        0 M M|     |      M    |     |M|  7
    ---------------     -------------
    */

    pivot = sc_to_sc_matrix[23];

    // sc-row-7 = sc-row-7 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[23] = 0;
#endif

    sc_to_sc_matrix[24] -= sc_to_sc_matrix[21] * pivot;

    sc_to_bb_matrix[2] -= sc_to_bb_matrix[1] * pivot;

    sc_g_matrix[6] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 M M        |     |           |     |M|  1
    |0 1 M        |     |           |     |M|  2
    |0 0 1 M M    |     |           |     |M|  3
    |    0 1 M    | ... |           | ... |M|  4 sc
    |    0 0 1 M M|     |      M    |     |M|  5
    |        0 1 M|     |      M    |     |M|  6
    |        0 0 M|     |      M    |     |M|  7
    ---------------     -------------
    */

    pivot = sc_to_sc_matrix[24];

    // sc-row-7 = sc-row-7 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[24] = 1;
#endif

    sc_to_bb_matrix[2] /= pivot;

    sc_g_matrix[6] /= pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 M M        |     |           |     |M|  1
    |0 1 M        |     |           |     |M|  2
    |0 0 1 M M    |     |           |     |M|  3
    |    0 1 M    | ... |           | ... |M|  4 sc
    |    0 0 1 M M|     |      M    |     |M|  5
    |        0 1 M|     |      M    |     |M|  6
    |        0 0 1|     |      M    |     |M|  7
    ---------------     -------------
    */
}

void gmx::IlvesPC::solve_2_glutamine(real *const sc_to_sc_matrix,
                                     real *const sc_to_bb_matrix,
                                     __attribute__((unused))
                                     real *const sc_to_sep_matrix,
                                     real *const sc_g_matrix,
                                     __attribute__((unused))
                                     real *const sc_to_sc_fillins,
                                     __attribute__((unused))
                                     real *const sc_to_bb_fillins) {
    /*
     *
     * Row 1
     *
     */

    real pivot = sc_to_sc_matrix[0];

    // sc-row-1 = sc-row-1 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[0] = 1;
#endif

    sc_to_sc_matrix[1] /= pivot;
    sc_to_sc_matrix[2] /= pivot;

    sc_g_matrix[0] /= pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M              |     |           |     |M|  1
    |x x x              |     |           |     |x|  2
    |x x x x x          |     |           |     |x|  3
    |    x x x          |     |           |     |x|  4
    |    x x x x x x    |     |           |     |x|  5
    |        x x x x    | ... |           | ... |x|  6 sc
    |        x x x x    |     |           |     |x|  7
    |        x x x x x x|     |      x    |     |x|  8
    |              x x x|     |      x    |     |x|  9
    |              x x x|     |      x    |     |x| 10
    ---------------------     -------------
    */

    /*
     *
     * Row 2
     *
     */

    pivot = sc_to_sc_matrix[3];

    // sc-row-2 = sc-row-2 - sc-row-1 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[3] = 0;
#endif

    sc_to_sc_matrix[4] -= sc_to_sc_matrix[1] * pivot;
    sc_to_sc_matrix[5] -= sc_to_sc_matrix[2] * pivot;

    sc_g_matrix[1] -= sc_g_matrix[0] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M              |     |           |     |M|  1
    |0 M M              |     |           |     |M|  2
    |x x x x x          |     |           |     |x|  3
    |    x x x          |     |           |     |x|  4
    |    x x x x x x    |     |           |     |x|  5
    |        x x x x    | ... |           | ... |x|  6 sc
    |        x x x x    |     |           |     |x|  7
    |        x x x x x x|     |      x    |     |x|  8
    |              x x x|     |      x    |     |x|  9
    |              x x x|     |      x    |     |x| 10
    ---------------------     -------------
    */

    pivot = sc_to_sc_matrix[4];

    // sc-row-2 = sc-row-2 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[4] = 1;
#endif

    sc_to_sc_matrix[5] /= pivot;

    sc_g_matrix[1] /= pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M              |     |           |     |M|  1
    |0 1 M              |     |           |     |M|  2
    |x x x x x          |     |           |     |x|  3
    |    x x x          |     |           |     |x|  4
    |    x x x x x x    |     |           |     |x|  5
    |        x x x x    | ... |           | ... |x|  6 sc
    |        x x x x    |     |           |     |x|  7
    |        x x x x x x|     |      x    |     |x|  8
    |              x x x|     |      x    |     |x|  9
    |              x x x|     |      x    |     |x| 10
    ---------------------     -------------
    */

    /*
     *
     * Row 3
     *
     */

    pivot = sc_to_sc_matrix[6];

    // sc-row-3 = sc-row-3 - sc-row-1 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[6] = 0;
#endif

    sc_to_sc_matrix[7] -= sc_to_sc_matrix[1] * pivot;
    sc_to_sc_matrix[8] -= sc_to_sc_matrix[2] * pivot;

    sc_g_matrix[2] -= sc_g_matrix[0] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M              |     |           |     |M|  1
    |0 1 M              |     |           |     |M|  2
    |0 M M x x          |     |           |     |M|  3
    |    x x x          |     |           |     |x|  4
    |    x x x x x x    |     |           |     |x|  5
    |        x x x x    | ... |           | ... |x|  6 sc
    |        x x x x    |     |           |     |x|  7
    |        x x x x x x|     |      x    |     |x|  8
    |              x x x|     |      x    |     |x|  9
    |              x x x|     |      x    |     |x| 10
    ---------------------     -------------
    */

    pivot = sc_to_sc_matrix[7];

    // sc-row-3 = sc-row-3 - sc-row-2 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[7] = 0;
#endif

    sc_to_sc_matrix[8] -= sc_to_sc_matrix[5] * pivot;

    sc_g_matrix[2] -= sc_g_matrix[1] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M              |     |           |     |M|  1
    |0 1 M              |     |           |     |M|  2
    |0 0 M x x          |     |           |     |M|  3
    |    x x x          |     |           |     |x|  4
    |    x x x x x x    |     |           |     |x|  5
    |        x x x x    | ... |           | ... |x|  6 sc
    |        x x x x    |     |           |     |x|  7
    |        x x x x x x|     |      x    |     |x|  8
    |              x x x|     |      x    |     |x|  9
    |              x x x|     |      x    |     |x| 10
    ---------------------     -------------
    */

    pivot = sc_to_sc_matrix[8];

    // sc-row-3 = sc-row-3 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[8] = 1;
#endif

    sc_to_sc_matrix[9] /= pivot;
    sc_to_sc_matrix[10] /= pivot;

    sc_g_matrix[2] /= pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M              |     |           |     |M|  1
    |0 1 M              |     |           |     |M|  2
    |0 0 1 M M          |     |           |     |M|  3
    |    x x x          |     |           |     |x|  4
    |    x x x x x x    |     |           |     |x|  5
    |        x x x x    | ... |           | ... |x|  6 sc
    |        x x x x    |     |           |     |x|  7
    |        x x x x x x|     |      x    |     |x|  8
    |              x x x|     |      x    |     |x|  9
    |              x x x|     |      x    |     |x| 10
    ---------------------     -------------
    */

    /*
     *
     * Row 4
     *
     */

    pivot = sc_to_sc_matrix[11];

    // sc-row-4 = sc-row-4 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[11] = 0;
#endif

    sc_to_sc_matrix[12] -= sc_to_sc_matrix[9] * pivot;
    sc_to_sc_matrix[13] -= sc_to_sc_matrix[10] * pivot;

    sc_g_matrix[3] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M              |     |           |     |M|  1
    |0 1 M              |     |           |     |M|  2
    |0 0 1 M M          |     |           |     |M|  3
    |    0 M M          |     |           |     |M|  4
    |    x x x x x x    |     |           |     |x|  5
    |        x x x x    | ... |           | ... |x|  6 sc
    |        x x x x    |     |           |     |x|  7
    |        x x x x x x|     |      x    |     |x|  8
    |              x x x|     |      x    |     |x|  9
    |              x x x|     |      x    |     |x| 10
    ---------------------     -------------
    */

    pivot = sc_to_sc_matrix[12];

    // sc-row-4 = sc-row-4 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[12] = 1;
#endif

    sc_to_sc_matrix[13] /= pivot;

    sc_g_matrix[3] /= pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M              |     |           |     |M|  1
    |0 1 M              |     |           |     |M|  2
    |0 0 1 M M          |     |           |     |M|  3
    |    0 1 M          |     |           |     |M|  4
    |    x x x x x x    |     |           |     |x|  5
    |        x x x x    | ... |           | ... |x|  6 sc
    |        x x x x    |     |           |     |x|  7
    |        x x x x x x|     |      x    |     |x|  8
    |              x x x|     |      x    |     |x|  9
    |              x x x|     |      x    |     |x| 10
    ---------------------     -------------
    */

    /*
     *
     * Row 5
     *
     */

    pivot = sc_to_sc_matrix[14];

    // sc-row-5 = sc-row-5 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[14] = 0;
#endif

    sc_to_sc_matrix[15] -= sc_to_sc_matrix[9] * pivot;
    sc_to_sc_matrix[16] -= sc_to_sc_matrix[10] * pivot;

    sc_g_matrix[4] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M              |     |           |     |M|  1
    |0 1 M              |     |           |     |M|  2
    |0 0 1 M M          |     |           |     |M|  3
    |    0 1 M          |     |           |     |M|  4
    |    0 M M x x x    |     |           |     |M|  5
    |        x x x x    | ... |           | ... |x|  6 sc
    |        x x x x    |     |           |     |x|  7
    |        x x x x x x|     |      x    |     |x|  8
    |              x x x|     |      x    |     |x|  9
    |              x x x|     |      x    |     |x| 10
    ---------------------     -------------
    */

    pivot = sc_to_sc_matrix[15];

    // sc-row-5 = sc-row-5 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[15] = 0;
#endif

    sc_to_sc_matrix[16] -= sc_to_sc_matrix[13] * pivot;

    sc_g_matrix[4] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M              |     |           |     |M|  1
    |0 1 M              |     |           |     |M|  2
    |0 0 1 M M          |     |           |     |M|  3
    |    0 1 M          |     |           |     |M|  4
    |    0 0 M x x x    |     |           |     |M|  5
    |        x x x x    | ... |           | ... |x|  6 sc
    |        x x x x    |     |           |     |x|  7
    |        x x x x x x|     |      x    |     |x|  8
    |              x x x|     |      x    |     |x|  9
    |              x x x|     |      x    |     |x| 10
    ---------------------     -------------
    */

    pivot = sc_to_sc_matrix[16];

    // sc-row-5 = sc-row-5 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[16] = 1;
#endif

    sc_to_sc_matrix[17] /= pivot;
    sc_to_sc_matrix[18] /= pivot;
    sc_to_sc_matrix[19] /= pivot;

    sc_g_matrix[4] /= pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M              |     |           |     |M|  1
    |0 1 M              |     |           |     |M|  2
    |0 0 1 M M          |     |           |     |M|  3
    |    0 1 M          |     |           |     |M|  4
    |    0 0 1 M M M    |     |           |     |M|  5
    |        x x x x    | ... |           | ... |x|  6 sc
    |        x x x x    |     |           |     |x|  7
    |        x x x x x x|     |      x    |     |x|  8
    |              x x x|     |      x    |     |x|  9
    |              x x x|     |      x    |     |x| 10
    ---------------------     -------------
    */

    /*
     *
     * Row 6
     *
     */

    pivot = sc_to_sc_matrix[20];

    // sc-row-6 = sc-row-6 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[20] = 0;
#endif

    sc_to_sc_matrix[21] -= sc_to_sc_matrix[17] * pivot;
    sc_to_sc_matrix[22] -= sc_to_sc_matrix[18] * pivot;
    sc_to_sc_matrix[23] -= sc_to_sc_matrix[19] * pivot;

    sc_g_matrix[5] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M              |     |           |     |M|  1
    |0 1 M              |     |           |     |M|  2
    |0 0 1 M M          |     |           |     |M|  3
    |    0 1 M          |     |           |     |M|  4
    |    0 0 1 M M M    |     |           |     |M|  5
    |        0 M M M    | ... |           | ... |M|  6 sc
    |        x x x x    |     |           |     |x|  7
    |        x x x x x x|     |      x    |     |x|  8
    |              x x x|     |      x    |     |x|  9
    |              x x x|     |      x    |     |x| 10
    ---------------------     -------------
    */

    pivot = sc_to_sc_matrix[21];

    // sc-row-6 = sc-row-6 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[21] = 1;
#endif

    sc_to_sc_matrix[22] /= pivot;
    sc_to_sc_matrix[23] /= pivot;

    sc_g_matrix[5] /= pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M              |     |           |     |M|  1
    |0 1 M              |     |           |     |M|  2
    |0 0 1 M M          |     |           |     |M|  3
    |    0 1 M          |     |           |     |M|  4
    |    0 0 1 M M M    |     |           |     |M|  5
    |        0 1 M M    | ... |           | ... |M|  6 sc
    |        x x x x    |     |           |     |x|  7
    |        x x x x x x|     |      x    |     |x|  8
    |              x x x|     |      x    |     |x|  9
    |              x x x|     |      x    |     |x| 10
    ---------------------     -------------
    */

    /*
     *
     * Row 7
     *
     */

    pivot = sc_to_sc_matrix[24];

    // sc-row-7 = sc-row-7 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[24] = 0;
#endif

    sc_to_sc_matrix[25] -= sc_to_sc_matrix[17] * pivot;
    sc_to_sc_matrix[26] -= sc_to_sc_matrix[18] * pivot;
    sc_to_sc_matrix[27] -= sc_to_sc_matrix[19] * pivot;

    sc_g_matrix[6] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M              |     |           |     |M|  1
    |0 1 M              |     |           |     |M|  2
    |0 0 1 M M          |     |           |     |M|  3
    |    0 1 M          |     |           |     |M|  4
    |    0 0 1 M M M    |     |           |     |M|  5
    |        0 1 M M    | ... |           | ... |M|  6 sc
    |        0 M M M    |     |           |     |M|  7
    |        x x x x x x|     |      x    |     |x|  8
    |              x x x|     |      x    |     |x|  9
    |              x x x|     |      x    |     |x| 10
    ---------------------     -------------
    */

    pivot = sc_to_sc_matrix[25];

    // sc-row-7 = sc-row-7 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[25] = 0;
#endif

    sc_to_sc_matrix[26] -= sc_to_sc_matrix[22] * pivot;
    sc_to_sc_matrix[27] -= sc_to_sc_matrix[23] * pivot;

    sc_g_matrix[6] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M              |     |           |     |M|  1
    |0 1 M              |     |           |     |M|  2
    |0 0 1 M M          |     |           |     |M|  3
    |    0 1 M          |     |           |     |M|  4
    |    0 0 1 M M M    |     |           |     |M|  5
    |        0 1 M M    | ... |           | ... |M|  6 sc
    |        0 0 M M    |     |           |     |M|  7
    |        x x x x x x|     |      x    |     |x|  8
    |              x x x|     |      x    |     |x|  9
    |              x x x|     |      x    |     |x| 10
    ---------------------     -------------
    */

    pivot = sc_to_sc_matrix[26];

    // sc-row-7 = sc-row-7 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[26] = 1;
#endif

    sc_to_sc_matrix[27] /= pivot;

    sc_g_matrix[6] /= pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M              |     |           |     |M|  1
    |0 1 M              |     |           |     |M|  2
    |0 0 1 M M          |     |           |     |M|  3
    |    0 1 M          |     |           |     |M|  4
    |    0 0 1 M M M    |     |           |     |M|  5
    |        0 1 M M    | ... |           | ... |M|  6 sc
    |        0 0 1 M    |     |           |     |M|  7
    |        x x x x x x|     |      x    |     |x|  8
    |              x x x|     |      x    |     |x|  9
    |              x x x|     |      x    |     |x| 10
    ---------------------     -------------
    */

    /*
     *
     * Row 8
     *
     */

    pivot = sc_to_sc_matrix[28];

    // sc-row-8 = sc-row-8 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[28] = 0;
#endif

    sc_to_sc_matrix[29] -= sc_to_sc_matrix[17] * pivot;
    sc_to_sc_matrix[30] -= sc_to_sc_matrix[18] * pivot;
    sc_to_sc_matrix[31] -= sc_to_sc_matrix[19] * pivot;

    sc_g_matrix[7] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M              |     |           |     |M|  1
    |0 1 M              |     |           |     |M|  2
    |0 0 1 M M          |     |           |     |M|  3
    |    0 1 M          |     |           |     |M|  4
    |    0 0 1 M M M    |     |           |     |M|  5
    |        0 1 M M    | ... |           | ... |M|  6 sc
    |        0 0 1 M    |     |           |     |M|  7
    |        0 M M M x x|     |      x    |     |M|  8
    |              x x x|     |      x    |     |x|  9
    |              x x x|     |      x    |     |x| 10
    ---------------------     -------------
    */

    pivot = sc_to_sc_matrix[29];

    // sc-row-8 = sc-row-8 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[29] = 0;
#endif

    sc_to_sc_matrix[30] -= sc_to_sc_matrix[22] * pivot;
    sc_to_sc_matrix[31] -= sc_to_sc_matrix[23] * pivot;

    sc_g_matrix[7] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M              |     |           |     |M|  1
    |0 1 M              |     |           |     |M|  2
    |0 0 1 M M          |     |           |     |M|  3
    |    0 1 M          |     |           |     |M|  4
    |    0 0 1 M M M    |     |           |     |M|  5
    |        0 1 M M    | ... |           | ... |M|  6 sc
    |        0 0 1 M    |     |           |     |M|  7
    |        0 0 M M x x|     |      x    |     |M|  8
    |              x x x|     |      x    |     |x|  9
    |              x x x|     |      x    |     |x| 10
    ---------------------     -------------
    */

    pivot = sc_to_sc_matrix[30];

    // sc-row-8 = sc-row-8 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[30] = 0;
#endif

    sc_to_sc_matrix[31] -= sc_to_sc_matrix[27] * pivot;

    sc_g_matrix[7] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M              |     |           |     |M|  1
    |0 1 M              |     |           |     |M|  2
    |0 0 1 M M          |     |           |     |M|  3
    |    0 1 M          |     |           |     |M|  4
    |    0 0 1 M M M    |     |           |     |M|  5
    |        0 1 M M    | ... |           | ... |M|  6 sc
    |        0 0 1 M    |     |           |     |M|  7
    |        0 0 0 M x x|     |      x    |     |M|  8
    |              x x x|     |      x    |     |x|  9
    |              x x x|     |      x    |     |x| 10
    ---------------------     -------------
    */

    pivot = sc_to_sc_matrix[31];

    // sc-row-8 = sc-row-8 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[31] = 1;
#endif

    sc_to_sc_matrix[32] /= pivot;
    sc_to_sc_matrix[33] /= pivot;

    sc_to_bb_matrix[0] /= pivot;

    sc_g_matrix[7] /= pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M              |     |           |     |M|  1
    |0 1 M              |     |           |     |M|  2
    |0 0 1 M M          |     |           |     |M|  3
    |    0 1 M          |     |           |     |M|  4
    |    0 0 1 M M M    |     |           |     |M|  5
    |        0 1 M M    | ... |           | ... |M|  6 sc
    |        0 0 1 M    |     |           |     |M|  7
    |        0 0 0 1 M M|     |      M    |     |M|  8
    |              x x x|     |      x    |     |x|  9
    |              x x x|     |      x    |     |x| 10
    ---------------------     -------------
    */

    /*
     *
     * Row 9
     *
     */

    pivot = sc_to_sc_matrix[34];

    // sc-row-9 = sc-row-9 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[34] = 0;
#endif

    sc_to_sc_matrix[35] -= sc_to_sc_matrix[32] * pivot;
    sc_to_sc_matrix[36] -= sc_to_sc_matrix[33] * pivot;

    sc_to_bb_matrix[1] -= sc_to_bb_matrix[0] * pivot;

    sc_g_matrix[8] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M              |     |           |     |M|  1
    |0 1 M              |     |           |     |M|  2
    |0 0 1 M M          |     |           |     |M|  3
    |    0 1 M          |     |           |     |M|  4
    |    0 0 1 M M M    |     |           |     |M|  5
    |        0 1 M M    | ... |           | ... |M|  6 sc
    |        0 0 1 M    |     |           |     |M|  7
    |        0 0 0 1 M M|     |      M    |     |M|  8
    |              0 M M|     |      M    |     |M|  9
    |              x x x|     |      x    |     |x| 10
    ---------------------     -------------
    */

    pivot = sc_to_sc_matrix[35];

    // sc-row-9 = sc-row-9 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[35] = 1;
#endif

    sc_to_sc_matrix[36] /= pivot;

    sc_to_bb_matrix[1] /= pivot;

    sc_g_matrix[8] /= pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M              |     |           |     |M|  1
    |0 1 M              |     |           |     |M|  2
    |0 0 1 M M          |     |           |     |M|  3
    |    0 1 M          |     |           |     |M|  4
    |    0 0 1 M M M    |     |           |     |M|  5
    |        0 1 M M    | ... |           | ... |M|  6 sc
    |        0 0 1 M    |     |           |     |M|  7
    |        0 0 0 1 M M|     |      M    |     |M|  8
    |              0 1 M|     |      M    |     |M|  9
    |              x x x|     |      x    |     |x| 10
    ---------------------     -------------
    */

    /*
     *
     * Row 10
     *
     */

    pivot = sc_to_sc_matrix[37];

    // sc-row-10 = sc-row-10 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[37] = 0;
#endif

    sc_to_sc_matrix[38] -= sc_to_sc_matrix[32] * pivot;
    sc_to_sc_matrix[39] -= sc_to_sc_matrix[33] * pivot;

    sc_to_bb_matrix[2] -= sc_to_bb_matrix[0] * pivot;

    sc_g_matrix[9] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M              |     |           |     |M|  1
    |0 1 M              |     |           |     |M|  2
    |0 0 1 M M          |     |           |     |M|  3
    |    0 1 M          |     |           |     |M|  4
    |    0 0 1 M M M    |     |           |     |M|  5
    |        0 1 M M    | ... |           | ... |M|  6 sc
    |        0 0 1 M    |     |           |     |M|  7
    |        0 0 0 1 M M|     |      M    |     |M|  8
    |              0 1 M|     |      M    |     |M|  9
    |              0 M M|     |      M    |     |M| 10
    ---------------------     -------------
    */

    pivot = sc_to_sc_matrix[38];

    // sc-row-10 = sc-row-10 - sc-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[38] = 0;
#endif

    sc_to_sc_matrix[39] -= sc_to_sc_matrix[36] * pivot;

    sc_to_bb_matrix[2] -= sc_to_bb_matrix[1] * pivot;

    sc_g_matrix[9] -= sc_g_matrix[8] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M              |     |           |     |M|  1
    |0 1 M              |     |           |     |M|  2
    |0 0 1 M M          |     |           |     |M|  3
    |    0 1 M          |     |           |     |M|  4
    |    0 0 1 M M M    |     |           |     |M|  5
    |        0 1 M M    | ... |           | ... |M|  6 sc
    |        0 0 1 M    |     |           |     |M|  7
    |        0 0 0 1 M M|     |      M    |     |M|  8
    |              0 1 M|     |      M    |     |M|  9
    |              0 0 M|     |      M    |     |M| 10
    ---------------------     -------------
    */

    pivot = sc_to_sc_matrix[39];

    // sc-row-10 = sc-row-10 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[39] = 1;
#endif

    sc_to_bb_matrix[2] /= pivot;

    sc_g_matrix[9] /= pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 M M              |     |           |     |M|  1
    |0 1 M              |     |           |     |M|  2
    |0 0 1 M M          |     |           |     |M|  3
    |    0 1 M          |     |           |     |M|  4
    |    0 0 1 M M M    |     |           |     |M|  5
    |        0 1 M M    | ... |           | ... |M|  6 sc
    |        0 0 1 M    |     |           |     |M|  7
    |        0 0 0 1 M M|     |      M    |     |M|  8
    |              0 1 M|     |      M    |     |M|  9
    |              0 0 1|     |      M    |     |M| 10
    ---------------------     -------------
    */
}

void gmx::IlvesPC::solve_2_histidine(real *const sc_to_sc_matrix,
                                     real *const sc_to_bb_matrix,
                                     __attribute__((unused))
                                     real *const sc_to_sep_matrix,
                                     real *const sc_g_matrix,
                                     real *const sc_to_sc_fillins,
                                     __attribute__((unused))
                                     real *const sc_to_bb_fillins) {
    /*
     *
     * Row 1
     *
     */

    real pivot = sc_to_sc_matrix[0];

    // sc-row-1 = sc-row-1 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[0] = 1;
#endif

    sc_to_sc_matrix[1] /= pivot;
    sc_to_sc_matrix[2] /= pivot;

    sc_g_matrix[0] /= pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   M   M            |     |           |     |M|  1
    |  x x     x          |     |           |     |x|  2
    |x x x   x x          |     |           |     |x|  3
    |      x x     x      |     |           |     |x|  4
    |x   x x x     x      |     |           |     |x|  5
    |  x x     x x        | ... |           | ... |x|  6 sc
    |          x x x x    |     |           |     |x|  7
    |      x x   x x x    |     |           |     |x|  8
    |            x x x x x|     |      x    |     |x|  9
    |                x x x|     |      x    |     |x| 10
    |                x x x|     |      x    |     |x| 11
    -----------------------     -------------
    */

    /*
     *
     * Row 2
     *
     */

    pivot = sc_to_sc_matrix[3];

    // sc-row-2 = sc-row-2 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[3] = 1;
#endif

    sc_to_sc_matrix[4] /= pivot;
    sc_to_sc_matrix[5] /= pivot;

    sc_g_matrix[1] /= pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   M   M            |     |           |     |M|  1
    |  1 M     M          |     |           |     |M|  2
    |x x x   x x          |     |           |     |x|  3
    |      x x     x      |     |           |     |x|  4
    |x   x x x     x      |     |           |     |x|  5
    |  x x     x x        | ... |           | ... |x|  6 sc
    |          x x x x    |     |           |     |x|  7
    |      x x   x x x    |     |           |     |x|  8
    |            x x x x x|     |      x    |     |x|  9
    |                x x x|     |      x    |     |x| 10
    |                x x x|     |      x    |     |x| 11
    -----------------------     -------------
    */

    /*
     *
     * Row 3
     *
     */

    pivot = sc_to_sc_matrix[6];

    // sc-row-3 = sc-row-3 - sc-row-1 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[6] = 0;
#endif

    sc_to_sc_matrix[8] -= sc_to_sc_matrix[1] * pivot;
    sc_to_sc_matrix[9] -= sc_to_sc_matrix[2] * pivot;

    sc_g_matrix[2] -= sc_g_matrix[0] * pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   M   M            |     |           |     |M|  1
    |  1 M     M          |     |           |     |M|  2
    |0 x M   M x          |     |           |     |M|  3
    |      x x     x      |     |           |     |x|  4
    |x   x x x     x      |     |           |     |x|  5
    |  x x     x x        | ... |           | ... |x|  6 sc
    |          x x x x    |     |           |     |x|  7
    |      x x   x x x    |     |           |     |x|  8
    |            x x x x x|     |      x    |     |x|  9
    |                x x x|     |      x    |     |x| 10
    |                x x x|     |      x    |     |x| 11
    -----------------------     -------------
    */

    pivot = sc_to_sc_matrix[7];

    // sc-row-3 = sc-row-3 - sc-row-2 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[7] = 0;
#endif

    sc_to_sc_matrix[8] -= sc_to_sc_matrix[4] * pivot;
    sc_to_sc_matrix[10] -= sc_to_sc_matrix[5] * pivot;

    sc_g_matrix[2] -= sc_g_matrix[1] * pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   M   M            |     |           |     |M|  1
    |  1 M     M          |     |           |     |M|  2
    |0 0 M   M M          |     |           |     |M|  3
    |      x x     x      |     |           |     |x|  4
    |x   x x x     x      |     |           |     |x|  5
    |  x x     x x        | ... |           | ... |x|  6 sc
    |          x x x x    |     |           |     |x|  7
    |      x x   x x x    |     |           |     |x|  8
    |            x x x x x|     |      x    |     |x|  9
    |                x x x|     |      x    |     |x| 10
    |                x x x|     |      x    |     |x| 11
    -----------------------     -------------
    */

    pivot = sc_to_sc_matrix[8];

    // sc-row-3 = sc-row-3 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[8] = 1;
#endif

    sc_to_sc_matrix[9] /= pivot;
    sc_to_sc_matrix[10] /= pivot;

    sc_g_matrix[2] /= pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   M   M            |     |           |     |M|  1
    |  1 M     M          |     |           |     |M|  2
    |0 0 1   M M          |     |           |     |M|  3
    |      x x     x      |     |           |     |x|  4
    |x   x x x     x      |     |           |     |x|  5
    |  x x     x x        | ... |           | ... |x|  6 sc
    |          x x x x    |     |           |     |x|  7
    |      x x   x x x    |     |           |     |x|  8
    |            x x x x x|     |      x    |     |x|  9
    |                x x x|     |      x    |     |x| 10
    |                x x x|     |      x    |     |x| 11
    -----------------------     -------------
    */

    /*
     *
     * Row 4
     *
     */

    pivot = sc_to_sc_matrix[11];

    // sc-row-4 = sc-row-4 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[11] = 1;
#endif

    sc_to_sc_matrix[12] /= pivot;
    sc_to_sc_matrix[13] /= pivot;

    sc_g_matrix[3] /= pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   M   M            |     |           |     |M|  1
    |  1 M     M          |     |           |     |M|  2
    |0 0 1   M M          |     |           |     |M|  3
    |      1 M     M      |     |           |     |M|  4
    |x   x x x     x      |     |           |     |x|  5
    |  x x     x x        | ... |           | ... |x|  6 sc
    |          x x x x    |     |           |     |x|  7
    |      x x   x x x    |     |           |     |x|  8
    |            x x x x x|     |      x    |     |x|  9
    |                x x x|     |      x    |     |x| 10
    |                x x x|     |      x    |     |x| 11
    -----------------------     -------------
    */

    /*
     *
     * Row 5
     *
     */

    pivot = sc_to_sc_matrix[14];

    // sc-row-5 = sc-row-5 - sc-row-1 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[14] = 0;
#endif

    sc_to_sc_matrix[15] -= sc_to_sc_matrix[1] * pivot;
    sc_to_sc_matrix[17] -= sc_to_sc_matrix[2] * pivot;

    sc_g_matrix[4] -= sc_g_matrix[0] * pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   M   M            |     |           |     |M|  1
    |  1 M     M          |     |           |     |M|  2
    |0 0 1   M M          |     |           |     |M|  3
    |      1 M     M      |     |           |     |M|  4
    |0   M x M     x      |     |           |     |M|  5
    |  x x     x x        | ... |           | ... |x|  6 sc
    |          x x x x    |     |           |     |x|  7
    |      x x   x x x    |     |           |     |x|  8
    |            x x x x x|     |      x    |     |x|  9
    |                x x x|     |      x    |     |x| 10
    |                x x x|     |      x    |     |x| 11
    -----------------------     -------------
    */

    pivot = sc_to_sc_matrix[15];

    // sc-row-5 = sc-row-5 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[15] = 0;
#endif

    sc_to_sc_matrix[17] -= sc_to_sc_matrix[9] * pivot;

    sc_to_sc_fillins[0] = -sc_to_sc_matrix[10] * pivot;

    sc_g_matrix[4] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   M   M            |     |           |     |M|  1
    |  1 M     M          |     |           |     |M|  2
    |0 0 1   M M          |     |           |     |M|  3
    |      1 M     M      |     |           |     |M|  4
    |0   0 x M F   x      |     |           |     |M|  5
    |  x x     x x        | ... |           | ... |x|  6 sc
    |          x x x x    |     |           |     |x|  7
    |      x x   x x x    |     |           |     |x|  8
    |            x x x x x|     |      x    |     |x|  9
    |                x x x|     |      x    |     |x| 10
    |                x x x|     |      x    |     |x| 11
    -----------------------     -------------
    */

    pivot = sc_to_sc_matrix[16];

    // sc-row-5 = sc-row-5 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[16] = 0;
#endif

    sc_to_sc_matrix[17] -= sc_to_sc_matrix[12] * pivot;
    sc_to_sc_matrix[18] -= sc_to_sc_matrix[13] * pivot;

    sc_g_matrix[4] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   M   M            |     |           |     |M|  1
    |  1 M     M          |     |           |     |M|  2
    |0 0 1   M M          |     |           |     |M|  3
    |      1 M     M      |     |           |     |M|  4
    |0   0 0 M F   M      |     |           |     |M|  5
    |  x x     x x        | ... |           | ... |x|  6 sc
    |          x x x x    |     |           |     |x|  7
    |      x x   x x x    |     |           |     |x|  8
    |            x x x x x|     |      x    |     |x|  9
    |                x x x|     |      x    |     |x| 10
    |                x x x|     |      x    |     |x| 11
    -----------------------     -------------
    */

    pivot = sc_to_sc_matrix[17];

    // sc-row-5 = sc-row-5 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[17] = 1;
#endif

    sc_to_sc_fillins[0] /= pivot;

    sc_to_sc_matrix[18] /= pivot;

    sc_g_matrix[4] /= pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   M   M            |     |           |     |M|  1
    |  1 M     M          |     |           |     |M|  2
    |0 0 1   M M          |     |           |     |M|  3
    |      1 M     M      |     |           |     |M|  4
    |0   0 0 1 F   M      |     |           |     |M|  5
    |  x x     x x        | ... |           | ... |x|  6 sc
    |          x x x x    |     |           |     |x|  7
    |      x x   x x x    |     |           |     |x|  8
    |            x x x x x|     |      x    |     |x|  9
    |                x x x|     |      x    |     |x| 10
    |                x x x|     |      x    |     |x| 11
    -----------------------     -------------
    */

    /*
     *
     * Row 6
     *
     */

    pivot = sc_to_sc_matrix[19];

    // sc-row-6 = sc-row-6 - sc-row-2 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[19] = 0;
#endif

    sc_to_sc_matrix[20] -= sc_to_sc_matrix[4] * pivot;
    sc_to_sc_matrix[21] -= sc_to_sc_matrix[5] * pivot;

    sc_g_matrix[5] -= sc_g_matrix[1] * pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   M   M            |     |           |     |M|  1
    |  1 M     M          |     |           |     |M|  2
    |0 0 1   M M          |     |           |     |M|  3
    |      1 M     M      |     |           |     |M|  4
    |0   0 0 1 F   M      |     |           |     |M|  5
    |  0 M     M x        | ... |           | ... |M|  6 sc
    |          x x x x    |     |           |     |x|  7
    |      x x   x x x    |     |           |     |x|  8
    |            x x x x x|     |      x    |     |x|  9
    |                x x x|     |      x    |     |x| 10
    |                x x x|     |      x    |     |x| 11
    -----------------------     -------------
    */

    pivot = sc_to_sc_matrix[20];

    // sc-row-6 = sc-row-6 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[20] = 0;
#endif

    sc_to_sc_fillins[1] = -sc_to_sc_matrix[9] * pivot;

    sc_to_sc_matrix[21] -= sc_to_sc_matrix[10] * pivot;

    sc_g_matrix[5] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   M   M            |     |           |     |M|  1
    |  1 M     M          |     |           |     |M|  2
    |0 0 1   M M          |     |           |     |M|  3
    |      1 M     M      |     |           |     |M|  4
    |0   0 0 1 F   M      |     |           |     |M|  5
    |  0 0   F M x        | ... |           | ... |M|  6 sc
    |          x x x x    |     |           |     |x|  7
    |      x x   x x x    |     |           |     |x|  8
    |            x x x x x|     |      x    |     |x|  9
    |                x x x|     |      x    |     |x| 10
    |                x x x|     |      x    |     |x| 11
    -----------------------     -------------
    */

    pivot = sc_to_sc_fillins[1];

    // sc-row-6 = sc-row-6 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_fillins[1] = 0;
#endif

    sc_to_sc_matrix[21] -= sc_to_sc_fillins[0] * pivot;

    sc_to_sc_fillins[2] = -sc_to_sc_matrix[18] * pivot;

    sc_g_matrix[5] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   M   M            |     |           |     |M|  1
    |  1 M     M          |     |           |     |M|  2
    |0 0 1   M M          |     |           |     |M|  3
    |      1 M     M      |     |           |     |M|  4
    |0   0 0 1 F   M      |     |           |     |M|  5
    |  0 0   0 M x F      | ... |           | ... |M|  6 sc
    |          x x x x    |     |           |     |x|  7
    |      x x   x x x    |     |           |     |x|  8
    |            x x x x x|     |      x    |     |x|  9
    |                x x x|     |      x    |     |x| 10
    |                x x x|     |      x    |     |x| 11
    -----------------------     -------------
    */

    pivot = sc_to_sc_matrix[21];

    // sc-row-6 = sc-row-6 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[21] = 1;
#endif

    sc_to_sc_matrix[22] /= pivot;

    sc_to_sc_fillins[2] /= pivot;

    sc_g_matrix[5] /= pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   M   M            |     |           |     |M|  1
    |  1 M     M          |     |           |     |M|  2
    |0 0 1   M M          |     |           |     |M|  3
    |      1 M     M      |     |           |     |M|  4
    |0   0 0 1 F   M      |     |           |     |M|  5
    |  0 0   0 1 M F      | ... |           | ... |M|  6 sc
    |          x x x x    |     |           |     |x|  7
    |      x x   x x x    |     |           |     |x|  8
    |            x x x x x|     |      x    |     |x|  9
    |                x x x|     |      x    |     |x| 10
    |                x x x|     |      x    |     |x| 11
    -----------------------     -------------
    */

    /*
     *
     * Row 7
     *
     */

    pivot = sc_to_sc_matrix[23];

    // sc-row-7 = sc-row-7 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[23] = 0;
#endif

    sc_to_sc_matrix[24] -= sc_to_sc_matrix[22] * pivot;
    sc_to_sc_matrix[25] -= sc_to_sc_fillins[2] * pivot;

    sc_g_matrix[6] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   M   M            |     |           |     |M|  1
    |  1 M     M          |     |           |     |M|  2
    |0 0 1   M M          |     |           |     |M|  3
    |      1 M     M      |     |           |     |M|  4
    |0   0 0 1 F   M      |     |           |     |M|  5
    |  0 0   0 1 M F      | ... |           | ... |M|  6 sc
    |          0 M M x    |     |           |     |M|  7
    |      x x   x x x    |     |           |     |x|  8
    |            x x x x x|     |      x    |     |x|  9
    |                x x x|     |      x    |     |x| 10
    |                x x x|     |      x    |     |x| 11
    -----------------------     -------------
    */

    pivot = sc_to_sc_matrix[24];

    // sc-row-7 = sc-row-7 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[24] = 1;
#endif

    sc_to_sc_matrix[25] /= pivot;
    sc_to_sc_matrix[26] /= pivot;

    sc_g_matrix[6] /= pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   M   M            |     |           |     |M|  1
    |  1 M     M          |     |           |     |M|  2
    |0 0 1   M M          |     |           |     |M|  3
    |      1 M     M      |     |           |     |M|  4
    |0   0 0 1 F   M      |     |           |     |M|  5
    |  0 0   0 1 M F      | ... |           | ... |M|  6 sc
    |          0 1 M M    |     |           |     |M|  7
    |      x x   x x x    |     |           |     |x|  8
    |            x x x x x|     |      x    |     |x|  9
    |                x x x|     |      x    |     |x| 10
    |                x x x|     |      x    |     |x| 11
    -----------------------     -------------
    */

    /*
     *
     * Row 8
     *
     */

    pivot = sc_to_sc_matrix[27];

    // sc-row-8 = sc-row-8 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[27] = 0;
#endif

    sc_to_sc_matrix[28] -= sc_to_sc_matrix[12] * pivot;
    sc_to_sc_matrix[30] -= sc_to_sc_matrix[13] * pivot;

    sc_g_matrix[7] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   M   M            |     |           |     |M|  1
    |  1 M     M          |     |           |     |M|  2
    |0 0 1   M M          |     |           |     |M|  3
    |      1 M     M      |     |           |     |M|  4
    |0   0 0 1 F   M      |     |           |     |M|  5
    |  0 0   0 1 M F      | ... |           | ... |M|  6 sc
    |          0 1 M M    |     |           |     |M|  7
    |      0 M   x M x    |     |           |     |M|  8
    |            x x x x x|     |      x    |     |x|  9
    |                x x x|     |      x    |     |x| 10
    |                x x x|     |      x    |     |x| 11
    -----------------------     -------------
    */

    pivot = sc_to_sc_matrix[28];

    // sc-row-8 = sc-row-8 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[28] = 0;
#endif

    sc_to_sc_fillins[3] = -sc_to_sc_fillins[0] * pivot;

    sc_to_sc_matrix[30] -= sc_to_sc_matrix[18] * pivot;

    sc_g_matrix[7] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   M   M            |     |           |     |M|  1
    |  1 M     M          |     |           |     |M|  2
    |0 0 1   M M          |     |           |     |M|  3
    |      1 M     M      |     |           |     |M|  4
    |0   0 0 1 F   M      |     |           |     |M|  5
    |  0 0   0 1 M F      | ... |           | ... |M|  6 sc
    |          0 1 M M    |     |           |     |M|  7
    |      0 0 F x M x    |     |           |     |M|  8
    |            x x x x x|     |      x    |     |x|  9
    |                x x x|     |      x    |     |x| 10
    |                x x x|     |      x    |     |x| 11
    -----------------------     -------------
    */

    pivot = sc_to_sc_fillins[3];

    // sc-row-8 = sc-row-8 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_fillins[3] = 0;
#endif

    sc_to_sc_matrix[29] -= sc_to_sc_matrix[22] * pivot;
    sc_to_sc_matrix[30] -= sc_to_sc_fillins[2] * pivot;

    sc_g_matrix[7] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   M   M            |     |           |     |M|  1
    |  1 M     M          |     |           |     |M|  2
    |0 0 1   M M          |     |           |     |M|  3
    |      1 M     M      |     |           |     |M|  4
    |0   0 0 1 F   M      |     |           |     |M|  5
    |  0 0   0 1 M F      | ... |           | ... |M|  6 sc
    |          0 1 M M    |     |           |     |M|  7
    |      0 0 0 M M x    |     |           |     |M|  8
    |            x x x x x|     |      x    |     |x|  9
    |                x x x|     |      x    |     |x| 10
    |                x x x|     |      x    |     |x| 11
    -----------------------     -------------
    */

    pivot = sc_to_sc_matrix[29];

    // sc-row-8 = sc-row-8 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[29] = 0;
#endif

    sc_to_sc_matrix[30] -= sc_to_sc_matrix[25] * pivot;
    sc_to_sc_matrix[31] -= sc_to_sc_matrix[26] * pivot;

    sc_g_matrix[7] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   M   M            |     |           |     |M|  1
    |  1 M     M          |     |           |     |M|  2
    |0 0 1   M M          |     |           |     |M|  3
    |      1 M     M      |     |           |     |M|  4
    |0   0 0 1 F   M      |     |           |     |M|  5
    |  0 0   0 1 M F      | ... |           | ... |M|  6 sc
    |          0 1 M M    |     |           |     |M|  7
    |      0 0 0 0 M M    |     |           |     |M|  8
    |            x x x x x|     |      x    |     |x|  9
    |                x x x|     |      x    |     |x| 10
    |                x x x|     |      x    |     |x| 11
    -----------------------     -------------
    */

    pivot = sc_to_sc_matrix[30];

    // sc-row-8 = sc-row-8 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[30] = 1;
#endif

    sc_to_sc_matrix[31] /= pivot;

    sc_g_matrix[7] /= pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   M   M            |     |           |     |M|  1
    |  1 M     M          |     |           |     |M|  2
    |0 0 1   M M          |     |           |     |M|  3
    |      1 M     M      |     |           |     |M|  4
    |0   0 0 1 F   M      |     |           |     |M|  5
    |  0 0   0 1 M F      | ... |           | ... |M|  6 sc
    |          0 1 M M    |     |           |     |M|  7
    |      0 0 0 0 1 M    |     |           |     |M|  8
    |            x x x x x|     |      x    |     |x|  9
    |                x x x|     |      x    |     |x| 10
    |                x x x|     |      x    |     |x| 11
    -----------------------     -------------
    */

    /*
     *
     * Row 9
     *
     */

    pivot = sc_to_sc_matrix[32];

    // sc-row-9 = sc-row-9 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[32] = 0;
#endif

    sc_to_sc_matrix[33] -= sc_to_sc_matrix[25] * pivot;
    sc_to_sc_matrix[34] -= sc_to_sc_matrix[26] * pivot;

    sc_g_matrix[8] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   M   M            |     |           |     |M|  1
    |  1 M     M          |     |           |     |M|  2
    |0 0 1   M M          |     |           |     |M|  3
    |      1 M     M      |     |           |     |M|  4
    |0   0 0 1 F   M      |     |           |     |M|  5
    |  0 0   0 1 M F      | ... |           | ... |M|  6 sc
    |          0 1 M M    |     |           |     |M|  7
    |      0 0 0 0 1 M    |     |           |     |M|  8
    |            0 M M x x|     |      x    |     |M|  9
    |                x x x|     |      x    |     |x| 10
    |                x x x|     |      x    |     |x| 11
    -----------------------     -------------
    */

    pivot = sc_to_sc_matrix[33];

    // sc-row-9 = sc-row-9 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[33] = 0;
#endif

    sc_to_sc_matrix[34] -= sc_to_sc_matrix[31] * pivot;

    sc_g_matrix[8] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   M   M            |     |           |     |M|  1
    |  1 M     M          |     |           |     |M|  2
    |0 0 1   M M          |     |           |     |M|  3
    |      1 M     M      |     |           |     |M|  4
    |0   0 0 1 F   M      |     |           |     |M|  5
    |  0 0   0 1 M F      | ... |           | ... |M|  6 sc
    |          0 1 M M    |     |           |     |M|  7
    |      0 0 0 0 1 M    |     |           |     |M|  8
    |            0 0 M x x|     |      x    |     |M|  9
    |                x x x|     |      x    |     |x| 10
    |                x x x|     |      x    |     |x| 11
    -----------------------     -------------
    */

    pivot = sc_to_sc_matrix[34];

    // sc-row-9 = sc-row-9 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[34] = 1;
#endif

    sc_to_sc_matrix[35] /= pivot;
    sc_to_sc_matrix[36] /= pivot;

    sc_to_bb_matrix[0] /= pivot;

    sc_g_matrix[8] /= pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   M   M            |     |           |     |M|  1
    |  1 M     M          |     |           |     |M|  2
    |0 0 1   M M          |     |           |     |M|  3
    |      1 M     M      |     |           |     |M|  4
    |0   0 0 1 F   M      |     |           |     |M|  5
    |  0 0   0 1 M F      | ... |           | ... |M|  6 sc
    |          0 1 M M    |     |           |     |M|  7
    |      0 0 0 0 1 M    |     |           |     |M|  8
    |            0 0 1 M M|     |      M    |     |M|  9
    |                x x x|     |      x    |     |x| 10
    |                x x x|     |      x    |     |x| 11
    -----------------------     -------------
    */

    /*
     *
     * Row 10
     *
     */

    pivot = sc_to_sc_matrix[37];

    // sc-row-10 = sc-row-10 - sc-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[37] = 0;
#endif

    sc_to_sc_matrix[38] -= sc_to_sc_matrix[35] * pivot;
    sc_to_sc_matrix[39] -= sc_to_sc_matrix[36] * pivot;

    sc_to_bb_matrix[1] -= sc_to_bb_matrix[0] * pivot;

    sc_g_matrix[9] -= sc_g_matrix[8] * pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   M   M            |     |           |     |M|  1
    |  1 M     M          |     |           |     |M|  2
    |0 0 1   M M          |     |           |     |M|  3
    |      1 M     M      |     |           |     |M|  4
    |0   0 0 1 F   M      |     |           |     |M|  5
    |  0 0   0 1 M F      | ... |           | ... |M|  6 sc
    |          0 1 M M    |     |           |     |M|  7
    |      0 0 0 0 1 M    |     |           |     |M|  8
    |            0 0 1 M M|     |      M    |     |M|  9
    |                0 M M|     |      M    |     |M| 10
    |                x x x|     |      x    |     |x| 11
    -----------------------     -------------
    */

    pivot = sc_to_sc_matrix[38];

    // sc-row-10 = sc-row-10 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[38] = 1;
#endif

    sc_to_sc_matrix[39] /= pivot;

    sc_to_bb_matrix[1] /= pivot;

    sc_g_matrix[9] /= pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   M   M            |     |           |     |M|  1
    |  1 M     M          |     |           |     |M|  2
    |0 0 1   M M          |     |           |     |M|  3
    |      1 M     M      |     |           |     |M|  4
    |0   0 0 1 F   M      |     |           |     |M|  5
    |  0 0   0 1 M F      | ... |           | ... |M|  6 sc
    |          0 1 M M    |     |           |     |M|  7
    |      0 0 0 0 1 M    |     |           |     |M|  8
    |            0 0 1 M M|     |      M    |     |M|  9
    |                0 1 M|     |      M    |     |M| 10
    |                x x x|     |      x    |     |x| 11
    -----------------------     -------------
    */

    /*
     *
     * Row 11
     *
     */

    pivot = sc_to_sc_matrix[40];

    // sc-row-11 = sc-row-11 - sc-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[40] = 0;
#endif

    sc_to_sc_matrix[41] -= sc_to_sc_matrix[35] * pivot;
    sc_to_sc_matrix[42] -= sc_to_sc_matrix[36] * pivot;

    sc_to_bb_matrix[2] -= sc_to_bb_matrix[0] * pivot;

    sc_g_matrix[10] -= sc_g_matrix[8] * pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   M   M            |     |           |     |M|  1
    |  1 M     M          |     |           |     |M|  2
    |0 0 1   M M          |     |           |     |M|  3
    |      1 M     M      |     |           |     |M|  4
    |0   0 0 1 F   M      |     |           |     |M|  5
    |  0 0   0 1 M F      | ... |           | ... |M|  6 sc
    |          0 1 M M    |     |           |     |M|  7
    |      0 0 0 0 1 M    |     |           |     |M|  8
    |            0 0 1 M M|     |      M    |     |M|  9
    |                0 1 M|     |      M    |     |M| 10
    |                0 M M|     |      M    |     |M| 11
    -----------------------     -------------
    */

    pivot = sc_to_sc_matrix[41];

    // sc-row-11 = sc-row-11 - sc-row-10 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[41] = 0;
#endif

    sc_to_sc_matrix[42] -= sc_to_sc_matrix[39] * pivot;

    sc_to_bb_matrix[2] -= sc_to_bb_matrix[1] * pivot;

    sc_g_matrix[10] -= sc_g_matrix[9] * pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   M   M            |     |           |     |M|  1
    |  1 M     M          |     |           |     |M|  2
    |0 0 1   M M          |     |           |     |M|  3
    |      1 M     M      |     |           |     |M|  4
    |0   0 0 1 F   M      |     |           |     |M|  5
    |  0 0   0 1 M F      | ... |           | ... |M|  6 sc
    |          0 1 M M    |     |           |     |M|  7
    |      0 0 0 0 1 M    |     |           |     |M|  8
    |            0 0 1 M M|     |      M    |     |M|  9
    |                0 1 M|     |      M    |     |M| 10
    |                0 0 M|     |      M    |     |M| 11
    -----------------------     -------------
    */

    pivot = sc_to_sc_matrix[42];

    // sc-row-11 = sc-row-11 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[42] = 1;
#endif

    sc_to_bb_matrix[2] /= pivot;

    sc_g_matrix[10] /= pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   M   M            |     |           |     |M|  1
    |  1 M     M          |     |           |     |M|  2
    |0 0 1   M M          |     |           |     |M|  3
    |      1 M     M      |     |           |     |M|  4
    |0   0 0 1 F   M      |     |           |     |M|  5
    |  0 0   0 1 M F      | ... |           | ... |M|  6 sc
    |          0 1 M M    |     |           |     |M|  7
    |      0 0 0 0 1 M    |     |           |     |M|  8
    |            0 0 1 M M|     |      M    |     |M|  9
    |                0 1 M|     |      M    |     |M| 10
    |                0 0 1|     |      M    |     |M| 11
    -----------------------     -------------
    */
}

void gmx::IlvesPC::solve_2_lysine(real *const sc_to_sc_matrix,
                                  real *const sc_to_bb_matrix,
                                  __attribute__((unused))
                                  real *const sc_to_sep_matrix,
                                  real *const sc_g_matrix,
                                  __attribute__((unused))
                                  real *const sc_to_sc_fillins,
                                  __attribute__((unused))
                                  real *const sc_to_bb_fillins) {
    /*
     *
     * Row 1
     *
     */

    real pivot = sc_to_sc_matrix[0];

    // sc-row-1 = sc-row-1 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[0] = 1;
#endif

    sc_to_sc_matrix[1] /= pivot;
    sc_to_sc_matrix[2] /= pivot;
    sc_to_sc_matrix[3] /= pivot;

    sc_g_matrix[0] /= pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 M M M                      |     |           |     |M|  1
    |x x x x                      |     |           |     |x|  2
    |x x x x                      |     |           |     |x|  3
    |x x x x x x x                |     |           |     |x|  4
    |      x x x x                |     |           |     |x|  5
    |      x x x x                |     |           |     |x|  6
    |      x x x x x x x          |     |           |     |x|  7
    |            x x x x          | ... |           | ... |x|  8 sc
    |            x x x x          |     |           |     |x|  9
    |            x x x x x x x    |     |           |     |x| 10
    |                  x x x x    |     |           |     |x| 11
    |                  x x x x    |     |           |     |x| 12
    |                  x x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 2
     *
     */

    pivot = sc_to_sc_matrix[4];

    // sc-row-2 = sc-row-2 - sc-row-1 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[4] = 0;
#endif

    sc_to_sc_matrix[5] -= sc_to_sc_matrix[1] * pivot;
    sc_to_sc_matrix[6] -= sc_to_sc_matrix[2] * pivot;
    sc_to_sc_matrix[7] -= sc_to_sc_matrix[3] * pivot;

    sc_g_matrix[1] -= sc_g_matrix[0] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 M M M                      |     |           |     |M|  1
    |0 M M M                      |     |           |     |M|  2
    |x x x x                      |     |           |     |x|  3
    |x x x x x x x                |     |           |     |x|  4
    |      x x x x                |     |           |     |x|  5
    |      x x x x                |     |           |     |x|  6
    |      x x x x x x x          |     |           |     |x|  7
    |            x x x x          | ... |           | ... |x|  8 sc
    |            x x x x          |     |           |     |x|  9
    |            x x x x x x x    |     |           |     |x| 10
    |                  x x x x    |     |           |     |x| 11
    |                  x x x x    |     |           |     |x| 12
    |                  x x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[5];

    // sc-row-2 = sc-row-2 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[5] = 1;
#endif

    sc_to_sc_matrix[6] /= pivot;
    sc_to_sc_matrix[7] /= pivot;

    sc_g_matrix[1] /= pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 M M M                      |     |           |     |M|  1
    |0 1 M M                      |     |           |     |M|  2
    |x x x x                      |     |           |     |x|  3
    |x x x x x x x                |     |           |     |x|  4
    |      x x x x                |     |           |     |x|  5
    |      x x x x                |     |           |     |x|  6
    |      x x x x x x x          |     |           |     |x|  7
    |            x x x x          | ... |           | ... |x|  8 sc
    |            x x x x          |     |           |     |x|  9
    |            x x x x x x x    |     |           |     |x| 10
    |                  x x x x    |     |           |     |x| 11
    |                  x x x x    |     |           |     |x| 12
    |                  x x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 3
     *
     */

    pivot = sc_to_sc_matrix[8];

    // sc-row-3 = sc-row-3 - sc-row-1 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[8] = 0;
#endif

    sc_to_sc_matrix[9] -= sc_to_sc_matrix[1] * pivot;
    sc_to_sc_matrix[10] -= sc_to_sc_matrix[2] * pivot;
    sc_to_sc_matrix[11] -= sc_to_sc_matrix[3] * pivot;

    sc_g_matrix[2] -= sc_g_matrix[0] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 M M M                      |     |           |     |M|  1
    |0 1 M M                      |     |           |     |M|  2
    |0 M M M                      |     |           |     |M|  3
    |x x x x x x x                |     |           |     |x|  4
    |      x x x x                |     |           |     |x|  5
    |      x x x x                |     |           |     |x|  6
    |      x x x x x x x          |     |           |     |x|  7
    |            x x x x          | ... |           | ... |x|  8 sc
    |            x x x x          |     |           |     |x|  9
    |            x x x x x x x    |     |           |     |x| 10
    |                  x x x x    |     |           |     |x| 11
    |                  x x x x    |     |           |     |x| 12
    |                  x x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[9];

    // sc-row-3 = sc-row-3 - sc-row-2 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[9] = 0;
#endif

    sc_to_sc_matrix[10] -= sc_to_sc_matrix[6] * pivot;
    sc_to_sc_matrix[11] -= sc_to_sc_matrix[7] * pivot;

    sc_g_matrix[2] -= sc_g_matrix[1] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 M M M                      |     |           |     |M|  1
    |0 1 M M                      |     |           |     |M|  2
    |0 0 M M                      |     |           |     |M|  3
    |x x x x x x x                |     |           |     |x|  4
    |      x x x x                |     |           |     |x|  5
    |      x x x x                |     |           |     |x|  6
    |      x x x x x x x          |     |           |     |x|  7
    |            x x x x          | ... |           | ... |x|  8 sc
    |            x x x x          |     |           |     |x|  9
    |            x x x x x x x    |     |           |     |x| 10
    |                  x x x x    |     |           |     |x| 11
    |                  x x x x    |     |           |     |x| 12
    |                  x x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[10];

    // sc-row-3 = sc-row-3 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[10] = 1;
#endif

    sc_to_sc_matrix[11] /= pivot;

    sc_g_matrix[2] /= pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 M M M                      |     |           |     |M|  1
    |0 1 M M                      |     |           |     |M|  2
    |0 0 1 M                      |     |           |     |M|  3
    |x x x x x x x                |     |           |     |x|  4
    |      x x x x                |     |           |     |x|  5
    |      x x x x                |     |           |     |x|  6
    |      x x x x x x x          |     |           |     |x|  7
    |            x x x x          | ... |           | ... |x|  8 sc
    |            x x x x          |     |           |     |x|  9
    |            x x x x x x x    |     |           |     |x| 10
    |                  x x x x    |     |           |     |x| 11
    |                  x x x x    |     |           |     |x| 12
    |                  x x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 4
     *
     */

    pivot = sc_to_sc_matrix[12];

    // sc-row-4 = sc-row-4 - sc-row-1 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[12] = 0;
#endif

    sc_to_sc_matrix[13] -= sc_to_sc_matrix[1] * pivot;
    sc_to_sc_matrix[14] -= sc_to_sc_matrix[2] * pivot;
    sc_to_sc_matrix[15] -= sc_to_sc_matrix[3] * pivot;

    sc_g_matrix[3] -= sc_g_matrix[0] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 M M M                      |     |           |     |M|  1
    |0 1 M M                      |     |           |     |M|  2
    |0 0 1 M                      |     |           |     |M|  3
    |0 M M M x x x                |     |           |     |M|  4
    |      x x x x                |     |           |     |x|  5
    |      x x x x                |     |           |     |x|  6
    |      x x x x x x x          |     |           |     |x|  7
    |            x x x x          | ... |           | ... |x|  8 sc
    |            x x x x          |     |           |     |x|  9
    |            x x x x x x x    |     |           |     |x| 10
    |                  x x x x    |     |           |     |x| 11
    |                  x x x x    |     |           |     |x| 12
    |                  x x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[13];

    // sc-row-4 = sc-row-4 - sc-row-2 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[13] = 0;
#endif

    sc_to_sc_matrix[14] -= sc_to_sc_matrix[6] * pivot;
    sc_to_sc_matrix[15] -= sc_to_sc_matrix[7] * pivot;

    sc_g_matrix[3] -= sc_g_matrix[1] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 M M M                      |     |           |     |M|  1
    |0 1 M M                      |     |           |     |M|  2
    |0 0 1 M                      |     |           |     |M|  3
    |0 0 M M x x x                |     |           |     |M|  4
    |      x x x x                |     |           |     |x|  5
    |      x x x x                |     |           |     |x|  6
    |      x x x x x x x          |     |           |     |x|  7
    |            x x x x          | ... |           | ... |x|  8 sc
    |            x x x x          |     |           |     |x|  9
    |            x x x x x x x    |     |           |     |x| 10
    |                  x x x x    |     |           |     |x| 11
    |                  x x x x    |     |           |     |x| 12
    |                  x x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[14];

    // sc-row-4 = sc-row-4 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[14] = 0;
#endif

    sc_to_sc_matrix[15] -= sc_to_sc_matrix[11] * pivot;

    sc_g_matrix[3] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 M M M                      |     |           |     |M|  1
    |0 1 M M                      |     |           |     |M|  2
    |0 0 1 M                      |     |           |     |M|  3
    |0 0 0 M x x x                |     |           |     |M|  4
    |      x x x x                |     |           |     |x|  5
    |      x x x x                |     |           |     |x|  6
    |      x x x x x x x          |     |           |     |x|  7
    |            x x x x          | ... |           | ... |x|  8 sc
    |            x x x x          |     |           |     |x|  9
    |            x x x x x x x    |     |           |     |x| 10
    |                  x x x x    |     |           |     |x| 11
    |                  x x x x    |     |           |     |x| 12
    |                  x x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[15];

    // sc-row-4 = sc-row-4 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[15] = 1;
#endif

    sc_to_sc_matrix[16] /= pivot;
    sc_to_sc_matrix[17] /= pivot;
    sc_to_sc_matrix[18] /= pivot;

    sc_g_matrix[3] /= pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 M M M                      |     |           |     |M|  1
    |0 1 M M                      |     |           |     |M|  2
    |0 0 1 M                      |     |           |     |M|  3
    |0 0 0 1 M M M                |     |           |     |M|  4
    |      x x x x                |     |           |     |x|  5
    |      x x x x                |     |           |     |x|  6
    |      x x x x x x x          |     |           |     |x|  7
    |            x x x x          | ... |           | ... |x|  8 sc
    |            x x x x          |     |           |     |x|  9
    |            x x x x x x x    |     |           |     |x| 10
    |                  x x x x    |     |           |     |x| 11
    |                  x x x x    |     |           |     |x| 12
    |                  x x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 5
     *
     */

    pivot = sc_to_sc_matrix[19];

    // sc-row-5 = sc-row-5 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[19] = 0;
#endif

    sc_to_sc_matrix[20] -= sc_to_sc_matrix[16] * pivot;
    sc_to_sc_matrix[21] -= sc_to_sc_matrix[17] * pivot;
    sc_to_sc_matrix[22] -= sc_to_sc_matrix[18] * pivot;

    sc_g_matrix[4] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 M M M                      |     |           |     |M|  1
    |0 1 M M                      |     |           |     |M|  2
    |0 0 1 M                      |     |           |     |M|  3
    |0 0 0 1 M M M                |     |           |     |M|  4
    |      0 M M M                |     |           |     |M|  5
    |      x x x x                |     |           |     |x|  6
    |      x x x x x x x          |     |           |     |x|  7
    |            x x x x          | ... |           | ... |x|  8 sc
    |            x x x x          |     |           |     |x|  9
    |            x x x x x x x    |     |           |     |x| 10
    |                  x x x x    |     |           |     |x| 11
    |                  x x x x    |     |           |     |x| 12
    |                  x x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[20];

    // sc-row-5 = sc-row-5 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[20] = 1;
#endif

    sc_to_sc_matrix[21] /= pivot;
    sc_to_sc_matrix[22] /= pivot;

    sc_g_matrix[4] /= pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 M M M                      |     |           |     |M|  1
    |0 1 M M                      |     |           |     |M|  2
    |0 0 1 M                      |     |           |     |M|  3
    |0 0 0 1 M M M                |     |           |     |M|  4
    |      0 1 M M                |     |           |     |M|  5
    |      x x x x                |     |           |     |x|  6
    |      x x x x x x x          |     |           |     |x|  7
    |            x x x x          | ... |           | ... |x|  8 sc
    |            x x x x          |     |           |     |x|  9
    |            x x x x x x x    |     |           |     |x| 10
    |                  x x x x    |     |           |     |x| 11
    |                  x x x x    |     |           |     |x| 12
    |                  x x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 6
     *
     */

    pivot = sc_to_sc_matrix[23];

    // sc-row-6 = sc-row-6 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[23] = 0;
#endif

    sc_to_sc_matrix[24] -= sc_to_sc_matrix[16] * pivot;
    sc_to_sc_matrix[25] -= sc_to_sc_matrix[17] * pivot;
    sc_to_sc_matrix[26] -= sc_to_sc_matrix[18] * pivot;

    sc_g_matrix[5] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 M M M                      |     |           |     |M|  1
    |0 1 M M                      |     |           |     |M|  2
    |0 0 1 M                      |     |           |     |M|  3
    |0 0 0 1 M M M                |     |           |     |M|  4
    |      0 1 M M                |     |           |     |M|  5
    |      0 M M M                |     |           |     |M|  6
    |      x x x x x x x          |     |           |     |x|  7
    |            x x x x          | ... |           | ... |x|  8 sc
    |            x x x x          |     |           |     |x|  9
    |            x x x x x x x    |     |           |     |x| 10
    |                  x x x x    |     |           |     |x| 11
    |                  x x x x    |     |           |     |x| 12
    |                  x x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[24];

    // sc-row-6 = sc-row-6 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[24] = 0;
#endif

    sc_to_sc_matrix[25] -= sc_to_sc_matrix[21] * pivot;
    sc_to_sc_matrix[26] -= sc_to_sc_matrix[22] * pivot;

    sc_g_matrix[5] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 M M M                      |     |           |     |M|  1
    |0 1 M M                      |     |           |     |M|  2
    |0 0 1 M                      |     |           |     |M|  3
    |0 0 0 1 M M M                |     |           |     |M|  4
    |      0 1 M M                |     |           |     |M|  5
    |      0 0 M M                |     |           |     |M|  6
    |      x x x x x x x          |     |           |     |x|  7
    |            x x x x          | ... |           | ... |x|  8 sc
    |            x x x x          |     |           |     |x|  9
    |            x x x x x x x    |     |           |     |x| 10
    |                  x x x x    |     |           |     |x| 11
    |                  x x x x    |     |           |     |x| 12
    |                  x x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[25];

    // sc-row-6 = sc-row-6 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[25] = 1;
#endif

    sc_to_sc_matrix[26] /= pivot;

    sc_g_matrix[5] /= pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 M M M                      |     |           |     |M|  1
    |0 1 M M                      |     |           |     |M|  2
    |0 0 1 M                      |     |           |     |M|  3
    |0 0 0 1 M M M                |     |           |     |M|  4
    |      0 1 M M                |     |           |     |M|  5
    |      0 0 1 M                |     |           |     |M|  6
    |      x x x x x x x          |     |           |     |x|  7
    |            x x x x          | ... |           | ... |x|  8 sc
    |            x x x x          |     |           |     |x|  9
    |            x x x x x x x    |     |           |     |x| 10
    |                  x x x x    |     |           |     |x| 11
    |                  x x x x    |     |           |     |x| 12
    |                  x x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 7
     *
     */

    pivot = sc_to_sc_matrix[27];

    // sc-row-7 = sc-row-7 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[27] = 0;
#endif

    sc_to_sc_matrix[28] -= sc_to_sc_matrix[16] * pivot;
    sc_to_sc_matrix[29] -= sc_to_sc_matrix[17] * pivot;
    sc_to_sc_matrix[30] -= sc_to_sc_matrix[18] * pivot;

    sc_g_matrix[6] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 M M M                      |     |           |     |M|  1
    |0 1 M M                      |     |           |     |M|  2
    |0 0 1 M                      |     |           |     |M|  3
    |0 0 0 1 M M M                |     |           |     |M|  4
    |      0 1 M M                |     |           |     |M|  5
    |      0 0 1 M                |     |           |     |M|  6
    |      0 M M M x x x          |     |           |     |M|  7
    |            x x x x          | ... |           | ... |x|  8 sc
    |            x x x x          |     |           |     |x|  9
    |            x x x x x x x    |     |           |     |x| 10
    |                  x x x x    |     |           |     |x| 11
    |                  x x x x    |     |           |     |x| 12
    |                  x x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[28];

    // sc-row-7 = sc-row-7 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[28] = 0;
#endif

    sc_to_sc_matrix[29] -= sc_to_sc_matrix[21] * pivot;
    sc_to_sc_matrix[30] -= sc_to_sc_matrix[22] * pivot;

    sc_g_matrix[6] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 M M M                      |     |           |     |M|  1
    |0 1 M M                      |     |           |     |M|  2
    |0 0 1 M                      |     |           |     |M|  3
    |0 0 0 1 M M M                |     |           |     |M|  4
    |      0 1 M M                |     |           |     |M|  5
    |      0 0 1 M                |     |           |     |M|  6
    |      0 0 M M x x x          |     |           |     |M|  7
    |            x x x x          | ... |           | ... |x|  8 sc
    |            x x x x          |     |           |     |x|  9
    |            x x x x x x x    |     |           |     |x| 10
    |                  x x x x    |     |           |     |x| 11
    |                  x x x x    |     |           |     |x| 12
    |                  x x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[29];

    // sc-row-7 = sc-row-7 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[29] = 0;
#endif

    sc_to_sc_matrix[30] -= sc_to_sc_matrix[26] * pivot;

    sc_g_matrix[6] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 M M M                      |     |           |     |M|  1
    |0 1 M M                      |     |           |     |M|  2
    |0 0 1 M                      |     |           |     |M|  3
    |0 0 0 1 M M M                |     |           |     |M|  4
    |      0 1 M M                |     |           |     |M|  5
    |      0 0 1 M                |     |           |     |M|  6
    |      0 0 0 M x x x          |     |           |     |M|  7
    |            x x x x          | ... |           | ... |x|  8 sc
    |            x x x x          |     |           |     |x|  9
    |            x x x x x x x    |     |           |     |x| 10
    |                  x x x x    |     |           |     |x| 11
    |                  x x x x    |     |           |     |x| 12
    |                  x x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[30];

    // sc-row-7 = sc-row-7 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[30] = 1;
#endif

    sc_to_sc_matrix[31] /= pivot;
    sc_to_sc_matrix[32] /= pivot;
    sc_to_sc_matrix[33] /= pivot;

    sc_g_matrix[6] /= pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 M M M                      |     |           |     |M|  1
    |0 1 M M                      |     |           |     |M|  2
    |0 0 1 M                      |     |           |     |M|  3
    |0 0 0 1 M M M                |     |           |     |M|  4
    |      0 1 M M                |     |           |     |M|  5
    |      0 0 1 M                |     |           |     |M|  6
    |      0 0 0 1 M M M          |     |           |     |M|  7
    |            x x x x          | ... |           | ... |x|  8 sc
    |            x x x x          |     |           |     |x|  9
    |            x x x x x x x    |     |           |     |x| 10
    |                  x x x x    |     |           |     |x| 11
    |                  x x x x    |     |           |     |x| 12
    |                  x x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 8
     *
     */

    pivot = sc_to_sc_matrix[34];

    // sc-row-8 = sc-row-8 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[34] = 0;
#endif

    sc_to_sc_matrix[35] -= sc_to_sc_matrix[31] * pivot;
    sc_to_sc_matrix[36] -= sc_to_sc_matrix[32] * pivot;
    sc_to_sc_matrix[37] -= sc_to_sc_matrix[33] * pivot;

    sc_g_matrix[7] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 M M M                      |     |           |     |M|  1
    |0 1 M M                      |     |           |     |M|  2
    |0 0 1 M                      |     |           |     |M|  3
    |0 0 0 1 M M M                |     |           |     |M|  4
    |      0 1 M M                |     |           |     |M|  5
    |      0 0 1 M                |     |           |     |M|  6
    |      0 0 0 1 M M M          |     |           |     |M|  7
    |            0 M M M          | ... |           | ... |M|  8 sc
    |            x x x x          |     |           |     |x|  9
    |            x x x x x x x    |     |           |     |x| 10
    |                  x x x x    |     |           |     |x| 11
    |                  x x x x    |     |           |     |x| 12
    |                  x x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[35];

    // sc-row-8 = sc-row-8 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[35] = 1;
#endif

    sc_to_sc_matrix[36] /= pivot;
    sc_to_sc_matrix[37] /= pivot;

    sc_g_matrix[7] /= pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 M M M                      |     |           |     |M|  1
    |0 1 M M                      |     |           |     |M|  2
    |0 0 1 M                      |     |           |     |M|  3
    |0 0 0 1 M M M                |     |           |     |M|  4
    |      0 1 M M                |     |           |     |M|  5
    |      0 0 1 M                |     |           |     |M|  6
    |      0 0 0 1 M M M          |     |           |     |M|  7
    |            0 1 M M          | ... |           | ... |M|  8 sc
    |            x x x x          |     |           |     |x|  9
    |            x x x x x x x    |     |           |     |x| 10
    |                  x x x x    |     |           |     |x| 11
    |                  x x x x    |     |           |     |x| 12
    |                  x x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 9
     *
     */

    pivot = sc_to_sc_matrix[38];

    // sc-row-9 = sc-row-9 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[38] = 0;
#endif

    sc_to_sc_matrix[39] -= sc_to_sc_matrix[31] * pivot;
    sc_to_sc_matrix[40] -= sc_to_sc_matrix[32] * pivot;
    sc_to_sc_matrix[41] -= sc_to_sc_matrix[33] * pivot;

    sc_g_matrix[8] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 M M M                      |     |           |     |M|  1
    |0 1 M M                      |     |           |     |M|  2
    |0 0 1 M                      |     |           |     |M|  3
    |0 0 0 1 M M M                |     |           |     |M|  4
    |      0 1 M M                |     |           |     |M|  5
    |      0 0 1 M                |     |           |     |M|  6
    |      0 0 0 1 M M M          |     |           |     |M|  7
    |            0 1 M M          | ... |           | ... |M|  8 sc
    |            0 M M M          |     |           |     |M|  9
    |            x x x x x x x    |     |           |     |x| 10
    |                  x x x x    |     |           |     |x| 11
    |                  x x x x    |     |           |     |x| 12
    |                  x x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[39];

    // sc-row-9 = sc-row-9 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[39] = 0;
#endif

    sc_to_sc_matrix[40] -= sc_to_sc_matrix[36] * pivot;
    sc_to_sc_matrix[41] -= sc_to_sc_matrix[37] * pivot;

    sc_g_matrix[8] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 M M M                      |     |           |     |M|  1
    |0 1 M M                      |     |           |     |M|  2
    |0 0 1 M                      |     |           |     |M|  3
    |0 0 0 1 M M M                |     |           |     |M|  4
    |      0 1 M M                |     |           |     |M|  5
    |      0 0 1 M                |     |           |     |M|  6
    |      0 0 0 1 M M M          |     |           |     |M|  7
    |            0 1 M M          | ... |           | ... |M|  8 sc
    |            0 0 M M          |     |           |     |M|  9
    |            x x x x x x x    |     |           |     |x| 10
    |                  x x x x    |     |           |     |x| 11
    |                  x x x x    |     |           |     |x| 12
    |                  x x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[40];

    // sc-row-9 = sc-row-9 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[40] = 1;
#endif

    sc_to_sc_matrix[41] /= pivot;

    sc_g_matrix[8] /= pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 M M M                      |     |           |     |M|  1
    |0 1 M M                      |     |           |     |M|  2
    |0 0 1 M                      |     |           |     |M|  3
    |0 0 0 1 M M M                |     |           |     |M|  4
    |      0 1 M M                |     |           |     |M|  5
    |      0 0 1 M                |     |           |     |M|  6
    |      0 0 0 1 M M M          |     |           |     |M|  7
    |            0 1 M M          | ... |           | ... |M|  8 sc
    |            0 0 1 M          |     |           |     |M|  9
    |            x x x x x x x    |     |           |     |x| 10
    |                  x x x x    |     |           |     |x| 11
    |                  x x x x    |     |           |     |x| 12
    |                  x x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 10
     *
     */

    pivot = sc_to_sc_matrix[42];

    // sc-row-10 = sc-row-10 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[42] = 0;
#endif

    sc_to_sc_matrix[43] -= sc_to_sc_matrix[31] * pivot;
    sc_to_sc_matrix[44] -= sc_to_sc_matrix[32] * pivot;
    sc_to_sc_matrix[45] -= sc_to_sc_matrix[33] * pivot;

    sc_g_matrix[9] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 M M M                      |     |           |     |M|  1
    |0 1 M M                      |     |           |     |M|  2
    |0 0 1 M                      |     |           |     |M|  3
    |0 0 0 1 M M M                |     |           |     |M|  4
    |      0 1 M M                |     |           |     |M|  5
    |      0 0 1 M                |     |           |     |M|  6
    |      0 0 0 1 M M M          |     |           |     |M|  7
    |            0 1 M M          | ... |           | ... |M|  8 sc
    |            0 0 1 M          |     |           |     |M|  9
    |            0 M M M x x x    |     |           |     |M| 10
    |                  x x x x    |     |           |     |x| 11
    |                  x x x x    |     |           |     |x| 12
    |                  x x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[43];

    // sc-row-10 = sc-row-10 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[43] = 0;
#endif

    sc_to_sc_matrix[44] -= sc_to_sc_matrix[36] * pivot;
    sc_to_sc_matrix[45] -= sc_to_sc_matrix[37] * pivot;

    sc_g_matrix[9] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 M M M                      |     |           |     |M|  1
    |0 1 M M                      |     |           |     |M|  2
    |0 0 1 M                      |     |           |     |M|  3
    |0 0 0 1 M M M                |     |           |     |M|  4
    |      0 1 M M                |     |           |     |M|  5
    |      0 0 1 M                |     |           |     |M|  6
    |      0 0 0 1 M M M          |     |           |     |M|  7
    |            0 1 M M          | ... |           | ... |M|  8 sc
    |            0 0 1 M          |     |           |     |M|  9
    |            0 0 M M x x x    |     |           |     |M| 10
    |                  x x x x    |     |           |     |x| 11
    |                  x x x x    |     |           |     |x| 12
    |                  x x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[44];

    // sc-row-10 = sc-row-10 - sc-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[44] = 0;
#endif

    sc_to_sc_matrix[45] -= sc_to_sc_matrix[41] * pivot;

    sc_g_matrix[9] -= sc_g_matrix[8] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 M M M                      |     |           |     |M|  1
    |0 1 M M                      |     |           |     |M|  2
    |0 0 1 M                      |     |           |     |M|  3
    |0 0 0 1 M M M                |     |           |     |M|  4
    |      0 1 M M                |     |           |     |M|  5
    |      0 0 1 M                |     |           |     |M|  6
    |      0 0 0 1 M M M          |     |           |     |M|  7
    |            0 1 M M          | ... |           | ... |M|  8 sc
    |            0 0 1 M          |     |           |     |M|  9
    |            0 0 0 M x x x    |     |           |     |M| 10
    |                  x x x x    |     |           |     |x| 11
    |                  x x x x    |     |           |     |x| 12
    |                  x x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[45];

    // sc-row-10 = sc-row-10 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[45] = 1;
#endif

    sc_to_sc_matrix[46] /= pivot;
    sc_to_sc_matrix[47] /= pivot;
    sc_to_sc_matrix[48] /= pivot;

    sc_g_matrix[9] /= pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 M M M                      |     |           |     |M|  1
    |0 1 M M                      |     |           |     |M|  2
    |0 0 1 M                      |     |           |     |M|  3
    |0 0 0 1 M M M                |     |           |     |M|  4
    |      0 1 M M                |     |           |     |M|  5
    |      0 0 1 M                |     |           |     |M|  6
    |      0 0 0 1 M M M          |     |           |     |M|  7
    |            0 1 M M          | ... |           | ... |M|  8 sc
    |            0 0 1 M          |     |           |     |M|  9
    |            0 0 0 1 M M M    |     |           |     |M| 10
    |                  x x x x    |     |           |     |x| 11
    |                  x x x x    |     |           |     |x| 12
    |                  x x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 11
     *
     */

    pivot = sc_to_sc_matrix[49];

    // sc-row-11 = sc-row-11 - sc-row-10 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[49] = 0;
#endif

    sc_to_sc_matrix[50] -= sc_to_sc_matrix[46] * pivot;
    sc_to_sc_matrix[51] -= sc_to_sc_matrix[47] * pivot;
    sc_to_sc_matrix[52] -= sc_to_sc_matrix[48] * pivot;

    sc_g_matrix[10] -= sc_g_matrix[9] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 M M M                      |     |           |     |M|  1
    |0 1 M M                      |     |           |     |M|  2
    |0 0 1 M                      |     |           |     |M|  3
    |0 0 0 1 M M M                |     |           |     |M|  4
    |      0 1 M M                |     |           |     |M|  5
    |      0 0 1 M                |     |           |     |M|  6
    |      0 0 0 1 M M M          |     |           |     |M|  7
    |            0 1 M M          | ... |           | ... |M|  8 sc
    |            0 0 1 M          |     |           |     |M|  9
    |            0 0 0 1 M M M    |     |           |     |M| 10
    |                  0 M M M    |     |           |     |M| 11
    |                  x x x x    |     |           |     |x| 12
    |                  x x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[50];

    // sc-row-11 = sc-row-11 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[50] = 1;
#endif

    sc_to_sc_matrix[51] /= pivot;
    sc_to_sc_matrix[52] /= pivot;

    sc_g_matrix[10] /= pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 M M M                      |     |           |     |M|  1
    |0 1 M M                      |     |           |     |M|  2
    |0 0 1 M                      |     |           |     |M|  3
    |0 0 0 1 M M M                |     |           |     |M|  4
    |      0 1 M M                |     |           |     |M|  5
    |      0 0 1 M                |     |           |     |M|  6
    |      0 0 0 1 M M M          |     |           |     |M|  7
    |            0 1 M M          | ... |           | ... |M|  8 sc
    |            0 0 1 M          |     |           |     |M|  9
    |            0 0 0 1 M M M    |     |           |     |M| 10
    |                  0 1 M M    |     |           |     |M| 11
    |                  x x x x    |     |           |     |x| 12
    |                  x x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 12
     *
     */

    pivot = sc_to_sc_matrix[53];

    // sc-row-12 = sc-row-12 - sc-row-10 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[53] = 0;
#endif

    sc_to_sc_matrix[54] -= sc_to_sc_matrix[46] * pivot;
    sc_to_sc_matrix[55] -= sc_to_sc_matrix[47] * pivot;
    sc_to_sc_matrix[56] -= sc_to_sc_matrix[48] * pivot;

    sc_g_matrix[11] -= sc_g_matrix[9] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 M M M                      |     |           |     |M|  1
    |0 1 M M                      |     |           |     |M|  2
    |0 0 1 M                      |     |           |     |M|  3
    |0 0 0 1 M M M                |     |           |     |M|  4
    |      0 1 M M                |     |           |     |M|  5
    |      0 0 1 M                |     |           |     |M|  6
    |      0 0 0 1 M M M          |     |           |     |M|  7
    |            0 1 M M          | ... |           | ... |M|  8 sc
    |            0 0 1 M          |     |           |     |M|  9
    |            0 0 0 1 M M M    |     |           |     |M| 10
    |                  0 1 M M    |     |           |     |M| 11
    |                  0 M M M    |     |           |     |M| 12
    |                  x x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[54];

    // sc-row-12 = sc-row-12 - sc-row-11 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[54] = 0;
#endif

    sc_to_sc_matrix[55] -= sc_to_sc_matrix[51] * pivot;
    sc_to_sc_matrix[56] -= sc_to_sc_matrix[52] * pivot;

    sc_g_matrix[11] -= sc_g_matrix[10] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 M M M                      |     |           |     |M|  1
    |0 1 M M                      |     |           |     |M|  2
    |0 0 1 M                      |     |           |     |M|  3
    |0 0 0 1 M M M                |     |           |     |M|  4
    |      0 1 M M                |     |           |     |M|  5
    |      0 0 1 M                |     |           |     |M|  6
    |      0 0 0 1 M M M          |     |           |     |M|  7
    |            0 1 M M          | ... |           | ... |M|  8 sc
    |            0 0 1 M          |     |           |     |M|  9
    |            0 0 0 1 M M M    |     |           |     |M| 10
    |                  0 1 M M    |     |           |     |M| 11
    |                  0 0 M M    |     |           |     |M| 12
    |                  x x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[55];

    // sc-row-12 = sc-row-12 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[55] = 1;
#endif

    sc_to_sc_matrix[56] /= pivot;

    sc_g_matrix[11] /= pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 M M M                      |     |           |     |M|  1
    |0 1 M M                      |     |           |     |M|  2
    |0 0 1 M                      |     |           |     |M|  3
    |0 0 0 1 M M M                |     |           |     |M|  4
    |      0 1 M M                |     |           |     |M|  5
    |      0 0 1 M                |     |           |     |M|  6
    |      0 0 0 1 M M M          |     |           |     |M|  7
    |            0 1 M M          | ... |           | ... |M|  8 sc
    |            0 0 1 M          |     |           |     |M|  9
    |            0 0 0 1 M M M    |     |           |     |M| 10
    |                  0 1 M M    |     |           |     |M| 11
    |                  0 0 1 M    |     |           |     |M| 12
    |                  x x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 13
     *
     */

    pivot = sc_to_sc_matrix[57];

    // sc-row-13 = sc-row-13 - sc-row-10 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[57] = 0;
#endif

    sc_to_sc_matrix[58] -= sc_to_sc_matrix[46] * pivot;
    sc_to_sc_matrix[59] -= sc_to_sc_matrix[47] * pivot;
    sc_to_sc_matrix[60] -= sc_to_sc_matrix[48] * pivot;

    sc_g_matrix[12] -= sc_g_matrix[9] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 M M M                      |     |           |     |M|  1
    |0 1 M M                      |     |           |     |M|  2
    |0 0 1 M                      |     |           |     |M|  3
    |0 0 0 1 M M M                |     |           |     |M|  4
    |      0 1 M M                |     |           |     |M|  5
    |      0 0 1 M                |     |           |     |M|  6
    |      0 0 0 1 M M M          |     |           |     |M|  7
    |            0 1 M M          | ... |           | ... |M|  8 sc
    |            0 0 1 M          |     |           |     |M|  9
    |            0 0 0 1 M M M    |     |           |     |M| 10
    |                  0 1 M M    |     |           |     |M| 11
    |                  0 0 1 M    |     |           |     |M| 12
    |                  0 M M M x x|     |      x    |     |M| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[58];

    // sc-row-13 = sc-row-13 - sc-row-11 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[58] = 0;
#endif

    sc_to_sc_matrix[59] -= sc_to_sc_matrix[51] * pivot;
    sc_to_sc_matrix[60] -= sc_to_sc_matrix[52] * pivot;

    sc_g_matrix[12] -= sc_g_matrix[10] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 M M M                      |     |           |     |M|  1
    |0 1 M M                      |     |           |     |M|  2
    |0 0 1 M                      |     |           |     |M|  3
    |0 0 0 1 M M M                |     |           |     |M|  4
    |      0 1 M M                |     |           |     |M|  5
    |      0 0 1 M                |     |           |     |M|  6
    |      0 0 0 1 M M M          |     |           |     |M|  7
    |            0 1 M M          | ... |           | ... |M|  8 sc
    |            0 0 1 M          |     |           |     |M|  9
    |            0 0 0 1 M M M    |     |           |     |M| 10
    |                  0 1 M M    |     |           |     |M| 11
    |                  0 0 1 M    |     |           |     |M| 12
    |                  0 0 M M x x|     |      x    |     |M| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[59];

    // sc-row-13 = sc-row-13 - sc-row-12 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[59] = 0;
#endif

    sc_to_sc_matrix[60] -= sc_to_sc_matrix[56] * pivot;

    sc_g_matrix[12] -= sc_g_matrix[11] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 M M M                      |     |           |     |M|  1
    |0 1 M M                      |     |           |     |M|  2
    |0 0 1 M                      |     |           |     |M|  3
    |0 0 0 1 M M M                |     |           |     |M|  4
    |      0 1 M M                |     |           |     |M|  5
    |      0 0 1 M                |     |           |     |M|  6
    |      0 0 0 1 M M M          |     |           |     |M|  7
    |            0 1 M M          | ... |           | ... |M|  8 sc
    |            0 0 1 M          |     |           |     |M|  9
    |            0 0 0 1 M M M    |     |           |     |M| 10
    |                  0 1 M M    |     |           |     |M| 11
    |                  0 0 1 M    |     |           |     |M| 12
    |                  0 0 0 M x x|     |      x    |     |M| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[60];

    // sc-row-13 = sc-row-13 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[60] = 1;
#endif

    sc_to_sc_matrix[61] /= pivot;
    sc_to_sc_matrix[62] /= pivot;

    sc_to_bb_matrix[0] /= pivot;

    sc_g_matrix[12] /= pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 M M M                      |     |           |     |M|  1
    |0 1 M M                      |     |           |     |M|  2
    |0 0 1 M                      |     |           |     |M|  3
    |0 0 0 1 M M M                |     |           |     |M|  4
    |      0 1 M M                |     |           |     |M|  5
    |      0 0 1 M                |     |           |     |M|  6
    |      0 0 0 1 M M M          |     |           |     |M|  7
    |            0 1 M M          | ... |           | ... |M|  8 sc
    |            0 0 1 M          |     |           |     |M|  9
    |            0 0 0 1 M M M    |     |           |     |M| 10
    |                  0 1 M M    |     |           |     |M| 11
    |                  0 0 1 M    |     |           |     |M| 12
    |                  0 0 0 1 M M|     |      M    |     |M| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 14
     *
     */

    pivot = sc_to_sc_matrix[63];

    // sc-row-14 = sc-row-14 - sc-row-13 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[63] = 0;
#endif

    sc_to_sc_matrix[64] -= sc_to_sc_matrix[61] * pivot;
    sc_to_sc_matrix[65] -= sc_to_sc_matrix[62] * pivot;

    sc_to_bb_matrix[1] -= sc_to_bb_matrix[0] * pivot;

    sc_g_matrix[13] -= sc_g_matrix[12] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 M M M                      |     |           |     |M|  1
    |0 1 M M                      |     |           |     |M|  2
    |0 0 1 M                      |     |           |     |M|  3
    |0 0 0 1 M M M                |     |           |     |M|  4
    |      0 1 M M                |     |           |     |M|  5
    |      0 0 1 M                |     |           |     |M|  6
    |      0 0 0 1 M M M          |     |           |     |M|  7
    |            0 1 M M          | ... |           | ... |M|  8 sc
    |            0 0 1 M          |     |           |     |M|  9
    |            0 0 0 1 M M M    |     |           |     |M| 10
    |                  0 1 M M    |     |           |     |M| 11
    |                  0 0 1 M    |     |           |     |M| 12
    |                  0 0 0 1 M M|     |      M    |     |M| 13
    |                        0 M M|     |      M    |     |M| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[64];

    // sc-row-14 = sc-row-14 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[64] = 1;
#endif

    sc_to_sc_matrix[65] /= pivot;

    sc_to_bb_matrix[1] /= pivot;

    sc_g_matrix[13] /= pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 M M M                      |     |           |     |M|  1
    |0 1 M M                      |     |           |     |M|  2
    |0 0 1 M                      |     |           |     |M|  3
    |0 0 0 1 M M M                |     |           |     |M|  4
    |      0 1 M M                |     |           |     |M|  5
    |      0 0 1 M                |     |           |     |M|  6
    |      0 0 0 1 M M M          |     |           |     |M|  7
    |            0 1 M M          | ... |           | ... |M|  8 sc
    |            0 0 1 M          |     |           |     |M|  9
    |            0 0 0 1 M M M    |     |           |     |M| 10
    |                  0 1 M M    |     |           |     |M| 11
    |                  0 0 1 M    |     |           |     |M| 12
    |                  0 0 0 1 M M|     |      M    |     |M| 13
    |                        0 1 M|     |      M    |     |M| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 15
     *
     */

    pivot = sc_to_sc_matrix[66];

    // sc-row-15 = sc-row-15 - sc-row-13 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[66] = 0;
#endif

    sc_to_sc_matrix[67] -= sc_to_sc_matrix[61] * pivot;
    sc_to_sc_matrix[68] -= sc_to_sc_matrix[62] * pivot;

    sc_to_bb_matrix[2] -= sc_to_bb_matrix[0] * pivot;

    sc_g_matrix[14] -= sc_g_matrix[12] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 M M M                      |     |           |     |M|  1
    |0 1 M M                      |     |           |     |M|  2
    |0 0 1 M                      |     |           |     |M|  3
    |0 0 0 1 M M M                |     |           |     |M|  4
    |      0 1 M M                |     |           |     |M|  5
    |      0 0 1 M                |     |           |     |M|  6
    |      0 0 0 1 M M M          |     |           |     |M|  7
    |            0 1 M M          | ... |           | ... |M|  8 sc
    |            0 0 1 M          |     |           |     |M|  9
    |            0 0 0 1 M M M    |     |           |     |M| 10
    |                  0 1 M M    |     |           |     |M| 11
    |                  0 0 1 M    |     |           |     |M| 12
    |                  0 0 0 1 M M|     |      M    |     |M| 13
    |                        0 1 M|     |      M    |     |M| 14
    |                        0 M M|     |      M    |     |M| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[67];

    // sc-row-15 = sc-row-15 - sc-row-14 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[67] = 0;
#endif

    sc_to_sc_matrix[68] -= sc_to_sc_matrix[65] * pivot;

    sc_to_bb_matrix[2] -= sc_to_bb_matrix[1] * pivot;

    sc_g_matrix[14] -= sc_g_matrix[13] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 M M M                      |     |           |     |M|  1
    |0 1 M M                      |     |           |     |M|  2
    |0 0 1 M                      |     |           |     |M|  3
    |0 0 0 1 M M M                |     |           |     |M|  4
    |      0 1 M M                |     |           |     |M|  5
    |      0 0 1 M                |     |           |     |M|  6
    |      0 0 0 1 M M M          |     |           |     |M|  7
    |            0 1 M M          | ... |           | ... |M|  8 sc
    |            0 0 1 M          |     |           |     |M|  9
    |            0 0 0 1 M M M    |     |           |     |M| 10
    |                  0 1 M M    |     |           |     |M| 11
    |                  0 0 1 M    |     |           |     |M| 12
    |                  0 0 0 1 M M|     |      M    |     |M| 13
    |                        0 1 M|     |      M    |     |M| 14
    |                        0 0 M|     |      M    |     |M| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[68];

    // sc-row-15 = sc-row-15 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[68] = 1;
#endif

    sc_to_bb_matrix[2] /= pivot;

    sc_g_matrix[14] /= pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 M M M                      |     |           |     |M|  1
    |0 1 M M                      |     |           |     |M|  2
    |0 0 1 M                      |     |           |     |M|  3
    |0 0 0 1 M M M                |     |           |     |M|  4
    |      0 1 M M                |     |           |     |M|  5
    |      0 0 1 M                |     |           |     |M|  6
    |      0 0 0 1 M M M          |     |           |     |M|  7
    |            0 1 M M          | ... |           | ... |M|  8 sc
    |            0 0 1 M          |     |           |     |M|  9
    |            0 0 0 1 M M M    |     |           |     |M| 10
    |                  0 1 M M    |     |           |     |M| 11
    |                  0 0 1 M    |     |           |     |M| 12
    |                  0 0 0 1 M M|     |      M    |     |M| 13
    |                        0 1 M|     |      M    |     |M| 14
    |                        0 0 1|     |      M    |     |M| 15
    -------------------------------     -------------
    */
}

void gmx::IlvesPC::solve_2_arginine(real *const sc_to_sc_matrix,
                                    real *const sc_to_bb_matrix,
                                    __attribute__((unused))
                                    real *const sc_to_sep_matrix,
                                    real *const sc_g_matrix,
                                    __attribute__((unused))
                                    real *const sc_to_sc_fillins,
                                    __attribute__((unused))
                                    real *const sc_to_bb_fillins) {
    /*
     *
     * Row 1
     *
     */

    real pivot = sc_to_sc_matrix[0];

    // sc-row-1 = sc-row-1 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[0] = 1;
#endif

    sc_to_sc_matrix[1] /= pivot;
    sc_to_sc_matrix[2] /= pivot;

    sc_g_matrix[0] /= pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 M M                            |     |           |     |M|  1
    |x x x                            |     |           |     |x|  2
    |x x x     x x                    |     |           |     |x|  3
    |      x x x                      |     |           |     |x|  4
    |      x x x                      |     |           |     |x|  5
    |    x x x x x                    |     |           |     |x|  6
    |    x     x x x x                |     |           |     |x|  7
    |            x x x                |     |           |     |x|  8
    |            x x x x x x          | ... |           | ... |x|  9 sc
    |                x x x x          |     |           |     |x| 10
    |                x x x x          |     |           |     |x| 11
    |                x x x x x x x    |     |           |     |x| 12
    |                      x x x x    |     |           |     |x| 13
    |                      x x x x    |     |           |     |x| 14
    |                      x x x x x x|     |      x    |     |x| 15
    |                            x x x|     |      x    |     |x| 16
    |                            x x x|     |      x    |     |x| 17
    -----------------------------------     -------------
    */

    /*
     *
     * Row 2
     *
     */

    pivot = sc_to_sc_matrix[3];

    // sc-row-2 = sc-row-2 - sc-row-1 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[3] = 0;
#endif

    sc_to_sc_matrix[4] -= sc_to_sc_matrix[1] * pivot;
    sc_to_sc_matrix[5] -= sc_to_sc_matrix[2] * pivot;

    sc_g_matrix[1] -= sc_g_matrix[0] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 M M                            |     |           |     |M|  1
    |0 M M                            |     |           |     |M|  2
    |x x x     x x                    |     |           |     |x|  3
    |      x x x                      |     |           |     |x|  4
    |      x x x                      |     |           |     |x|  5
    |    x x x x x                    |     |           |     |x|  6
    |    x     x x x x                |     |           |     |x|  7
    |            x x x                |     |           |     |x|  8
    |            x x x x x x          | ... |           | ... |x|  9 sc
    |                x x x x          |     |           |     |x| 10
    |                x x x x          |     |           |     |x| 11
    |                x x x x x x x    |     |           |     |x| 12
    |                      x x x x    |     |           |     |x| 13
    |                      x x x x    |     |           |     |x| 14
    |                      x x x x x x|     |      x    |     |x| 15
    |                            x x x|     |      x    |     |x| 16
    |                            x x x|     |      x    |     |x| 17
    -----------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[4];

    // sc-row-2 = sc-row-2 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[4] = 1;
#endif

    sc_to_sc_matrix[5] /= pivot;

    sc_g_matrix[1] /= pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 M M                            |     |           |     |M|  1
    |0 1 M                            |     |           |     |M|  2
    |x x x     x x                    |     |           |     |x|  3
    |      x x x                      |     |           |     |x|  4
    |      x x x                      |     |           |     |x|  5
    |    x x x x x                    |     |           |     |x|  6
    |    x     x x x x                |     |           |     |x|  7
    |            x x x                |     |           |     |x|  8
    |            x x x x x x          | ... |           | ... |x|  9 sc
    |                x x x x          |     |           |     |x| 10
    |                x x x x          |     |           |     |x| 11
    |                x x x x x x x    |     |           |     |x| 12
    |                      x x x x    |     |           |     |x| 13
    |                      x x x x    |     |           |     |x| 14
    |                      x x x x x x|     |      x    |     |x| 15
    |                            x x x|     |      x    |     |x| 16
    |                            x x x|     |      x    |     |x| 17
    -----------------------------------     -------------
    */

    /*
     *
     * Row 3
     *
     */

    pivot = sc_to_sc_matrix[6];

    // sc-row-3 = sc-row-3 - sc-row-1 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[6] = 0;
#endif

    sc_to_sc_matrix[7] -= sc_to_sc_matrix[1] * pivot;
    sc_to_sc_matrix[8] -= sc_to_sc_matrix[2] * pivot;

    sc_g_matrix[2] -= sc_g_matrix[0] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 M M                            |     |           |     |M|  1
    |0 1 M                            |     |           |     |M|  2
    |0 M M     x x                    |     |           |     |M|  3
    |      x x x                      |     |           |     |x|  4
    |      x x x                      |     |           |     |x|  5
    |    x x x x x                    |     |           |     |x|  6
    |    x     x x x x                |     |           |     |x|  7
    |            x x x                |     |           |     |x|  8
    |            x x x x x x          | ... |           | ... |x|  9 sc
    |                x x x x          |     |           |     |x| 10
    |                x x x x          |     |           |     |x| 11
    |                x x x x x x x    |     |           |     |x| 12
    |                      x x x x    |     |           |     |x| 13
    |                      x x x x    |     |           |     |x| 14
    |                      x x x x x x|     |      x    |     |x| 15
    |                            x x x|     |      x    |     |x| 16
    |                            x x x|     |      x    |     |x| 17
    -----------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[7];

    // sc-row-3 = sc-row-3 - sc-row-2 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[7] = 0;
#endif

    sc_to_sc_matrix[8] -= sc_to_sc_matrix[5] * pivot;

    sc_g_matrix[2] -= sc_g_matrix[1] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 M M                            |     |           |     |M|  1
    |0 1 M                            |     |           |     |M|  2
    |0 0 M     x x                    |     |           |     |M|  3
    |      x x x                      |     |           |     |x|  4
    |      x x x                      |     |           |     |x|  5
    |    x x x x x                    |     |           |     |x|  6
    |    x     x x x x                |     |           |     |x|  7
    |            x x x                |     |           |     |x|  8
    |            x x x x x x          | ... |           | ... |x|  9 sc
    |                x x x x          |     |           |     |x| 10
    |                x x x x          |     |           |     |x| 11
    |                x x x x x x x    |     |           |     |x| 12
    |                      x x x x    |     |           |     |x| 13
    |                      x x x x    |     |           |     |x| 14
    |                      x x x x x x|     |      x    |     |x| 15
    |                            x x x|     |      x    |     |x| 16
    |                            x x x|     |      x    |     |x| 17
    -----------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[8];

    // sc-row-3 = sc-row-3 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[8] = 1;
#endif

    sc_to_sc_matrix[9] /= pivot;
    sc_to_sc_matrix[10] /= pivot;

    sc_g_matrix[2] /= pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 M M                            |     |           |     |M|  1
    |0 1 M                            |     |           |     |M|  2
    |0 0 1     M M                    |     |           |     |M|  3
    |      x x x                      |     |           |     |x|  4
    |      x x x                      |     |           |     |x|  5
    |    x x x x x                    |     |           |     |x|  6
    |    x     x x x x                |     |           |     |x|  7
    |            x x x                |     |           |     |x|  8
    |            x x x x x x          | ... |           | ... |x|  9 sc
    |                x x x x          |     |           |     |x| 10
    |                x x x x          |     |           |     |x| 11
    |                x x x x x x x    |     |           |     |x| 12
    |                      x x x x    |     |           |     |x| 13
    |                      x x x x    |     |           |     |x| 14
    |                      x x x x x x|     |      x    |     |x| 15
    |                            x x x|     |      x    |     |x| 16
    |                            x x x|     |      x    |     |x| 17
    -----------------------------------     -------------
    */

    /*
     *
     * Row 4
     *
     */

    pivot = sc_to_sc_matrix[11];

    // sc-row-4 = sc-row-4 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[11] = 1;
#endif

    sc_to_sc_matrix[12] /= pivot;
    sc_to_sc_matrix[13] /= pivot;

    sc_g_matrix[3] /= pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 M M                            |     |           |     |M|  1
    |0 1 M                            |     |           |     |M|  2
    |0 0 1     M M                    |     |           |     |M|  3
    |      1 M M                      |     |           |     |M|  4
    |      x x x                      |     |           |     |x|  5
    |    x x x x x                    |     |           |     |x|  6
    |    x     x x x x                |     |           |     |x|  7
    |            x x x                |     |           |     |x|  8
    |            x x x x x x          | ... |           | ... |x|  9 sc
    |                x x x x          |     |           |     |x| 10
    |                x x x x          |     |           |     |x| 11
    |                x x x x x x x    |     |           |     |x| 12
    |                      x x x x    |     |           |     |x| 13
    |                      x x x x    |     |           |     |x| 14
    |                      x x x x x x|     |      x    |     |x| 15
    |                            x x x|     |      x    |     |x| 16
    |                            x x x|     |      x    |     |x| 17
    -----------------------------------     -------------
    */

    /*
     *
     * Row 5
     *
     */

    pivot = sc_to_sc_matrix[14];

    // sc-row-5 = sc-row-5 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[14] = 0;
#endif

    sc_to_sc_matrix[15] -= sc_to_sc_matrix[12] * pivot;
    sc_to_sc_matrix[16] -= sc_to_sc_matrix[13] * pivot;

    sc_g_matrix[4] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 M M                            |     |           |     |M|  1
    |0 1 M                            |     |           |     |M|  2
    |0 0 1     M M                    |     |           |     |M|  3
    |      1 M M                      |     |           |     |M|  4
    |      0 M M                      |     |           |     |M|  5
    |    x x x x x                    |     |           |     |x|  6
    |    x     x x x x                |     |           |     |x|  7
    |            x x x                |     |           |     |x|  8
    |            x x x x x x          | ... |           | ... |x|  9 sc
    |                x x x x          |     |           |     |x| 10
    |                x x x x          |     |           |     |x| 11
    |                x x x x x x x    |     |           |     |x| 12
    |                      x x x x    |     |           |     |x| 13
    |                      x x x x    |     |           |     |x| 14
    |                      x x x x x x|     |      x    |     |x| 15
    |                            x x x|     |      x    |     |x| 16
    |                            x x x|     |      x    |     |x| 17
    -----------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[15];

    // sc-row-5 = sc-row-5 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[15] = 1;
#endif

    sc_to_sc_matrix[16] /= pivot;

    sc_g_matrix[4] /= pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 M M                            |     |           |     |M|  1
    |0 1 M                            |     |           |     |M|  2
    |0 0 1     M M                    |     |           |     |M|  3
    |      1 M M                      |     |           |     |M|  4
    |      0 1 M                      |     |           |     |M|  5
    |    x x x x x                    |     |           |     |x|  6
    |    x     x x x x                |     |           |     |x|  7
    |            x x x                |     |           |     |x|  8
    |            x x x x x x          | ... |           | ... |x|  9 sc
    |                x x x x          |     |           |     |x| 10
    |                x x x x          |     |           |     |x| 11
    |                x x x x x x x    |     |           |     |x| 12
    |                      x x x x    |     |           |     |x| 13
    |                      x x x x    |     |           |     |x| 14
    |                      x x x x x x|     |      x    |     |x| 15
    |                            x x x|     |      x    |     |x| 16
    |                            x x x|     |      x    |     |x| 17
    -----------------------------------     -------------
    */

    /*
     *
     * Row 6
     *
     */

    pivot = sc_to_sc_matrix[17];

    // sc-row-6 = sc-row-6 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[17] = 0;
#endif

    sc_to_sc_matrix[20] -= sc_to_sc_matrix[9] * pivot;
    sc_to_sc_matrix[21] -= sc_to_sc_matrix[10] * pivot;

    sc_g_matrix[5] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 M M                            |     |           |     |M|  1
    |0 1 M                            |     |           |     |M|  2
    |0 0 1     M M                    |     |           |     |M|  3
    |      1 M M                      |     |           |     |M|  4
    |      0 1 M                      |     |           |     |M|  5
    |    0 x x M M                    |     |           |     |M|  6
    |    x     x x x x                |     |           |     |x|  7
    |            x x x                |     |           |     |x|  8
    |            x x x x x x          | ... |           | ... |x|  9 sc
    |                x x x x          |     |           |     |x| 10
    |                x x x x          |     |           |     |x| 11
    |                x x x x x x x    |     |           |     |x| 12
    |                      x x x x    |     |           |     |x| 13
    |                      x x x x    |     |           |     |x| 14
    |                      x x x x x x|     |      x    |     |x| 15
    |                            x x x|     |      x    |     |x| 16
    |                            x x x|     |      x    |     |x| 17
    -----------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[18];

    // sc-row-6 = sc-row-6 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[18] = 0;
#endif

    sc_to_sc_matrix[19] -= sc_to_sc_matrix[12] * pivot;
    sc_to_sc_matrix[20] -= sc_to_sc_matrix[13] * pivot;

    sc_g_matrix[5] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 M M                            |     |           |     |M|  1
    |0 1 M                            |     |           |     |M|  2
    |0 0 1     M M                    |     |           |     |M|  3
    |      1 M M                      |     |           |     |M|  4
    |      0 1 M                      |     |           |     |M|  5
    |    0 0 M M M                    |     |           |     |M|  6
    |    x     x x x x                |     |           |     |x|  7
    |            x x x                |     |           |     |x|  8
    |            x x x x x x          | ... |           | ... |x|  9 sc
    |                x x x x          |     |           |     |x| 10
    |                x x x x          |     |           |     |x| 11
    |                x x x x x x x    |     |           |     |x| 12
    |                      x x x x    |     |           |     |x| 13
    |                      x x x x    |     |           |     |x| 14
    |                      x x x x x x|     |      x    |     |x| 15
    |                            x x x|     |      x    |     |x| 16
    |                            x x x|     |      x    |     |x| 17
    -----------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[19];

    // sc-row-6 = sc-row-6 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[19] = 0;
#endif

    sc_to_sc_matrix[20] -= sc_to_sc_matrix[16] * pivot;

    sc_g_matrix[5] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 M M                            |     |           |     |M|  1
    |0 1 M                            |     |           |     |M|  2
    |0 0 1     M M                    |     |           |     |M|  3
    |      1 M M                      |     |           |     |M|  4
    |      0 1 M                      |     |           |     |M|  5
    |    0 0 0 M M                    |     |           |     |M|  6
    |    x     x x x x                |     |           |     |x|  7
    |            x x x                |     |           |     |x|  8
    |            x x x x x x          | ... |           | ... |x|  9 sc
    |                x x x x          |     |           |     |x| 10
    |                x x x x          |     |           |     |x| 11
    |                x x x x x x x    |     |           |     |x| 12
    |                      x x x x    |     |           |     |x| 13
    |                      x x x x    |     |           |     |x| 14
    |                      x x x x x x|     |      x    |     |x| 15
    |                            x x x|     |      x    |     |x| 16
    |                            x x x|     |      x    |     |x| 17
    -----------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[20];

    // sc-row-6 = sc-row-6 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[20] = 1;
#endif

    sc_to_sc_matrix[21] /= pivot;

    sc_g_matrix[5] /= pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 M M                            |     |           |     |M|  1
    |0 1 M                            |     |           |     |M|  2
    |0 0 1     M M                    |     |           |     |M|  3
    |      1 M M                      |     |           |     |M|  4
    |      0 1 M                      |     |           |     |M|  5
    |    0 0 0 1 M                    |     |           |     |M|  6
    |    x     x x x x                |     |           |     |x|  7
    |            x x x                |     |           |     |x|  8
    |            x x x x x x          | ... |           | ... |x|  9 sc
    |                x x x x          |     |           |     |x| 10
    |                x x x x          |     |           |     |x| 11
    |                x x x x x x x    |     |           |     |x| 12
    |                      x x x x    |     |           |     |x| 13
    |                      x x x x    |     |           |     |x| 14
    |                      x x x x x x|     |      x    |     |x| 15
    |                            x x x|     |      x    |     |x| 16
    |                            x x x|     |      x    |     |x| 17
    -----------------------------------     -------------
    */

    /*
     *
     * Row 7
     *
     */

    pivot = sc_to_sc_matrix[22];

    // sc-row-7 = sc-row-7 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[22] = 0;
#endif

    sc_to_sc_matrix[23] -= sc_to_sc_matrix[9] * pivot;
    sc_to_sc_matrix[24] -= sc_to_sc_matrix[10] * pivot;

    sc_g_matrix[6] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 M M                            |     |           |     |M|  1
    |0 1 M                            |     |           |     |M|  2
    |0 0 1     M M                    |     |           |     |M|  3
    |      1 M M                      |     |           |     |M|  4
    |      0 1 M                      |     |           |     |M|  5
    |    0 0 0 1 M                    |     |           |     |M|  6
    |    0     M M x x                |     |           |     |M|  7
    |            x x x                |     |           |     |x|  8
    |            x x x x x x          | ... |           | ... |x|  9 sc
    |                x x x x          |     |           |     |x| 10
    |                x x x x          |     |           |     |x| 11
    |                x x x x x x x    |     |           |     |x| 12
    |                      x x x x    |     |           |     |x| 13
    |                      x x x x    |     |           |     |x| 14
    |                      x x x x x x|     |      x    |     |x| 15
    |                            x x x|     |      x    |     |x| 16
    |                            x x x|     |      x    |     |x| 17
    -----------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[23];

    // sc-row-7 = sc-row-7 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[23] = 0;
#endif

    sc_to_sc_matrix[24] -= sc_to_sc_matrix[21] * pivot;

    sc_g_matrix[6] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 M M                            |     |           |     |M|  1
    |0 1 M                            |     |           |     |M|  2
    |0 0 1     M M                    |     |           |     |M|  3
    |      1 M M                      |     |           |     |M|  4
    |      0 1 M                      |     |           |     |M|  5
    |    0 0 0 1 M                    |     |           |     |M|  6
    |    0     0 M x x                |     |           |     |M|  7
    |            x x x                |     |           |     |x|  8
    |            x x x x x x          | ... |           | ... |x|  9 sc
    |                x x x x          |     |           |     |x| 10
    |                x x x x          |     |           |     |x| 11
    |                x x x x x x x    |     |           |     |x| 12
    |                      x x x x    |     |           |     |x| 13
    |                      x x x x    |     |           |     |x| 14
    |                      x x x x x x|     |      x    |     |x| 15
    |                            x x x|     |      x    |     |x| 16
    |                            x x x|     |      x    |     |x| 17
    -----------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[24];

    // sc-row-7 = sc-row-7 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[24] = 1;
#endif

    sc_to_sc_matrix[25] /= pivot;
    sc_to_sc_matrix[26] /= pivot;

    sc_g_matrix[6] /= pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 M M                            |     |           |     |M|  1
    |0 1 M                            |     |           |     |M|  2
    |0 0 1     M M                    |     |           |     |M|  3
    |      1 M M                      |     |           |     |M|  4
    |      0 1 M                      |     |           |     |M|  5
    |    0 0 0 1 M                    |     |           |     |M|  6
    |    0     0 1 M M                |     |           |     |M|  7
    |            x x x                |     |           |     |x|  8
    |            x x x x x x          | ... |           | ... |x|  9 sc
    |                x x x x          |     |           |     |x| 10
    |                x x x x          |     |           |     |x| 11
    |                x x x x x x x    |     |           |     |x| 12
    |                      x x x x    |     |           |     |x| 13
    |                      x x x x    |     |           |     |x| 14
    |                      x x x x x x|     |      x    |     |x| 15
    |                            x x x|     |      x    |     |x| 16
    |                            x x x|     |      x    |     |x| 17
    -----------------------------------     -------------
    */

    /*
     *
     * Row 8
     *
     */

    pivot = sc_to_sc_matrix[27];

    // sc-row-8 = sc-row-8 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[27] = 0;
#endif

    sc_to_sc_matrix[28] -= sc_to_sc_matrix[25] * pivot;
    sc_to_sc_matrix[29] -= sc_to_sc_matrix[26] * pivot;

    sc_g_matrix[7] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 M M                            |     |           |     |M|  1
    |0 1 M                            |     |           |     |M|  2
    |0 0 1     M M                    |     |           |     |M|  3
    |      1 M M                      |     |           |     |M|  4
    |      0 1 M                      |     |           |     |M|  5
    |    0 0 0 1 M                    |     |           |     |M|  6
    |    0     0 1 M M                |     |           |     |M|  7
    |            0 M M                |     |           |     |M|  8
    |            x x x x x x          | ... |           | ... |x|  9 sc
    |                x x x x          |     |           |     |x| 10
    |                x x x x          |     |           |     |x| 11
    |                x x x x x x x    |     |           |     |x| 12
    |                      x x x x    |     |           |     |x| 13
    |                      x x x x    |     |           |     |x| 14
    |                      x x x x x x|     |      x    |     |x| 15
    |                            x x x|     |      x    |     |x| 16
    |                            x x x|     |      x    |     |x| 17
    -----------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[28];

    // sc-row-8 = sc-row-8 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[28] = 1;
#endif

    sc_to_sc_matrix[29] /= pivot;

    sc_g_matrix[7] /= pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 M M                            |     |           |     |M|  1
    |0 1 M                            |     |           |     |M|  2
    |0 0 1     M M                    |     |           |     |M|  3
    |      1 M M                      |     |           |     |M|  4
    |      0 1 M                      |     |           |     |M|  5
    |    0 0 0 1 M                    |     |           |     |M|  6
    |    0     0 1 M M                |     |           |     |M|  7
    |            0 1 M                |     |           |     |M|  8
    |            x x x x x x          | ... |           | ... |x|  9 sc
    |                x x x x          |     |           |     |x| 10
    |                x x x x          |     |           |     |x| 11
    |                x x x x x x x    |     |           |     |x| 12
    |                      x x x x    |     |           |     |x| 13
    |                      x x x x    |     |           |     |x| 14
    |                      x x x x x x|     |      x    |     |x| 15
    |                            x x x|     |      x    |     |x| 16
    |                            x x x|     |      x    |     |x| 17
    -----------------------------------     -------------
    */

    /*
     *
     * Row 9
     *
     */

    pivot = sc_to_sc_matrix[30];

    // sc-row-9 = sc-row-9 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[30] = 0;
#endif

    sc_to_sc_matrix[31] -= sc_to_sc_matrix[25] * pivot;
    sc_to_sc_matrix[32] -= sc_to_sc_matrix[26] * pivot;

    sc_g_matrix[8] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 M M                            |     |           |     |M|  1
    |0 1 M                            |     |           |     |M|  2
    |0 0 1     M M                    |     |           |     |M|  3
    |      1 M M                      |     |           |     |M|  4
    |      0 1 M                      |     |           |     |M|  5
    |    0 0 0 1 M                    |     |           |     |M|  6
    |    0     0 1 M M                |     |           |     |M|  7
    |            0 1 M                |     |           |     |M|  8
    |            0 M M x x x          | ... |           | ... |M|  9 sc
    |                x x x x          |     |           |     |x| 10
    |                x x x x          |     |           |     |x| 11
    |                x x x x x x x    |     |           |     |x| 12
    |                      x x x x    |     |           |     |x| 13
    |                      x x x x    |     |           |     |x| 14
    |                      x x x x x x|     |      x    |     |x| 15
    |                            x x x|     |      x    |     |x| 16
    |                            x x x|     |      x    |     |x| 17
    -----------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[31];

    // sc-row-9 = sc-row-9 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[31] = 0;
#endif

    sc_to_sc_matrix[32] -= sc_to_sc_matrix[29] * pivot;

    sc_g_matrix[8] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 M M                            |     |           |     |M|  1
    |0 1 M                            |     |           |     |M|  2
    |0 0 1     M M                    |     |           |     |M|  3
    |      1 M M                      |     |           |     |M|  4
    |      0 1 M                      |     |           |     |M|  5
    |    0 0 0 1 M                    |     |           |     |M|  6
    |    0     0 1 M M                |     |           |     |M|  7
    |            0 1 M                |     |           |     |M|  8
    |            0 0 M x x x          | ... |           | ... |M|  9 sc
    |                x x x x          |     |           |     |x| 10
    |                x x x x          |     |           |     |x| 11
    |                x x x x x x x    |     |           |     |x| 12
    |                      x x x x    |     |           |     |x| 13
    |                      x x x x    |     |           |     |x| 14
    |                      x x x x x x|     |      x    |     |x| 15
    |                            x x x|     |      x    |     |x| 16
    |                            x x x|     |      x    |     |x| 17
    -----------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[32];

    // sc-row-9 = sc-row-9 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[32] = 1;
#endif

    sc_to_sc_matrix[33] /= pivot;
    sc_to_sc_matrix[34] /= pivot;
    sc_to_sc_matrix[35] /= pivot;

    sc_g_matrix[8] /= pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 M M                            |     |           |     |M|  1
    |0 1 M                            |     |           |     |M|  2
    |0 0 1     M M                    |     |           |     |M|  3
    |      1 M M                      |     |           |     |M|  4
    |      0 1 M                      |     |           |     |M|  5
    |    0 0 0 1 M                    |     |           |     |M|  6
    |    0     0 1 M M                |     |           |     |M|  7
    |            0 1 M                |     |           |     |M|  8
    |            0 0 1 M M M          | ... |           | ... |M|  9 sc
    |                x x x x          |     |           |     |x| 10
    |                x x x x          |     |           |     |x| 11
    |                x x x x x x x    |     |           |     |x| 12
    |                      x x x x    |     |           |     |x| 13
    |                      x x x x    |     |           |     |x| 14
    |                      x x x x x x|     |      x    |     |x| 15
    |                            x x x|     |      x    |     |x| 16
    |                            x x x|     |      x    |     |x| 17
    -----------------------------------     -------------
    */

    /*
     *
     * Row 10
     *
     */

    pivot = sc_to_sc_matrix[36];

    // sc-row-10 = sc-row-10 - sc-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[36] = 0;
#endif

    sc_to_sc_matrix[37] -= sc_to_sc_matrix[33] * pivot;
    sc_to_sc_matrix[38] -= sc_to_sc_matrix[34] * pivot;
    sc_to_sc_matrix[39] -= sc_to_sc_matrix[35] * pivot;

    sc_g_matrix[9] -= sc_g_matrix[8] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 M M                            |     |           |     |M|  1
    |0 1 M                            |     |           |     |M|  2
    |0 0 1     M M                    |     |           |     |M|  3
    |      1 M M                      |     |           |     |M|  4
    |      0 1 M                      |     |           |     |M|  5
    |    0 0 0 1 M                    |     |           |     |M|  6
    |    0     0 1 M M                |     |           |     |M|  7
    |            0 1 M                |     |           |     |M|  8
    |            0 0 1 M M M          | ... |           | ... |M|  9 sc
    |                0 M M M          |     |           |     |M| 10
    |                x x x x          |     |           |     |x| 11
    |                x x x x x x x    |     |           |     |x| 12
    |                      x x x x    |     |           |     |x| 13
    |                      x x x x    |     |           |     |x| 14
    |                      x x x x x x|     |      x    |     |x| 15
    |                            x x x|     |      x    |     |x| 16
    |                            x x x|     |      x    |     |x| 17
    -----------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[37];

    // sc-row-10 = sc-row-10 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[37] = 1;
#endif

    sc_to_sc_matrix[38] /= pivot;
    sc_to_sc_matrix[39] /= pivot;

    sc_g_matrix[9] /= pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 M M                            |     |           |     |M|  1
    |0 1 M                            |     |           |     |M|  2
    |0 0 1     M M                    |     |           |     |M|  3
    |      1 M M                      |     |           |     |M|  4
    |      0 1 M                      |     |           |     |M|  5
    |    0 0 0 1 M                    |     |           |     |M|  6
    |    0     0 1 M M                |     |           |     |M|  7
    |            0 1 M                |     |           |     |M|  8
    |            0 0 1 M M M          | ... |           | ... |M|  9 sc
    |                0 1 M M          |     |           |     |M| 10
    |                x x x x          |     |           |     |x| 11
    |                x x x x x x x    |     |           |     |x| 12
    |                      x x x x    |     |           |     |x| 13
    |                      x x x x    |     |           |     |x| 14
    |                      x x x x x x|     |      x    |     |x| 15
    |                            x x x|     |      x    |     |x| 16
    |                            x x x|     |      x    |     |x| 17
    -----------------------------------     -------------
    */

    /*
     *
     * Row 11
     *
     */

    pivot = sc_to_sc_matrix[40];

    // sc-row-11 = sc-row-11 - sc-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[40] = 0;
#endif

    sc_to_sc_matrix[41] -= sc_to_sc_matrix[33] * pivot;
    sc_to_sc_matrix[42] -= sc_to_sc_matrix[34] * pivot;
    sc_to_sc_matrix[43] -= sc_to_sc_matrix[35] * pivot;

    sc_g_matrix[10] -= sc_g_matrix[8] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 M M                            |     |           |     |M|  1
    |0 1 M                            |     |           |     |M|  2
    |0 0 1     M M                    |     |           |     |M|  3
    |      1 M M                      |     |           |     |M|  4
    |      0 1 M                      |     |           |     |M|  5
    |    0 0 0 1 M                    |     |           |     |M|  6
    |    0     0 1 M M                |     |           |     |M|  7
    |            0 1 M                |     |           |     |M|  8
    |            0 0 1 M M M          | ... |           | ... |M|  9 sc
    |                0 1 M M          |     |           |     |M| 10
    |                0 M M M          |     |           |     |M| 11
    |                x x x x x x x    |     |           |     |x| 12
    |                      x x x x    |     |           |     |x| 13
    |                      x x x x    |     |           |     |x| 14
    |                      x x x x x x|     |      x    |     |x| 15
    |                            x x x|     |      x    |     |x| 16
    |                            x x x|     |      x    |     |x| 17
    -----------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[41];

    // sc-row-11 = sc-row-11 - sc-row-10 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[41] = 0;
#endif

    sc_to_sc_matrix[42] -= sc_to_sc_matrix[38] * pivot;
    sc_to_sc_matrix[43] -= sc_to_sc_matrix[39] * pivot;

    sc_g_matrix[10] -= sc_g_matrix[9] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 M M                            |     |           |     |M|  1
    |0 1 M                            |     |           |     |M|  2
    |0 0 1     M M                    |     |           |     |M|  3
    |      1 M M                      |     |           |     |M|  4
    |      0 1 M                      |     |           |     |M|  5
    |    0 0 0 1 M                    |     |           |     |M|  6
    |    0     0 1 M M                |     |           |     |M|  7
    |            0 1 M                |     |           |     |M|  8
    |            0 0 1 M M M          | ... |           | ... |M|  9 sc
    |                0 1 M M          |     |           |     |M| 10
    |                0 0 M M          |     |           |     |M| 11
    |                x x x x x x x    |     |           |     |x| 12
    |                      x x x x    |     |           |     |x| 13
    |                      x x x x    |     |           |     |x| 14
    |                      x x x x x x|     |      x    |     |x| 15
    |                            x x x|     |      x    |     |x| 16
    |                            x x x|     |      x    |     |x| 17
    -----------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[42];

    // sc-row-11 = sc-row-11 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[42] = 1;
#endif

    sc_to_sc_matrix[43] /= pivot;

    sc_g_matrix[10] /= pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 M M                            |     |           |     |M|  1
    |0 1 M                            |     |           |     |M|  2
    |0 0 1     M M                    |     |           |     |M|  3
    |      1 M M                      |     |           |     |M|  4
    |      0 1 M                      |     |           |     |M|  5
    |    0 0 0 1 M                    |     |           |     |M|  6
    |    0     0 1 M M                |     |           |     |M|  7
    |            0 1 M                |     |           |     |M|  8
    |            0 0 1 M M M          | ... |           | ... |M|  9 sc
    |                0 1 M M          |     |           |     |M| 10
    |                0 0 1 M          |     |           |     |M| 11
    |                x x x x x x x    |     |           |     |x| 12
    |                      x x x x    |     |           |     |x| 13
    |                      x x x x    |     |           |     |x| 14
    |                      x x x x x x|     |      x    |     |x| 15
    |                            x x x|     |      x    |     |x| 16
    |                            x x x|     |      x    |     |x| 17
    -----------------------------------     -------------
    */

    /*
     *
     * Row 12
     *
     */

    pivot = sc_to_sc_matrix[44];

    // sc-row-12 = sc-row-12 - sc-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[44] = 0;
#endif

    sc_to_sc_matrix[45] -= sc_to_sc_matrix[33] * pivot;
    sc_to_sc_matrix[46] -= sc_to_sc_matrix[34] * pivot;
    sc_to_sc_matrix[47] -= sc_to_sc_matrix[35] * pivot;

    sc_g_matrix[11] -= sc_g_matrix[8] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 M M                            |     |           |     |M|  1
    |0 1 M                            |     |           |     |M|  2
    |0 0 1     M M                    |     |           |     |M|  3
    |      1 M M                      |     |           |     |M|  4
    |      0 1 M                      |     |           |     |M|  5
    |    0 0 0 1 M                    |     |           |     |M|  6
    |    0     0 1 M M                |     |           |     |M|  7
    |            0 1 M                |     |           |     |M|  8
    |            0 0 1 M M M          | ... |           | ... |M|  9 sc
    |                0 1 M M          |     |           |     |M| 10
    |                0 0 1 M          |     |           |     |M| 11
    |                0 M M M x x x    |     |           |     |M| 12
    |                      x x x x    |     |           |     |x| 13
    |                      x x x x    |     |           |     |x| 14
    |                      x x x x x x|     |      x    |     |x| 15
    |                            x x x|     |      x    |     |x| 16
    |                            x x x|     |      x    |     |x| 17
    -----------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[45];

    // sc-row-12 = sc-row-12 - sc-row-10 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[45] = 0;
#endif

    sc_to_sc_matrix[46] -= sc_to_sc_matrix[38] * pivot;
    sc_to_sc_matrix[47] -= sc_to_sc_matrix[39] * pivot;

    sc_g_matrix[11] -= sc_g_matrix[9] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 M M                            |     |           |     |M|  1
    |0 1 M                            |     |           |     |M|  2
    |0 0 1     M M                    |     |           |     |M|  3
    |      1 M M                      |     |           |     |M|  4
    |      0 1 M                      |     |           |     |M|  5
    |    0 0 0 1 M                    |     |           |     |M|  6
    |    0     0 1 M M                |     |           |     |M|  7
    |            0 1 M                |     |           |     |M|  8
    |            0 0 1 M M M          | ... |           | ... |M|  9 sc
    |                0 1 M M          |     |           |     |M| 10
    |                0 0 1 M          |     |           |     |M| 11
    |                0 0 M M x x x    |     |           |     |M| 12
    |                      x x x x    |     |           |     |x| 13
    |                      x x x x    |     |           |     |x| 14
    |                      x x x x x x|     |      x    |     |x| 15
    |                            x x x|     |      x    |     |x| 16
    |                            x x x|     |      x    |     |x| 17
    -----------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[46];

    // sc-row-12 = sc-row-12 - sc-row-11 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[46] = 0;
#endif

    sc_to_sc_matrix[47] -= sc_to_sc_matrix[43] * pivot;

    sc_g_matrix[11] -= sc_g_matrix[10] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 M M                            |     |           |     |M|  1
    |0 1 M                            |     |           |     |M|  2
    |0 0 1     M M                    |     |           |     |M|  3
    |      1 M M                      |     |           |     |M|  4
    |      0 1 M                      |     |           |     |M|  5
    |    0 0 0 1 M                    |     |           |     |M|  6
    |    0     0 1 M M                |     |           |     |M|  7
    |            0 1 M                |     |           |     |M|  8
    |            0 0 1 M M M          | ... |           | ... |M|  9 sc
    |                0 1 M M          |     |           |     |M| 10
    |                0 0 1 M          |     |           |     |M| 11
    |                0 0 0 M x x x    |     |           |     |M| 12
    |                      x x x x    |     |           |     |x| 13
    |                      x x x x    |     |           |     |x| 14
    |                      x x x x x x|     |      x    |     |x| 15
    |                            x x x|     |      x    |     |x| 16
    |                            x x x|     |      x    |     |x| 17
    -----------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[47];

    // sc-row-12 = sc-row-12 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[47] = 1;
#endif

    sc_to_sc_matrix[48] /= pivot;
    sc_to_sc_matrix[49] /= pivot;
    sc_to_sc_matrix[50] /= pivot;

    sc_g_matrix[11] /= pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 M M                            |     |           |     |M|  1
    |0 1 M                            |     |           |     |M|  2
    |0 0 1     M M                    |     |           |     |M|  3
    |      1 M M                      |     |           |     |M|  4
    |      0 1 M                      |     |           |     |M|  5
    |    0 0 0 1 M                    |     |           |     |M|  6
    |    0     0 1 M M                |     |           |     |M|  7
    |            0 1 M                |     |           |     |M|  8
    |            0 0 1 M M M          | ... |           | ... |M|  9 sc
    |                0 1 M M          |     |           |     |M| 10
    |                0 0 1 M          |     |           |     |M| 11
    |                0 0 0 1 M M M    |     |           |     |M| 12
    |                      x x x x    |     |           |     |x| 13
    |                      x x x x    |     |           |     |x| 14
    |                      x x x x x x|     |      x    |     |x| 15
    |                            x x x|     |      x    |     |x| 16
    |                            x x x|     |      x    |     |x| 17
    -----------------------------------     -------------
    */

    /*
     *
     * Row 13
     *
     */

    pivot = sc_to_sc_matrix[51];

    // sc-row-13 = sc-row-13 - sc-row-12 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[51] = 0;
#endif

    sc_to_sc_matrix[52] -= sc_to_sc_matrix[48] * pivot;
    sc_to_sc_matrix[53] -= sc_to_sc_matrix[49] * pivot;
    sc_to_sc_matrix[54] -= sc_to_sc_matrix[50] * pivot;

    sc_g_matrix[12] -= sc_g_matrix[11] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 M M                            |     |           |     |M|  1
    |0 1 M                            |     |           |     |M|  2
    |0 0 1     M M                    |     |           |     |M|  3
    |      1 M M                      |     |           |     |M|  4
    |      0 1 M                      |     |           |     |M|  5
    |    0 0 0 1 M                    |     |           |     |M|  6
    |    0     0 1 M M                |     |           |     |M|  7
    |            0 1 M                |     |           |     |M|  8
    |            0 0 1 M M M          | ... |           | ... |M|  9 sc
    |                0 1 M M          |     |           |     |M| 10
    |                0 0 1 M          |     |           |     |M| 11
    |                0 0 0 1 M M M    |     |           |     |M| 12
    |                      0 M M M    |     |           |     |M| 13
    |                      x x x x    |     |           |     |x| 14
    |                      x x x x x x|     |      x    |     |x| 15
    |                            x x x|     |      x    |     |x| 16
    |                            x x x|     |      x    |     |x| 17
    -----------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[52];

    // sc-row-13 = sc-row-13 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[52] = 1;
#endif

    sc_to_sc_matrix[53] /= pivot;
    sc_to_sc_matrix[54] /= pivot;

    sc_g_matrix[12] /= pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 M M                            |     |           |     |M|  1
    |0 1 M                            |     |           |     |M|  2
    |0 0 1     M M                    |     |           |     |M|  3
    |      1 M M                      |     |           |     |M|  4
    |      0 1 M                      |     |           |     |M|  5
    |    0 0 0 1 M                    |     |           |     |M|  6
    |    0     0 1 M M                |     |           |     |M|  7
    |            0 1 M                |     |           |     |M|  8
    |            0 0 1 M M M          | ... |           | ... |M|  9 sc
    |                0 1 M M          |     |           |     |M| 10
    |                0 0 1 M          |     |           |     |M| 11
    |                0 0 0 1 M M M    |     |           |     |M| 12
    |                      0 1 M M    |     |           |     |M| 13
    |                      x x x x    |     |           |     |x| 14
    |                      x x x x x x|     |      x    |     |x| 15
    |                            x x x|     |      x    |     |x| 16
    |                            x x x|     |      x    |     |x| 17
    -----------------------------------     -------------
    */

    /*
     *
     * Row 14
     *
     */

    pivot = sc_to_sc_matrix[55];

    // sc-row-14 = sc-row-14 - sc-row-12 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[55] = 0;
#endif

    sc_to_sc_matrix[56] -= sc_to_sc_matrix[48] * pivot;
    sc_to_sc_matrix[57] -= sc_to_sc_matrix[49] * pivot;
    sc_to_sc_matrix[58] -= sc_to_sc_matrix[50] * pivot;

    sc_g_matrix[13] -= sc_g_matrix[11] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 M M                            |     |           |     |M|  1
    |0 1 M                            |     |           |     |M|  2
    |0 0 1     M M                    |     |           |     |M|  3
    |      1 M M                      |     |           |     |M|  4
    |      0 1 M                      |     |           |     |M|  5
    |    0 0 0 1 M                    |     |           |     |M|  6
    |    0     0 1 M M                |     |           |     |M|  7
    |            0 1 M                |     |           |     |M|  8
    |            0 0 1 M M M          | ... |           | ... |M|  9 sc
    |                0 1 M M          |     |           |     |M| 10
    |                0 0 1 M          |     |           |     |M| 11
    |                0 0 0 1 M M M    |     |           |     |M| 12
    |                      0 1 M M    |     |           |     |M| 13
    |                      0 M M M    |     |           |     |M| 14
    |                      x x x x x x|     |      x    |     |x| 15
    |                            x x x|     |      x    |     |x| 16
    |                            x x x|     |      x    |     |x| 17
    -----------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[56];

    // sc-row-14 = sc-row-14 - sc-row-13 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[56] = 0;
#endif

    sc_to_sc_matrix[57] -= sc_to_sc_matrix[53] * pivot;
    sc_to_sc_matrix[58] -= sc_to_sc_matrix[54] * pivot;

    sc_g_matrix[13] -= sc_g_matrix[12] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 M M                            |     |           |     |M|  1
    |0 1 M                            |     |           |     |M|  2
    |0 0 1     M M                    |     |           |     |M|  3
    |      1 M M                      |     |           |     |M|  4
    |      0 1 M                      |     |           |     |M|  5
    |    0 0 0 1 M                    |     |           |     |M|  6
    |    0     0 1 M M                |     |           |     |M|  7
    |            0 1 M                |     |           |     |M|  8
    |            0 0 1 M M M          | ... |           | ... |M|  9 sc
    |                0 1 M M          |     |           |     |M| 10
    |                0 0 1 M          |     |           |     |M| 11
    |                0 0 0 1 M M M    |     |           |     |M| 12
    |                      0 1 M M    |     |           |     |M| 13
    |                      0 0 M M    |     |           |     |M| 14
    |                      x x x x x x|     |      x    |     |x| 15
    |                            x x x|     |      x    |     |x| 16
    |                            x x x|     |      x    |     |x| 17
    -----------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[57];

    // sc-row-14 = sc-row-14 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[57] = 1;
#endif

    sc_to_sc_matrix[58] /= pivot;

    sc_g_matrix[13] /= pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 M M                            |     |           |     |M|  1
    |0 1 M                            |     |           |     |M|  2
    |0 0 1     M M                    |     |           |     |M|  3
    |      1 M M                      |     |           |     |M|  4
    |      0 1 M                      |     |           |     |M|  5
    |    0 0 0 1 M                    |     |           |     |M|  6
    |    0     0 1 M M                |     |           |     |M|  7
    |            0 1 M                |     |           |     |M|  8
    |            0 0 1 M M M          | ... |           | ... |M|  9 sc
    |                0 1 M M          |     |           |     |M| 10
    |                0 0 1 M          |     |           |     |M| 11
    |                0 0 0 1 M M M    |     |           |     |M| 12
    |                      0 1 M M    |     |           |     |M| 13
    |                      0 0 1 M    |     |           |     |M| 14
    |                      x x x x x x|     |      x    |     |x| 15
    |                            x x x|     |      x    |     |x| 16
    |                            x x x|     |      x    |     |x| 17
    -----------------------------------     -------------
    */

    /*
     *
     * Row 15
     *
     */

    pivot = sc_to_sc_matrix[59];

    // sc-row-15 = sc-row-15 - sc-row-12 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[59] = 0;
#endif

    sc_to_sc_matrix[60] -= sc_to_sc_matrix[48] * pivot;
    sc_to_sc_matrix[61] -= sc_to_sc_matrix[49] * pivot;
    sc_to_sc_matrix[62] -= sc_to_sc_matrix[50] * pivot;

    sc_g_matrix[14] -= sc_g_matrix[11] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 M M                            |     |           |     |M|  1
    |0 1 M                            |     |           |     |M|  2
    |0 0 1     M M                    |     |           |     |M|  3
    |      1 M M                      |     |           |     |M|  4
    |      0 1 M                      |     |           |     |M|  5
    |    0 0 0 1 M                    |     |           |     |M|  6
    |    0     0 1 M M                |     |           |     |M|  7
    |            0 1 M                |     |           |     |M|  8
    |            0 0 1 M M M          | ... |           | ... |M|  9 sc
    |                0 1 M M          |     |           |     |M| 10
    |                0 0 1 M          |     |           |     |M| 11
    |                0 0 0 1 M M M    |     |           |     |M| 12
    |                      0 1 M M    |     |           |     |M| 13
    |                      0 0 1 M    |     |           |     |M| 14
    |                      0 M M M x x|     |      x    |     |M| 15
    |                            x x x|     |      x    |     |x| 16
    |                            x x x|     |      x    |     |x| 17
    -----------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[60];

    // sc-row-15 = sc-row-15 - sc-row-13 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[60] = 0;
#endif

    sc_to_sc_matrix[61] -= sc_to_sc_matrix[53] * pivot;
    sc_to_sc_matrix[62] -= sc_to_sc_matrix[54] * pivot;

    sc_g_matrix[14] -= sc_g_matrix[12] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 M M                            |     |           |     |M|  1
    |0 1 M                            |     |           |     |M|  2
    |0 0 1     M M                    |     |           |     |M|  3
    |      1 M M                      |     |           |     |M|  4
    |      0 1 M                      |     |           |     |M|  5
    |    0 0 0 1 M                    |     |           |     |M|  6
    |    0     0 1 M M                |     |           |     |M|  7
    |            0 1 M                |     |           |     |M|  8
    |            0 0 1 M M M          | ... |           | ... |M|  9 sc
    |                0 1 M M          |     |           |     |M| 10
    |                0 0 1 M          |     |           |     |M| 11
    |                0 0 0 1 M M M    |     |           |     |M| 12
    |                      0 1 M M    |     |           |     |M| 13
    |                      0 0 1 M    |     |           |     |M| 14
    |                      0 0 M M x x|     |      x    |     |M| 15
    |                            x x x|     |      x    |     |x| 16
    |                            x x x|     |      x    |     |x| 17
    -----------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[61];

    // sc-row-15 = sc-row-15 - sc-row-14 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[61] = 0;
#endif

    sc_to_sc_matrix[62] -= sc_to_sc_matrix[58] * pivot;

    sc_g_matrix[14] -= sc_g_matrix[13] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 M M                            |     |           |     |M|  1
    |0 1 M                            |     |           |     |M|  2
    |0 0 1     M M                    |     |           |     |M|  3
    |      1 M M                      |     |           |     |M|  4
    |      0 1 M                      |     |           |     |M|  5
    |    0 0 0 1 M                    |     |           |     |M|  6
    |    0     0 1 M M                |     |           |     |M|  7
    |            0 1 M                |     |           |     |M|  8
    |            0 0 1 M M M          | ... |           | ... |M|  9 sc
    |                0 1 M M          |     |           |     |M| 10
    |                0 0 1 M          |     |           |     |M| 11
    |                0 0 0 1 M M M    |     |           |     |M| 12
    |                      0 1 M M    |     |           |     |M| 13
    |                      0 0 1 M    |     |           |     |M| 14
    |                      0 0 0 M x x|     |      x    |     |M| 15
    |                            x x x|     |      x    |     |x| 16
    |                            x x x|     |      x    |     |x| 17
    -----------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[62];

    // sc-row-15 = sc-row-15 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[62] = 1;
#endif

    sc_to_sc_matrix[63] /= pivot;
    sc_to_sc_matrix[64] /= pivot;

    sc_to_bb_matrix[0] /= pivot;

    sc_g_matrix[14] /= pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 M M                            |     |           |     |M|  1
    |0 1 M                            |     |           |     |M|  2
    |0 0 1     M M                    |     |           |     |M|  3
    |      1 M M                      |     |           |     |M|  4
    |      0 1 M                      |     |           |     |M|  5
    |    0 0 0 1 M                    |     |           |     |M|  6
    |    0     0 1 M M                |     |           |     |M|  7
    |            0 1 M                |     |           |     |M|  8
    |            0 0 1 M M M          | ... |           | ... |M|  9 sc
    |                0 1 M M          |     |           |     |M| 10
    |                0 0 1 M          |     |           |     |M| 11
    |                0 0 0 1 M M M    |     |           |     |M| 12
    |                      0 1 M M    |     |           |     |M| 13
    |                      0 0 1 M    |     |           |     |M| 14
    |                      0 0 0 1 M M|     |      M    |     |M| 15
    |                            x x x|     |      x    |     |x| 16
    |                            x x x|     |      x    |     |x| 17
    -----------------------------------     -------------
    */

    /*
     *
     * Row 16
     *
     */

    pivot = sc_to_sc_matrix[65];

    // sc-row-16 = sc-row-16 - sc-row-15 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[65] = 0;
#endif

    sc_to_sc_matrix[66] -= sc_to_sc_matrix[63] * pivot;
    sc_to_sc_matrix[67] -= sc_to_sc_matrix[64] * pivot;

    sc_to_bb_matrix[1] -= sc_to_bb_matrix[0] * pivot;

    sc_g_matrix[15] -= sc_g_matrix[14] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 M M                            |     |           |     |M|  1
    |0 1 M                            |     |           |     |M|  2
    |0 0 1     M M                    |     |           |     |M|  3
    |      1 M M                      |     |           |     |M|  4
    |      0 1 M                      |     |           |     |M|  5
    |    0 0 0 1 M                    |     |           |     |M|  6
    |    0     0 1 M M                |     |           |     |M|  7
    |            0 1 M                |     |           |     |M|  8
    |            0 0 1 M M M          | ... |           | ... |M|  9 sc
    |                0 1 M M          |     |           |     |M| 10
    |                0 0 1 M          |     |           |     |M| 11
    |                0 0 0 1 M M M    |     |           |     |M| 12
    |                      0 1 M M    |     |           |     |M| 13
    |                      0 0 1 M    |     |           |     |M| 14
    |                      0 0 0 1 M M|     |      M    |     |M| 15
    |                            0 M M|     |      M    |     |M| 16
    |                            x x x|     |      x    |     |x| 17
    -----------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[66];

    // sc-row-16 = sc-row-16 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[66] = 1;
#endif

    sc_to_sc_matrix[67] /= pivot;

    sc_to_bb_matrix[1] /= pivot;

    sc_g_matrix[15] /= pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 M M                            |     |           |     |M|  1
    |0 1 M                            |     |           |     |M|  2
    |0 0 1     M M                    |     |           |     |M|  3
    |      1 M M                      |     |           |     |M|  4
    |      0 1 M                      |     |           |     |M|  5
    |    0 0 0 1 M                    |     |           |     |M|  6
    |    0     0 1 M M                |     |           |     |M|  7
    |            0 1 M                |     |           |     |M|  8
    |            0 0 1 M M M          | ... |           | ... |M|  9 sc
    |                0 1 M M          |     |           |     |M| 10
    |                0 0 1 M          |     |           |     |M| 11
    |                0 0 0 1 M M M    |     |           |     |M| 12
    |                      0 1 M M    |     |           |     |M| 13
    |                      0 0 1 M    |     |           |     |M| 14
    |                      0 0 0 1 M M|     |      M    |     |M| 15
    |                            0 1 M|     |      M    |     |M| 16
    |                            x x x|     |      x    |     |x| 17
    -----------------------------------     -------------
    */

    /*
     *
     * Row 17
     *
     */

    pivot = sc_to_sc_matrix[68];

    // sc-row-17 = sc-row-17 - sc-row-15 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[68] = 0;
#endif

    sc_to_sc_matrix[69] -= sc_to_sc_matrix[63] * pivot;
    sc_to_sc_matrix[70] -= sc_to_sc_matrix[64] * pivot;

    sc_to_bb_matrix[2] -= sc_to_bb_matrix[0] * pivot;

    sc_g_matrix[16] -= sc_g_matrix[14] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 M M                            |     |           |     |M|  1
    |0 1 M                            |     |           |     |M|  2
    |0 0 1     M M                    |     |           |     |M|  3
    |      1 M M                      |     |           |     |M|  4
    |      0 1 M                      |     |           |     |M|  5
    |    0 0 0 1 M                    |     |           |     |M|  6
    |    0     0 1 M M                |     |           |     |M|  7
    |            0 1 M                |     |           |     |M|  8
    |            0 0 1 M M M          | ... |           | ... |M|  9 sc
    |                0 1 M M          |     |           |     |M| 10
    |                0 0 1 M          |     |           |     |M| 11
    |                0 0 0 1 M M M    |     |           |     |M| 12
    |                      0 1 M M    |     |           |     |M| 13
    |                      0 0 1 M    |     |           |     |M| 14
    |                      0 0 0 1 M M|     |      M    |     |M| 15
    |                            0 1 M|     |      M    |     |M| 16
    |                            0 M M|     |      M    |     |M| 17
    -----------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[69];

    // sc-row-17 = sc-row-17 - sc-row-16 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[69] = 0;
#endif

    sc_to_sc_matrix[70] -= sc_to_sc_matrix[67] * pivot;

    sc_to_bb_matrix[2] -= sc_to_bb_matrix[1] * pivot;

    sc_g_matrix[16] -= sc_g_matrix[15] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 M M                            |     |           |     |M|  1
    |0 1 M                            |     |           |     |M|  2
    |0 0 1     M M                    |     |           |     |M|  3
    |      1 M M                      |     |           |     |M|  4
    |      0 1 M                      |     |           |     |M|  5
    |    0 0 0 1 M                    |     |           |     |M|  6
    |    0     0 1 M M                |     |           |     |M|  7
    |            0 1 M                |     |           |     |M|  8
    |            0 0 1 M M M          | ... |           | ... |M|  9 sc
    |                0 1 M M          |     |           |     |M| 10
    |                0 0 1 M          |     |           |     |M| 11
    |                0 0 0 1 M M M    |     |           |     |M| 12
    |                      0 1 M M    |     |           |     |M| 13
    |                      0 0 1 M    |     |           |     |M| 14
    |                      0 0 0 1 M M|     |      M    |     |M| 15
    |                            0 1 M|     |      M    |     |M| 16
    |                            0 0 M|     |      M    |     |M| 17
    -----------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[70];

    // sc-row-17 = sc-row-17 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[70] = 1;
#endif

    sc_to_bb_matrix[2] /= pivot;

    sc_g_matrix[16] /= pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 M M                            |     |           |     |M|  1
    |0 1 M                            |     |           |     |M|  2
    |0 0 1     M M                    |     |           |     |M|  3
    |      1 M M                      |     |           |     |M|  4
    |      0 1 M                      |     |           |     |M|  5
    |    0 0 0 1 M                    |     |           |     |M|  6
    |    0     0 1 M M                |     |           |     |M|  7
    |            0 1 M                |     |           |     |M|  8
    |            0 0 1 M M M          | ... |           | ... |M|  9 sc
    |                0 1 M M          |     |           |     |M| 10
    |                0 0 1 M          |     |           |     |M| 11
    |                0 0 0 1 M M M    |     |           |     |M| 12
    |                      0 1 M M    |     |           |     |M| 13
    |                      0 0 1 M    |     |           |     |M| 14
    |                      0 0 0 1 M M|     |      M    |     |M| 15
    |                            0 1 M|     |      M    |     |M| 16
    |                            0 0 1|     |      M    |     |M| 17
    -----------------------------------     -------------
    */
}

void gmx::IlvesPC::solve_2_serine(real *const sc_to_sc_matrix,
                                  real *const sc_to_bb_matrix,
                                  __attribute__((unused))
                                  real *const sc_to_sep_matrix,
                                  real *const sc_g_matrix,
                                  __attribute__((unused))
                                  real *const sc_to_sc_fillins,
                                  __attribute__((unused))
                                  real *const sc_to_bb_fillins) {
    /*
     *
     * Row 1
     *
     */

    real pivot = sc_to_sc_matrix[0];

    // sc-row-1 = sc-row-1 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[0] = 1;
#endif

    sc_to_sc_matrix[1] /= pivot;

    sc_g_matrix[0] /= pivot;

    /*
    Resulting matrix:

       sc              bb            g
     1 2 3 4       1 2 3 4 5 6
    ---------     -------------
    |1 M    |     |           |     |M|  1
    |x x x x|     |      x    |     |x|  2
    |  x x x| ... |      x    | ... |x|  3 sc
    |  x x x|     |      x    |     |x|  4
    ---------     -------------
    */

    /*
     *
     * Row 2
     *
     */

    pivot = sc_to_sc_matrix[2];

    // sc-row-2 = sc-row-2 - sc-row-1 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[2] = 0;
#endif

    sc_to_sc_matrix[3] -= sc_to_sc_matrix[1] * pivot;

    sc_g_matrix[1] -= sc_g_matrix[0] * pivot;

    /*
    Resulting matrix:

       sc              bb            g
     1 2 3 4       1 2 3 4 5 6
    ---------     -------------
    |1 M    |     |           |     |M|  1
    |0 M x x|     |      x    |     |M|  2
    |  x x x| ... |      x    | ... |x|  3 sc
    |  x x x|     |      x    |     |x|  4
    ---------     -------------
    */

    pivot = sc_to_sc_matrix[3];

    // sc-row-2 = sc-row-2 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[3] = 1;
#endif

    sc_to_sc_matrix[4] /= pivot;
    sc_to_sc_matrix[5] /= pivot;

    sc_to_bb_matrix[0] /= pivot;

    sc_g_matrix[1] /= pivot;

    /*
    Resulting matrix:

       sc              bb            g
     1 2 3 4       1 2 3 4 5 6
    ---------     -------------
    |1 M    |     |           |     |M|  1
    |0 1 M M|     |      M    |     |M|  2
    |  x x x| ... |      x    | ... |x|  3 sc
    |  x x x|     |      x    |     |x|  4
    ---------     -------------
    */

    /*
     *
     * Row 3
     *
     */

    pivot = sc_to_sc_matrix[6];

    // sc-row-3 = sc-row-3 - sc-row-2 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[6] = 0;
#endif

    sc_to_sc_matrix[7] -= sc_to_sc_matrix[4] * pivot;
    sc_to_sc_matrix[8] -= sc_to_sc_matrix[5] * pivot;

    sc_to_bb_matrix[1] -= sc_to_bb_matrix[0] * pivot;

    sc_g_matrix[2] -= sc_g_matrix[1] * pivot;

    /*
    Resulting matrix:

       sc              bb            g
     1 2 3 4       1 2 3 4 5 6
    ---------     -------------
    |1 M    |     |           |     |M|  1
    |0 1 M M|     |      M    |     |M|  2
    |  0 M M| ... |      M    | ... |M|  3 sc
    |  x x x|     |      x    |     |x|  4
    ---------     -------------
    */

    pivot = sc_to_sc_matrix[7];

    // sc-row-3 = sc-row-3 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[7] = 1;
#endif

    sc_to_sc_matrix[8] /= pivot;

    sc_to_bb_matrix[1] /= pivot;

    sc_g_matrix[2] /= pivot;

    /*
    Resulting matrix:

       sc              bb            g
     1 2 3 4       1 2 3 4 5 6
    ---------     -------------
    |1 M    |     |           |     |M|  1
    |0 1 M M|     |      M    |     |M|  2
    |  0 1 M| ... |      M    | ... |M|  3 sc
    |  x x x|     |      x    |     |x|  4
    ---------     -------------
    */

    /*
     *
     * Row 4
     *
     */

    pivot = sc_to_sc_matrix[9];

    // sc-row-4 = sc-row-4 - sc-row-2 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[9] = 0;
#endif

    sc_to_sc_matrix[10] -= sc_to_sc_matrix[4] * pivot;
    sc_to_sc_matrix[11] -= sc_to_sc_matrix[5] * pivot;

    sc_to_bb_matrix[2] -= sc_to_bb_matrix[0] * pivot;

    sc_g_matrix[3] -= sc_g_matrix[1] * pivot;

    /*
    Resulting matrix:

       sc              bb            g
     1 2 3 4       1 2 3 4 5 6
    ---------     -------------
    |1 M    |     |           |     |M|  1
    |0 1 M M|     |      M    |     |M|  2
    |  0 1 M| ... |      M    | ... |M|  3 sc
    |  0 M M|     |      M    |     |M|  4
    ---------     -------------
    */

    pivot = sc_to_sc_matrix[10];

    // sc-row-4 = sc-row-4 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[10] = 0;
#endif

    sc_to_sc_matrix[11] -= sc_to_sc_matrix[8] * pivot;

    sc_to_bb_matrix[2] -= sc_to_bb_matrix[1] * pivot;

    sc_g_matrix[3] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

       sc              bb            g
     1 2 3 4       1 2 3 4 5 6
    ---------     -------------
    |1 M    |     |           |     |M|  1
    |0 1 M M|     |      M    |     |M|  2
    |  0 1 M| ... |      M    | ... |M|  3 sc
    |  0 0 M|     |      M    |     |M|  4
    ---------     -------------
    */

    pivot = sc_to_sc_matrix[11];

    // sc-row-4 = sc-row-4 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[11] = 1;
#endif

    sc_to_bb_matrix[2] /= pivot;

    sc_g_matrix[3] /= pivot;

    /*
    Resulting matrix:

       sc              bb            g
     1 2 3 4       1 2 3 4 5 6
    ---------     -------------
    |1 M    |     |           |     |M|  1
    |0 1 M M|     |      M    |     |M|  2
    |  0 1 M| ... |      M    | ... |M|  3 sc
    |  0 0 1|     |      M    |     |M|  4
    ---------     -------------
    */
}

void gmx::IlvesPC::solve_2_phenylaline(real *const sc_to_sc_matrix,
                                       real *const sc_to_bb_matrix,
                                       __attribute__((unused))
                                       real *const sc_to_sep_matrix,
                                       real *const sc_g_matrix,
                                       real *const sc_to_sc_fillins,
                                       __attribute__((unused))
                                       real *const sc_to_bb_fillins) {
    /*
     *
     * Row 1
     *
     */

    real pivot = sc_to_sc_matrix[0];

    // sc-row-1 = sc-row-1 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[0] = 1;
#endif

    sc_to_sc_matrix[1] /= pivot;
    sc_to_sc_matrix[2] /= pivot;

    sc_g_matrix[0] /= pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   M             M        |     |           |     |M|  1
    |  x x   x                  |     |           |     |x|  2
    |x x x   x         x        |     |           |     |x|  3
    |      x x   x              |     |           |     |x|  4
    |  x x x x   x              |     |           |     |x|  5
    |          x x   x          |     |           |     |x|  6
    |      x x x x   x          |     |           |     |x|  7
    |              x x   x      | ... |           | ... |x|  8 sc
    |          x x x x   x      |     |           |     |x|  9
    |x   x             x x x    |     |           |     |x| 10
    |              x x x x x    |     |           |     |x| 11
    |                  x x x x x|     |      x    |     |x| 12
    |                      x x x|     |      x    |     |x| 13
    |                      x x x|     |      x    |     |x| 14
    -----------------------------     -------------
    */

    /*
     *
     * Row 2
     *
     */

    pivot = sc_to_sc_matrix[3];

    // sc-row-2 = sc-row-2 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[3] = 1;
#endif

    sc_to_sc_matrix[4] /= pivot;
    sc_to_sc_matrix[5] /= pivot;

    sc_g_matrix[1] /= pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   M             M        |     |           |     |M|  1
    |  1 M   M                  |     |           |     |M|  2
    |x x x   x         x        |     |           |     |x|  3
    |      x x   x              |     |           |     |x|  4
    |  x x x x   x              |     |           |     |x|  5
    |          x x   x          |     |           |     |x|  6
    |      x x x x   x          |     |           |     |x|  7
    |              x x   x      | ... |           | ... |x|  8 sc
    |          x x x x   x      |     |           |     |x|  9
    |x   x             x x x    |     |           |     |x| 10
    |              x x x x x    |     |           |     |x| 11
    |                  x x x x x|     |      x    |     |x| 12
    |                      x x x|     |      x    |     |x| 13
    |                      x x x|     |      x    |     |x| 14
    -----------------------------     -------------
    */

    /*
     *
     * Row 3
     *
     */

    pivot = sc_to_sc_matrix[6];

    // sc-row-3 = sc-row-3 - sc-row-1 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[6] = 0;
#endif

    sc_to_sc_matrix[8] -= sc_to_sc_matrix[1] * pivot;
    sc_to_sc_matrix[10] -= sc_to_sc_matrix[2] * pivot;

    sc_g_matrix[2] -= sc_g_matrix[0] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   M             M        |     |           |     |M|  1
    |  1 M   M                  |     |           |     |M|  2
    |0 x M   x         M        |     |           |     |M|  3
    |      x x   x              |     |           |     |x|  4
    |  x x x x   x              |     |           |     |x|  5
    |          x x   x          |     |           |     |x|  6
    |      x x x x   x          |     |           |     |x|  7
    |              x x   x      | ... |           | ... |x|  8 sc
    |          x x x x   x      |     |           |     |x|  9
    |x   x             x x x    |     |           |     |x| 10
    |              x x x x x    |     |           |     |x| 11
    |                  x x x x x|     |      x    |     |x| 12
    |                      x x x|     |      x    |     |x| 13
    |                      x x x|     |      x    |     |x| 14
    -----------------------------     -------------
    */

    pivot = sc_to_sc_matrix[7];

    // sc-row-3 = sc-row-3 - sc-row-2 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[7] = 0;
#endif

    sc_to_sc_matrix[8] -= sc_to_sc_matrix[4] * pivot;
    sc_to_sc_matrix[9] -= sc_to_sc_matrix[5] * pivot;

    sc_g_matrix[2] -= sc_g_matrix[1] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   M             M        |     |           |     |M|  1
    |  1 M   M                  |     |           |     |M|  2
    |0 0 M   M         M        |     |           |     |M|  3
    |      x x   x              |     |           |     |x|  4
    |  x x x x   x              |     |           |     |x|  5
    |          x x   x          |     |           |     |x|  6
    |      x x x x   x          |     |           |     |x|  7
    |              x x   x      | ... |           | ... |x|  8 sc
    |          x x x x   x      |     |           |     |x|  9
    |x   x             x x x    |     |           |     |x| 10
    |              x x x x x    |     |           |     |x| 11
    |                  x x x x x|     |      x    |     |x| 12
    |                      x x x|     |      x    |     |x| 13
    |                      x x x|     |      x    |     |x| 14
    -----------------------------     -------------
    */

    pivot = sc_to_sc_matrix[8];

    // sc-row-3 = sc-row-3 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[8] = 1;
#endif

    sc_to_sc_matrix[9] /= pivot;
    sc_to_sc_matrix[10] /= pivot;

    sc_g_matrix[2] /= pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   M             M        |     |           |     |M|  1
    |  1 M   M                  |     |           |     |M|  2
    |0 0 1   M         M        |     |           |     |M|  3
    |      x x   x              |     |           |     |x|  4
    |  x x x x   x              |     |           |     |x|  5
    |          x x   x          |     |           |     |x|  6
    |      x x x x   x          |     |           |     |x|  7
    |              x x   x      | ... |           | ... |x|  8 sc
    |          x x x x   x      |     |           |     |x|  9
    |x   x             x x x    |     |           |     |x| 10
    |              x x x x x    |     |           |     |x| 11
    |                  x x x x x|     |      x    |     |x| 12
    |                      x x x|     |      x    |     |x| 13
    |                      x x x|     |      x    |     |x| 14
    -----------------------------     -------------
    */

    /*
     *
     * Row 4
     *
     */

    pivot = sc_to_sc_matrix[11];

    // sc-row-4 = sc-row-4 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[11] = 1;
#endif

    sc_to_sc_matrix[12] /= pivot;
    sc_to_sc_matrix[13] /= pivot;

    sc_g_matrix[3] /= pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   M             M        |     |           |     |M|  1
    |  1 M   M                  |     |           |     |M|  2
    |0 0 1   M         M        |     |           |     |M|  3
    |      1 M   M              |     |           |     |M|  4
    |  x x x x   x              |     |           |     |x|  5
    |          x x   x          |     |           |     |x|  6
    |      x x x x   x          |     |           |     |x|  7
    |              x x   x      | ... |           | ... |x|  8 sc
    |          x x x x   x      |     |           |     |x|  9
    |x   x             x x x    |     |           |     |x| 10
    |              x x x x x    |     |           |     |x| 11
    |                  x x x x x|     |      x    |     |x| 12
    |                      x x x|     |      x    |     |x| 13
    |                      x x x|     |      x    |     |x| 14
    -----------------------------     -------------
    */

    /*
     *
     * Row 5
     *
     */

    pivot = sc_to_sc_matrix[14];

    // sc-row-5 = sc-row-5 - sc-row-2 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[14] = 0;
#endif

    sc_to_sc_matrix[15] -= sc_to_sc_matrix[4] * pivot;
    sc_to_sc_matrix[17] -= sc_to_sc_matrix[5] * pivot;

    sc_g_matrix[4] -= sc_g_matrix[1] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   M             M        |     |           |     |M|  1
    |  1 M   M                  |     |           |     |M|  2
    |0 0 1   M         M        |     |           |     |M|  3
    |      1 M   M              |     |           |     |M|  4
    |  0 M x M   x              |     |           |     |M|  5
    |          x x   x          |     |           |     |x|  6
    |      x x x x   x          |     |           |     |x|  7
    |              x x   x      | ... |           | ... |x|  8 sc
    |          x x x x   x      |     |           |     |x|  9
    |x   x             x x x    |     |           |     |x| 10
    |              x x x x x    |     |           |     |x| 11
    |                  x x x x x|     |      x    |     |x| 12
    |                      x x x|     |      x    |     |x| 13
    |                      x x x|     |      x    |     |x| 14
    -----------------------------     -------------
    */

    pivot = sc_to_sc_matrix[15];

    // sc-row-5 = sc-row-5 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[15] = 0;
#endif

    sc_to_sc_matrix[17] -= sc_to_sc_matrix[9] * pivot;

    sc_to_sc_fillins[0] = -sc_to_sc_matrix[10] * pivot;

    sc_g_matrix[4] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   M             M        |     |           |     |M|  1
    |  1 M   M                  |     |           |     |M|  2
    |0 0 1   M         M        |     |           |     |M|  3
    |      1 M   M              |     |           |     |M|  4
    |  0 0 x M   x     F        |     |           |     |M|  5
    |          x x   x          |     |           |     |x|  6
    |      x x x x   x          |     |           |     |x|  7
    |              x x   x      | ... |           | ... |x|  8 sc
    |          x x x x   x      |     |           |     |x|  9
    |x   x             x x x    |     |           |     |x| 10
    |              x x x x x    |     |           |     |x| 11
    |                  x x x x x|     |      x    |     |x| 12
    |                      x x x|     |      x    |     |x| 13
    |                      x x x|     |      x    |     |x| 14
    -----------------------------     -------------
    */

    pivot = sc_to_sc_matrix[16];

    // sc-row-5 = sc-row-5 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[16] = 0;
#endif

    sc_to_sc_matrix[17] -= sc_to_sc_matrix[12] * pivot;
    sc_to_sc_matrix[18] -= sc_to_sc_matrix[13] * pivot;

    sc_g_matrix[4] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   M             M        |     |           |     |M|  1
    |  1 M   M                  |     |           |     |M|  2
    |0 0 1   M         M        |     |           |     |M|  3
    |      1 M   M              |     |           |     |M|  4
    |  0 0 0 M   M     F        |     |           |     |M|  5
    |          x x   x          |     |           |     |x|  6
    |      x x x x   x          |     |           |     |x|  7
    |              x x   x      | ... |           | ... |x|  8 sc
    |          x x x x   x      |     |           |     |x|  9
    |x   x             x x x    |     |           |     |x| 10
    |              x x x x x    |     |           |     |x| 11
    |                  x x x x x|     |      x    |     |x| 12
    |                      x x x|     |      x    |     |x| 13
    |                      x x x|     |      x    |     |x| 14
    -----------------------------     -------------
    */

    pivot = sc_to_sc_matrix[17];

    // sc-row-5 = sc-row-5 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[17] = 1;
#endif

    sc_to_sc_matrix[18] /= pivot;

    sc_to_sc_fillins[0] /= pivot;

    sc_g_matrix[4] /= pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   M             M        |     |           |     |M|  1
    |  1 M   M                  |     |           |     |M|  2
    |0 0 1   M         M        |     |           |     |M|  3
    |      1 M   M              |     |           |     |M|  4
    |  0 0 0 1   M     F        |     |           |     |M|  5
    |          x x   x          |     |           |     |x|  6
    |      x x x x   x          |     |           |     |x|  7
    |              x x   x      | ... |           | ... |x|  8 sc
    |          x x x x   x      |     |           |     |x|  9
    |x   x             x x x    |     |           |     |x| 10
    |              x x x x x    |     |           |     |x| 11
    |                  x x x x x|     |      x    |     |x| 12
    |                      x x x|     |      x    |     |x| 13
    |                      x x x|     |      x    |     |x| 14
    -----------------------------     -------------
    */

    /*
     *
     * Row 6
     *
     */

    pivot = sc_to_sc_matrix[19];

    // sc-row-6 = sc-row-6 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[19] = 1;
#endif

    sc_to_sc_matrix[20] /= pivot;
    sc_to_sc_matrix[21] /= pivot;

    sc_g_matrix[5] /= pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   M             M        |     |           |     |M|  1
    |  1 M   M                  |     |           |     |M|  2
    |0 0 1   M         M        |     |           |     |M|  3
    |      1 M   M              |     |           |     |M|  4
    |  0 0 0 1   M     F        |     |           |     |M|  5
    |          1 M   M          |     |           |     |M|  6
    |      x x x x   x          |     |           |     |x|  7
    |              x x   x      | ... |           | ... |x|  8 sc
    |          x x x x   x      |     |           |     |x|  9
    |x   x             x x x    |     |           |     |x| 10
    |              x x x x x    |     |           |     |x| 11
    |                  x x x x x|     |      x    |     |x| 12
    |                      x x x|     |      x    |     |x| 13
    |                      x x x|     |      x    |     |x| 14
    -----------------------------     -------------
    */

    /*
     *
     * Row 7
     *
     */

    pivot = sc_to_sc_matrix[22];

    // sc-row-7 = sc-row-7 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[22] = 0;
#endif

    sc_to_sc_matrix[23] -= sc_to_sc_matrix[12] * pivot;
    sc_to_sc_matrix[25] -= sc_to_sc_matrix[13] * pivot;

    sc_g_matrix[6] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   M             M        |     |           |     |M|  1
    |  1 M   M                  |     |           |     |M|  2
    |0 0 1   M         M        |     |           |     |M|  3
    |      1 M   M              |     |           |     |M|  4
    |  0 0 0 1   M     F        |     |           |     |M|  5
    |          1 M   M          |     |           |     |M|  6
    |      0 M x M   x          |     |           |     |M|  7
    |              x x   x      | ... |           | ... |x|  8 sc
    |          x x x x   x      |     |           |     |x|  9
    |x   x             x x x    |     |           |     |x| 10
    |              x x x x x    |     |           |     |x| 11
    |                  x x x x x|     |      x    |     |x| 12
    |                      x x x|     |      x    |     |x| 13
    |                      x x x|     |      x    |     |x| 14
    -----------------------------     -------------
    */

    pivot = sc_to_sc_matrix[23];

    // sc-row-7 = sc-row-7 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[23] = 0;
#endif

    sc_to_sc_matrix[25] -= sc_to_sc_matrix[18] * pivot;

    sc_to_sc_fillins[1] = -sc_to_sc_fillins[0] * pivot;

    sc_g_matrix[6] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   M             M        |     |           |     |M|  1
    |  1 M   M                  |     |           |     |M|  2
    |0 0 1   M         M        |     |           |     |M|  3
    |      1 M   M              |     |           |     |M|  4
    |  0 0 0 1   M     F        |     |           |     |M|  5
    |          1 M   M          |     |           |     |M|  6
    |      0 0 x M   x F        |     |           |     |M|  7
    |              x x   x      | ... |           | ... |x|  8 sc
    |          x x x x   x      |     |           |     |x|  9
    |x   x             x x x    |     |           |     |x| 10
    |              x x x x x    |     |           |     |x| 11
    |                  x x x x x|     |      x    |     |x| 12
    |                      x x x|     |      x    |     |x| 13
    |                      x x x|     |      x    |     |x| 14
    -----------------------------     -------------
    */

    pivot = sc_to_sc_matrix[24];

    // sc-row-7 = sc-row-7 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[24] = 0;
#endif

    sc_to_sc_matrix[25] -= sc_to_sc_matrix[20] * pivot;
    sc_to_sc_matrix[26] -= sc_to_sc_matrix[21] * pivot;

    sc_g_matrix[6] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   M             M        |     |           |     |M|  1
    |  1 M   M                  |     |           |     |M|  2
    |0 0 1   M         M        |     |           |     |M|  3
    |      1 M   M              |     |           |     |M|  4
    |  0 0 0 1   M     F        |     |           |     |M|  5
    |          1 M   M          |     |           |     |M|  6
    |      0 0 0 M   M F        |     |           |     |M|  7
    |              x x   x      | ... |           | ... |x|  8 sc
    |          x x x x   x      |     |           |     |x|  9
    |x   x             x x x    |     |           |     |x| 10
    |              x x x x x    |     |           |     |x| 11
    |                  x x x x x|     |      x    |     |x| 12
    |                      x x x|     |      x    |     |x| 13
    |                      x x x|     |      x    |     |x| 14
    -----------------------------     -------------
    */

    pivot = sc_to_sc_matrix[25];

    // sc-row-7 = sc-row-7 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[25] = 1;
#endif

    sc_to_sc_matrix[26] /= pivot;

    sc_to_sc_fillins[1] /= pivot;

    sc_g_matrix[6] /= pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   M             M        |     |           |     |M|  1
    |  1 M   M                  |     |           |     |M|  2
    |0 0 1   M         M        |     |           |     |M|  3
    |      1 M   M              |     |           |     |M|  4
    |  0 0 0 1   M     F        |     |           |     |M|  5
    |          1 M   M          |     |           |     |M|  6
    |      0 0 0 1   M F        |     |           |     |M|  7
    |              x x   x      | ... |           | ... |x|  8 sc
    |          x x x x   x      |     |           |     |x|  9
    |x   x             x x x    |     |           |     |x| 10
    |              x x x x x    |     |           |     |x| 11
    |                  x x x x x|     |      x    |     |x| 12
    |                      x x x|     |      x    |     |x| 13
    |                      x x x|     |      x    |     |x| 14
    -----------------------------     -------------
    */

    /*
     *
     * Row 8
     *
     */

    pivot = sc_to_sc_matrix[27];

    // sc-row-8 = sc-row-8 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[27] = 1;
#endif

    sc_to_sc_matrix[28] /= pivot;
    sc_to_sc_matrix[29] /= pivot;

    sc_g_matrix[7] /= pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   M             M        |     |           |     |M|  1
    |  1 M   M                  |     |           |     |M|  2
    |0 0 1   M         M        |     |           |     |M|  3
    |      1 M   M              |     |           |     |M|  4
    |  0 0 0 1   M     F        |     |           |     |M|  5
    |          1 M   M          |     |           |     |M|  6
    |      0 0 0 1   M F        |     |           |     |M|  7
    |              1 M   M      | ... |           | ... |M|  8 sc
    |          x x x x   x      |     |           |     |x|  9
    |x   x             x x x    |     |           |     |x| 10
    |              x x x x x    |     |           |     |x| 11
    |                  x x x x x|     |      x    |     |x| 12
    |                      x x x|     |      x    |     |x| 13
    |                      x x x|     |      x    |     |x| 14
    -----------------------------     -------------
    */

    /*
     *
     * Row 9
     *
     */

    pivot = sc_to_sc_matrix[30];

    // sc-row-9 = sc-row-9 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[30] = 0;
#endif

    sc_to_sc_matrix[31] -= sc_to_sc_matrix[20] * pivot;
    sc_to_sc_matrix[33] -= sc_to_sc_matrix[21] * pivot;

    sc_g_matrix[8] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   M             M        |     |           |     |M|  1
    |  1 M   M                  |     |           |     |M|  2
    |0 0 1   M         M        |     |           |     |M|  3
    |      1 M   M              |     |           |     |M|  4
    |  0 0 0 1   M     F        |     |           |     |M|  5
    |          1 M   M          |     |           |     |M|  6
    |      0 0 0 1   M F        |     |           |     |M|  7
    |              1 M   M      | ... |           | ... |M|  8 sc
    |          0 M x M   x      |     |           |     |M|  9
    |x   x             x x x    |     |           |     |x| 10
    |              x x x x x    |     |           |     |x| 11
    |                  x x x x x|     |      x    |     |x| 12
    |                      x x x|     |      x    |     |x| 13
    |                      x x x|     |      x    |     |x| 14
    -----------------------------     -------------
    */

    pivot = sc_to_sc_matrix[31];

    // sc-row-9 = sc-row-9 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[31] = 0;
#endif

    sc_to_sc_matrix[33] -= sc_to_sc_matrix[26] * pivot;

    sc_to_sc_fillins[2] = -sc_to_sc_fillins[1] * pivot;

    sc_g_matrix[8] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   M             M        |     |           |     |M|  1
    |  1 M   M                  |     |           |     |M|  2
    |0 0 1   M         M        |     |           |     |M|  3
    |      1 M   M              |     |           |     |M|  4
    |  0 0 0 1   M     F        |     |           |     |M|  5
    |          1 M   M          |     |           |     |M|  6
    |      0 0 0 1   M F        |     |           |     |M|  7
    |              1 M   M      | ... |           | ... |M|  8 sc
    |          0 0 x M F x      |     |           |     |M|  9
    |x   x             x x x    |     |           |     |x| 10
    |              x x x x x    |     |           |     |x| 11
    |                  x x x x x|     |      x    |     |x| 12
    |                      x x x|     |      x    |     |x| 13
    |                      x x x|     |      x    |     |x| 14
    -----------------------------     -------------
    */

    pivot = sc_to_sc_matrix[32];

    // sc-row-9 = sc-row-9 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[32] = 0;
#endif

    sc_to_sc_matrix[33] -= sc_to_sc_matrix[28] * pivot;
    sc_to_sc_matrix[34] -= sc_to_sc_matrix[29] * pivot;

    sc_g_matrix[8] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   M             M        |     |           |     |M|  1
    |  1 M   M                  |     |           |     |M|  2
    |0 0 1   M         M        |     |           |     |M|  3
    |      1 M   M              |     |           |     |M|  4
    |  0 0 0 1   M     F        |     |           |     |M|  5
    |          1 M   M          |     |           |     |M|  6
    |      0 0 0 1   M F        |     |           |     |M|  7
    |              1 M   M      | ... |           | ... |M|  8 sc
    |          0 0 0 M F M      |     |           |     |M|  9
    |x   x             x x x    |     |           |     |x| 10
    |              x x x x x    |     |           |     |x| 11
    |                  x x x x x|     |      x    |     |x| 12
    |                      x x x|     |      x    |     |x| 13
    |                      x x x|     |      x    |     |x| 14
    -----------------------------     -------------
    */

    pivot = sc_to_sc_matrix[33];

    // sc-row-9 = sc-row-9 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[33] = 1;
#endif

    sc_to_sc_fillins[2] /= pivot;

    sc_to_sc_matrix[34] /= pivot;

    sc_g_matrix[8] /= pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   M             M        |     |           |     |M|  1
    |  1 M   M                  |     |           |     |M|  2
    |0 0 1   M         M        |     |           |     |M|  3
    |      1 M   M              |     |           |     |M|  4
    |  0 0 0 1   M     F        |     |           |     |M|  5
    |          1 M   M          |     |           |     |M|  6
    |      0 0 0 1   M F        |     |           |     |M|  7
    |              1 M   M      | ... |           | ... |M|  8 sc
    |          0 0 0 1 F M      |     |           |     |M|  9
    |x   x             x x x    |     |           |     |x| 10
    |              x x x x x    |     |           |     |x| 11
    |                  x x x x x|     |      x    |     |x| 12
    |                      x x x|     |      x    |     |x| 13
    |                      x x x|     |      x    |     |x| 14
    -----------------------------     -------------
    */

    /*
     *
     * Row 10
     *
     */

    pivot = sc_to_sc_matrix[35];

    // sc-row-10 = sc-row-10 - sc-row-1 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[35] = 0;
#endif

    sc_to_sc_matrix[36] -= sc_to_sc_matrix[1] * pivot;
    sc_to_sc_matrix[37] -= sc_to_sc_matrix[2] * pivot;

    sc_g_matrix[9] -= sc_g_matrix[0] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   M             M        |     |           |     |M|  1
    |  1 M   M                  |     |           |     |M|  2
    |0 0 1   M         M        |     |           |     |M|  3
    |      1 M   M              |     |           |     |M|  4
    |  0 0 0 1   M     F        |     |           |     |M|  5
    |          1 M   M          |     |           |     |M|  6
    |      0 0 0 1   M F        |     |           |     |M|  7
    |              1 M   M      | ... |           | ... |M|  8 sc
    |          0 0 0 1 F M      |     |           |     |M|  9
    |0   M             M x x    |     |           |     |M| 10
    |              x x x x x    |     |           |     |x| 11
    |                  x x x x x|     |      x    |     |x| 12
    |                      x x x|     |      x    |     |x| 13
    |                      x x x|     |      x    |     |x| 14
    -----------------------------     -------------
    */

    pivot = sc_to_sc_matrix[36];

    // sc-row-10 = sc-row-10 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[36] = 0;
#endif

    sc_to_sc_fillins[3] = -sc_to_sc_matrix[9] * pivot;

    sc_to_sc_matrix[37] -= sc_to_sc_matrix[10] * pivot;

    sc_g_matrix[9] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   M             M        |     |           |     |M|  1
    |  1 M   M                  |     |           |     |M|  2
    |0 0 1   M         M        |     |           |     |M|  3
    |      1 M   M              |     |           |     |M|  4
    |  0 0 0 1   M     F        |     |           |     |M|  5
    |          1 M   M          |     |           |     |M|  6
    |      0 0 0 1   M F        |     |           |     |M|  7
    |              1 M   M      | ... |           | ... |M|  8 sc
    |          0 0 0 1 F M      |     |           |     |M|  9
    |0   0   F         M x x    |     |           |     |M| 10
    |              x x x x x    |     |           |     |x| 11
    |                  x x x x x|     |      x    |     |x| 12
    |                      x x x|     |      x    |     |x| 13
    |                      x x x|     |      x    |     |x| 14
    -----------------------------     -------------
    */

    pivot = sc_to_sc_fillins[3];

    // sc-row-10 = sc-row-10 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_fillins[3] = 0;
#endif

    sc_to_sc_fillins[4] = -sc_to_sc_matrix[18] * pivot;

    sc_to_sc_matrix[37] -= sc_to_sc_fillins[0] * pivot;

    sc_g_matrix[9] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   M             M        |     |           |     |M|  1
    |  1 M   M                  |     |           |     |M|  2
    |0 0 1   M         M        |     |           |     |M|  3
    |      1 M   M              |     |           |     |M|  4
    |  0 0 0 1   M     F        |     |           |     |M|  5
    |          1 M   M          |     |           |     |M|  6
    |      0 0 0 1   M F        |     |           |     |M|  7
    |              1 M   M      | ... |           | ... |M|  8 sc
    |          0 0 0 1 F M      |     |           |     |M|  9
    |0   0   0   F     M x x    |     |           |     |M| 10
    |              x x x x x    |     |           |     |x| 11
    |                  x x x x x|     |      x    |     |x| 12
    |                      x x x|     |      x    |     |x| 13
    |                      x x x|     |      x    |     |x| 14
    -----------------------------     -------------
    */

    pivot = sc_to_sc_fillins[4];

    // sc-row-10 = sc-row-10 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_fillins[4] = 0;
#endif

    sc_to_sc_fillins[5] = -sc_to_sc_matrix[26] * pivot;

    sc_to_sc_matrix[37] -= sc_to_sc_fillins[1] * pivot;

    sc_g_matrix[9] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   M             M        |     |           |     |M|  1
    |  1 M   M                  |     |           |     |M|  2
    |0 0 1   M         M        |     |           |     |M|  3
    |      1 M   M              |     |           |     |M|  4
    |  0 0 0 1   M     F        |     |           |     |M|  5
    |          1 M   M          |     |           |     |M|  6
    |      0 0 0 1   M F        |     |           |     |M|  7
    |              1 M   M      | ... |           | ... |M|  8 sc
    |          0 0 0 1 F M      |     |           |     |M|  9
    |0   0   0   0   F M x x    |     |           |     |M| 10
    |              x x x x x    |     |           |     |x| 11
    |                  x x x x x|     |      x    |     |x| 12
    |                      x x x|     |      x    |     |x| 13
    |                      x x x|     |      x    |     |x| 14
    -----------------------------     -------------
    */

    pivot = sc_to_sc_fillins[5];

    // sc-row-10 = sc-row-10 - sc-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_fillins[5] = 0;
#endif

    sc_to_sc_matrix[37] -= sc_to_sc_fillins[2] * pivot;
    sc_to_sc_matrix[38] -= sc_to_sc_matrix[34] * pivot;

    sc_g_matrix[9] -= sc_g_matrix[8] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   M             M        |     |           |     |M|  1
    |  1 M   M                  |     |           |     |M|  2
    |0 0 1   M         M        |     |           |     |M|  3
    |      1 M   M              |     |           |     |M|  4
    |  0 0 0 1   M     F        |     |           |     |M|  5
    |          1 M   M          |     |           |     |M|  6
    |      0 0 0 1   M F        |     |           |     |M|  7
    |              1 M   M      | ... |           | ... |M|  8 sc
    |          0 0 0 1 F M      |     |           |     |M|  9
    |0   0   0   0   0 M M x    |     |           |     |M| 10
    |              x x x x x    |     |           |     |x| 11
    |                  x x x x x|     |      x    |     |x| 12
    |                      x x x|     |      x    |     |x| 13
    |                      x x x|     |      x    |     |x| 14
    -----------------------------     -------------
    */

    pivot = sc_to_sc_matrix[37];

    // sc-row-10 = sc-row-10 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[37] = 1;
#endif

    sc_to_sc_matrix[38] /= pivot;
    sc_to_sc_matrix[39] /= pivot;

    sc_g_matrix[9] /= pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   M             M        |     |           |     |M|  1
    |  1 M   M                  |     |           |     |M|  2
    |0 0 1   M         M        |     |           |     |M|  3
    |      1 M   M              |     |           |     |M|  4
    |  0 0 0 1   M     F        |     |           |     |M|  5
    |          1 M   M          |     |           |     |M|  6
    |      0 0 0 1   M F        |     |           |     |M|  7
    |              1 M   M      | ... |           | ... |M|  8 sc
    |          0 0 0 1 F M      |     |           |     |M|  9
    |0   0   0   0   0 1 M M    |     |           |     |M| 10
    |              x x x x x    |     |           |     |x| 11
    |                  x x x x x|     |      x    |     |x| 12
    |                      x x x|     |      x    |     |x| 13
    |                      x x x|     |      x    |     |x| 14
    -----------------------------     -------------
    */

    /*
     *
     * Row 11
     *
     */

    pivot = sc_to_sc_matrix[40];

    // sc-row-11 = sc-row-11 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[40] = 0;
#endif

    sc_to_sc_matrix[41] -= sc_to_sc_matrix[28] * pivot;
    sc_to_sc_matrix[43] -= sc_to_sc_matrix[29] * pivot;

    sc_g_matrix[10] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   M             M        |     |           |     |M|  1
    |  1 M   M                  |     |           |     |M|  2
    |0 0 1   M         M        |     |           |     |M|  3
    |      1 M   M              |     |           |     |M|  4
    |  0 0 0 1   M     F        |     |           |     |M|  5
    |          1 M   M          |     |           |     |M|  6
    |      0 0 0 1   M F        |     |           |     |M|  7
    |              1 M   M      | ... |           | ... |M|  8 sc
    |          0 0 0 1 F M      |     |           |     |M|  9
    |0   0   0   0   0 1 M M    |     |           |     |M| 10
    |              0 M x M x    |     |           |     |M| 11
    |                  x x x x x|     |      x    |     |x| 12
    |                      x x x|     |      x    |     |x| 13
    |                      x x x|     |      x    |     |x| 14
    -----------------------------     -------------
    */

    pivot = sc_to_sc_matrix[41];

    // sc-row-11 = sc-row-11 - sc-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[41] = 0;
#endif

    sc_to_sc_matrix[42] -= sc_to_sc_fillins[2] * pivot;
    sc_to_sc_matrix[43] -= sc_to_sc_matrix[34] * pivot;

    sc_g_matrix[10] -= sc_g_matrix[8] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   M             M        |     |           |     |M|  1
    |  1 M   M                  |     |           |     |M|  2
    |0 0 1   M         M        |     |           |     |M|  3
    |      1 M   M              |     |           |     |M|  4
    |  0 0 0 1   M     F        |     |           |     |M|  5
    |          1 M   M          |     |           |     |M|  6
    |      0 0 0 1   M F        |     |           |     |M|  7
    |              1 M   M      | ... |           | ... |M|  8 sc
    |          0 0 0 1 F M      |     |           |     |M|  9
    |0   0   0   0   0 1 M M    |     |           |     |M| 10
    |              0 0 M M x    |     |           |     |M| 11
    |                  x x x x x|     |      x    |     |x| 12
    |                      x x x|     |      x    |     |x| 13
    |                      x x x|     |      x    |     |x| 14
    -----------------------------     -------------
    */

    pivot = sc_to_sc_matrix[42];

    // sc-row-11 = sc-row-11 - sc-row-10 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[42] = 0;
#endif

    sc_to_sc_matrix[43] -= sc_to_sc_matrix[38] * pivot;
    sc_to_sc_matrix[44] -= sc_to_sc_matrix[39] * pivot;

    sc_g_matrix[10] -= sc_g_matrix[9] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   M             M        |     |           |     |M|  1
    |  1 M   M                  |     |           |     |M|  2
    |0 0 1   M         M        |     |           |     |M|  3
    |      1 M   M              |     |           |     |M|  4
    |  0 0 0 1   M     F        |     |           |     |M|  5
    |          1 M   M          |     |           |     |M|  6
    |      0 0 0 1   M F        |     |           |     |M|  7
    |              1 M   M      | ... |           | ... |M|  8 sc
    |          0 0 0 1 F M      |     |           |     |M|  9
    |0   0   0   0   0 1 M M    |     |           |     |M| 10
    |              0 0 0 M M    |     |           |     |M| 11
    |                  x x x x x|     |      x    |     |x| 12
    |                      x x x|     |      x    |     |x| 13
    |                      x x x|     |      x    |     |x| 14
    -----------------------------     -------------
    */

    pivot = sc_to_sc_matrix[43];

    // sc-row-11 = sc-row-11 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[43] = 1;
#endif

    sc_to_sc_matrix[44] /= pivot;

    sc_g_matrix[10] /= pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   M             M        |     |           |     |M|  1
    |  1 M   M                  |     |           |     |M|  2
    |0 0 1   M         M        |     |           |     |M|  3
    |      1 M   M              |     |           |     |M|  4
    |  0 0 0 1   M     F        |     |           |     |M|  5
    |          1 M   M          |     |           |     |M|  6
    |      0 0 0 1   M F        |     |           |     |M|  7
    |              1 M   M      | ... |           | ... |M|  8 sc
    |          0 0 0 1 F M      |     |           |     |M|  9
    |0   0   0   0   0 1 M M    |     |           |     |M| 10
    |              0 0 0 1 M    |     |           |     |M| 11
    |                  x x x x x|     |      x    |     |x| 12
    |                      x x x|     |      x    |     |x| 13
    |                      x x x|     |      x    |     |x| 14
    -----------------------------     -------------
    */

    /*
     *
     * Row 12
     *
     */

    pivot = sc_to_sc_matrix[45];

    // sc-row-12 = sc-row-12 - sc-row-10 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[45] = 0;
#endif

    sc_to_sc_matrix[46] -= sc_to_sc_matrix[38] * pivot;
    sc_to_sc_matrix[47] -= sc_to_sc_matrix[39] * pivot;

    sc_g_matrix[11] -= sc_g_matrix[9] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   M             M        |     |           |     |M|  1
    |  1 M   M                  |     |           |     |M|  2
    |0 0 1   M         M        |     |           |     |M|  3
    |      1 M   M              |     |           |     |M|  4
    |  0 0 0 1   M     F        |     |           |     |M|  5
    |          1 M   M          |     |           |     |M|  6
    |      0 0 0 1   M F        |     |           |     |M|  7
    |              1 M   M      | ... |           | ... |M|  8 sc
    |          0 0 0 1 F M      |     |           |     |M|  9
    |0   0   0   0   0 1 M M    |     |           |     |M| 10
    |              0 0 0 1 M    |     |           |     |M| 11
    |                  0 M M x x|     |      x    |     |M| 12
    |                      x x x|     |      x    |     |x| 13
    |                      x x x|     |      x    |     |x| 14
    -----------------------------     -------------
    */

    pivot = sc_to_sc_matrix[46];

    // sc-row-12 = sc-row-12 - sc-row-11 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[46] = 0;
#endif

    sc_to_sc_matrix[47] -= sc_to_sc_matrix[44] * pivot;

    sc_g_matrix[11] -= sc_g_matrix[10] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   M             M        |     |           |     |M|  1
    |  1 M   M                  |     |           |     |M|  2
    |0 0 1   M         M        |     |           |     |M|  3
    |      1 M   M              |     |           |     |M|  4
    |  0 0 0 1   M     F        |     |           |     |M|  5
    |          1 M   M          |     |           |     |M|  6
    |      0 0 0 1   M F        |     |           |     |M|  7
    |              1 M   M      | ... |           | ... |M|  8 sc
    |          0 0 0 1 F M      |     |           |     |M|  9
    |0   0   0   0   0 1 M M    |     |           |     |M| 10
    |              0 0 0 1 M    |     |           |     |M| 11
    |                  0 0 M x x|     |      x    |     |M| 12
    |                      x x x|     |      x    |     |x| 13
    |                      x x x|     |      x    |     |x| 14
    -----------------------------     -------------
    */

    pivot = sc_to_sc_matrix[47];

    // sc-row-12 = sc-row-12 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[47] = 1;
#endif

    sc_to_sc_matrix[48] /= pivot;
    sc_to_sc_matrix[49] /= pivot;

    sc_to_bb_matrix[0] /= pivot;

    sc_g_matrix[11] /= pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   M             M        |     |           |     |M|  1
    |  1 M   M                  |     |           |     |M|  2
    |0 0 1   M         M        |     |           |     |M|  3
    |      1 M   M              |     |           |     |M|  4
    |  0 0 0 1   M     F        |     |           |     |M|  5
    |          1 M   M          |     |           |     |M|  6
    |      0 0 0 1   M F        |     |           |     |M|  7
    |              1 M   M      | ... |           | ... |M|  8 sc
    |          0 0 0 1 F M      |     |           |     |M|  9
    |0   0   0   0   0 1 M M    |     |           |     |M| 10
    |              0 0 0 1 M    |     |           |     |M| 11
    |                  0 0 1 M M|     |      M    |     |M| 12
    |                      x x x|     |      x    |     |x| 13
    |                      x x x|     |      x    |     |x| 14
    -----------------------------     -------------
    */

    /*
     *
     * Row 13
     *
     */

    pivot = sc_to_sc_matrix[50];

    // sc-row-13 = sc-row-13 - sc-row-12 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[50] = 0;
#endif

    sc_to_sc_matrix[51] -= sc_to_sc_matrix[48] * pivot;
    sc_to_sc_matrix[52] -= sc_to_sc_matrix[49] * pivot;

    sc_to_bb_matrix[1] -= sc_to_bb_matrix[0] * pivot;

    sc_g_matrix[12] -= sc_g_matrix[11] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   M             M        |     |           |     |M|  1
    |  1 M   M                  |     |           |     |M|  2
    |0 0 1   M         M        |     |           |     |M|  3
    |      1 M   M              |     |           |     |M|  4
    |  0 0 0 1   M     F        |     |           |     |M|  5
    |          1 M   M          |     |           |     |M|  6
    |      0 0 0 1   M F        |     |           |     |M|  7
    |              1 M   M      | ... |           | ... |M|  8 sc
    |          0 0 0 1 F M      |     |           |     |M|  9
    |0   0   0   0   0 1 M M    |     |           |     |M| 10
    |              0 0 0 1 M    |     |           |     |M| 11
    |                  0 0 1 M M|     |      M    |     |M| 12
    |                      0 M M|     |      M    |     |M| 13
    |                      x x x|     |      x    |     |x| 14
    -----------------------------     -------------
    */

    pivot = sc_to_sc_matrix[51];

    // sc-row-13 = sc-row-13 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[51] = 1;
#endif

    sc_to_sc_matrix[52] /= pivot;

    sc_to_bb_matrix[1] /= pivot;

    sc_g_matrix[12] /= pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   M             M        |     |           |     |M|  1
    |  1 M   M                  |     |           |     |M|  2
    |0 0 1   M         M        |     |           |     |M|  3
    |      1 M   M              |     |           |     |M|  4
    |  0 0 0 1   M     F        |     |           |     |M|  5
    |          1 M   M          |     |           |     |M|  6
    |      0 0 0 1   M F        |     |           |     |M|  7
    |              1 M   M      | ... |           | ... |M|  8 sc
    |          0 0 0 1 F M      |     |           |     |M|  9
    |0   0   0   0   0 1 M M    |     |           |     |M| 10
    |              0 0 0 1 M    |     |           |     |M| 11
    |                  0 0 1 M M|     |      M    |     |M| 12
    |                      0 1 M|     |      M    |     |M| 13
    |                      x x x|     |      x    |     |x| 14
    -----------------------------     -------------
    */

    /*
     *
     * Row 14
     *
     */

    pivot = sc_to_sc_matrix[53];

    // sc-row-14 = sc-row-14 - sc-row-12 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[53] = 0;
#endif

    sc_to_sc_matrix[54] -= sc_to_sc_matrix[48] * pivot;
    sc_to_sc_matrix[55] -= sc_to_sc_matrix[49] * pivot;

    sc_to_bb_matrix[2] -= sc_to_bb_matrix[0] * pivot;

    sc_g_matrix[13] -= sc_g_matrix[11] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   M             M        |     |           |     |M|  1
    |  1 M   M                  |     |           |     |M|  2
    |0 0 1   M         M        |     |           |     |M|  3
    |      1 M   M              |     |           |     |M|  4
    |  0 0 0 1   M     F        |     |           |     |M|  5
    |          1 M   M          |     |           |     |M|  6
    |      0 0 0 1   M F        |     |           |     |M|  7
    |              1 M   M      | ... |           | ... |M|  8 sc
    |          0 0 0 1 F M      |     |           |     |M|  9
    |0   0   0   0   0 1 M M    |     |           |     |M| 10
    |              0 0 0 1 M    |     |           |     |M| 11
    |                  0 0 1 M M|     |      M    |     |M| 12
    |                      0 1 M|     |      M    |     |M| 13
    |                      0 M M|     |      M    |     |M| 14
    -----------------------------     -------------
    */

    pivot = sc_to_sc_matrix[54];

    // sc-row-14 = sc-row-14 - sc-row-13 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[54] = 0;
#endif

    sc_to_sc_matrix[55] -= sc_to_sc_matrix[52] * pivot;

    sc_to_bb_matrix[2] -= sc_to_bb_matrix[1] * pivot;

    sc_g_matrix[13] -= sc_g_matrix[12] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   M             M        |     |           |     |M|  1
    |  1 M   M                  |     |           |     |M|  2
    |0 0 1   M         M        |     |           |     |M|  3
    |      1 M   M              |     |           |     |M|  4
    |  0 0 0 1   M     F        |     |           |     |M|  5
    |          1 M   M          |     |           |     |M|  6
    |      0 0 0 1   M F        |     |           |     |M|  7
    |              1 M   M      | ... |           | ... |M|  8 sc
    |          0 0 0 1 F M      |     |           |     |M|  9
    |0   0   0   0   0 1 M M    |     |           |     |M| 10
    |              0 0 0 1 M    |     |           |     |M| 11
    |                  0 0 1 M M|     |      M    |     |M| 12
    |                      0 1 M|     |      M    |     |M| 13
    |                      0 0 M|     |      M    |     |M| 14
    -----------------------------     -------------
    */

    pivot = sc_to_sc_matrix[55];

    // sc-row-14 = sc-row-14 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[55] = 1;
#endif

    sc_to_bb_matrix[2] /= pivot;

    sc_g_matrix[13] /= pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   M             M        |     |           |     |M|  1
    |  1 M   M                  |     |           |     |M|  2
    |0 0 1   M         M        |     |           |     |M|  3
    |      1 M   M              |     |           |     |M|  4
    |  0 0 0 1   M     F        |     |           |     |M|  5
    |          1 M   M          |     |           |     |M|  6
    |      0 0 0 1   M F        |     |           |     |M|  7
    |              1 M   M      | ... |           | ... |M|  8 sc
    |          0 0 0 1 F M      |     |           |     |M|  9
    |0   0   0   0   0 1 M M    |     |           |     |M| 10
    |              0 0 0 1 M    |     |           |     |M| 11
    |                  0 0 1 M M|     |      M    |     |M| 12
    |                      0 1 M|     |      M    |     |M| 13
    |                      0 0 1|     |      M    |     |M| 14
    -----------------------------     -------------
    */
}

void gmx::IlvesPC::solve_2_tyrosine(real *const sc_to_sc_matrix,
                                    real *const sc_to_bb_matrix,
                                    __attribute__((unused))
                                    real *const sc_to_sep_matrix,
                                    real *const sc_g_matrix,
                                    real *const sc_to_sc_fillins,
                                    __attribute__((unused))
                                    real *const sc_to_bb_fillins) {
    /*
     *
     * Row 1
     *
     */

    real pivot = sc_to_sc_matrix[0];

    // sc-row-1 = sc-row-1 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[0] = 1;
#endif

    sc_to_sc_matrix[1] /= pivot;

    sc_g_matrix[0] /= pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       M                    |     |           |     |M|  1
    |  x   x             x        |     |           |     |x|  2
    |    x x   x                  |     |           |     |x|  3
    |  x x x   x         x        |     |           |     |x|  4
    |x       x x   x              |     |           |     |x|  5
    |    x x x x   x              |     |           |     |x|  6
    |            x x   x          |     |           |     |x|  7
    |        x x x x   x          | ... |           | ... |x|  8 sc
    |                x x   x      |     |           |     |x|  9
    |            x x x x   x      |     |           |     |x| 10
    |  x   x             x x x    |     |           |     |x| 11
    |                x x x x x    |     |           |     |x| 12
    |                    x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 2
     *
     */

    pivot = sc_to_sc_matrix[2];

    // sc-row-2 = sc-row-2 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[2] = 1;
#endif

    sc_to_sc_matrix[3] /= pivot;
    sc_to_sc_matrix[4] /= pivot;

    sc_g_matrix[1] /= pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       M                    |     |           |     |M|  1
    |  1   M             M        |     |           |     |M|  2
    |    x x   x                  |     |           |     |x|  3
    |  x x x   x         x        |     |           |     |x|  4
    |x       x x   x              |     |           |     |x|  5
    |    x x x x   x              |     |           |     |x|  6
    |            x x   x          |     |           |     |x|  7
    |        x x x x   x          | ... |           | ... |x|  8 sc
    |                x x   x      |     |           |     |x|  9
    |            x x x x   x      |     |           |     |x| 10
    |  x   x             x x x    |     |           |     |x| 11
    |                x x x x x    |     |           |     |x| 12
    |                    x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 3
     *
     */

    pivot = sc_to_sc_matrix[5];

    // sc-row-3 = sc-row-3 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[5] = 1;
#endif

    sc_to_sc_matrix[6] /= pivot;
    sc_to_sc_matrix[7] /= pivot;

    sc_g_matrix[2] /= pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       M                    |     |           |     |M|  1
    |  1   M             M        |     |           |     |M|  2
    |    1 M   M                  |     |           |     |M|  3
    |  x x x   x         x        |     |           |     |x|  4
    |x       x x   x              |     |           |     |x|  5
    |    x x x x   x              |     |           |     |x|  6
    |            x x   x          |     |           |     |x|  7
    |        x x x x   x          | ... |           | ... |x|  8 sc
    |                x x   x      |     |           |     |x|  9
    |            x x x x   x      |     |           |     |x| 10
    |  x   x             x x x    |     |           |     |x| 11
    |                x x x x x    |     |           |     |x| 12
    |                    x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 4
     *
     */

    pivot = sc_to_sc_matrix[8];

    // sc-row-4 = sc-row-4 - sc-row-2 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[8] = 0;
#endif

    sc_to_sc_matrix[10] -= sc_to_sc_matrix[3] * pivot;
    sc_to_sc_matrix[12] -= sc_to_sc_matrix[4] * pivot;

    sc_g_matrix[3] -= sc_g_matrix[1] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       M                    |     |           |     |M|  1
    |  1   M             M        |     |           |     |M|  2
    |    1 M   M                  |     |           |     |M|  3
    |  0 x M   x         M        |     |           |     |M|  4
    |x       x x   x              |     |           |     |x|  5
    |    x x x x   x              |     |           |     |x|  6
    |            x x   x          |     |           |     |x|  7
    |        x x x x   x          | ... |           | ... |x|  8 sc
    |                x x   x      |     |           |     |x|  9
    |            x x x x   x      |     |           |     |x| 10
    |  x   x             x x x    |     |           |     |x| 11
    |                x x x x x    |     |           |     |x| 12
    |                    x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[9];

    // sc-row-4 = sc-row-4 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[9] = 0;
#endif

    sc_to_sc_matrix[10] -= sc_to_sc_matrix[6] * pivot;
    sc_to_sc_matrix[11] -= sc_to_sc_matrix[7] * pivot;

    sc_g_matrix[3] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       M                    |     |           |     |M|  1
    |  1   M             M        |     |           |     |M|  2
    |    1 M   M                  |     |           |     |M|  3
    |  0 0 M   M         M        |     |           |     |M|  4
    |x       x x   x              |     |           |     |x|  5
    |    x x x x   x              |     |           |     |x|  6
    |            x x   x          |     |           |     |x|  7
    |        x x x x   x          | ... |           | ... |x|  8 sc
    |                x x   x      |     |           |     |x|  9
    |            x x x x   x      |     |           |     |x| 10
    |  x   x             x x x    |     |           |     |x| 11
    |                x x x x x    |     |           |     |x| 12
    |                    x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[10];

    // sc-row-4 = sc-row-4 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[10] = 1;
#endif

    sc_to_sc_matrix[11] /= pivot;
    sc_to_sc_matrix[12] /= pivot;

    sc_g_matrix[3] /= pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       M                    |     |           |     |M|  1
    |  1   M             M        |     |           |     |M|  2
    |    1 M   M                  |     |           |     |M|  3
    |  0 0 1   M         M        |     |           |     |M|  4
    |x       x x   x              |     |           |     |x|  5
    |    x x x x   x              |     |           |     |x|  6
    |            x x   x          |     |           |     |x|  7
    |        x x x x   x          | ... |           | ... |x|  8 sc
    |                x x   x      |     |           |     |x|  9
    |            x x x x   x      |     |           |     |x| 10
    |  x   x             x x x    |     |           |     |x| 11
    |                x x x x x    |     |           |     |x| 12
    |                    x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 5
     *
     */

    pivot = sc_to_sc_matrix[13];

    // sc-row-5 = sc-row-5 - sc-row-1 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[13] = 0;
#endif

    sc_to_sc_matrix[14] -= sc_to_sc_matrix[1] * pivot;

    sc_g_matrix[4] -= sc_g_matrix[0] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       M                    |     |           |     |M|  1
    |  1   M             M        |     |           |     |M|  2
    |    1 M   M                  |     |           |     |M|  3
    |  0 0 1   M         M        |     |           |     |M|  4
    |0       M x   x              |     |           |     |M|  5
    |    x x x x   x              |     |           |     |x|  6
    |            x x   x          |     |           |     |x|  7
    |        x x x x   x          | ... |           | ... |x|  8 sc
    |                x x   x      |     |           |     |x|  9
    |            x x x x   x      |     |           |     |x| 10
    |  x   x             x x x    |     |           |     |x| 11
    |                x x x x x    |     |           |     |x| 12
    |                    x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[14];

    // sc-row-5 = sc-row-5 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[14] = 1;
#endif

    sc_to_sc_matrix[15] /= pivot;
    sc_to_sc_matrix[16] /= pivot;

    sc_g_matrix[4] /= pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       M                    |     |           |     |M|  1
    |  1   M             M        |     |           |     |M|  2
    |    1 M   M                  |     |           |     |M|  3
    |  0 0 1   M         M        |     |           |     |M|  4
    |0       1 M   M              |     |           |     |M|  5
    |    x x x x   x              |     |           |     |x|  6
    |            x x   x          |     |           |     |x|  7
    |        x x x x   x          | ... |           | ... |x|  8 sc
    |                x x   x      |     |           |     |x|  9
    |            x x x x   x      |     |           |     |x| 10
    |  x   x             x x x    |     |           |     |x| 11
    |                x x x x x    |     |           |     |x| 12
    |                    x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 6
     *
     */

    pivot = sc_to_sc_matrix[17];

    // sc-row-6 = sc-row-6 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[17] = 0;
#endif

    sc_to_sc_matrix[18] -= sc_to_sc_matrix[6] * pivot;
    sc_to_sc_matrix[20] -= sc_to_sc_matrix[7] * pivot;

    sc_g_matrix[5] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       M                    |     |           |     |M|  1
    |  1   M             M        |     |           |     |M|  2
    |    1 M   M                  |     |           |     |M|  3
    |  0 0 1   M         M        |     |           |     |M|  4
    |0       1 M   M              |     |           |     |M|  5
    |    0 M x M   x              |     |           |     |M|  6
    |            x x   x          |     |           |     |x|  7
    |        x x x x   x          | ... |           | ... |x|  8 sc
    |                x x   x      |     |           |     |x|  9
    |            x x x x   x      |     |           |     |x| 10
    |  x   x             x x x    |     |           |     |x| 11
    |                x x x x x    |     |           |     |x| 12
    |                    x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[18];

    // sc-row-6 = sc-row-6 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[18] = 0;
#endif

    sc_to_sc_matrix[20] -= sc_to_sc_matrix[11] * pivot;

    sc_to_sc_fillins[0] = -sc_to_sc_matrix[12] * pivot;

    sc_g_matrix[5] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       M                    |     |           |     |M|  1
    |  1   M             M        |     |           |     |M|  2
    |    1 M   M                  |     |           |     |M|  3
    |  0 0 1   M         M        |     |           |     |M|  4
    |0       1 M   M              |     |           |     |M|  5
    |    0 0 x M   x     F        |     |           |     |M|  6
    |            x x   x          |     |           |     |x|  7
    |        x x x x   x          | ... |           | ... |x|  8 sc
    |                x x   x      |     |           |     |x|  9
    |            x x x x   x      |     |           |     |x| 10
    |  x   x             x x x    |     |           |     |x| 11
    |                x x x x x    |     |           |     |x| 12
    |                    x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[19];

    // sc-row-6 = sc-row-6 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[19] = 0;
#endif

    sc_to_sc_matrix[20] -= sc_to_sc_matrix[15] * pivot;
    sc_to_sc_matrix[21] -= sc_to_sc_matrix[16] * pivot;

    sc_g_matrix[5] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       M                    |     |           |     |M|  1
    |  1   M             M        |     |           |     |M|  2
    |    1 M   M                  |     |           |     |M|  3
    |  0 0 1   M         M        |     |           |     |M|  4
    |0       1 M   M              |     |           |     |M|  5
    |    0 0 0 M   M     F        |     |           |     |M|  6
    |            x x   x          |     |           |     |x|  7
    |        x x x x   x          | ... |           | ... |x|  8 sc
    |                x x   x      |     |           |     |x|  9
    |            x x x x   x      |     |           |     |x| 10
    |  x   x             x x x    |     |           |     |x| 11
    |                x x x x x    |     |           |     |x| 12
    |                    x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[20];

    // sc-row-6 = sc-row-6 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[20] = 1;
#endif

    sc_to_sc_matrix[21] /= pivot;

    sc_to_sc_fillins[0] /= pivot;

    sc_g_matrix[5] /= pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       M                    |     |           |     |M|  1
    |  1   M             M        |     |           |     |M|  2
    |    1 M   M                  |     |           |     |M|  3
    |  0 0 1   M         M        |     |           |     |M|  4
    |0       1 M   M              |     |           |     |M|  5
    |    0 0 0 1   M     F        |     |           |     |M|  6
    |            x x   x          |     |           |     |x|  7
    |        x x x x   x          | ... |           | ... |x|  8 sc
    |                x x   x      |     |           |     |x|  9
    |            x x x x   x      |     |           |     |x| 10
    |  x   x             x x x    |     |           |     |x| 11
    |                x x x x x    |     |           |     |x| 12
    |                    x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 7
     *
     */

    pivot = sc_to_sc_matrix[22];

    // sc-row-7 = sc-row-7 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[22] = 1;
#endif

    sc_to_sc_matrix[23] /= pivot;
    sc_to_sc_matrix[24] /= pivot;

    sc_g_matrix[6] /= pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       M                    |     |           |     |M|  1
    |  1   M             M        |     |           |     |M|  2
    |    1 M   M                  |     |           |     |M|  3
    |  0 0 1   M         M        |     |           |     |M|  4
    |0       1 M   M              |     |           |     |M|  5
    |    0 0 0 1   M     F        |     |           |     |M|  6
    |            1 M   M          |     |           |     |M|  7
    |        x x x x   x          | ... |           | ... |x|  8 sc
    |                x x   x      |     |           |     |x|  9
    |            x x x x   x      |     |           |     |x| 10
    |  x   x             x x x    |     |           |     |x| 11
    |                x x x x x    |     |           |     |x| 12
    |                    x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 8
     *
     */

    pivot = sc_to_sc_matrix[25];

    // sc-row-8 = sc-row-8 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[25] = 0;
#endif

    sc_to_sc_matrix[26] -= sc_to_sc_matrix[15] * pivot;
    sc_to_sc_matrix[28] -= sc_to_sc_matrix[16] * pivot;

    sc_g_matrix[7] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       M                    |     |           |     |M|  1
    |  1   M             M        |     |           |     |M|  2
    |    1 M   M                  |     |           |     |M|  3
    |  0 0 1   M         M        |     |           |     |M|  4
    |0       1 M   M              |     |           |     |M|  5
    |    0 0 0 1   M     F        |     |           |     |M|  6
    |            1 M   M          |     |           |     |M|  7
    |        0 M x M   x          | ... |           | ... |M|  8 sc
    |                x x   x      |     |           |     |x|  9
    |            x x x x   x      |     |           |     |x| 10
    |  x   x             x x x    |     |           |     |x| 11
    |                x x x x x    |     |           |     |x| 12
    |                    x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[26];

    // sc-row-8 = sc-row-8 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[26] = 0;
#endif

    sc_to_sc_matrix[28] -= sc_to_sc_matrix[21] * pivot;

    sc_to_sc_fillins[1] = -sc_to_sc_fillins[0] * pivot;

    sc_g_matrix[7] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       M                    |     |           |     |M|  1
    |  1   M             M        |     |           |     |M|  2
    |    1 M   M                  |     |           |     |M|  3
    |  0 0 1   M         M        |     |           |     |M|  4
    |0       1 M   M              |     |           |     |M|  5
    |    0 0 0 1   M     F        |     |           |     |M|  6
    |            1 M   M          |     |           |     |M|  7
    |        0 0 x M   x F        | ... |           | ... |M|  8 sc
    |                x x   x      |     |           |     |x|  9
    |            x x x x   x      |     |           |     |x| 10
    |  x   x             x x x    |     |           |     |x| 11
    |                x x x x x    |     |           |     |x| 12
    |                    x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[27];

    // sc-row-8 = sc-row-8 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[27] = 0;
#endif

    sc_to_sc_matrix[28] -= sc_to_sc_matrix[23] * pivot;
    sc_to_sc_matrix[29] -= sc_to_sc_matrix[24] * pivot;

    sc_g_matrix[7] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       M                    |     |           |     |M|  1
    |  1   M             M        |     |           |     |M|  2
    |    1 M   M                  |     |           |     |M|  3
    |  0 0 1   M         M        |     |           |     |M|  4
    |0       1 M   M              |     |           |     |M|  5
    |    0 0 0 1   M     F        |     |           |     |M|  6
    |            1 M   M          |     |           |     |M|  7
    |        0 0 0 M   M F        | ... |           | ... |M|  8 sc
    |                x x   x      |     |           |     |x|  9
    |            x x x x   x      |     |           |     |x| 10
    |  x   x             x x x    |     |           |     |x| 11
    |                x x x x x    |     |           |     |x| 12
    |                    x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[28];

    // sc-row-8 = sc-row-8 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[28] = 1;
#endif

    sc_to_sc_matrix[29] /= pivot;

    sc_to_sc_fillins[1] /= pivot;

    sc_g_matrix[7] /= pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       M                    |     |           |     |M|  1
    |  1   M             M        |     |           |     |M|  2
    |    1 M   M                  |     |           |     |M|  3
    |  0 0 1   M         M        |     |           |     |M|  4
    |0       1 M   M              |     |           |     |M|  5
    |    0 0 0 1   M     F        |     |           |     |M|  6
    |            1 M   M          |     |           |     |M|  7
    |        0 0 0 1   M F        | ... |           | ... |M|  8 sc
    |                x x   x      |     |           |     |x|  9
    |            x x x x   x      |     |           |     |x| 10
    |  x   x             x x x    |     |           |     |x| 11
    |                x x x x x    |     |           |     |x| 12
    |                    x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 9
     *
     */

    pivot = sc_to_sc_matrix[30];

    // sc-row-9 = sc-row-9 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[30] = 1;
#endif

    sc_to_sc_matrix[31] /= pivot;
    sc_to_sc_matrix[32] /= pivot;

    sc_g_matrix[8] /= pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       M                    |     |           |     |M|  1
    |  1   M             M        |     |           |     |M|  2
    |    1 M   M                  |     |           |     |M|  3
    |  0 0 1   M         M        |     |           |     |M|  4
    |0       1 M   M              |     |           |     |M|  5
    |    0 0 0 1   M     F        |     |           |     |M|  6
    |            1 M   M          |     |           |     |M|  7
    |        0 0 0 1   M F        | ... |           | ... |M|  8 sc
    |                1 M   M      |     |           |     |M|  9
    |            x x x x   x      |     |           |     |x| 10
    |  x   x             x x x    |     |           |     |x| 11
    |                x x x x x    |     |           |     |x| 12
    |                    x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 10
     *
     */

    pivot = sc_to_sc_matrix[33];

    // sc-row-10 = sc-row-10 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[33] = 0;
#endif

    sc_to_sc_matrix[34] -= sc_to_sc_matrix[23] * pivot;
    sc_to_sc_matrix[36] -= sc_to_sc_matrix[24] * pivot;

    sc_g_matrix[9] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       M                    |     |           |     |M|  1
    |  1   M             M        |     |           |     |M|  2
    |    1 M   M                  |     |           |     |M|  3
    |  0 0 1   M         M        |     |           |     |M|  4
    |0       1 M   M              |     |           |     |M|  5
    |    0 0 0 1   M     F        |     |           |     |M|  6
    |            1 M   M          |     |           |     |M|  7
    |        0 0 0 1   M F        | ... |           | ... |M|  8 sc
    |                1 M   M      |     |           |     |M|  9
    |            0 M x M   x      |     |           |     |M| 10
    |  x   x             x x x    |     |           |     |x| 11
    |                x x x x x    |     |           |     |x| 12
    |                    x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[34];

    // sc-row-10 = sc-row-10 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[34] = 0;
#endif

    sc_to_sc_matrix[36] -= sc_to_sc_matrix[29] * pivot;

    sc_to_sc_fillins[2] = -sc_to_sc_fillins[1] * pivot;

    sc_g_matrix[9] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       M                    |     |           |     |M|  1
    |  1   M             M        |     |           |     |M|  2
    |    1 M   M                  |     |           |     |M|  3
    |  0 0 1   M         M        |     |           |     |M|  4
    |0       1 M   M              |     |           |     |M|  5
    |    0 0 0 1   M     F        |     |           |     |M|  6
    |            1 M   M          |     |           |     |M|  7
    |        0 0 0 1   M F        | ... |           | ... |M|  8 sc
    |                1 M   M      |     |           |     |M|  9
    |            0 0 x M F x      |     |           |     |M| 10
    |  x   x             x x x    |     |           |     |x| 11
    |                x x x x x    |     |           |     |x| 12
    |                    x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[35];

    // sc-row-10 = sc-row-10 - sc-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[35] = 0;
#endif

    sc_to_sc_matrix[36] -= sc_to_sc_matrix[31] * pivot;
    sc_to_sc_matrix[37] -= sc_to_sc_matrix[32] * pivot;

    sc_g_matrix[9] -= sc_g_matrix[8] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       M                    |     |           |     |M|  1
    |  1   M             M        |     |           |     |M|  2
    |    1 M   M                  |     |           |     |M|  3
    |  0 0 1   M         M        |     |           |     |M|  4
    |0       1 M   M              |     |           |     |M|  5
    |    0 0 0 1   M     F        |     |           |     |M|  6
    |            1 M   M          |     |           |     |M|  7
    |        0 0 0 1   M F        | ... |           | ... |M|  8 sc
    |                1 M   M      |     |           |     |M|  9
    |            0 0 0 M F M      |     |           |     |M| 10
    |  x   x             x x x    |     |           |     |x| 11
    |                x x x x x    |     |           |     |x| 12
    |                    x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[36];

    // sc-row-10 = sc-row-10 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[36] = 1;
#endif

    sc_to_sc_fillins[2] /= pivot;

    sc_to_sc_matrix[37] /= pivot;

    sc_g_matrix[9] /= pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       M                    |     |           |     |M|  1
    |  1   M             M        |     |           |     |M|  2
    |    1 M   M                  |     |           |     |M|  3
    |  0 0 1   M         M        |     |           |     |M|  4
    |0       1 M   M              |     |           |     |M|  5
    |    0 0 0 1   M     F        |     |           |     |M|  6
    |            1 M   M          |     |           |     |M|  7
    |        0 0 0 1   M F        | ... |           | ... |M|  8 sc
    |                1 M   M      |     |           |     |M|  9
    |            0 0 0 1 F M      |     |           |     |M| 10
    |  x   x             x x x    |     |           |     |x| 11
    |                x x x x x    |     |           |     |x| 12
    |                    x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 11
     *
     */

    pivot = sc_to_sc_matrix[38];

    // sc-row-11 = sc-row-11 - sc-row-2 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[38] = 0;
#endif

    sc_to_sc_matrix[39] -= sc_to_sc_matrix[3] * pivot;
    sc_to_sc_matrix[40] -= sc_to_sc_matrix[4] * pivot;

    sc_g_matrix[10] -= sc_g_matrix[1] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       M                    |     |           |     |M|  1
    |  1   M             M        |     |           |     |M|  2
    |    1 M   M                  |     |           |     |M|  3
    |  0 0 1   M         M        |     |           |     |M|  4
    |0       1 M   M              |     |           |     |M|  5
    |    0 0 0 1   M     F        |     |           |     |M|  6
    |            1 M   M          |     |           |     |M|  7
    |        0 0 0 1   M F        | ... |           | ... |M|  8 sc
    |                1 M   M      |     |           |     |M|  9
    |            0 0 0 1 F M      |     |           |     |M| 10
    |  0   M             M x x    |     |           |     |M| 11
    |                x x x x x    |     |           |     |x| 12
    |                    x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[39];

    // sc-row-11 = sc-row-11 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[39] = 0;
#endif

    sc_to_sc_fillins[3] = -sc_to_sc_matrix[11] * pivot;

    sc_to_sc_matrix[40] -= sc_to_sc_matrix[12] * pivot;

    sc_g_matrix[10] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       M                    |     |           |     |M|  1
    |  1   M             M        |     |           |     |M|  2
    |    1 M   M                  |     |           |     |M|  3
    |  0 0 1   M         M        |     |           |     |M|  4
    |0       1 M   M              |     |           |     |M|  5
    |    0 0 0 1   M     F        |     |           |     |M|  6
    |            1 M   M          |     |           |     |M|  7
    |        0 0 0 1   M F        | ... |           | ... |M|  8 sc
    |                1 M   M      |     |           |     |M|  9
    |            0 0 0 1 F M      |     |           |     |M| 10
    |  0   0   F         M x x    |     |           |     |M| 11
    |                x x x x x    |     |           |     |x| 12
    |                    x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_fillins[3];

    // sc-row-11 = sc-row-11 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_fillins[3] = 0;
#endif

    sc_to_sc_fillins[4] = -sc_to_sc_matrix[21] * pivot;

    sc_to_sc_matrix[40] -= sc_to_sc_fillins[0] * pivot;

    sc_g_matrix[10] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       M                    |     |           |     |M|  1
    |  1   M             M        |     |           |     |M|  2
    |    1 M   M                  |     |           |     |M|  3
    |  0 0 1   M         M        |     |           |     |M|  4
    |0       1 M   M              |     |           |     |M|  5
    |    0 0 0 1   M     F        |     |           |     |M|  6
    |            1 M   M          |     |           |     |M|  7
    |        0 0 0 1   M F        | ... |           | ... |M|  8 sc
    |                1 M   M      |     |           |     |M|  9
    |            0 0 0 1 F M      |     |           |     |M| 10
    |  0   0   0   F     M x x    |     |           |     |M| 11
    |                x x x x x    |     |           |     |x| 12
    |                    x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_fillins[4];

    // sc-row-11 = sc-row-11 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_fillins[4] = 0;
#endif

    sc_to_sc_fillins[5] = -sc_to_sc_matrix[29] * pivot;

    sc_to_sc_matrix[40] -= sc_to_sc_fillins[1] * pivot;

    sc_g_matrix[10] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       M                    |     |           |     |M|  1
    |  1   M             M        |     |           |     |M|  2
    |    1 M   M                  |     |           |     |M|  3
    |  0 0 1   M         M        |     |           |     |M|  4
    |0       1 M   M              |     |           |     |M|  5
    |    0 0 0 1   M     F        |     |           |     |M|  6
    |            1 M   M          |     |           |     |M|  7
    |        0 0 0 1   M F        | ... |           | ... |M|  8 sc
    |                1 M   M      |     |           |     |M|  9
    |            0 0 0 1 F M      |     |           |     |M| 10
    |  0   0   0   0   F M x x    |     |           |     |M| 11
    |                x x x x x    |     |           |     |x| 12
    |                    x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_fillins[5];

    // sc-row-11 = sc-row-11 - sc-row-10 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_fillins[5] = 0;
#endif

    sc_to_sc_matrix[40] -= sc_to_sc_fillins[2] * pivot;
    sc_to_sc_matrix[41] -= sc_to_sc_matrix[37] * pivot;

    sc_g_matrix[10] -= sc_g_matrix[9] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       M                    |     |           |     |M|  1
    |  1   M             M        |     |           |     |M|  2
    |    1 M   M                  |     |           |     |M|  3
    |  0 0 1   M         M        |     |           |     |M|  4
    |0       1 M   M              |     |           |     |M|  5
    |    0 0 0 1   M     F        |     |           |     |M|  6
    |            1 M   M          |     |           |     |M|  7
    |        0 0 0 1   M F        | ... |           | ... |M|  8 sc
    |                1 M   M      |     |           |     |M|  9
    |            0 0 0 1 F M      |     |           |     |M| 10
    |  0   0   0   0   0 M M x    |     |           |     |M| 11
    |                x x x x x    |     |           |     |x| 12
    |                    x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[40];

    // sc-row-11 = sc-row-11 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[40] = 1;
#endif

    sc_to_sc_matrix[41] /= pivot;
    sc_to_sc_matrix[42] /= pivot;

    sc_g_matrix[10] /= pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       M                    |     |           |     |M|  1
    |  1   M             M        |     |           |     |M|  2
    |    1 M   M                  |     |           |     |M|  3
    |  0 0 1   M         M        |     |           |     |M|  4
    |0       1 M   M              |     |           |     |M|  5
    |    0 0 0 1   M     F        |     |           |     |M|  6
    |            1 M   M          |     |           |     |M|  7
    |        0 0 0 1   M F        | ... |           | ... |M|  8 sc
    |                1 M   M      |     |           |     |M|  9
    |            0 0 0 1 F M      |     |           |     |M| 10
    |  0   0   0   0   0 1 M M    |     |           |     |M| 11
    |                x x x x x    |     |           |     |x| 12
    |                    x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 12
     *
     */

    pivot = sc_to_sc_matrix[43];

    // sc-row-12 = sc-row-12 - sc-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[43] = 0;
#endif

    sc_to_sc_matrix[44] -= sc_to_sc_matrix[31] * pivot;
    sc_to_sc_matrix[46] -= sc_to_sc_matrix[32] * pivot;

    sc_g_matrix[11] -= sc_g_matrix[8] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       M                    |     |           |     |M|  1
    |  1   M             M        |     |           |     |M|  2
    |    1 M   M                  |     |           |     |M|  3
    |  0 0 1   M         M        |     |           |     |M|  4
    |0       1 M   M              |     |           |     |M|  5
    |    0 0 0 1   M     F        |     |           |     |M|  6
    |            1 M   M          |     |           |     |M|  7
    |        0 0 0 1   M F        | ... |           | ... |M|  8 sc
    |                1 M   M      |     |           |     |M|  9
    |            0 0 0 1 F M      |     |           |     |M| 10
    |  0   0   0   0   0 1 M M    |     |           |     |M| 11
    |                0 M x M x    |     |           |     |M| 12
    |                    x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[44];

    // sc-row-12 = sc-row-12 - sc-row-10 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[44] = 0;
#endif

    sc_to_sc_matrix[45] -= sc_to_sc_fillins[2] * pivot;
    sc_to_sc_matrix[46] -= sc_to_sc_matrix[37] * pivot;

    sc_g_matrix[11] -= sc_g_matrix[9] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       M                    |     |           |     |M|  1
    |  1   M             M        |     |           |     |M|  2
    |    1 M   M                  |     |           |     |M|  3
    |  0 0 1   M         M        |     |           |     |M|  4
    |0       1 M   M              |     |           |     |M|  5
    |    0 0 0 1   M     F        |     |           |     |M|  6
    |            1 M   M          |     |           |     |M|  7
    |        0 0 0 1   M F        | ... |           | ... |M|  8 sc
    |                1 M   M      |     |           |     |M|  9
    |            0 0 0 1 F M      |     |           |     |M| 10
    |  0   0   0   0   0 1 M M    |     |           |     |M| 11
    |                0 0 M M x    |     |           |     |M| 12
    |                    x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[45];

    // sc-row-12 = sc-row-12 - sc-row-11 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[45] = 0;
#endif

    sc_to_sc_matrix[46] -= sc_to_sc_matrix[41] * pivot;
    sc_to_sc_matrix[47] -= sc_to_sc_matrix[42] * pivot;

    sc_g_matrix[11] -= sc_g_matrix[10] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       M                    |     |           |     |M|  1
    |  1   M             M        |     |           |     |M|  2
    |    1 M   M                  |     |           |     |M|  3
    |  0 0 1   M         M        |     |           |     |M|  4
    |0       1 M   M              |     |           |     |M|  5
    |    0 0 0 1   M     F        |     |           |     |M|  6
    |            1 M   M          |     |           |     |M|  7
    |        0 0 0 1   M F        | ... |           | ... |M|  8 sc
    |                1 M   M      |     |           |     |M|  9
    |            0 0 0 1 F M      |     |           |     |M| 10
    |  0   0   0   0   0 1 M M    |     |           |     |M| 11
    |                0 0 0 M M    |     |           |     |M| 12
    |                    x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[46];

    // sc-row-12 = sc-row-12 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[46] = 1;
#endif

    sc_to_sc_matrix[47] /= pivot;

    sc_g_matrix[11] /= pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       M                    |     |           |     |M|  1
    |  1   M             M        |     |           |     |M|  2
    |    1 M   M                  |     |           |     |M|  3
    |  0 0 1   M         M        |     |           |     |M|  4
    |0       1 M   M              |     |           |     |M|  5
    |    0 0 0 1   M     F        |     |           |     |M|  6
    |            1 M   M          |     |           |     |M|  7
    |        0 0 0 1   M F        | ... |           | ... |M|  8 sc
    |                1 M   M      |     |           |     |M|  9
    |            0 0 0 1 F M      |     |           |     |M| 10
    |  0   0   0   0   0 1 M M    |     |           |     |M| 11
    |                0 0 0 1 M    |     |           |     |M| 12
    |                    x x x x x|     |      x    |     |x| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 13
     *
     */

    pivot = sc_to_sc_matrix[48];

    // sc-row-13 = sc-row-13 - sc-row-11 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[48] = 0;
#endif

    sc_to_sc_matrix[49] -= sc_to_sc_matrix[41] * pivot;
    sc_to_sc_matrix[50] -= sc_to_sc_matrix[42] * pivot;

    sc_g_matrix[12] -= sc_g_matrix[10] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       M                    |     |           |     |M|  1
    |  1   M             M        |     |           |     |M|  2
    |    1 M   M                  |     |           |     |M|  3
    |  0 0 1   M         M        |     |           |     |M|  4
    |0       1 M   M              |     |           |     |M|  5
    |    0 0 0 1   M     F        |     |           |     |M|  6
    |            1 M   M          |     |           |     |M|  7
    |        0 0 0 1   M F        | ... |           | ... |M|  8 sc
    |                1 M   M      |     |           |     |M|  9
    |            0 0 0 1 F M      |     |           |     |M| 10
    |  0   0   0   0   0 1 M M    |     |           |     |M| 11
    |                0 0 0 1 M    |     |           |     |M| 12
    |                    0 M M x x|     |      x    |     |M| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[49];

    // sc-row-13 = sc-row-13 - sc-row-12 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[49] = 0;
#endif

    sc_to_sc_matrix[50] -= sc_to_sc_matrix[47] * pivot;

    sc_g_matrix[12] -= sc_g_matrix[11] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       M                    |     |           |     |M|  1
    |  1   M             M        |     |           |     |M|  2
    |    1 M   M                  |     |           |     |M|  3
    |  0 0 1   M         M        |     |           |     |M|  4
    |0       1 M   M              |     |           |     |M|  5
    |    0 0 0 1   M     F        |     |           |     |M|  6
    |            1 M   M          |     |           |     |M|  7
    |        0 0 0 1   M F        | ... |           | ... |M|  8 sc
    |                1 M   M      |     |           |     |M|  9
    |            0 0 0 1 F M      |     |           |     |M| 10
    |  0   0   0   0   0 1 M M    |     |           |     |M| 11
    |                0 0 0 1 M    |     |           |     |M| 12
    |                    0 0 M x x|     |      x    |     |M| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[50];

    // sc-row-13 = sc-row-13 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[50] = 1;
#endif

    sc_to_sc_matrix[51] /= pivot;
    sc_to_sc_matrix[52] /= pivot;

    sc_to_bb_matrix[0] /= pivot;

    sc_g_matrix[12] /= pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       M                    |     |           |     |M|  1
    |  1   M             M        |     |           |     |M|  2
    |    1 M   M                  |     |           |     |M|  3
    |  0 0 1   M         M        |     |           |     |M|  4
    |0       1 M   M              |     |           |     |M|  5
    |    0 0 0 1   M     F        |     |           |     |M|  6
    |            1 M   M          |     |           |     |M|  7
    |        0 0 0 1   M F        | ... |           | ... |M|  8 sc
    |                1 M   M      |     |           |     |M|  9
    |            0 0 0 1 F M      |     |           |     |M| 10
    |  0   0   0   0   0 1 M M    |     |           |     |M| 11
    |                0 0 0 1 M    |     |           |     |M| 12
    |                    0 0 1 M M|     |      M    |     |M| 13
    |                        x x x|     |      x    |     |x| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 14
     *
     */

    pivot = sc_to_sc_matrix[53];

    // sc-row-14 = sc-row-14 - sc-row-13 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[53] = 0;
#endif

    sc_to_sc_matrix[54] -= sc_to_sc_matrix[51] * pivot;
    sc_to_sc_matrix[55] -= sc_to_sc_matrix[52] * pivot;

    sc_to_bb_matrix[1] -= sc_to_bb_matrix[0] * pivot;

    sc_g_matrix[13] -= sc_g_matrix[12] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       M                    |     |           |     |M|  1
    |  1   M             M        |     |           |     |M|  2
    |    1 M   M                  |     |           |     |M|  3
    |  0 0 1   M         M        |     |           |     |M|  4
    |0       1 M   M              |     |           |     |M|  5
    |    0 0 0 1   M     F        |     |           |     |M|  6
    |            1 M   M          |     |           |     |M|  7
    |        0 0 0 1   M F        | ... |           | ... |M|  8 sc
    |                1 M   M      |     |           |     |M|  9
    |            0 0 0 1 F M      |     |           |     |M| 10
    |  0   0   0   0   0 1 M M    |     |           |     |M| 11
    |                0 0 0 1 M    |     |           |     |M| 12
    |                    0 0 1 M M|     |      M    |     |M| 13
    |                        0 M M|     |      M    |     |M| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[54];

    // sc-row-14 = sc-row-14 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[54] = 1;
#endif

    sc_to_sc_matrix[55] /= pivot;

    sc_to_bb_matrix[1] /= pivot;

    sc_g_matrix[13] /= pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       M                    |     |           |     |M|  1
    |  1   M             M        |     |           |     |M|  2
    |    1 M   M                  |     |           |     |M|  3
    |  0 0 1   M         M        |     |           |     |M|  4
    |0       1 M   M              |     |           |     |M|  5
    |    0 0 0 1   M     F        |     |           |     |M|  6
    |            1 M   M          |     |           |     |M|  7
    |        0 0 0 1   M F        | ... |           | ... |M|  8 sc
    |                1 M   M      |     |           |     |M|  9
    |            0 0 0 1 F M      |     |           |     |M| 10
    |  0   0   0   0   0 1 M M    |     |           |     |M| 11
    |                0 0 0 1 M    |     |           |     |M| 12
    |                    0 0 1 M M|     |      M    |     |M| 13
    |                        0 1 M|     |      M    |     |M| 14
    |                        x x x|     |      x    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 15
     *
     */

    pivot = sc_to_sc_matrix[56];

    // sc-row-15 = sc-row-15 - sc-row-13 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[56] = 0;
#endif

    sc_to_sc_matrix[57] -= sc_to_sc_matrix[51] * pivot;
    sc_to_sc_matrix[58] -= sc_to_sc_matrix[52] * pivot;

    sc_to_bb_matrix[2] -= sc_to_bb_matrix[0] * pivot;

    sc_g_matrix[14] -= sc_g_matrix[12] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       M                    |     |           |     |M|  1
    |  1   M             M        |     |           |     |M|  2
    |    1 M   M                  |     |           |     |M|  3
    |  0 0 1   M         M        |     |           |     |M|  4
    |0       1 M   M              |     |           |     |M|  5
    |    0 0 0 1   M     F        |     |           |     |M|  6
    |            1 M   M          |     |           |     |M|  7
    |        0 0 0 1   M F        | ... |           | ... |M|  8 sc
    |                1 M   M      |     |           |     |M|  9
    |            0 0 0 1 F M      |     |           |     |M| 10
    |  0   0   0   0   0 1 M M    |     |           |     |M| 11
    |                0 0 0 1 M    |     |           |     |M| 12
    |                    0 0 1 M M|     |      M    |     |M| 13
    |                        0 1 M|     |      M    |     |M| 14
    |                        0 M M|     |      M    |     |M| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[57];

    // sc-row-15 = sc-row-15 - sc-row-14 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[57] = 0;
#endif

    sc_to_sc_matrix[58] -= sc_to_sc_matrix[55] * pivot;

    sc_to_bb_matrix[2] -= sc_to_bb_matrix[1] * pivot;

    sc_g_matrix[14] -= sc_g_matrix[13] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       M                    |     |           |     |M|  1
    |  1   M             M        |     |           |     |M|  2
    |    1 M   M                  |     |           |     |M|  3
    |  0 0 1   M         M        |     |           |     |M|  4
    |0       1 M   M              |     |           |     |M|  5
    |    0 0 0 1   M     F        |     |           |     |M|  6
    |            1 M   M          |     |           |     |M|  7
    |        0 0 0 1   M F        | ... |           | ... |M|  8 sc
    |                1 M   M      |     |           |     |M|  9
    |            0 0 0 1 F M      |     |           |     |M| 10
    |  0   0   0   0   0 1 M M    |     |           |     |M| 11
    |                0 0 0 1 M    |     |           |     |M| 12
    |                    0 0 1 M M|     |      M    |     |M| 13
    |                        0 1 M|     |      M    |     |M| 14
    |                        0 0 M|     |      M    |     |M| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[58];

    // sc-row-15 = sc-row-15 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[58] = 1;
#endif

    sc_to_bb_matrix[2] /= pivot;

    sc_g_matrix[14] /= pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       M                    |     |           |     |M|  1
    |  1   M             M        |     |           |     |M|  2
    |    1 M   M                  |     |           |     |M|  3
    |  0 0 1   M         M        |     |           |     |M|  4
    |0       1 M   M              |     |           |     |M|  5
    |    0 0 0 1   M     F        |     |           |     |M|  6
    |            1 M   M          |     |           |     |M|  7
    |        0 0 0 1   M F        | ... |           | ... |M|  8 sc
    |                1 M   M      |     |           |     |M|  9
    |            0 0 0 1 F M      |     |           |     |M| 10
    |  0   0   0   0   0 1 M M    |     |           |     |M| 11
    |                0 0 0 1 M    |     |           |     |M| 12
    |                    0 0 1 M M|     |      M    |     |M| 13
    |                        0 1 M|     |      M    |     |M| 14
    |                        0 0 1|     |      M    |     |M| 15
    -------------------------------     -------------
    */
}

void gmx::IlvesPC::solve_2_tryptophan(real *const sc_to_sc_matrix,
                                      real *const sc_to_bb_matrix,
                                      __attribute__((unused))
                                      real *const sc_to_sep_matrix,
                                      real *const sc_g_matrix,
                                      __attribute__((unused))
                                      real *const sc_to_sc_fillins,
                                      __attribute__((unused))
                                      real *const sc_to_bb_fillins) {
    /*
     *
     * Row 1
     *
     */

    real pivot = sc_to_sc_matrix[0];

    // sc-row-1 = sc-row-1 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[0] = 1;
#endif

    sc_to_sc_matrix[1] /= pivot;
    sc_to_sc_matrix[2] /= pivot;

    sc_g_matrix[0] /= pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  x x   x                            |     |           |     |x|  2
    |x x x   x       x                    |     |           |     |x|  3
    |      x x   x                        |     |           |     |x|  4
    |  x x x x   x                        |     |           |     |x|  5
    |          x x x                      |     |           |     |x|  6
    |      x x x x x                      |     |           |     |x|  7
    |          x x x           x   x      |     |           |     |x|  8
    |x   x           x       x x          |     |           |     |x|  9
    |                  x   x x            | ... |           | ... |x| 10 sc
    |                    x x     x        |     |           |     |x| 11
    |                  x x x x   x        |     |           |     |x| 12
    |                x x   x x x          |     |           |     |x| 13
    |              x x       x x   x      |     |           |     |x| 14
    |                    x x     x x x    |     |           |     |x| 15
    |              x           x x x x    |     |           |     |x| 16
    |                            x x x x x|     |      x    |     |x| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    /*
     *
     * Row 2
     *
     */

    pivot = sc_to_sc_matrix[3];

    // sc-row-2 = sc-row-2 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[3] = 1;
#endif

    sc_to_sc_matrix[4] /= pivot;
    sc_to_sc_matrix[5] /= pivot;

    sc_g_matrix[1] /= pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |x x x   x       x                    |     |           |     |x|  3
    |      x x   x                        |     |           |     |x|  4
    |  x x x x   x                        |     |           |     |x|  5
    |          x x x                      |     |           |     |x|  6
    |      x x x x x                      |     |           |     |x|  7
    |          x x x           x   x      |     |           |     |x|  8
    |x   x           x       x x          |     |           |     |x|  9
    |                  x   x x            | ... |           | ... |x| 10 sc
    |                    x x     x        |     |           |     |x| 11
    |                  x x x x   x        |     |           |     |x| 12
    |                x x   x x x          |     |           |     |x| 13
    |              x x       x x   x      |     |           |     |x| 14
    |                    x x     x x x    |     |           |     |x| 15
    |              x           x x x x    |     |           |     |x| 16
    |                            x x x x x|     |      x    |     |x| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    /*
     *
     * Row 3
     *
     */

    pivot = sc_to_sc_matrix[6];

    // sc-row-3 = sc-row-3 - sc-row-1 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[6] = 0;
#endif

    sc_to_sc_matrix[8] -= sc_to_sc_matrix[1] * pivot;
    sc_to_sc_matrix[10] -= sc_to_sc_matrix[2] * pivot;

    sc_g_matrix[2] -= sc_g_matrix[0] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 x M   x       M                    |     |           |     |M|  3
    |      x x   x                        |     |           |     |x|  4
    |  x x x x   x                        |     |           |     |x|  5
    |          x x x                      |     |           |     |x|  6
    |      x x x x x                      |     |           |     |x|  7
    |          x x x           x   x      |     |           |     |x|  8
    |x   x           x       x x          |     |           |     |x|  9
    |                  x   x x            | ... |           | ... |x| 10 sc
    |                    x x     x        |     |           |     |x| 11
    |                  x x x x   x        |     |           |     |x| 12
    |                x x   x x x          |     |           |     |x| 13
    |              x x       x x   x      |     |           |     |x| 14
    |                    x x     x x x    |     |           |     |x| 15
    |              x           x x x x    |     |           |     |x| 16
    |                            x x x x x|     |      x    |     |x| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[7];

    // sc-row-3 = sc-row-3 - sc-row-2 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[7] = 0;
#endif

    sc_to_sc_matrix[8] -= sc_to_sc_matrix[4] * pivot;
    sc_to_sc_matrix[9] -= sc_to_sc_matrix[5] * pivot;

    sc_g_matrix[2] -= sc_g_matrix[1] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 M   M       M                    |     |           |     |M|  3
    |      x x   x                        |     |           |     |x|  4
    |  x x x x   x                        |     |           |     |x|  5
    |          x x x                      |     |           |     |x|  6
    |      x x x x x                      |     |           |     |x|  7
    |          x x x           x   x      |     |           |     |x|  8
    |x   x           x       x x          |     |           |     |x|  9
    |                  x   x x            | ... |           | ... |x| 10 sc
    |                    x x     x        |     |           |     |x| 11
    |                  x x x x   x        |     |           |     |x| 12
    |                x x   x x x          |     |           |     |x| 13
    |              x x       x x   x      |     |           |     |x| 14
    |                    x x     x x x    |     |           |     |x| 15
    |              x           x x x x    |     |           |     |x| 16
    |                            x x x x x|     |      x    |     |x| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[8];

    // sc-row-3 = sc-row-3 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[8] = 1;
#endif

    sc_to_sc_matrix[9] /= pivot;
    sc_to_sc_matrix[10] /= pivot;

    sc_g_matrix[2] /= pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      x x   x                        |     |           |     |x|  4
    |  x x x x   x                        |     |           |     |x|  5
    |          x x x                      |     |           |     |x|  6
    |      x x x x x                      |     |           |     |x|  7
    |          x x x           x   x      |     |           |     |x|  8
    |x   x           x       x x          |     |           |     |x|  9
    |                  x   x x            | ... |           | ... |x| 10 sc
    |                    x x     x        |     |           |     |x| 11
    |                  x x x x   x        |     |           |     |x| 12
    |                x x   x x x          |     |           |     |x| 13
    |              x x       x x   x      |     |           |     |x| 14
    |                    x x     x x x    |     |           |     |x| 15
    |              x           x x x x    |     |           |     |x| 16
    |                            x x x x x|     |      x    |     |x| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    /*
     *
     * Row 4
     *
     */

    pivot = sc_to_sc_matrix[11];

    // sc-row-4 = sc-row-4 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[11] = 1;
#endif

    sc_to_sc_matrix[12] /= pivot;
    sc_to_sc_matrix[13] /= pivot;

    sc_g_matrix[3] /= pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  x x x x   x                        |     |           |     |x|  5
    |          x x x                      |     |           |     |x|  6
    |      x x x x x                      |     |           |     |x|  7
    |          x x x           x   x      |     |           |     |x|  8
    |x   x           x       x x          |     |           |     |x|  9
    |                  x   x x            | ... |           | ... |x| 10 sc
    |                    x x     x        |     |           |     |x| 11
    |                  x x x x   x        |     |           |     |x| 12
    |                x x   x x x          |     |           |     |x| 13
    |              x x       x x   x      |     |           |     |x| 14
    |                    x x     x x x    |     |           |     |x| 15
    |              x           x x x x    |     |           |     |x| 16
    |                            x x x x x|     |      x    |     |x| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    /*
     *
     * Row 5
     *
     */

    pivot = sc_to_sc_matrix[14];

    // sc-row-5 = sc-row-5 - sc-row-2 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[14] = 0;
#endif

    sc_to_sc_matrix[15] -= sc_to_sc_matrix[4] * pivot;
    sc_to_sc_matrix[17] -= sc_to_sc_matrix[5] * pivot;

    sc_g_matrix[4] -= sc_g_matrix[1] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  0 M x M   x                        |     |           |     |M|  5
    |          x x x                      |     |           |     |x|  6
    |      x x x x x                      |     |           |     |x|  7
    |          x x x           x   x      |     |           |     |x|  8
    |x   x           x       x x          |     |           |     |x|  9
    |                  x   x x            | ... |           | ... |x| 10 sc
    |                    x x     x        |     |           |     |x| 11
    |                  x x x x   x        |     |           |     |x| 12
    |                x x   x x x          |     |           |     |x| 13
    |              x x       x x   x      |     |           |     |x| 14
    |                    x x     x x x    |     |           |     |x| 15
    |              x           x x x x    |     |           |     |x| 16
    |                            x x x x x|     |      x    |     |x| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[15];

    // sc-row-5 = sc-row-5 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[15] = 0;
#endif

    sc_to_sc_matrix[17] -= sc_to_sc_matrix[9] * pivot;

    sc_to_sc_fillins[0] = -sc_to_sc_matrix[10] * pivot;

    sc_g_matrix[4] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  0 0 x M   x   F                    |     |           |     |M|  5
    |          x x x                      |     |           |     |x|  6
    |      x x x x x                      |     |           |     |x|  7
    |          x x x           x   x      |     |           |     |x|  8
    |x   x           x       x x          |     |           |     |x|  9
    |                  x   x x            | ... |           | ... |x| 10 sc
    |                    x x     x        |     |           |     |x| 11
    |                  x x x x   x        |     |           |     |x| 12
    |                x x   x x x          |     |           |     |x| 13
    |              x x       x x   x      |     |           |     |x| 14
    |                    x x     x x x    |     |           |     |x| 15
    |              x           x x x x    |     |           |     |x| 16
    |                            x x x x x|     |      x    |     |x| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[16];

    // sc-row-5 = sc-row-5 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[16] = 0;
#endif

    sc_to_sc_matrix[17] -= sc_to_sc_matrix[12] * pivot;
    sc_to_sc_matrix[18] -= sc_to_sc_matrix[13] * pivot;

    sc_g_matrix[4] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  0 0 0 M   M   F                    |     |           |     |M|  5
    |          x x x                      |     |           |     |x|  6
    |      x x x x x                      |     |           |     |x|  7
    |          x x x           x   x      |     |           |     |x|  8
    |x   x           x       x x          |     |           |     |x|  9
    |                  x   x x            | ... |           | ... |x| 10 sc
    |                    x x     x        |     |           |     |x| 11
    |                  x x x x   x        |     |           |     |x| 12
    |                x x   x x x          |     |           |     |x| 13
    |              x x       x x   x      |     |           |     |x| 14
    |                    x x     x x x    |     |           |     |x| 15
    |              x           x x x x    |     |           |     |x| 16
    |                            x x x x x|     |      x    |     |x| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[17];

    // sc-row-5 = sc-row-5 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[17] = 1;
#endif

    sc_to_sc_matrix[18] /= pivot;

    sc_to_sc_fillins[0] /= pivot;

    sc_g_matrix[4] /= pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  0 0 0 1   M   F                    |     |           |     |M|  5
    |          x x x                      |     |           |     |x|  6
    |      x x x x x                      |     |           |     |x|  7
    |          x x x           x   x      |     |           |     |x|  8
    |x   x           x       x x          |     |           |     |x|  9
    |                  x   x x            | ... |           | ... |x| 10 sc
    |                    x x     x        |     |           |     |x| 11
    |                  x x x x   x        |     |           |     |x| 12
    |                x x   x x x          |     |           |     |x| 13
    |              x x       x x   x      |     |           |     |x| 14
    |                    x x     x x x    |     |           |     |x| 15
    |              x           x x x x    |     |           |     |x| 16
    |                            x x x x x|     |      x    |     |x| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    /*
     *
     * Row 6
     *
     */

    pivot = sc_to_sc_matrix[19];

    // sc-row-6 = sc-row-6 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[19] = 1;
#endif

    sc_to_sc_matrix[20] /= pivot;
    sc_to_sc_matrix[21] /= pivot;

    sc_g_matrix[5] /= pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  0 0 0 1   M   F                    |     |           |     |M|  5
    |          1 M M                      |     |           |     |M|  6
    |      x x x x x                      |     |           |     |x|  7
    |          x x x           x   x      |     |           |     |x|  8
    |x   x           x       x x          |     |           |     |x|  9
    |                  x   x x            | ... |           | ... |x| 10 sc
    |                    x x     x        |     |           |     |x| 11
    |                  x x x x   x        |     |           |     |x| 12
    |                x x   x x x          |     |           |     |x| 13
    |              x x       x x   x      |     |           |     |x| 14
    |                    x x     x x x    |     |           |     |x| 15
    |              x           x x x x    |     |           |     |x| 16
    |                            x x x x x|     |      x    |     |x| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    /*
     *
     * Row 7
     *
     */

    pivot = sc_to_sc_matrix[22];

    // sc-row-7 = sc-row-7 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[22] = 0;
#endif

    sc_to_sc_matrix[23] -= sc_to_sc_matrix[12] * pivot;
    sc_to_sc_matrix[25] -= sc_to_sc_matrix[13] * pivot;

    sc_g_matrix[6] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  0 0 0 1   M   F                    |     |           |     |M|  5
    |          1 M M                      |     |           |     |M|  6
    |      0 M x M x                      |     |           |     |M|  7
    |          x x x           x   x      |     |           |     |x|  8
    |x   x           x       x x          |     |           |     |x|  9
    |                  x   x x            | ... |           | ... |x| 10 sc
    |                    x x     x        |     |           |     |x| 11
    |                  x x x x   x        |     |           |     |x| 12
    |                x x   x x x          |     |           |     |x| 13
    |              x x       x x   x      |     |           |     |x| 14
    |                    x x     x x x    |     |           |     |x| 15
    |              x           x x x x    |     |           |     |x| 16
    |                            x x x x x|     |      x    |     |x| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[23];

    // sc-row-7 = sc-row-7 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[23] = 0;
#endif

    sc_to_sc_matrix[25] -= sc_to_sc_matrix[18] * pivot;

    sc_to_sc_fillins[1] = -sc_to_sc_fillins[0] * pivot;

    sc_g_matrix[6] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  0 0 0 1   M   F                    |     |           |     |M|  5
    |          1 M M                      |     |           |     |M|  6
    |      0 0 x M x F                    |     |           |     |M|  7
    |          x x x           x   x      |     |           |     |x|  8
    |x   x           x       x x          |     |           |     |x|  9
    |                  x   x x            | ... |           | ... |x| 10 sc
    |                    x x     x        |     |           |     |x| 11
    |                  x x x x   x        |     |           |     |x| 12
    |                x x   x x x          |     |           |     |x| 13
    |              x x       x x   x      |     |           |     |x| 14
    |                    x x     x x x    |     |           |     |x| 15
    |              x           x x x x    |     |           |     |x| 16
    |                            x x x x x|     |      x    |     |x| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[24];

    // sc-row-7 = sc-row-7 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[24] = 0;
#endif

    sc_to_sc_matrix[25] -= sc_to_sc_matrix[20] * pivot;
    sc_to_sc_matrix[26] -= sc_to_sc_matrix[21] * pivot;

    sc_g_matrix[6] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  0 0 0 1   M   F                    |     |           |     |M|  5
    |          1 M M                      |     |           |     |M|  6
    |      0 0 0 M M F                    |     |           |     |M|  7
    |          x x x           x   x      |     |           |     |x|  8
    |x   x           x       x x          |     |           |     |x|  9
    |                  x   x x            | ... |           | ... |x| 10 sc
    |                    x x     x        |     |           |     |x| 11
    |                  x x x x   x        |     |           |     |x| 12
    |                x x   x x x          |     |           |     |x| 13
    |              x x       x x   x      |     |           |     |x| 14
    |                    x x     x x x    |     |           |     |x| 15
    |              x           x x x x    |     |           |     |x| 16
    |                            x x x x x|     |      x    |     |x| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[25];

    // sc-row-7 = sc-row-7 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[25] = 1;
#endif

    sc_to_sc_matrix[26] /= pivot;

    sc_to_sc_fillins[1] /= pivot;

    sc_g_matrix[6] /= pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  0 0 0 1   M   F                    |     |           |     |M|  5
    |          1 M M                      |     |           |     |M|  6
    |      0 0 0 1 M F                    |     |           |     |M|  7
    |          x x x           x   x      |     |           |     |x|  8
    |x   x           x       x x          |     |           |     |x|  9
    |                  x   x x            | ... |           | ... |x| 10 sc
    |                    x x     x        |     |           |     |x| 11
    |                  x x x x   x        |     |           |     |x| 12
    |                x x   x x x          |     |           |     |x| 13
    |              x x       x x   x      |     |           |     |x| 14
    |                    x x     x x x    |     |           |     |x| 15
    |              x           x x x x    |     |           |     |x| 16
    |                            x x x x x|     |      x    |     |x| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    /*
     *
     * Row 8
     *
     */

    pivot = sc_to_sc_matrix[27];

    // sc-row-8 = sc-row-8 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[27] = 0;
#endif

    sc_to_sc_matrix[28] -= sc_to_sc_matrix[20] * pivot;
    sc_to_sc_matrix[29] -= sc_to_sc_matrix[21] * pivot;

    sc_g_matrix[7] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  0 0 0 1   M   F                    |     |           |     |M|  5
    |          1 M M                      |     |           |     |M|  6
    |      0 0 0 1 M F                    |     |           |     |M|  7
    |          0 M M           x   x      |     |           |     |M|  8
    |x   x           x       x x          |     |           |     |x|  9
    |                  x   x x            | ... |           | ... |x| 10 sc
    |                    x x     x        |     |           |     |x| 11
    |                  x x x x   x        |     |           |     |x| 12
    |                x x   x x x          |     |           |     |x| 13
    |              x x       x x   x      |     |           |     |x| 14
    |                    x x     x x x    |     |           |     |x| 15
    |              x           x x x x    |     |           |     |x| 16
    |                            x x x x x|     |      x    |     |x| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[28];

    // sc-row-8 = sc-row-8 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[28] = 0;
#endif

    sc_to_sc_matrix[29] -= sc_to_sc_matrix[26] * pivot;

    sc_to_sc_fillins[2] = -sc_to_sc_fillins[1] * pivot;

    sc_g_matrix[7] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  0 0 0 1   M   F                    |     |           |     |M|  5
    |          1 M M                      |     |           |     |M|  6
    |      0 0 0 1 M F                    |     |           |     |M|  7
    |          0 0 M F         x   x      |     |           |     |M|  8
    |x   x           x       x x          |     |           |     |x|  9
    |                  x   x x            | ... |           | ... |x| 10 sc
    |                    x x     x        |     |           |     |x| 11
    |                  x x x x   x        |     |           |     |x| 12
    |                x x   x x x          |     |           |     |x| 13
    |              x x       x x   x      |     |           |     |x| 14
    |                    x x     x x x    |     |           |     |x| 15
    |              x           x x x x    |     |           |     |x| 16
    |                            x x x x x|     |      x    |     |x| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[29];

    // sc-row-8 = sc-row-8 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[29] = 1;
#endif

    sc_to_sc_fillins[2] /= pivot;

    sc_to_sc_matrix[30] /= pivot;
    sc_to_sc_matrix[31] /= pivot;

    sc_g_matrix[7] /= pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  0 0 0 1   M   F                    |     |           |     |M|  5
    |          1 M M                      |     |           |     |M|  6
    |      0 0 0 1 M F                    |     |           |     |M|  7
    |          0 0 1 F         M   M      |     |           |     |M|  8
    |x   x           x       x x          |     |           |     |x|  9
    |                  x   x x            | ... |           | ... |x| 10 sc
    |                    x x     x        |     |           |     |x| 11
    |                  x x x x   x        |     |           |     |x| 12
    |                x x   x x x          |     |           |     |x| 13
    |              x x       x x   x      |     |           |     |x| 14
    |                    x x     x x x    |     |           |     |x| 15
    |              x           x x x x    |     |           |     |x| 16
    |                            x x x x x|     |      x    |     |x| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    /*
     *
     * Row 9
     *
     */

    pivot = sc_to_sc_matrix[32];

    // sc-row-9 = sc-row-9 - sc-row-1 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[32] = 0;
#endif

    sc_to_sc_matrix[33] -= sc_to_sc_matrix[1] * pivot;
    sc_to_sc_matrix[34] -= sc_to_sc_matrix[2] * pivot;

    sc_g_matrix[8] -= sc_g_matrix[0] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  0 0 0 1   M   F                    |     |           |     |M|  5
    |          1 M M                      |     |           |     |M|  6
    |      0 0 0 1 M F                    |     |           |     |M|  7
    |          0 0 1 F         M   M      |     |           |     |M|  8
    |0   M           M       x x          |     |           |     |M|  9
    |                  x   x x            | ... |           | ... |x| 10 sc
    |                    x x     x        |     |           |     |x| 11
    |                  x x x x   x        |     |           |     |x| 12
    |                x x   x x x          |     |           |     |x| 13
    |              x x       x x   x      |     |           |     |x| 14
    |                    x x     x x x    |     |           |     |x| 15
    |              x           x x x x    |     |           |     |x| 16
    |                            x x x x x|     |      x    |     |x| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[33];

    // sc-row-9 = sc-row-9 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[33] = 0;
#endif

    sc_to_sc_fillins[3] = -sc_to_sc_matrix[9] * pivot;

    sc_to_sc_matrix[34] -= sc_to_sc_matrix[10] * pivot;

    sc_g_matrix[8] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  0 0 0 1   M   F                    |     |           |     |M|  5
    |          1 M M                      |     |           |     |M|  6
    |      0 0 0 1 M F                    |     |           |     |M|  7
    |          0 0 1 F         M   M      |     |           |     |M|  8
    |0   0   F       M       x x          |     |           |     |M|  9
    |                  x   x x            | ... |           | ... |x| 10 sc
    |                    x x     x        |     |           |     |x| 11
    |                  x x x x   x        |     |           |     |x| 12
    |                x x   x x x          |     |           |     |x| 13
    |              x x       x x   x      |     |           |     |x| 14
    |                    x x     x x x    |     |           |     |x| 15
    |              x           x x x x    |     |           |     |x| 16
    |                            x x x x x|     |      x    |     |x| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_fillins[3];

    // sc-row-9 = sc-row-9 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_fillins[3] = 0;
#endif

    sc_to_sc_fillins[4] = -sc_to_sc_matrix[18] * pivot;

    sc_to_sc_matrix[34] -= sc_to_sc_fillins[0] * pivot;

    sc_g_matrix[8] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  0 0 0 1   M   F                    |     |           |     |M|  5
    |          1 M M                      |     |           |     |M|  6
    |      0 0 0 1 M F                    |     |           |     |M|  7
    |          0 0 1 F         M   M      |     |           |     |M|  8
    |0   0   0   F   M       x x          |     |           |     |M|  9
    |                  x   x x            | ... |           | ... |x| 10 sc
    |                    x x     x        |     |           |     |x| 11
    |                  x x x x   x        |     |           |     |x| 12
    |                x x   x x x          |     |           |     |x| 13
    |              x x       x x   x      |     |           |     |x| 14
    |                    x x     x x x    |     |           |     |x| 15
    |              x           x x x x    |     |           |     |x| 16
    |                            x x x x x|     |      x    |     |x| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_fillins[4];

    // sc-row-9 = sc-row-9 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_fillins[4] = 0;
#endif

    sc_to_sc_fillins[5] = -sc_to_sc_matrix[26] * pivot;

    sc_to_sc_matrix[34] -= sc_to_sc_fillins[1] * pivot;

    sc_g_matrix[8] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  0 0 0 1   M   F                    |     |           |     |M|  5
    |          1 M M                      |     |           |     |M|  6
    |      0 0 0 1 M F                    |     |           |     |M|  7
    |          0 0 1 F         M   M      |     |           |     |M|  8
    |0   0   0   0 F M       x x          |     |           |     |M|  9
    |                  x   x x            | ... |           | ... |x| 10 sc
    |                    x x     x        |     |           |     |x| 11
    |                  x x x x   x        |     |           |     |x| 12
    |                x x   x x x          |     |           |     |x| 13
    |              x x       x x   x      |     |           |     |x| 14
    |                    x x     x x x    |     |           |     |x| 15
    |              x           x x x x    |     |           |     |x| 16
    |                            x x x x x|     |      x    |     |x| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_fillins[5];

    // sc-row-9 = sc-row-9 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_fillins[5] = 0;
#endif

    sc_to_sc_matrix[34] -= sc_to_sc_fillins[2] * pivot;
    sc_to_sc_matrix[36] -= sc_to_sc_matrix[30] * pivot;

    sc_to_sc_fillins[6] = -sc_to_sc_matrix[31] * pivot;

    sc_g_matrix[8] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  0 0 0 1   M   F                    |     |           |     |M|  5
    |          1 M M                      |     |           |     |M|  6
    |      0 0 0 1 M F                    |     |           |     |M|  7
    |          0 0 1 F         M   M      |     |           |     |M|  8
    |0   0   0   0 0 M       x M   F      |     |           |     |M|  9
    |                  x   x x            | ... |           | ... |x| 10 sc
    |                    x x     x        |     |           |     |x| 11
    |                  x x x x   x        |     |           |     |x| 12
    |                x x   x x x          |     |           |     |x| 13
    |              x x       x x   x      |     |           |     |x| 14
    |                    x x     x x x    |     |           |     |x| 15
    |              x           x x x x    |     |           |     |x| 16
    |                            x x x x x|     |      x    |     |x| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[34];

    // sc-row-9 = sc-row-9 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[34] = 1;
#endif

    sc_to_sc_matrix[35] /= pivot;
    sc_to_sc_matrix[36] /= pivot;

    sc_to_sc_fillins[6] /= pivot;

    sc_g_matrix[8] /= pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  0 0 0 1   M   F                    |     |           |     |M|  5
    |          1 M M                      |     |           |     |M|  6
    |      0 0 0 1 M F                    |     |           |     |M|  7
    |          0 0 1 F         M   M      |     |           |     |M|  8
    |0   0   0   0 0 1       M M   F      |     |           |     |M|  9
    |                  x   x x            | ... |           | ... |x| 10 sc
    |                    x x     x        |     |           |     |x| 11
    |                  x x x x   x        |     |           |     |x| 12
    |                x x   x x x          |     |           |     |x| 13
    |              x x       x x   x      |     |           |     |x| 14
    |                    x x     x x x    |     |           |     |x| 15
    |              x           x x x x    |     |           |     |x| 16
    |                            x x x x x|     |      x    |     |x| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    /*
     *
     * Row 10
     *
     */

    pivot = sc_to_sc_matrix[37];

    // sc-row-10 = sc-row-10 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[37] = 1;
#endif

    sc_to_sc_matrix[38] /= pivot;
    sc_to_sc_matrix[39] /= pivot;

    sc_g_matrix[9] /= pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  0 0 0 1   M   F                    |     |           |     |M|  5
    |          1 M M                      |     |           |     |M|  6
    |      0 0 0 1 M F                    |     |           |     |M|  7
    |          0 0 1 F         M   M      |     |           |     |M|  8
    |0   0   0   0 0 1       M M   F      |     |           |     |M|  9
    |                  1   M M            | ... |           | ... |M| 10 sc
    |                    x x     x        |     |           |     |x| 11
    |                  x x x x   x        |     |           |     |x| 12
    |                x x   x x x          |     |           |     |x| 13
    |              x x       x x   x      |     |           |     |x| 14
    |                    x x     x x x    |     |           |     |x| 15
    |              x           x x x x    |     |           |     |x| 16
    |                            x x x x x|     |      x    |     |x| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    /*
     *
     * Row 11
     *
     */

    pivot = sc_to_sc_matrix[40];

    // sc-row-11 = sc-row-11 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[40] = 1;
#endif

    sc_to_sc_matrix[41] /= pivot;
    sc_to_sc_matrix[42] /= pivot;

    sc_g_matrix[10] /= pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  0 0 0 1   M   F                    |     |           |     |M|  5
    |          1 M M                      |     |           |     |M|  6
    |      0 0 0 1 M F                    |     |           |     |M|  7
    |          0 0 1 F         M   M      |     |           |     |M|  8
    |0   0   0   0 0 1       M M   F      |     |           |     |M|  9
    |                  1   M M            | ... |           | ... |M| 10 sc
    |                    1 M     M        |     |           |     |M| 11
    |                  x x x x   x        |     |           |     |x| 12
    |                x x   x x x          |     |           |     |x| 13
    |              x x       x x   x      |     |           |     |x| 14
    |                    x x     x x x    |     |           |     |x| 15
    |              x           x x x x    |     |           |     |x| 16
    |                            x x x x x|     |      x    |     |x| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    /*
     *
     * Row 12
     *
     */

    pivot = sc_to_sc_matrix[43];

    // sc-row-12 = sc-row-12 - sc-row-10 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[43] = 0;
#endif

    sc_to_sc_matrix[45] -= sc_to_sc_matrix[38] * pivot;
    sc_to_sc_matrix[46] -= sc_to_sc_matrix[39] * pivot;

    sc_g_matrix[11] -= sc_g_matrix[9] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  0 0 0 1   M   F                    |     |           |     |M|  5
    |          1 M M                      |     |           |     |M|  6
    |      0 0 0 1 M F                    |     |           |     |M|  7
    |          0 0 1 F         M   M      |     |           |     |M|  8
    |0   0   0   0 0 1       M M   F      |     |           |     |M|  9
    |                  1   M M            | ... |           | ... |M| 10 sc
    |                    1 M     M        |     |           |     |M| 11
    |                  0 x M M   x        |     |           |     |M| 12
    |                x x   x x x          |     |           |     |x| 13
    |              x x       x x   x      |     |           |     |x| 14
    |                    x x     x x x    |     |           |     |x| 15
    |              x           x x x x    |     |           |     |x| 16
    |                            x x x x x|     |      x    |     |x| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[44];

    // sc-row-12 = sc-row-12 - sc-row-11 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[44] = 0;
#endif

    sc_to_sc_matrix[45] -= sc_to_sc_matrix[41] * pivot;
    sc_to_sc_matrix[47] -= sc_to_sc_matrix[42] * pivot;

    sc_g_matrix[11] -= sc_g_matrix[10] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  0 0 0 1   M   F                    |     |           |     |M|  5
    |          1 M M                      |     |           |     |M|  6
    |      0 0 0 1 M F                    |     |           |     |M|  7
    |          0 0 1 F         M   M      |     |           |     |M|  8
    |0   0   0   0 0 1       M M   F      |     |           |     |M|  9
    |                  1   M M            | ... |           | ... |M| 10 sc
    |                    1 M     M        |     |           |     |M| 11
    |                  0 0 M M   M        |     |           |     |M| 12
    |                x x   x x x          |     |           |     |x| 13
    |              x x       x x   x      |     |           |     |x| 14
    |                    x x     x x x    |     |           |     |x| 15
    |              x           x x x x    |     |           |     |x| 16
    |                            x x x x x|     |      x    |     |x| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[45];

    // sc-row-12 = sc-row-12 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[45] = 1;
#endif

    sc_to_sc_matrix[46] /= pivot;
    sc_to_sc_matrix[47] /= pivot;

    sc_g_matrix[11] /= pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  0 0 0 1   M   F                    |     |           |     |M|  5
    |          1 M M                      |     |           |     |M|  6
    |      0 0 0 1 M F                    |     |           |     |M|  7
    |          0 0 1 F         M   M      |     |           |     |M|  8
    |0   0   0   0 0 1       M M   F      |     |           |     |M|  9
    |                  1   M M            | ... |           | ... |M| 10 sc
    |                    1 M     M        |     |           |     |M| 11
    |                  0 0 1 M   M        |     |           |     |M| 12
    |                x x   x x x          |     |           |     |x| 13
    |              x x       x x   x      |     |           |     |x| 14
    |                    x x     x x x    |     |           |     |x| 15
    |              x           x x x x    |     |           |     |x| 16
    |                            x x x x x|     |      x    |     |x| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    /*
     *
     * Row 13
     *
     */

    pivot = sc_to_sc_matrix[48];

    // sc-row-13 = sc-row-13 - sc-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[48] = 0;
#endif

    sc_to_sc_matrix[51] -= sc_to_sc_matrix[35] * pivot;
    sc_to_sc_matrix[52] -= sc_to_sc_matrix[36] * pivot;

    sc_to_sc_fillins[8] = -sc_to_sc_fillins[6] * pivot;

    sc_g_matrix[12] -= sc_g_matrix[8] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  0 0 0 1   M   F                    |     |           |     |M|  5
    |          1 M M                      |     |           |     |M|  6
    |      0 0 0 1 M F                    |     |           |     |M|  7
    |          0 0 1 F         M   M      |     |           |     |M|  8
    |0   0   0   0 0 1       M M   F      |     |           |     |M|  9
    |                  1   M M            | ... |           | ... |M| 10 sc
    |                    1 M     M        |     |           |     |M| 11
    |                  0 0 1 M   M        |     |           |     |M| 12
    |                0 x   x M M   F      |     |           |     |M| 13
    |              x x       x x   x      |     |           |     |x| 14
    |                    x x     x x x    |     |           |     |x| 15
    |              x           x x x x    |     |           |     |x| 16
    |                            x x x x x|     |      x    |     |x| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[49];

    // sc-row-13 = sc-row-13 - sc-row-10 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[49] = 0;
#endif

    sc_to_sc_matrix[50] -= sc_to_sc_matrix[38] * pivot;
    sc_to_sc_matrix[51] -= sc_to_sc_matrix[39] * pivot;

    sc_g_matrix[12] -= sc_g_matrix[9] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  0 0 0 1   M   F                    |     |           |     |M|  5
    |          1 M M                      |     |           |     |M|  6
    |      0 0 0 1 M F                    |     |           |     |M|  7
    |          0 0 1 F         M   M      |     |           |     |M|  8
    |0   0   0   0 0 1       M M   F      |     |           |     |M|  9
    |                  1   M M            | ... |           | ... |M| 10 sc
    |                    1 M     M        |     |           |     |M| 11
    |                  0 0 1 M   M        |     |           |     |M| 12
    |                0 0   M M M   F      |     |           |     |M| 13
    |              x x       x x   x      |     |           |     |x| 14
    |                    x x     x x x    |     |           |     |x| 15
    |              x           x x x x    |     |           |     |x| 16
    |                            x x x x x|     |      x    |     |x| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[50];

    // sc-row-13 = sc-row-13 - sc-row-12 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[50] = 0;
#endif

    sc_to_sc_matrix[51] -= sc_to_sc_matrix[46] * pivot;

    sc_to_sc_fillins[7] = -sc_to_sc_matrix[47] * pivot;

    sc_g_matrix[12] -= sc_g_matrix[11] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  0 0 0 1   M   F                    |     |           |     |M|  5
    |          1 M M                      |     |           |     |M|  6
    |      0 0 0 1 M F                    |     |           |     |M|  7
    |          0 0 1 F         M   M      |     |           |     |M|  8
    |0   0   0   0 0 1       M M   F      |     |           |     |M|  9
    |                  1   M M            | ... |           | ... |M| 10 sc
    |                    1 M     M        |     |           |     |M| 11
    |                  0 0 1 M   M        |     |           |     |M| 12
    |                0 0   0 M M F F      |     |           |     |M| 13
    |              x x       x x   x      |     |           |     |x| 14
    |                    x x     x x x    |     |           |     |x| 15
    |              x           x x x x    |     |           |     |x| 16
    |                            x x x x x|     |      x    |     |x| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[51];

    // sc-row-13 = sc-row-13 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[51] = 1;
#endif

    sc_to_sc_matrix[52] /= pivot;

    sc_to_sc_fillins[7] /= pivot;
    sc_to_sc_fillins[8] /= pivot;

    sc_g_matrix[12] /= pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  0 0 0 1   M   F                    |     |           |     |M|  5
    |          1 M M                      |     |           |     |M|  6
    |      0 0 0 1 M F                    |     |           |     |M|  7
    |          0 0 1 F         M   M      |     |           |     |M|  8
    |0   0   0   0 0 1       M M   F      |     |           |     |M|  9
    |                  1   M M            | ... |           | ... |M| 10 sc
    |                    1 M     M        |     |           |     |M| 11
    |                  0 0 1 M   M        |     |           |     |M| 12
    |                0 0   0 1 M F F      |     |           |     |M| 13
    |              x x       x x   x      |     |           |     |x| 14
    |                    x x     x x x    |     |           |     |x| 15
    |              x           x x x x    |     |           |     |x| 16
    |                            x x x x x|     |      x    |     |x| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    /*
     *
     * Row 14
     *
     */

    pivot = sc_to_sc_matrix[53];

    // sc-row-14 = sc-row-14 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[53] = 0;
#endif

    sc_to_sc_matrix[54] -= sc_to_sc_fillins[2] * pivot;
    sc_to_sc_matrix[56] -= sc_to_sc_matrix[30] * pivot;
    sc_to_sc_matrix[57] -= sc_to_sc_matrix[31] * pivot;

    sc_g_matrix[13] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  0 0 0 1   M   F                    |     |           |     |M|  5
    |          1 M M                      |     |           |     |M|  6
    |      0 0 0 1 M F                    |     |           |     |M|  7
    |          0 0 1 F         M   M      |     |           |     |M|  8
    |0   0   0   0 0 1       M M   F      |     |           |     |M|  9
    |                  1   M M            | ... |           | ... |M| 10 sc
    |                    1 M     M        |     |           |     |M| 11
    |                  0 0 1 M   M        |     |           |     |M| 12
    |                0 0   0 1 M F F      |     |           |     |M| 13
    |              0 M       x M   M      |     |           |     |M| 14
    |                    x x     x x x    |     |           |     |x| 15
    |              x           x x x x    |     |           |     |x| 16
    |                            x x x x x|     |      x    |     |x| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[54];

    // sc-row-14 = sc-row-14 - sc-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[54] = 0;
#endif

    sc_to_sc_matrix[55] -= sc_to_sc_matrix[35] * pivot;
    sc_to_sc_matrix[56] -= sc_to_sc_matrix[36] * pivot;
    sc_to_sc_matrix[57] -= sc_to_sc_fillins[6] * pivot;

    sc_g_matrix[13] -= sc_g_matrix[8] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  0 0 0 1   M   F                    |     |           |     |M|  5
    |          1 M M                      |     |           |     |M|  6
    |      0 0 0 1 M F                    |     |           |     |M|  7
    |          0 0 1 F         M   M      |     |           |     |M|  8
    |0   0   0   0 0 1       M M   F      |     |           |     |M|  9
    |                  1   M M            | ... |           | ... |M| 10 sc
    |                    1 M     M        |     |           |     |M| 11
    |                  0 0 1 M   M        |     |           |     |M| 12
    |                0 0   0 1 M F F      |     |           |     |M| 13
    |              0 0       M M   M      |     |           |     |M| 14
    |                    x x     x x x    |     |           |     |x| 15
    |              x           x x x x    |     |           |     |x| 16
    |                            x x x x x|     |      x    |     |x| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[55];

    // sc-row-14 = sc-row-14 - sc-row-13 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[55] = 0;
#endif

    sc_to_sc_matrix[56] -= sc_to_sc_matrix[52] * pivot;

    sc_to_sc_fillins[9] = -sc_to_sc_fillins[7] * pivot;

    sc_to_sc_matrix[57] -= sc_to_sc_fillins[8] * pivot;

    sc_g_matrix[13] -= sc_g_matrix[12] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  0 0 0 1   M   F                    |     |           |     |M|  5
    |          1 M M                      |     |           |     |M|  6
    |      0 0 0 1 M F                    |     |           |     |M|  7
    |          0 0 1 F         M   M      |     |           |     |M|  8
    |0   0   0   0 0 1       M M   F      |     |           |     |M|  9
    |                  1   M M            | ... |           | ... |M| 10 sc
    |                    1 M     M        |     |           |     |M| 11
    |                  0 0 1 M   M        |     |           |     |M| 12
    |                0 0   0 1 M F F      |     |           |     |M| 13
    |              0 0       0 M F M      |     |           |     |M| 14
    |                    x x     x x x    |     |           |     |x| 15
    |              x           x x x x    |     |           |     |x| 16
    |                            x x x x x|     |      x    |     |x| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[56];

    // sc-row-14 = sc-row-14 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[56] = 1;
#endif

    sc_to_sc_fillins[9] /= pivot;

    sc_to_sc_matrix[57] /= pivot;

    sc_g_matrix[13] /= pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  0 0 0 1   M   F                    |     |           |     |M|  5
    |          1 M M                      |     |           |     |M|  6
    |      0 0 0 1 M F                    |     |           |     |M|  7
    |          0 0 1 F         M   M      |     |           |     |M|  8
    |0   0   0   0 0 1       M M   F      |     |           |     |M|  9
    |                  1   M M            | ... |           | ... |M| 10 sc
    |                    1 M     M        |     |           |     |M| 11
    |                  0 0 1 M   M        |     |           |     |M| 12
    |                0 0   0 1 M F F      |     |           |     |M| 13
    |              0 0       0 1 F M      |     |           |     |M| 14
    |                    x x     x x x    |     |           |     |x| 15
    |              x           x x x x    |     |           |     |x| 16
    |                            x x x x x|     |      x    |     |x| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    /*
     *
     * Row 15
     *
     */

    pivot = sc_to_sc_matrix[58];

    // sc-row-15 = sc-row-15 - sc-row-11 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[58] = 0;
#endif

    sc_to_sc_matrix[59] -= sc_to_sc_matrix[41] * pivot;
    sc_to_sc_matrix[60] -= sc_to_sc_matrix[42] * pivot;

    sc_g_matrix[14] -= sc_g_matrix[10] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  0 0 0 1   M   F                    |     |           |     |M|  5
    |          1 M M                      |     |           |     |M|  6
    |      0 0 0 1 M F                    |     |           |     |M|  7
    |          0 0 1 F         M   M      |     |           |     |M|  8
    |0   0   0   0 0 1       M M   F      |     |           |     |M|  9
    |                  1   M M            | ... |           | ... |M| 10 sc
    |                    1 M     M        |     |           |     |M| 11
    |                  0 0 1 M   M        |     |           |     |M| 12
    |                0 0   0 1 M F F      |     |           |     |M| 13
    |              0 0       0 1 F M      |     |           |     |M| 14
    |                    0 M     M x x    |     |           |     |M| 15
    |              x           x x x x    |     |           |     |x| 16
    |                            x x x x x|     |      x    |     |x| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[59];

    // sc-row-15 = sc-row-15 - sc-row-12 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[59] = 0;
#endif

    sc_to_sc_fillins[10] = -sc_to_sc_matrix[46] * pivot;

    sc_to_sc_matrix[60] -= sc_to_sc_matrix[47] * pivot;

    sc_g_matrix[14] -= sc_g_matrix[11] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  0 0 0 1   M   F                    |     |           |     |M|  5
    |          1 M M                      |     |           |     |M|  6
    |      0 0 0 1 M F                    |     |           |     |M|  7
    |          0 0 1 F         M   M      |     |           |     |M|  8
    |0   0   0   0 0 1       M M   F      |     |           |     |M|  9
    |                  1   M M            | ... |           | ... |M| 10 sc
    |                    1 M     M        |     |           |     |M| 11
    |                  0 0 1 M   M        |     |           |     |M| 12
    |                0 0   0 1 M F F      |     |           |     |M| 13
    |              0 0       0 1 F M      |     |           |     |M| 14
    |                    0 0 F   M x x    |     |           |     |M| 15
    |              x           x x x x    |     |           |     |x| 16
    |                            x x x x x|     |      x    |     |x| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_fillins[10];

    // sc-row-15 = sc-row-15 - sc-row-13 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_fillins[10] = 0;
#endif

    sc_to_sc_fillins[11] = -sc_to_sc_matrix[52] * pivot;

    sc_to_sc_matrix[60] -= sc_to_sc_fillins[7] * pivot;
    sc_to_sc_matrix[61] -= sc_to_sc_fillins[8] * pivot;

    sc_g_matrix[14] -= sc_g_matrix[12] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  0 0 0 1   M   F                    |     |           |     |M|  5
    |          1 M M                      |     |           |     |M|  6
    |      0 0 0 1 M F                    |     |           |     |M|  7
    |          0 0 1 F         M   M      |     |           |     |M|  8
    |0   0   0   0 0 1       M M   F      |     |           |     |M|  9
    |                  1   M M            | ... |           | ... |M| 10 sc
    |                    1 M     M        |     |           |     |M| 11
    |                  0 0 1 M   M        |     |           |     |M| 12
    |                0 0   0 1 M F F      |     |           |     |M| 13
    |              0 0       0 1 F M      |     |           |     |M| 14
    |                    0 0 0 F M M x    |     |           |     |M| 15
    |              x           x x x x    |     |           |     |x| 16
    |                            x x x x x|     |      x    |     |x| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_fillins[11];

    // sc-row-15 = sc-row-15 - sc-row-14 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_fillins[11] = 0;
#endif

    sc_to_sc_matrix[60] -= sc_to_sc_fillins[9] * pivot;
    sc_to_sc_matrix[61] -= sc_to_sc_matrix[57] * pivot;

    sc_g_matrix[14] -= sc_g_matrix[13] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  0 0 0 1   M   F                    |     |           |     |M|  5
    |          1 M M                      |     |           |     |M|  6
    |      0 0 0 1 M F                    |     |           |     |M|  7
    |          0 0 1 F         M   M      |     |           |     |M|  8
    |0   0   0   0 0 1       M M   F      |     |           |     |M|  9
    |                  1   M M            | ... |           | ... |M| 10 sc
    |                    1 M     M        |     |           |     |M| 11
    |                  0 0 1 M   M        |     |           |     |M| 12
    |                0 0   0 1 M F F      |     |           |     |M| 13
    |              0 0       0 1 F M      |     |           |     |M| 14
    |                    0 0 0 0 M M x    |     |           |     |M| 15
    |              x           x x x x    |     |           |     |x| 16
    |                            x x x x x|     |      x    |     |x| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[60];

    // sc-row-15 = sc-row-15 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[60] = 1;
#endif

    sc_to_sc_matrix[61] /= pivot;
    sc_to_sc_matrix[62] /= pivot;

    sc_g_matrix[14] /= pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  0 0 0 1   M   F                    |     |           |     |M|  5
    |          1 M M                      |     |           |     |M|  6
    |      0 0 0 1 M F                    |     |           |     |M|  7
    |          0 0 1 F         M   M      |     |           |     |M|  8
    |0   0   0   0 0 1       M M   F      |     |           |     |M|  9
    |                  1   M M            | ... |           | ... |M| 10 sc
    |                    1 M     M        |     |           |     |M| 11
    |                  0 0 1 M   M        |     |           |     |M| 12
    |                0 0   0 1 M F F      |     |           |     |M| 13
    |              0 0       0 1 F M      |     |           |     |M| 14
    |                    0 0 0 0 1 M M    |     |           |     |M| 15
    |              x           x x x x    |     |           |     |x| 16
    |                            x x x x x|     |      x    |     |x| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    /*
     *
     * Row 16
     *
     */

    pivot = sc_to_sc_matrix[63];

    // sc-row-16 = sc-row-16 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[63] = 0;
#endif

    sc_to_sc_fillins[12] = -sc_to_sc_fillins[2] * pivot;

    sc_to_sc_matrix[64] -= sc_to_sc_matrix[30] * pivot;
    sc_to_sc_matrix[66] -= sc_to_sc_matrix[31] * pivot;

    sc_g_matrix[15] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  0 0 0 1   M   F                    |     |           |     |M|  5
    |          1 M M                      |     |           |     |M|  6
    |      0 0 0 1 M F                    |     |           |     |M|  7
    |          0 0 1 F         M   M      |     |           |     |M|  8
    |0   0   0   0 0 1       M M   F      |     |           |     |M|  9
    |                  1   M M            | ... |           | ... |M| 10 sc
    |                    1 M     M        |     |           |     |M| 11
    |                  0 0 1 M   M        |     |           |     |M| 12
    |                0 0   0 1 M F F      |     |           |     |M| 13
    |              0 0       0 1 F M      |     |           |     |M| 14
    |                    0 0 0 0 1 M M    |     |           |     |M| 15
    |              0 F         M x M x    |     |           |     |M| 16
    |                            x x x x x|     |      x    |     |x| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_fillins[12];

    // sc-row-16 = sc-row-16 - sc-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_fillins[12] = 0;
#endif

    sc_to_sc_fillins[13] = -sc_to_sc_matrix[35] * pivot;

    sc_to_sc_matrix[64] -= sc_to_sc_matrix[36] * pivot;
    sc_to_sc_matrix[66] -= sc_to_sc_fillins[6] * pivot;

    sc_g_matrix[15] -= sc_g_matrix[8] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  0 0 0 1   M   F                    |     |           |     |M|  5
    |          1 M M                      |     |           |     |M|  6
    |      0 0 0 1 M F                    |     |           |     |M|  7
    |          0 0 1 F         M   M      |     |           |     |M|  8
    |0   0   0   0 0 1       M M   F      |     |           |     |M|  9
    |                  1   M M            | ... |           | ... |M| 10 sc
    |                    1 M     M        |     |           |     |M| 11
    |                  0 0 1 M   M        |     |           |     |M| 12
    |                0 0   0 1 M F F      |     |           |     |M| 13
    |              0 0       0 1 F M      |     |           |     |M| 14
    |                    0 0 0 0 1 M M    |     |           |     |M| 15
    |              0 0       F M x M x    |     |           |     |M| 16
    |                            x x x x x|     |      x    |     |x| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_fillins[13];

    // sc-row-16 = sc-row-16 - sc-row-13 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_fillins[13] = 0;
#endif

    sc_to_sc_matrix[64] -= sc_to_sc_matrix[52] * pivot;
    sc_to_sc_matrix[65] -= sc_to_sc_fillins[7] * pivot;
    sc_to_sc_matrix[66] -= sc_to_sc_fillins[8] * pivot;

    sc_g_matrix[15] -= sc_g_matrix[12] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  0 0 0 1   M   F                    |     |           |     |M|  5
    |          1 M M                      |     |           |     |M|  6
    |      0 0 0 1 M F                    |     |           |     |M|  7
    |          0 0 1 F         M   M      |     |           |     |M|  8
    |0   0   0   0 0 1       M M   F      |     |           |     |M|  9
    |                  1   M M            | ... |           | ... |M| 10 sc
    |                    1 M     M        |     |           |     |M| 11
    |                  0 0 1 M   M        |     |           |     |M| 12
    |                0 0   0 1 M F F      |     |           |     |M| 13
    |              0 0       0 1 F M      |     |           |     |M| 14
    |                    0 0 0 0 1 M M    |     |           |     |M| 15
    |              0 0       0 M M M x    |     |           |     |M| 16
    |                            x x x x x|     |      x    |     |x| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[64];

    // sc-row-16 = sc-row-16 - sc-row-14 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[64] = 0;
#endif

    sc_to_sc_matrix[65] -= sc_to_sc_fillins[9] * pivot;
    sc_to_sc_matrix[66] -= sc_to_sc_matrix[57] * pivot;

    sc_g_matrix[15] -= sc_g_matrix[13] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  0 0 0 1   M   F                    |     |           |     |M|  5
    |          1 M M                      |     |           |     |M|  6
    |      0 0 0 1 M F                    |     |           |     |M|  7
    |          0 0 1 F         M   M      |     |           |     |M|  8
    |0   0   0   0 0 1       M M   F      |     |           |     |M|  9
    |                  1   M M            | ... |           | ... |M| 10 sc
    |                    1 M     M        |     |           |     |M| 11
    |                  0 0 1 M   M        |     |           |     |M| 12
    |                0 0   0 1 M F F      |     |           |     |M| 13
    |              0 0       0 1 F M      |     |           |     |M| 14
    |                    0 0 0 0 1 M M    |     |           |     |M| 15
    |              0 0       0 0 M M x    |     |           |     |M| 16
    |                            x x x x x|     |      x    |     |x| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[65];

    // sc-row-16 = sc-row-16 - sc-row-15 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[65] = 0;
#endif

    sc_to_sc_matrix[66] -= sc_to_sc_matrix[61] * pivot;
    sc_to_sc_matrix[67] -= sc_to_sc_matrix[62] * pivot;

    sc_g_matrix[15] -= sc_g_matrix[14] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  0 0 0 1   M   F                    |     |           |     |M|  5
    |          1 M M                      |     |           |     |M|  6
    |      0 0 0 1 M F                    |     |           |     |M|  7
    |          0 0 1 F         M   M      |     |           |     |M|  8
    |0   0   0   0 0 1       M M   F      |     |           |     |M|  9
    |                  1   M M            | ... |           | ... |M| 10 sc
    |                    1 M     M        |     |           |     |M| 11
    |                  0 0 1 M   M        |     |           |     |M| 12
    |                0 0   0 1 M F F      |     |           |     |M| 13
    |              0 0       0 1 F M      |     |           |     |M| 14
    |                    0 0 0 0 1 M M    |     |           |     |M| 15
    |              0 0       0 0 0 M M    |     |           |     |M| 16
    |                            x x x x x|     |      x    |     |x| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[66];

    // sc-row-16 = sc-row-16 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[66] = 1;
#endif

    sc_to_sc_matrix[67] /= pivot;

    sc_g_matrix[15] /= pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  0 0 0 1   M   F                    |     |           |     |M|  5
    |          1 M M                      |     |           |     |M|  6
    |      0 0 0 1 M F                    |     |           |     |M|  7
    |          0 0 1 F         M   M      |     |           |     |M|  8
    |0   0   0   0 0 1       M M   F      |     |           |     |M|  9
    |                  1   M M            | ... |           | ... |M| 10 sc
    |                    1 M     M        |     |           |     |M| 11
    |                  0 0 1 M   M        |     |           |     |M| 12
    |                0 0   0 1 M F F      |     |           |     |M| 13
    |              0 0       0 1 F M      |     |           |     |M| 14
    |                    0 0 0 0 1 M M    |     |           |     |M| 15
    |              0 0       0 0 0 1 M    |     |           |     |M| 16
    |                            x x x x x|     |      x    |     |x| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    /*
     *
     * Row 17
     *
     */

    pivot = sc_to_sc_matrix[68];

    // sc-row-17 = sc-row-17 - sc-row-15 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[68] = 0;
#endif

    sc_to_sc_matrix[69] -= sc_to_sc_matrix[61] * pivot;
    sc_to_sc_matrix[70] -= sc_to_sc_matrix[62] * pivot;

    sc_g_matrix[16] -= sc_g_matrix[14] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  0 0 0 1   M   F                    |     |           |     |M|  5
    |          1 M M                      |     |           |     |M|  6
    |      0 0 0 1 M F                    |     |           |     |M|  7
    |          0 0 1 F         M   M      |     |           |     |M|  8
    |0   0   0   0 0 1       M M   F      |     |           |     |M|  9
    |                  1   M M            | ... |           | ... |M| 10 sc
    |                    1 M     M        |     |           |     |M| 11
    |                  0 0 1 M   M        |     |           |     |M| 12
    |                0 0   0 1 M F F      |     |           |     |M| 13
    |              0 0       0 1 F M      |     |           |     |M| 14
    |                    0 0 0 0 1 M M    |     |           |     |M| 15
    |              0 0       0 0 0 1 M    |     |           |     |M| 16
    |                            0 M M x x|     |      x    |     |M| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[69];

    // sc-row-17 = sc-row-17 - sc-row-16 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[69] = 0;
#endif

    sc_to_sc_matrix[70] -= sc_to_sc_matrix[67] * pivot;

    sc_g_matrix[16] -= sc_g_matrix[15] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  0 0 0 1   M   F                    |     |           |     |M|  5
    |          1 M M                      |     |           |     |M|  6
    |      0 0 0 1 M F                    |     |           |     |M|  7
    |          0 0 1 F         M   M      |     |           |     |M|  8
    |0   0   0   0 0 1       M M   F      |     |           |     |M|  9
    |                  1   M M            | ... |           | ... |M| 10 sc
    |                    1 M     M        |     |           |     |M| 11
    |                  0 0 1 M   M        |     |           |     |M| 12
    |                0 0   0 1 M F F      |     |           |     |M| 13
    |              0 0       0 1 F M      |     |           |     |M| 14
    |                    0 0 0 0 1 M M    |     |           |     |M| 15
    |              0 0       0 0 0 1 M    |     |           |     |M| 16
    |                            0 0 M x x|     |      x    |     |M| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[70];

    // sc-row-17 = sc-row-17 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[70] = 1;
#endif

    sc_to_sc_matrix[71] /= pivot;
    sc_to_sc_matrix[72] /= pivot;

    sc_to_bb_matrix[0] /= pivot;

    sc_g_matrix[16] /= pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  0 0 0 1   M   F                    |     |           |     |M|  5
    |          1 M M                      |     |           |     |M|  6
    |      0 0 0 1 M F                    |     |           |     |M|  7
    |          0 0 1 F         M   M      |     |           |     |M|  8
    |0   0   0   0 0 1       M M   F      |     |           |     |M|  9
    |                  1   M M            | ... |           | ... |M| 10 sc
    |                    1 M     M        |     |           |     |M| 11
    |                  0 0 1 M   M        |     |           |     |M| 12
    |                0 0   0 1 M F F      |     |           |     |M| 13
    |              0 0       0 1 F M      |     |           |     |M| 14
    |                    0 0 0 0 1 M M    |     |           |     |M| 15
    |              0 0       0 0 0 1 M    |     |           |     |M| 16
    |                            0 0 1 M M|     |      M    |     |M| 17
    |                                x x x|     |      x    |     |x| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    /*
     *
     * Row 18
     *
     */

    pivot = sc_to_sc_matrix[73];

    // sc-row-18 = sc-row-18 - sc-row-17 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[73] = 0;
#endif

    sc_to_sc_matrix[74] -= sc_to_sc_matrix[71] * pivot;
    sc_to_sc_matrix[75] -= sc_to_sc_matrix[72] * pivot;

    sc_to_bb_matrix[1] -= sc_to_bb_matrix[0] * pivot;

    sc_g_matrix[17] -= sc_g_matrix[16] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  0 0 0 1   M   F                    |     |           |     |M|  5
    |          1 M M                      |     |           |     |M|  6
    |      0 0 0 1 M F                    |     |           |     |M|  7
    |          0 0 1 F         M   M      |     |           |     |M|  8
    |0   0   0   0 0 1       M M   F      |     |           |     |M|  9
    |                  1   M M            | ... |           | ... |M| 10 sc
    |                    1 M     M        |     |           |     |M| 11
    |                  0 0 1 M   M        |     |           |     |M| 12
    |                0 0   0 1 M F F      |     |           |     |M| 13
    |              0 0       0 1 F M      |     |           |     |M| 14
    |                    0 0 0 0 1 M M    |     |           |     |M| 15
    |              0 0       0 0 0 1 M    |     |           |     |M| 16
    |                            0 0 1 M M|     |      M    |     |M| 17
    |                                0 M M|     |      M    |     |M| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[74];

    // sc-row-18 = sc-row-18 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[74] = 1;
#endif

    sc_to_sc_matrix[75] /= pivot;

    sc_to_bb_matrix[1] /= pivot;

    sc_g_matrix[17] /= pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  0 0 0 1   M   F                    |     |           |     |M|  5
    |          1 M M                      |     |           |     |M|  6
    |      0 0 0 1 M F                    |     |           |     |M|  7
    |          0 0 1 F         M   M      |     |           |     |M|  8
    |0   0   0   0 0 1       M M   F      |     |           |     |M|  9
    |                  1   M M            | ... |           | ... |M| 10 sc
    |                    1 M     M        |     |           |     |M| 11
    |                  0 0 1 M   M        |     |           |     |M| 12
    |                0 0   0 1 M F F      |     |           |     |M| 13
    |              0 0       0 1 F M      |     |           |     |M| 14
    |                    0 0 0 0 1 M M    |     |           |     |M| 15
    |              0 0       0 0 0 1 M    |     |           |     |M| 16
    |                            0 0 1 M M|     |      M    |     |M| 17
    |                                0 1 M|     |      M    |     |M| 18
    |                                x x x|     |      x    |     |x| 19
    ---------------------------------------     -------------
    */

    /*
     *
     * Row 19
     *
     */

    pivot = sc_to_sc_matrix[76];

    // sc-row-19 = sc-row-19 - sc-row-17 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[76] = 0;
#endif

    sc_to_sc_matrix[77] -= sc_to_sc_matrix[71] * pivot;
    sc_to_sc_matrix[78] -= sc_to_sc_matrix[72] * pivot;

    sc_to_bb_matrix[2] -= sc_to_bb_matrix[0] * pivot;

    sc_g_matrix[18] -= sc_g_matrix[16] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  0 0 0 1   M   F                    |     |           |     |M|  5
    |          1 M M                      |     |           |     |M|  6
    |      0 0 0 1 M F                    |     |           |     |M|  7
    |          0 0 1 F         M   M      |     |           |     |M|  8
    |0   0   0   0 0 1       M M   F      |     |           |     |M|  9
    |                  1   M M            | ... |           | ... |M| 10 sc
    |                    1 M     M        |     |           |     |M| 11
    |                  0 0 1 M   M        |     |           |     |M| 12
    |                0 0   0 1 M F F      |     |           |     |M| 13
    |              0 0       0 1 F M      |     |           |     |M| 14
    |                    0 0 0 0 1 M M    |     |           |     |M| 15
    |              0 0       0 0 0 1 M    |     |           |     |M| 16
    |                            0 0 1 M M|     |      M    |     |M| 17
    |                                0 1 M|     |      M    |     |M| 18
    |                                0 M M|     |      M    |     |M| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[77];

    // sc-row-19 = sc-row-19 - sc-row-18 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[77] = 0;
#endif

    sc_to_sc_matrix[78] -= sc_to_sc_matrix[75] * pivot;

    sc_to_bb_matrix[2] -= sc_to_bb_matrix[1] * pivot;

    sc_g_matrix[18] -= sc_g_matrix[17] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  0 0 0 1   M   F                    |     |           |     |M|  5
    |          1 M M                      |     |           |     |M|  6
    |      0 0 0 1 M F                    |     |           |     |M|  7
    |          0 0 1 F         M   M      |     |           |     |M|  8
    |0   0   0   0 0 1       M M   F      |     |           |     |M|  9
    |                  1   M M            | ... |           | ... |M| 10 sc
    |                    1 M     M        |     |           |     |M| 11
    |                  0 0 1 M   M        |     |           |     |M| 12
    |                0 0   0 1 M F F      |     |           |     |M| 13
    |              0 0       0 1 F M      |     |           |     |M| 14
    |                    0 0 0 0 1 M M    |     |           |     |M| 15
    |              0 0       0 0 0 1 M    |     |           |     |M| 16
    |                            0 0 1 M M|     |      M    |     |M| 17
    |                                0 1 M|     |      M    |     |M| 18
    |                                0 0 M|     |      M    |     |M| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[78];

    // sc-row-19 = sc-row-19 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[78] = 1;
#endif

    sc_to_bb_matrix[2] /= pivot;

    sc_g_matrix[18] /= pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   M           M                    |     |           |     |M|  1
    |  1 M   M                            |     |           |     |M|  2
    |0 0 1   M       M                    |     |           |     |M|  3
    |      1 M   M                        |     |           |     |M|  4
    |  0 0 0 1   M   F                    |     |           |     |M|  5
    |          1 M M                      |     |           |     |M|  6
    |      0 0 0 1 M F                    |     |           |     |M|  7
    |          0 0 1 F         M   M      |     |           |     |M|  8
    |0   0   0   0 0 1       M M   F      |     |           |     |M|  9
    |                  1   M M            | ... |           | ... |M| 10 sc
    |                    1 M     M        |     |           |     |M| 11
    |                  0 0 1 M   M        |     |           |     |M| 12
    |                0 0   0 1 M F F      |     |           |     |M| 13
    |              0 0       0 1 F M      |     |           |     |M| 14
    |                    0 0 0 0 1 M M    |     |           |     |M| 15
    |              0 0       0 0 0 1 M    |     |           |     |M| 16
    |                            0 0 1 M M|     |      M    |     |M| 17
    |                                0 1 M|     |      M    |     |M| 18
    |                                0 0 1|     |      M    |     |M| 19
    ---------------------------------------     -------------
    */
}

void gmx::IlvesPC::solve_2_threonine(real *const sc_to_sc_matrix,
                                     real *const sc_to_bb_matrix,
                                     __attribute__((unused))
                                     real *const sc_to_sep_matrix,
                                     real *const sc_g_matrix,
                                     __attribute__((unused))
                                     real *const sc_to_sc_fillins,
                                     __attribute__((unused))
                                     real *const sc_to_bb_fillins) {
    /*
     *
     * Row 1
     *
     */

    real pivot = sc_to_sc_matrix[0];

    // sc-row-1 = sc-row-1 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[0] = 1;
#endif

    sc_to_sc_matrix[1] /= pivot;
    sc_to_sc_matrix[2] /= pivot;
    sc_to_sc_matrix[3] /= pivot;

    sc_g_matrix[0] /= pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 M M M      |     |           |     |M|  1
    |x x x x      |     |           |     |x|  2
    |x x x x      |     |           |     |x|  3
    |x x x x   x x| ... |      x    | ... |x|  4 sc
    |        x x  |     |           |     |x|  5
    |      x x x x|     |      x    |     |x|  6
    |      x   x x|     |      x    |     |x|  7
    ---------------     -------------
    */

    /*
     *
     * Row 2
     *
     */

    pivot = sc_to_sc_matrix[4];

    // sc-row-2 = sc-row-2 - sc-row-1 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[4] = 0;
#endif

    sc_to_sc_matrix[5] -= sc_to_sc_matrix[1] * pivot;
    sc_to_sc_matrix[6] -= sc_to_sc_matrix[2] * pivot;
    sc_to_sc_matrix[7] -= sc_to_sc_matrix[3] * pivot;

    sc_g_matrix[1] -= sc_g_matrix[0] * pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 M M M      |     |           |     |M|  1
    |0 M M M      |     |           |     |M|  2
    |x x x x      |     |           |     |x|  3
    |x x x x   x x| ... |      x    | ... |x|  4 sc
    |        x x  |     |           |     |x|  5
    |      x x x x|     |      x    |     |x|  6
    |      x   x x|     |      x    |     |x|  7
    ---------------     -------------
    */

    pivot = sc_to_sc_matrix[5];

    // sc-row-2 = sc-row-2 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[5] = 1;
#endif

    sc_to_sc_matrix[6] /= pivot;
    sc_to_sc_matrix[7] /= pivot;

    sc_g_matrix[1] /= pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 M M M      |     |           |     |M|  1
    |0 1 M M      |     |           |     |M|  2
    |x x x x      |     |           |     |x|  3
    |x x x x   x x| ... |      x    | ... |x|  4 sc
    |        x x  |     |           |     |x|  5
    |      x x x x|     |      x    |     |x|  6
    |      x   x x|     |      x    |     |x|  7
    ---------------     -------------
    */

    /*
     *
     * Row 3
     *
     */

    pivot = sc_to_sc_matrix[8];

    // sc-row-3 = sc-row-3 - sc-row-1 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[8] = 0;
#endif

    sc_to_sc_matrix[9] -= sc_to_sc_matrix[1] * pivot;
    sc_to_sc_matrix[10] -= sc_to_sc_matrix[2] * pivot;
    sc_to_sc_matrix[11] -= sc_to_sc_matrix[3] * pivot;

    sc_g_matrix[2] -= sc_g_matrix[0] * pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 M M M      |     |           |     |M|  1
    |0 1 M M      |     |           |     |M|  2
    |0 M M M      |     |           |     |M|  3
    |x x x x   x x| ... |      x    | ... |x|  4 sc
    |        x x  |     |           |     |x|  5
    |      x x x x|     |      x    |     |x|  6
    |      x   x x|     |      x    |     |x|  7
    ---------------     -------------
    */

    pivot = sc_to_sc_matrix[9];

    // sc-row-3 = sc-row-3 - sc-row-2 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[9] = 0;
#endif

    sc_to_sc_matrix[10] -= sc_to_sc_matrix[6] * pivot;
    sc_to_sc_matrix[11] -= sc_to_sc_matrix[7] * pivot;

    sc_g_matrix[2] -= sc_g_matrix[1] * pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 M M M      |     |           |     |M|  1
    |0 1 M M      |     |           |     |M|  2
    |0 0 M M      |     |           |     |M|  3
    |x x x x   x x| ... |      x    | ... |x|  4 sc
    |        x x  |     |           |     |x|  5
    |      x x x x|     |      x    |     |x|  6
    |      x   x x|     |      x    |     |x|  7
    ---------------     -------------
    */

    pivot = sc_to_sc_matrix[10];

    // sc-row-3 = sc-row-3 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[10] = 1;
#endif

    sc_to_sc_matrix[11] /= pivot;

    sc_g_matrix[2] /= pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 M M M      |     |           |     |M|  1
    |0 1 M M      |     |           |     |M|  2
    |0 0 1 M      |     |           |     |M|  3
    |x x x x   x x| ... |      x    | ... |x|  4 sc
    |        x x  |     |           |     |x|  5
    |      x x x x|     |      x    |     |x|  6
    |      x   x x|     |      x    |     |x|  7
    ---------------     -------------
    */

    /*
     *
     * Row 4
     *
     */

    pivot = sc_to_sc_matrix[12];

    // sc-row-4 = sc-row-4 - sc-row-1 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[12] = 0;
#endif

    sc_to_sc_matrix[13] -= sc_to_sc_matrix[1] * pivot;
    sc_to_sc_matrix[14] -= sc_to_sc_matrix[2] * pivot;
    sc_to_sc_matrix[15] -= sc_to_sc_matrix[3] * pivot;

    sc_g_matrix[3] -= sc_g_matrix[0] * pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 M M M      |     |           |     |M|  1
    |0 1 M M      |     |           |     |M|  2
    |0 0 1 M      |     |           |     |M|  3
    |0 M M M   x x| ... |      x    | ... |M|  4 sc
    |        x x  |     |           |     |x|  5
    |      x x x x|     |      x    |     |x|  6
    |      x   x x|     |      x    |     |x|  7
    ---------------     -------------
    */

    pivot = sc_to_sc_matrix[13];

    // sc-row-4 = sc-row-4 - sc-row-2 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[13] = 0;
#endif

    sc_to_sc_matrix[14] -= sc_to_sc_matrix[6] * pivot;
    sc_to_sc_matrix[15] -= sc_to_sc_matrix[7] * pivot;

    sc_g_matrix[3] -= sc_g_matrix[1] * pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 M M M      |     |           |     |M|  1
    |0 1 M M      |     |           |     |M|  2
    |0 0 1 M      |     |           |     |M|  3
    |0 0 M M   x x| ... |      x    | ... |M|  4 sc
    |        x x  |     |           |     |x|  5
    |      x x x x|     |      x    |     |x|  6
    |      x   x x|     |      x    |     |x|  7
    ---------------     -------------
    */

    pivot = sc_to_sc_matrix[14];

    // sc-row-4 = sc-row-4 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[14] = 0;
#endif

    sc_to_sc_matrix[15] -= sc_to_sc_matrix[11] * pivot;

    sc_g_matrix[3] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 M M M      |     |           |     |M|  1
    |0 1 M M      |     |           |     |M|  2
    |0 0 1 M      |     |           |     |M|  3
    |0 0 0 M   x x| ... |      x    | ... |M|  4 sc
    |        x x  |     |           |     |x|  5
    |      x x x x|     |      x    |     |x|  6
    |      x   x x|     |      x    |     |x|  7
    ---------------     -------------
    */

    pivot = sc_to_sc_matrix[15];

    // sc-row-4 = sc-row-4 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[15] = 1;
#endif

    sc_to_sc_matrix[16] /= pivot;
    sc_to_sc_matrix[17] /= pivot;

    sc_to_bb_matrix[0] /= pivot;

    sc_g_matrix[3] /= pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 M M M      |     |           |     |M|  1
    |0 1 M M      |     |           |     |M|  2
    |0 0 1 M      |     |           |     |M|  3
    |0 0 0 1   M M| ... |      M    | ... |M|  4 sc
    |        x x  |     |           |     |x|  5
    |      x x x x|     |      x    |     |x|  6
    |      x   x x|     |      x    |     |x|  7
    ---------------     -------------
    */

    /*
     *
     * Row 5
     *
     */

    pivot = sc_to_sc_matrix[18];

    // sc-row-5 = sc-row-5 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[18] = 1;
#endif

    sc_to_sc_matrix[19] /= pivot;

    sc_g_matrix[4] /= pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 M M M      |     |           |     |M|  1
    |0 1 M M      |     |           |     |M|  2
    |0 0 1 M      |     |           |     |M|  3
    |0 0 0 1   M M| ... |      M    | ... |M|  4 sc
    |        1 M  |     |           |     |M|  5
    |      x x x x|     |      x    |     |x|  6
    |      x   x x|     |      x    |     |x|  7
    ---------------     -------------
    */

    /*
     *
     * Row 6
     *
     */

    pivot = sc_to_sc_matrix[20];

    // sc-row-6 = sc-row-6 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[20] = 0;
#endif

    sc_to_sc_matrix[22] -= sc_to_sc_matrix[16] * pivot;
    sc_to_sc_matrix[23] -= sc_to_sc_matrix[17] * pivot;

    sc_to_bb_matrix[1] -= sc_to_bb_matrix[0] * pivot;

    sc_g_matrix[5] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 M M M      |     |           |     |M|  1
    |0 1 M M      |     |           |     |M|  2
    |0 0 1 M      |     |           |     |M|  3
    |0 0 0 1   M M| ... |      M    | ... |M|  4 sc
    |        1 M  |     |           |     |M|  5
    |      0 x M M|     |      M    |     |M|  6
    |      x   x x|     |      x    |     |x|  7
    ---------------     -------------
    */

    pivot = sc_to_sc_matrix[21];

    // sc-row-6 = sc-row-6 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[21] = 0;
#endif

    sc_to_sc_matrix[22] -= sc_to_sc_matrix[19] * pivot;

    sc_g_matrix[5] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 M M M      |     |           |     |M|  1
    |0 1 M M      |     |           |     |M|  2
    |0 0 1 M      |     |           |     |M|  3
    |0 0 0 1   M M| ... |      M    | ... |M|  4 sc
    |        1 M  |     |           |     |M|  5
    |      0 0 M M|     |      M    |     |M|  6
    |      x   x x|     |      x    |     |x|  7
    ---------------     -------------
    */

    pivot = sc_to_sc_matrix[22];

    // sc-row-6 = sc-row-6 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[22] = 1;
#endif

    sc_to_sc_matrix[23] /= pivot;

    sc_to_bb_matrix[1] /= pivot;

    sc_g_matrix[5] /= pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 M M M      |     |           |     |M|  1
    |0 1 M M      |     |           |     |M|  2
    |0 0 1 M      |     |           |     |M|  3
    |0 0 0 1   M M| ... |      M    | ... |M|  4 sc
    |        1 M  |     |           |     |M|  5
    |      0 0 1 M|     |      M    |     |M|  6
    |      x   x x|     |      x    |     |x|  7
    ---------------     -------------
    */

    /*
     *
     * Row 7
     *
     */

    pivot = sc_to_sc_matrix[24];

    // sc-row-7 = sc-row-7 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[24] = 0;
#endif

    sc_to_sc_matrix[25] -= sc_to_sc_matrix[16] * pivot;
    sc_to_sc_matrix[26] -= sc_to_sc_matrix[17] * pivot;

    sc_to_bb_matrix[2] -= sc_to_bb_matrix[0] * pivot;

    sc_g_matrix[6] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 M M M      |     |           |     |M|  1
    |0 1 M M      |     |           |     |M|  2
    |0 0 1 M      |     |           |     |M|  3
    |0 0 0 1   M M| ... |      M    | ... |M|  4 sc
    |        1 M  |     |           |     |M|  5
    |      0 0 1 M|     |      M    |     |M|  6
    |      0   M M|     |      M    |     |M|  7
    ---------------     -------------
    */

    pivot = sc_to_sc_matrix[25];

    // sc-row-7 = sc-row-7 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[25] = 0;
#endif

    sc_to_sc_matrix[26] -= sc_to_sc_matrix[23] * pivot;

    sc_to_bb_matrix[2] -= sc_to_bb_matrix[1] * pivot;

    sc_g_matrix[6] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 M M M      |     |           |     |M|  1
    |0 1 M M      |     |           |     |M|  2
    |0 0 1 M      |     |           |     |M|  3
    |0 0 0 1   M M| ... |      M    | ... |M|  4 sc
    |        1 M  |     |           |     |M|  5
    |      0 0 1 M|     |      M    |     |M|  6
    |      0   0 M|     |      M    |     |M|  7
    ---------------     -------------
    */

    pivot = sc_to_sc_matrix[26];

    // sc-row-7 = sc-row-7 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    sc_to_sc_matrix[26] = 1;
#endif

    sc_to_bb_matrix[2] /= pivot;

    sc_g_matrix[6] /= pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 M M M      |     |           |     |M|  1
    |0 1 M M      |     |           |     |M|  2
    |0 0 1 M      |     |           |     |M|  3
    |0 0 0 1   M M| ... |      M    | ... |M|  4 sc
    |        1 M  |     |           |     |M|  5
    |      0 0 1 M|     |      M    |     |M|  6
    |      0   0 1|     |      M    |     |M|  7
    ---------------     -------------
    */
}

// Array of pointer to step 2 solvers.
void (gmx::IlvesPC::*
          gmx::IlvesPC::step_2_solvers[NUM_TYPES])(real *const sc_to_sc_matrix,
                                                   real *const sc_to_bb_matrix,
                                                   real *const sc_to_sep_matrix,
                                                   real *const sc_g_matrix,
                                                   real *const sc_to_sc_fillins,
                                                   real *const sc_to_bb_fillins) =
    {&gmx::IlvesPC::solve_2_glycine,       &gmx::IlvesPC::solve_2_proline,
     &gmx::IlvesPC::solve_2_cysteine,      &gmx::IlvesPC::solve_2_methionine,
     &gmx::IlvesPC::solve_2_alaline,       &gmx::IlvesPC::solve_2_valine,
     &gmx::IlvesPC::solve_2_leucine,       &gmx::IlvesPC::solve_2_isoleucine,
     &gmx::IlvesPC::solve_2_aspartic_acid, &gmx::IlvesPC::solve_2_glutamic_acid,
     &gmx::IlvesPC::solve_2_asparagine,    &gmx::IlvesPC::solve_2_glutamine,
     &gmx::IlvesPC::solve_2_histidine,     &gmx::IlvesPC::solve_2_lysine,
     &gmx::IlvesPC::solve_2_arginine,      &gmx::IlvesPC::solve_2_serine,
     &gmx::IlvesPC::solve_2_phenylaline,   &gmx::IlvesPC::solve_2_tyrosine,
     &gmx::IlvesPC::solve_2_tryptophan,    &gmx::IlvesPC::solve_2_threonine};

void gmx::IlvesPC::solve_2(const int thread) {
    // Pointers to private data.

    private_data_t *pd = &private_data[thread];

    real *sc_to_sc_matrix = pd->sc_to_sc_matrix.data;
    real *sc_to_bb_matrix = pd->sc_to_bb_matrix.data;
    real *sc_to_sep_matrix = pd->sc_to_sep_matrix.data;

    real *sc_g_matrix = pd->sc_g_matrix.data;

    real *sc_to_sc_fillins = pd->sc_to_sc_fillins.data;
    real *sc_to_bb_fillins = pd->sc_to_bb_fillins.data;

    // Loop through the side-chains assigned to thread.
    for (int i = 0; i < pd->num_side_chains; i++) {
        side_chain_type_t type = mol->side_chain_types[pd->first_side_chain + i];

        // Call current side-chain step 2 solver.
        (this->*step_2_solvers[type])(sc_to_sc_matrix,
                                      sc_to_bb_matrix,
                                      sc_to_sep_matrix,
                                      sc_g_matrix,
                                      sc_to_sc_fillins,
                                      sc_to_bb_fillins);

        // Update pointers.
        sc_to_sc_matrix += sc_to_sc_matrix_sizes[type];
        sc_to_bb_matrix += sc_to_bb_matrix_sizes[type];

        sc_to_sc_fillins += sc_to_sc_fillins_sizes[type];
        sc_to_bb_fillins += (type == PROLINE ? SC_TO_BB_PROLINE_FILLINS_SIZE : 0);

        sc_g_matrix += sc_g_matrix_sizes[type];

        sc_to_sep_matrix += (type == PROLINE ? SC_TO_SEP_PROLINE_MATRIX_SIZE : 0);
    }
}

void gmx::IlvesPC::solve_3_glycine(__attribute__((unused))
                                   real *const sc_to_sc_matrix,
                                   __attribute__((unused))
                                   real *const sc_to_bb_matrix,
                                   __attribute__((unused))
                                   real *const sc_to_sep_matrix,
                                   __attribute__((unused)) real *const sc_g_matrix,
                                   __attribute__((unused))
                                   real *const sc_to_bb_fillins,
                                   __attribute__((unused))
                                   real *const bb_to_sc_matrix,
                                   __attribute__((unused))
                                   real *const bb_to_bb_matrix,
                                   __attribute__((unused))
                                   real *const bb_to_sep_matrix,
                                   __attribute__((unused)) real *const bb_g_matrix,
                                   __attribute__((unused))
                                   real *const bb_to_sc_fillins,
                                   __attribute__((unused))
                                   real *const bb_to_sep_fillins) {}

void gmx::IlvesPC::solve_3_proline(real *const sc_to_sc_matrix,
                                   real *const sc_to_bb_matrix,
                                   real *const sc_to_sep_matrix,
                                   real *const sc_g_matrix,
                                   real *const sc_to_bb_fillins,
                                   real *const bb_to_sc_matrix,
                                   real *const bb_to_bb_matrix,
                                   real *const bb_to_sep_matrix,
                                   real *const bb_g_matrix,
                                   real *const bb_to_sc_fillins,
                                   real *const bb_to_sep_fillins) {
    /*
     *
     * Row 4
     *
     */

    real pivot = bb_to_sc_matrix[0];

    // bb-row-4 = bb-row-4 - sc-row-1 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[0] = 0;
#endif

    bb_to_sc_matrix[1] -= sc_to_sc_matrix[1] * pivot;
    bb_to_sc_matrix[2] -= sc_to_sc_matrix[2] * pivot;

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[0] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[0] * pivot;

    /*
    Resulting matrix:

            sc                  bb           sep       g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------     -----
    |1 x         x    |     |      x  |     |   |     |x|  1
    |0 1         x    |     |      x  |     |   |     |x|  2
    |    1 x     x x  |     |         |     |   |     |x|  3
    |    0 1     x x  |     |         |     |   |     |x|  4
    |        1 x   x x| ... |         | ... |   | ... |x|  5 sc
    |        0 1   x x|     |         |     |   |     |x|  6
    |0 0 0 0     1 x  |     |      x  |     |   |     |x|  7
    |    0 0 0 0 0 1 x|     |      f  |     |   |     |x|  8
    |        0 0   0 1|     |      f x|     |  x|     |x|  9
    -------------------     -----------     -----
             .                   .            .
             .                   .            .
             .                   .            .
    -------------------     -----------     -----
    |                 |     |x x      |     |x  |     |x|  1
    |                 |     |x x x x x|     |x  |     |x|  2
    |                 | ... |  x x x x| ... |   | ... |x|  3 bb
    |0 M         M    |     |  x x M x|     |   |     |M|  4
    |                x|     |  x x x x|     |  x|     |x|  5
    -------------------     -----------     -----
    */

    pivot = bb_to_sc_matrix[1];

    // bb-row-4 = bb-row-4 - sc-row-2 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[1] = 0;
#endif

    bb_to_sc_matrix[2] -= sc_to_sc_matrix[5] * pivot;

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[1] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[1] * pivot;

    /*
    Resulting matrix:

            sc                  bb           sep       g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------     -----
    |1 x         x    |     |      x  |     |   |     |x|  1
    |0 1         x    |     |      x  |     |   |     |x|  2
    |    1 x     x x  |     |         |     |   |     |x|  3
    |    0 1     x x  |     |         |     |   |     |x|  4
    |        1 x   x x| ... |         | ... |   | ... |x|  5 sc
    |        0 1   x x|     |         |     |   |     |x|  6
    |0 0 0 0     1 x  |     |      x  |     |   |     |x|  7
    |    0 0 0 0 0 1 x|     |      f  |     |   |     |x|  8
    |        0 0   0 1|     |      f x|     |  x|     |x|  9
    -------------------     -----------     -----
             .                   .            .
             .                   .            .
             .                   .            .
    -------------------     -----------     -----
    |                 |     |x x      |     |x  |     |x|  1
    |                 |     |x x x x x|     |x  |     |x|  2
    |                 | ... |  x x x x| ... |   | ... |x|  3 bb
    |0 0         M    |     |  x x M x|     |   |     |M|  4
    |                x|     |  x x x x|     |  x|     |x|  5
    -------------------     -----------     -----
    */

    pivot = bb_to_sc_matrix[2];

    // bb-row-4 = bb-row-4 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[2] = 0;
#endif

    bb_to_sc_fillins[0] = -sc_to_sc_matrix[27] * pivot;

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[2] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

            sc                  bb           sep       g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------     -----
    |1 x         x    |     |      x  |     |   |     |x|  1
    |0 1         x    |     |      x  |     |   |     |x|  2
    |    1 x     x x  |     |         |     |   |     |x|  3
    |    0 1     x x  |     |         |     |   |     |x|  4
    |        1 x   x x| ... |         | ... |   | ... |x|  5 sc
    |        0 1   x x|     |         |     |   |     |x|  6
    |0 0 0 0     1 x  |     |      x  |     |   |     |x|  7
    |    0 0 0 0 0 1 x|     |      f  |     |   |     |x|  8
    |        0 0   0 1|     |      f x|     |  x|     |x|  9
    -------------------     -----------     -----
             .                   .            .
             .                   .            .
             .                   .            .
    -------------------     -----------     -----
    |                 |     |x x      |     |x  |     |x|  1
    |                 |     |x x x x x|     |x  |     |x|  2
    |                 | ... |  x x x x| ... |   | ... |x|  3 bb
    |0 0         0 F  |     |  x x M x|     |   |     |M|  4
    |                x|     |  x x x x|     |  x|     |x|  5
    -------------------     -----------     -----
    */

    pivot = bb_to_sc_fillins[0];

    // bb-row-4 = bb-row-4 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_fillins[0] = 0;
#endif

    bb_to_sc_fillins[1] = -sc_to_sc_matrix[34] * pivot;

    bb_to_bb_matrix[13] -= sc_to_bb_fillins[0] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

            sc                  bb           sep       g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------     -----
    |1 x         x    |     |      x  |     |   |     |x|  1
    |0 1         x    |     |      x  |     |   |     |x|  2
    |    1 x     x x  |     |         |     |   |     |x|  3
    |    0 1     x x  |     |         |     |   |     |x|  4
    |        1 x   x x| ... |         | ... |   | ... |x|  5 sc
    |        0 1   x x|     |         |     |   |     |x|  6
    |0 0 0 0     1 x  |     |      x  |     |   |     |x|  7
    |    0 0 0 0 0 1 x|     |      f  |     |   |     |x|  8
    |        0 0   0 1|     |      f x|     |  x|     |x|  9
    -------------------     -----------     -----
             .                   .            .
             .                   .            .
             .                   .            .
    -------------------     -----------     -----
    |                 |     |x x      |     |x  |     |x|  1
    |                 |     |x x x x x|     |x  |     |x|  2
    |                 | ... |  x x x x| ... |   | ... |x|  3 bb
    |0 0         0 0 F|     |  x x M x|     |   |     |M|  4
    |                x|     |  x x x x|     |  x|     |x|  5
    -------------------     -----------     -----
    */

    pivot = bb_to_sc_fillins[1];

    // bb-row-4 = bb-row-4 - sc-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_fillins[1] = 0;
#endif

    bb_to_bb_matrix[13] -= sc_to_bb_fillins[1] * pivot;
    bb_to_bb_matrix[14] -= sc_to_bb_matrix[3] * pivot;

    bb_to_sep_fillins[2] = -sc_to_sep_matrix[0] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[8] * pivot;

    /*
    Resulting matrix:

            sc                  bb           sep       g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------     -----
    |1 x         x    |     |      x  |     |   |     |x|  1
    |0 1         x    |     |      x  |     |   |     |x|  2
    |    1 x     x x  |     |         |     |   |     |x|  3
    |    0 1     x x  |     |         |     |   |     |x|  4
    |        1 x   x x| ... |         | ... |   | ... |x|  5 sc
    |        0 1   x x|     |         |     |   |     |x|  6
    |0 0 0 0     1 x  |     |      x  |     |   |     |x|  7
    |    0 0 0 0 0 1 x|     |      f  |     |   |     |x|  8
    |        0 0   0 1|     |      f x|     |  x|     |x|  9
    -------------------     -----------     -----
             .                   .            .
             .                   .            .
             .                   .            .
    -------------------     -----------     -----
    |                 |     |x x      |     |x  |     |x|  1
    |                 |     |x x x x x|     |x  |     |x|  2
    |                 | ... |  x x x x| ... |   | ... |x|  3 bb
    |0 0         0 0 0|     |  x x M M|     |  F|     |M|  4
    |                x|     |  x x x x|     |  x|     |x|  5
    -------------------     -----------     -----
    */

    /*
     *
     * Row 5
     *
     */

    pivot = bb_to_sc_matrix[3];

    // bb-row-5 = bb-row-5 - sc-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[3] = 0;
#endif

    bb_to_bb_matrix[17] -= sc_to_bb_fillins[1] * pivot;
    bb_to_bb_matrix[18] -= sc_to_bb_matrix[3] * pivot;

    bb_to_sep_matrix[2] -= sc_to_sep_matrix[0] * pivot;

    bb_g_matrix[4] -= sc_g_matrix[8] * pivot;

    /*
    Resulting matrix:

            sc                  bb           sep       g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------     -----
    |1 x         x    |     |      x  |     |   |     |x|  1
    |0 1         x    |     |      x  |     |   |     |x|  2
    |    1 x     x x  |     |         |     |   |     |x|  3
    |    0 1     x x  |     |         |     |   |     |x|  4
    |        1 x   x x| ... |         | ... |   | ... |x|  5 sc
    |        0 1   x x|     |         |     |   |     |x|  6
    |0 0 0 0     1 x  |     |      x  |     |   |     |x|  7
    |    0 0 0 0 0 1 x|     |      x  |     |   |     |x|  8
    |        0 0   0 1|     |      x x|     |  x|     |x|  9
    -------------------     -----------     -----
             .                   .            .
             .                   .            .
             .                   .            .
    -------------------     -----------     -----
    |                 |     |x x      |     |x  |     |x|  1
    |                 |     |x x x x x|     |x  |     |x|  2
    |                 | ... |  x x x x| ... |   | ... |x|  3 bb
    |0 0         0 0 0|     |  x x M M|     |  F|     |M|  4
    |                0|     |  x x M M|     |  M|     |M|  5
    -------------------     -----------     -----
    */
}

void gmx::IlvesPC::solve_3_cysteine(real *const sc_to_sc_matrix,
                                    real *const sc_to_bb_matrix,
                                    __attribute__((unused))
                                    real *const sc_to_sep_matrix,
                                    real *const sc_g_matrix,
                                    __attribute__((unused))
                                    real *const sc_to_bb_fillins,
                                    real *const bb_to_sc_matrix,
                                    real *const bb_to_bb_matrix,
                                    __attribute__((unused))
                                    real *const bb_to_sep_matrix,
                                    real *const bb_g_matrix,
                                    __attribute__((unused))
                                    real *const bb_to_sc_fillins,
                                    __attribute__((unused))
                                    real *const bb_to_sep_fillins) {
    /*
     *
     * Row 4
     *
     */

    real pivot = bb_to_sc_matrix[0];

    // bb-row-4 = bb-row-4 - sc-row-2 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[0] = 0;
#endif

    bb_to_sc_matrix[1] -= sc_to_sc_matrix[4] * pivot;
    bb_to_sc_matrix[2] -= sc_to_sc_matrix[5] * pivot;

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[0] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[1] * pivot;

    /*
    Resulting matrix:

       sc              bb            g
     1 2 3 4       1 2 3 4 5 6
    ---------     -------------
    |1 x    |     |           |     |x|  1
    |0 1 x x|     |      x    |     |x|  2
    |  0 1 x| ... |      x    | ... |x|  3 sc
    |  0 0 1|     |      x    |     |x|  4
    ---------     -------------
        .               .
        .               .
        .               .
    ---------     -------------
    |       |     |x x        |     |x|  1
    |       |     |x x x x x  |     |x|  2
    |       |     |  x x x x  |     |x|  3
    |  0 M M| ... |  x x M x  | ... |M|  4 bb
    |       |     |  x x x x x|     |x|  5
    |       |     |        x x|     |x|  6
    ---------     -------------
    */

    pivot = bb_to_sc_matrix[1];

    // bb-row-4 = bb-row-4 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[1] = 0;
#endif

    bb_to_sc_matrix[2] -= sc_to_sc_matrix[8] * pivot;

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[1] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

       sc              bb            g
     1 2 3 4       1 2 3 4 5 6
    ---------     -------------
    |1 x    |     |           |     |x|  1
    |0 1 x x|     |      x    |     |x|  2
    |  0 1 x| ... |      x    | ... |x|  3 sc
    |  0 0 1|     |      x    |     |x|  4
    ---------     -------------
        .               .
        .               .
        .               .
    ---------     -------------
    |       |     |x x        |     |x|  1
    |       |     |x x x x x  |     |x|  2
    |       |     |  x x x x  |     |x|  3
    |  0 0 M| ... |  x x M x  | ... |M|  4 bb
    |       |     |  x x x x x|     |x|  5
    |       |     |        x x|     |x|  6
    ---------     -------------
    */

    pivot = bb_to_sc_matrix[2];

    // bb-row-4 = bb-row-4 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[2] = 0;
#endif

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[2] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

       sc              bb            g
     1 2 3 4       1 2 3 4 5 6
    ---------     -------------
    |1 x    |     |           |     |x|  1
    |0 1 x x|     |      x    |     |x|  2
    |  0 1 x| ... |      x    | ... |x|  3 sc
    |  0 0 1|     |      x    |     |x|  4
    ---------     -------------
        .               .
        .               .
        .               .
    ---------     -------------
    |       |     |x x        |     |x|  1
    |       |     |x x x x x  |     |x|  2
    |       |     |  x x x x  |     |x|  3
    |  0 0 0| ... |  x x M x  | ... |M|  4 bb
    |       |     |  x x x x x|     |x|  5
    |       |     |        x x|     |x|  6
    ---------     -------------
    */
}

void gmx::IlvesPC::solve_3_methionine(real *const sc_to_sc_matrix,
                                      real *const sc_to_bb_matrix,
                                      __attribute__((unused))
                                      real *const sc_to_sep_matrix,
                                      real *const sc_g_matrix,
                                      __attribute__((unused))
                                      real *const sc_to_bb_fillins,
                                      real *const bb_to_sc_matrix,
                                      real *const bb_to_bb_matrix,
                                      __attribute__((unused))
                                      real *const bb_to_sep_matrix,
                                      real *const bb_g_matrix,
                                      __attribute__((unused))
                                      real *const bb_to_sc_fillins,
                                      __attribute__((unused))
                                      real *const bb_to_sep_fillins) {
    /*
     *
     * Row 4
     *
     */

    real pivot = bb_to_sc_matrix[0];

    // bb-row-4 = bb-row-4 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[0] = 0;
#endif

    bb_to_sc_matrix[1] -= sc_to_sc_matrix[34] * pivot;
    bb_to_sc_matrix[2] -= sc_to_sc_matrix[35] * pivot;

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[0] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 x x x            |     |           |     |x|  1
    |0 1 x x            |     |           |     |x|  2
    |0 0 1 x            |     |           |     |x|  3
    |0 0 0 1 x          |     |           |     |x|  4
    |      0 1 x x x    |     |           |     |x|  5
    |        0 1 x x    | ... |           | ... |x|  6 sc
    |        0 0 1 x    |     |           |     |x|  7
    |        0 0 0 1 x x|     |      x    |     |x|  8
    |              0 1 x|     |      x    |     |x|  9
    |              0 0 1|     |      x    |     |x| 10
    ---------------------     -------------
              .                     .
              .                     .
              .                     .
    ---------------------     -------------
    |                   |     |x x        |     |x|  1
    |                   |     |x x x x x  |     |x|  2
    |                   |     |  x x x x  |     |x|  3
    |              0 M M| ... |  x x M x  | ... |M|  4 bb
    |                   |     |  x x x x x|     |x|  5
    |                   |     |        x x|     |x|  6
    ---------------------     -------------
    */

    pivot = bb_to_sc_matrix[1];

    // bb-row-4 = bb-row-4 - sc-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[1] = 0;
#endif

    bb_to_sc_matrix[2] -= sc_to_sc_matrix[38] * pivot;

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[1] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[8] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 x x x            |     |           |     |x|  1
    |0 1 x x            |     |           |     |x|  2
    |0 0 1 x            |     |           |     |x|  3
    |0 0 0 1 x          |     |           |     |x|  4
    |      0 1 x x x    |     |           |     |x|  5
    |        0 1 x x    | ... |           | ... |x|  6 sc
    |        0 0 1 x    |     |           |     |x|  7
    |        0 0 0 1 x x|     |      x    |     |x|  8
    |              0 1 x|     |      x    |     |x|  9
    |              0 0 1|     |      x    |     |x| 10
    ---------------------     -------------
              .                     .
              .                     .
              .                     .
    ---------------------     -------------
    |                   |     |x x        |     |x|  1
    |                   |     |x x x x x  |     |x|  2
    |                   |     |  x x x x  |     |x|  3
    |              0 0 M| ... |  x x M x  | ... |M|  4 bb
    |                   |     |  x x x x x|     |x|  5
    |                   |     |        x x|     |x|  6
    ---------------------     -------------
    */

    pivot = bb_to_sc_matrix[2];

    // bb-row-4 = bb-row-4 - sc-row-10 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[2] = 0;
#endif

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[2] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[9] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 x x x            |     |           |     |x|  1
    |0 1 x x            |     |           |     |x|  2
    |0 0 1 x            |     |           |     |x|  3
    |0 0 0 1 x          |     |           |     |x|  4
    |      0 1 x x x    |     |           |     |x|  5
    |        0 1 x x    | ... |           | ... |x|  6 sc
    |        0 0 1 x    |     |           |     |x|  7
    |        0 0 0 1 x x|     |      x    |     |x|  8
    |              0 1 x|     |      x    |     |x|  9
    |              0 0 1|     |      x    |     |x| 10
    ---------------------     -------------
              .                     .
              .                     .
              .                     .
    ---------------------     -------------
    |                   |     |x x        |     |x|  1
    |                   |     |x x x x x  |     |x|  2
    |                   |     |  x x x x  |     |x|  3
    |              0 0 0| ... |  x x M x  | ... |M|  4 bb
    |                   |     |  x x x x x|     |x|  5
    |                   |     |        x x|     |x|  6
    ---------------------     -------------
    */
}

void gmx::IlvesPC::solve_3_alaline(real *const sc_to_sc_matrix,
                                   real *const sc_to_bb_matrix,
                                   __attribute__((unused))
                                   real *const sc_to_sep_matrix,
                                   real *const sc_g_matrix,
                                   __attribute__((unused))
                                   real *const sc_to_bb_fillins,
                                   real *const bb_to_sc_matrix,
                                   real *const bb_to_bb_matrix,
                                   __attribute__((unused))
                                   real *const bb_to_sep_matrix,
                                   real *const bb_g_matrix,
                                   __attribute__((unused))
                                   real *const bb_to_sc_fillins,
                                   __attribute__((unused))
                                   real *const bb_to_sep_fillins) {
    /*
     *
     * Row 4
     *
     */

    real pivot = bb_to_sc_matrix[0];

    // bb-row-4 = bb-row-4 - sc-row-1 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[0] = 0;
#endif

    bb_to_sc_matrix[1] -= sc_to_sc_matrix[1] * pivot;
    bb_to_sc_matrix[2] -= sc_to_sc_matrix[2] * pivot;

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[0] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[0] * pivot;

    /*
    Resulting matrix:

      sc             bb            g
     1 2 3       1 2 3 4 5 6
    -------     -------------
    |1 x x|     |      x    |     |x|  1
    |0 1 x| ... |      x    | ... |x|  2 sc
    |0 0 1|     |      x    |     |x|  3
    -------     -------------
       .              .
       .              .
       .              .
    -------     -------------
    |     |     |x x        |     |x|  1
    |     |     |x x x x x  |     |x|  2
    |     |     |  x x x x  |     |x|  3
    |0 M M| ... |  x x M x  | ... |M|  4 bb
    |     |     |  x x x x x|     |x|  5
    |     |     |        x x|     |x|  6
    -------     -------------
    */

    pivot = bb_to_sc_matrix[1];

    // bb-row-4 = bb-row-4 - sc-row-2 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[1] = 0;
#endif

    bb_to_sc_matrix[2] -= sc_to_sc_matrix[5] * pivot;

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[1] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[1] * pivot;

    /*
    Resulting matrix:

      sc             bb            g
     1 2 3       1 2 3 4 5 6
    -------     -------------
    |1 x x|     |      x    |     |x|  1
    |0 1 x| ... |      x    | ... |x|  2 sc
    |0 0 1|     |      x    |     |x|  3
    -------     -------------
       .              .
       .              .
       .              .
    -------     -------------
    |     |     |x x        |     |x|  1
    |     |     |x x x x x  |     |x|  2
    |     |     |  x x x x  |     |x|  3
    |0 0 M| ... |  x x M x  | ... |M|  4 bb
    |     |     |  x x x x x|     |x|  5
    |     |     |        x x|     |x|  6
    -------     -------------
    */

    pivot = bb_to_sc_matrix[2];

    // bb-row-4 = bb-row-4 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[2] = 0;
#endif

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[2] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

      sc             bb            g
     1 2 3       1 2 3 4 5 6
    -------     -------------
    |1 x x|     |      x    |     |x|  1
    |0 1 x| ... |      x    | ... |x|  2 sc
    |0 0 1|     |      x    |     |x|  3
    -------     -------------
       .              .
       .              .
       .              .
    -------     -------------
    |     |     |x x        |     |x|  1
    |     |     |x x x x x  |     |x|  2
    |     |     |  x x x x  |     |x|  3
    |0 0 0| ... |  x x M x  | ... |M|  4 bb
    |     |     |  x x x x x|     |x|  5
    |     |     |        x x|     |x|  6
    -------     -------------
    */
}

void gmx::IlvesPC::solve_3_valine(real *const sc_to_sc_matrix,
                                  real *const sc_to_bb_matrix,
                                  __attribute__((unused))
                                  real *const sc_to_sep_matrix,
                                  real *const sc_g_matrix,
                                  __attribute__((unused))
                                  real *const sc_to_bb_fillins,
                                  real *const bb_to_sc_matrix,
                                  real *const bb_to_bb_matrix,
                                  __attribute__((unused))
                                  real *const bb_to_sep_matrix,
                                  real *const bb_g_matrix,
                                  __attribute__((unused))
                                  real *const bb_to_sc_fillins,
                                  __attribute__((unused))
                                  real *const bb_to_sep_fillins) {
    /*
     *
     * Row 4
     *
     */

    real pivot = bb_to_sc_matrix[0];

    // bb-row-4 = bb-row-4 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[0] = 0;
#endif

    bb_to_sc_matrix[1] -= sc_to_sc_matrix[16] * pivot;
    bb_to_sc_matrix[2] -= sc_to_sc_matrix[17] * pivot;

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[0] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

            sc                   bb            g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5 6
    -------------------     -------------
    |1 x x x          |     |           |     |x|  1
    |0 1 x x          |     |           |     |x|  2
    |0 0 1 x          |     |           |     |x|  3
    |0 0 0 1       x x|     |      x    |     |x|  4
    |        1 x x x  | ... |           | ... |x|  5 sc
    |        0 1 x x  |     |           |     |x|  6
    |        0 0 1 x  |     |           |     |x|  7
    |      0 0 0 0 1 x|     |      x    |     |x|  8
    |      0       0 1|     |      x    |     |x|  9
    -------------------     -------------
             .                    .
             .                    .
             .                    .
    -------------------     -------------
    |                 |     |x x        |     |x|  1
    |                 |     |x x x x x  |     |x|  2
    |                 |     |  x x x x  |     |x|  3
    |      0       M M| ... |  x x M x  | ... |M|  4 bb
    |                 |     |  x x x x x|     |x|  5
    |                 |     |        x x|     |x|  6
    -------------------     -------------
    */

    pivot = bb_to_sc_matrix[1];

    // bb-row-4 = bb-row-4 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[1] = 0;
#endif

    bb_to_sc_matrix[2] -= sc_to_sc_matrix[35] * pivot;

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[1] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

            sc                   bb            g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5 6
    -------------------     -------------
    |1 x x x          |     |           |     |x|  1
    |0 1 x x          |     |           |     |x|  2
    |0 0 1 x          |     |           |     |x|  3
    |0 0 0 1       x x|     |      x    |     |x|  4
    |        1 x x x  | ... |           | ... |x|  5 sc
    |        0 1 x x  |     |           |     |x|  6
    |        0 0 1 x  |     |           |     |x|  7
    |      0 0 0 0 1 x|     |      x    |     |x|  8
    |      0       0 1|     |      x    |     |x|  9
    -------------------     -------------
             .                    .
             .                    .
             .                    .
    -------------------     -------------
    |                 |     |x x        |     |x|  1
    |                 |     |x x x x x  |     |x|  2
    |                 |     |  x x x x  |     |x|  3
    |      0       0 M| ... |  x x M x  | ... |M|  4 bb
    |                 |     |  x x x x x|     |x|  5
    |                 |     |        x x|     |x|  6
    -------------------     -------------
    */

    pivot = bb_to_sc_matrix[2];

    // bb-row-4 = bb-row-4 - sc-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[2] = 0;
#endif

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[2] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[8] * pivot;

    /*
    Resulting matrix:

            sc                   bb            g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5 6
    -------------------     -------------
    |1 x x x          |     |           |     |x|  1
    |0 1 x x          |     |           |     |x|  2
    |0 0 1 x          |     |           |     |x|  3
    |0 0 0 1       x x|     |      x    |     |x|  4
    |        1 x x x  | ... |           | ... |x|  5 sc
    |        0 1 x x  |     |           |     |x|  6
    |        0 0 1 x  |     |           |     |x|  7
    |      0 0 0 0 1 x|     |      x    |     |x|  8
    |      0       0 1|     |      x    |     |x|  9
    -------------------     -------------
             .                    .
             .                    .
             .                    .
    -------------------     -------------
    |                 |     |x x        |     |x|  1
    |                 |     |x x x x x  |     |x|  2
    |                 |     |  x x x x  |     |x|  3
    |      0       0 0| ... |  x x M x  | ... |M|  4 bb
    |                 |     |  x x x x x|     |x|  5
    |                 |     |        x x|     |x|  6
    -------------------     -------------
    */
}

void gmx::IlvesPC::solve_3_leucine(real *const sc_to_sc_matrix,
                                   real *const sc_to_bb_matrix,
                                   __attribute__((unused))
                                   real *const sc_to_sep_matrix,
                                   real *const sc_g_matrix,
                                   __attribute__((unused))
                                   real *const sc_to_bb_fillins,
                                   real *const bb_to_sc_matrix,
                                   real *const bb_to_bb_matrix,
                                   __attribute__((unused))
                                   real *const bb_to_sep_matrix,
                                   real *const bb_g_matrix,
                                   __attribute__((unused))
                                   real *const bb_to_sc_fillins,
                                   __attribute__((unused))
                                   real *const bb_to_sep_fillins) {
    /*
     *
     * Row 4
     *
     */

    real pivot = bb_to_sc_matrix[0];

    // bb-row-4 = bb-row-4 - sc-row-10 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[0] = 0;
#endif

    bb_to_sc_matrix[1] -= sc_to_sc_matrix[46] * pivot;
    bb_to_sc_matrix[2] -= sc_to_sc_matrix[47] * pivot;

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[0] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[9] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x x x                |     |           |     |x|  1
    |0 1 x x                |     |           |     |x|  2
    |0 0 1 x                |     |           |     |x|  3
    |0 0 0 1       x x x    |     |           |     |x|  4
    |        1 x x x        |     |           |     |x|  5
    |        0 1 x x        |     |           |     |x|  6
    |        0 0 1 x        | ... |           | ... |x|  7 sc
    |      0 0 0 0 1 x x    |     |           |     |x|  8
    |      0       0 1 x    |     |           |     |x|  9
    |      0       0 0 1 x x|     |      x    |     |x| 10
    |                  0 1 x|     |      x    |     |x| 11
    |                  0 0 1|     |      x    |     |x| 12
    -------------------------     -------------
                .                       .
                .                       .
                .                       .
    -------------------------     -------------
    |                       |     |x x        |     |x|  1
    |                       |     |x x x x x  |     |x|  2
    |                       |     |  x x x x  |     |x|  3
    |                  0 M M| ... |  x x M x  | ... |M|  4 bb
    |                       |     |  x x x x x|     |x|  5
    |                       |     |        x x|     |x|  6
    -------------------------     -------------
    */

    pivot = bb_to_sc_matrix[1];

    // bb-row-4 = bb-row-4 - sc-row-11 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[1] = 0;
#endif

    bb_to_sc_matrix[2] -= sc_to_sc_matrix[50] * pivot;

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[1] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[10] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x x x                |     |           |     |x|  1
    |0 1 x x                |     |           |     |x|  2
    |0 0 1 x                |     |           |     |x|  3
    |0 0 0 1       x x x    |     |           |     |x|  4
    |        1 x x x        |     |           |     |x|  5
    |        0 1 x x        |     |           |     |x|  6
    |        0 0 1 x        | ... |           | ... |x|  7 sc
    |      0 0 0 0 1 x x    |     |           |     |x|  8
    |      0       0 1 x    |     |           |     |x|  9
    |      0       0 0 1 x x|     |      x    |     |x| 10
    |                  0 1 x|     |      x    |     |x| 11
    |                  0 0 1|     |      x    |     |x| 12
    -------------------------     -------------
                .                       .
                .                       .
                .                       .
    -------------------------     -------------
    |                       |     |x x        |     |x|  1
    |                       |     |x x x x x  |     |x|  2
    |                       |     |  x x x x  |     |x|  3
    |                  0 0 M| ... |  x x M x  | ... |M|  4 bb
    |                       |     |  x x x x x|     |x|  5
    |                       |     |        x x|     |x|  6
    -------------------------     -------------
    */

    pivot = bb_to_sc_matrix[2];

    // bb-row-4 = bb-row-4 - sc-row-12 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[2] = 0;
#endif

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[2] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[11] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x x x                |     |           |     |x|  1
    |0 1 x x                |     |           |     |x|  2
    |0 0 1 x                |     |           |     |x|  3
    |0 0 0 1       x x x    |     |           |     |x|  4
    |        1 x x x        |     |           |     |x|  5
    |        0 1 x x        |     |           |     |x|  6
    |        0 0 1 x        | ... |           | ... |x|  7 sc
    |      0 0 0 0 1 x x    |     |           |     |x|  8
    |      0       0 1 x    |     |           |     |x|  9
    |      0       0 0 1 x x|     |      x    |     |x| 10
    |                  0 1 x|     |      x    |     |x| 11
    |                  0 0 1|     |      x    |     |x| 12
    -------------------------     -------------
                .                       .
                .                       .
                .                       .
    -------------------------     -------------
    |                       |     |x x        |     |x|  1
    |                       |     |x x x x x  |     |x|  2
    |                       |     |  x x x x  |     |x|  3
    |                  0 0 0| ... |  x x M x  | ... |M|  4 bb
    |                       |     |  x x x x x|     |x|  5
    |                       |     |        x x|     |x|  6
    -------------------------     -------------
    */
}

void gmx::IlvesPC::solve_3_isoleucine(real *const sc_to_sc_matrix,
                                      real *const sc_to_bb_matrix,
                                      __attribute__((unused))
                                      real *const sc_to_sep_matrix,
                                      real *const sc_g_matrix,
                                      __attribute__((unused))
                                      real *const sc_to_bb_fillins,
                                      real *const bb_to_sc_matrix,
                                      real *const bb_to_bb_matrix,
                                      __attribute__((unused))
                                      real *const bb_to_sep_matrix,
                                      real *const bb_g_matrix,
                                      __attribute__((unused))
                                      real *const bb_to_sc_fillins,
                                      __attribute__((unused))
                                      real *const bb_to_sep_fillins) {
    /*
     *
     * Row 4
     *
     */

    real pivot = bb_to_sc_matrix[0];

    // bb-row-4 = bb-row-4 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[0] = 0;
#endif

    bb_to_sc_matrix[1] -= sc_to_sc_matrix[31] * pivot;
    bb_to_sc_matrix[2] -= sc_to_sc_matrix[32] * pivot;

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[0] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x x x                |     |           |     |x|  1
    |0 1 x x                |     |           |     |x|  2
    |0 0 1 x                |     |           |     |x|  3
    |0 0 0 1 x x x          |     |           |     |x|  4
    |      0 1 x x          |     |           |     |x|  5
    |      0 0 1 x          |     |           |     |x|  6
    |      0 0 0 1       x x| ... |      x    | ... |x|  7 sc
    |              1 x x x  |     |           |     |x|  8
    |              0 1 x x  |     |           |     |x|  9
    |              0 0 1 x  |     |           |     |x| 10
    |            0 0 0 0 1 x|     |      x    |     |x| 11
    |            0       0 1|     |      x    |     |x| 12
    -------------------------     -------------
                .                       .
                .                       .
                .                       .
    -------------------------     -------------
    |                       |     |x x        |     |x|  1
    |                       |     |x x x x x  |     |x|  2
    |                       |     |  x x x x  |     |x|  3
    |            0       M M| ... |  x x M x  | ... |M|  4 bb
    |                       |     |  x x x x x|     |x|  5
    |                       |     |        x x|     |x|  6
    -------------------------     -------------
    */

    pivot = bb_to_sc_matrix[1];

    // bb-row-4 = bb-row-4 - sc-row-11 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[1] = 0;
#endif

    bb_to_sc_matrix[2] -= sc_to_sc_matrix[50] * pivot;

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[1] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[10] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x x x                |     |           |     |x|  1
    |0 1 x x                |     |           |     |x|  2
    |0 0 1 x                |     |           |     |x|  3
    |0 0 0 1 x x x          |     |           |     |x|  4
    |      0 1 x x          |     |           |     |x|  5
    |      0 0 1 x          |     |           |     |x|  6
    |      0 0 0 1       x x| ... |      x    | ... |x|  7 sc
    |              1 x x x  |     |           |     |x|  8
    |              0 1 x x  |     |           |     |x|  9
    |              0 0 1 x  |     |           |     |x| 10
    |            0 0 0 0 1 x|     |      x    |     |x| 11
    |            0       0 1|     |      x    |     |x| 12
    -------------------------     -------------
                .                       .
                .                       .
                .                       .
    -------------------------     -------------
    |                       |     |x x        |     |x|  1
    |                       |     |x x x x x  |     |x|  2
    |                       |     |  x x x x  |     |x|  3
    |            0       0 M| ... |  x x M x  | ... |M|  4 bb
    |                       |     |  x x x x x|     |x|  5
    |                       |     |        x x|     |x|  6
    -------------------------     -------------
    */

    pivot = bb_to_sc_matrix[2];

    // bb-row-4 = bb-row-4 - sc-row-12 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[2] = 0;
#endif

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[2] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[11] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x x x                |     |           |     |x|  1
    |0 1 x x                |     |           |     |x|  2
    |0 0 1 x                |     |           |     |x|  3
    |0 0 0 1 x x x          |     |           |     |x|  4
    |      0 1 x x          |     |           |     |x|  5
    |      0 0 1 x          |     |           |     |x|  6
    |      0 0 0 1       x x| ... |      x    | ... |x|  7 sc
    |              1 x x x  |     |           |     |x|  8
    |              0 1 x x  |     |           |     |x|  9
    |              0 0 1 x  |     |           |     |x| 10
    |            0 0 0 0 1 x|     |      x    |     |x| 11
    |            0       0 1|     |      x    |     |x| 12
    -------------------------     -------------
                .                       .
                .                       .
                .                       .
    -------------------------     -------------
    |                       |     |x x        |     |x|  1
    |                       |     |x x x x x  |     |x|  2
    |                       |     |  x x x x  |     |x|  3
    |            0       0 0| ... |  x x M x  | ... |M|  4 bb
    |                       |     |  x x x x x|     |x|  5
    |                       |     |        x x|     |x|  6
    -------------------------     -------------
    */
}

void gmx::IlvesPC::solve_3_aspartic_acid(real *const sc_to_sc_matrix,
                                         real *const sc_to_bb_matrix,
                                         __attribute__((unused))
                                         real *const sc_to_sep_matrix,
                                         real *const sc_g_matrix,
                                         __attribute__((unused))
                                         real *const sc_to_bb_fillins,
                                         real *const bb_to_sc_matrix,
                                         real *const bb_to_bb_matrix,
                                         __attribute__((unused))
                                         real *const bb_to_sep_matrix,
                                         real *const bb_g_matrix,
                                         __attribute__((unused))
                                         real *const bb_to_sc_fillins,
                                         __attribute__((unused))
                                         real *const bb_to_sep_fillins) {
    /*
     *
     * Row 4
     *
     */

    real pivot = bb_to_sc_matrix[0];

    // bb-row-4 = bb-row-4 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[0] = 0;
#endif

    bb_to_sc_matrix[1] -= sc_to_sc_matrix[9] * pivot;
    bb_to_sc_matrix[2] -= sc_to_sc_matrix[10] * pivot;

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[0] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

        sc               bb            g
     1 2 3 4 5       1 2 3 4 5 6
    -----------     -------------
    |1 x x    |     |           |     |x|  1
    |0 1 x    |     |           |     |x|  2
    |0 0 1 x x| ... |      x    | ... |x|  3 sc
    |    0 1 x|     |      x    |     |x|  4
    |    0 0 1|     |      x    |     |x|  5
    -----------     -------------
         .                .
         .                .
         .                .
    -----------     -------------
    |         |     |x x        |     |x|  1
    |         |     |x x x x x  |     |x|  2
    |         |     |  x x x x  |     |x|  3
    |    0 M M| ... |  x x M x  | ... |M|  4 bb
    |         |     |  x x x x x|     |x|  5
    |         |     |        x x|     |x|  6
    -----------     -------------
    */

    pivot = bb_to_sc_matrix[1];

    // bb-row-4 = bb-row-4 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[1] = 0;
#endif

    bb_to_sc_matrix[2] -= sc_to_sc_matrix[13] * pivot;

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[1] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

        sc               bb            g
     1 2 3 4 5       1 2 3 4 5 6
    -----------     -------------
    |1 x x    |     |           |     |x|  1
    |0 1 x    |     |           |     |x|  2
    |0 0 1 x x| ... |      x    | ... |x|  3 sc
    |    0 1 x|     |      x    |     |x|  4
    |    0 0 1|     |      x    |     |x|  5
    -----------     -------------
         .                .
         .                .
         .                .
    -----------     -------------
    |         |     |x x        |     |x|  1
    |         |     |x x x x x  |     |x|  2
    |         |     |  x x x x  |     |x|  3
    |    0 0 M| ... |  x x M x  | ... |M|  4 bb
    |         |     |  x x x x x|     |x|  5
    |         |     |        x x|     |x|  6
    -----------     -------------
    */

    pivot = bb_to_sc_matrix[2];

    // bb-row-4 = bb-row-4 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[2] = 0;
#endif

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[2] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

        sc               bb            g
     1 2 3 4 5       1 2 3 4 5 6
    -----------     -------------
    |1 x x    |     |           |     |x|  1
    |0 1 x    |     |           |     |x|  2
    |0 0 1 x x| ... |      x    | ... |x|  3 sc
    |    0 1 x|     |      x    |     |x|  4
    |    0 0 1|     |      x    |     |x|  5
    -----------     -------------
         .                .
         .                .
         .                .
    -----------     -------------
    |         |     |x x        |     |x|  1
    |         |     |x x x x x  |     |x|  2
    |         |     |  x x x x  |     |x|  3
    |    0 0 0| ... |  x x M x  | ... |M|  4 bb
    |         |     |  x x x x x|     |x|  5
    |         |     |        x x|     |x|  6
    -----------     -------------
    */
}

void gmx::IlvesPC::solve_3_glutamic_acid(real *const sc_to_sc_matrix,
                                         real *const sc_to_bb_matrix,
                                         __attribute__((unused))
                                         real *const sc_to_sep_matrix,
                                         real *const sc_g_matrix,
                                         __attribute__((unused))
                                         real *const sc_to_bb_fillins,
                                         real *const bb_to_sc_matrix,
                                         real *const bb_to_bb_matrix,
                                         __attribute__((unused))
                                         real *const bb_to_sep_matrix,
                                         real *const bb_g_matrix,
                                         __attribute__((unused))
                                         real *const bb_to_sc_fillins,
                                         __attribute__((unused))
                                         real *const bb_to_sep_fillins) {
    /*
     *
     * Row 4
     *
     */

    real pivot = bb_to_sc_matrix[0];

    // bb-row-4 = bb-row-4 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[0] = 0;
#endif

    bb_to_sc_matrix[1] -= sc_to_sc_matrix[24] * pivot;
    bb_to_sc_matrix[2] -= sc_to_sc_matrix[25] * pivot;

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[0] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

           sc                  bb            g
     1 2 3 4 5 6 7 8       1 2 3 4 5 6
    -----------------     -------------
    |1 x x          |     |           |     |x|  1
    |0 1 x          |     |           |     |x|  2
    |0 0 1 x x x    |     |           |     |x|  3
    |    0 1 x x    |     |           |     |x|  4
    |    0 0 1 x    | ... |           | ... |x|  5 sc
    |    0 0 0 1 x x|     |      x    |     |x|  6
    |          0 1 x|     |      x    |     |x|  7
    |          0 0 1|     |      x    |     |x|  8
    -----------------     -------------
            .                   .
            .                   .
            .                   .
    -----------------     -------------
    |               |     |x x        |     |x|  1
    |               |     |x x x x x  |     |x|  2
    |               |     |  x x x x  |     |x|  3
    |          0 M M| ... |  x x M x  | ... |M|  4 bb
    |               |     |  x x x x x|     |x|  5
    |               |     |        x x|     |x|  6
    -----------------     -------------
    */

    pivot = bb_to_sc_matrix[1];

    // bb-row-4 = bb-row-4 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[1] = 0;
#endif

    bb_to_sc_matrix[2] -= sc_to_sc_matrix[28] * pivot;

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[1] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

           sc                  bb            g
     1 2 3 4 5 6 7 8       1 2 3 4 5 6
    -----------------     -------------
    |1 x x          |     |           |     |x|  1
    |0 1 x          |     |           |     |x|  2
    |0 0 1 x x x    |     |           |     |x|  3
    |    0 1 x x    |     |           |     |x|  4
    |    0 0 1 x    | ... |           | ... |x|  5 sc
    |    0 0 0 1 x x|     |      x    |     |x|  6
    |          0 1 x|     |      x    |     |x|  7
    |          0 0 1|     |      x    |     |x|  8
    -----------------     -------------
            .                   .
            .                   .
            .                   .
    -----------------     -------------
    |               |     |x x        |     |x|  1
    |               |     |x x x x x  |     |x|  2
    |               |     |  x x x x  |     |x|  3
    |          0 0 M| ... |  x x M x  | ... |M|  4 bb
    |               |     |  x x x x x|     |x|  5
    |               |     |        x x|     |x|  6
    -----------------     -------------
    */

    pivot = bb_to_sc_matrix[2];

    // bb-row-4 = bb-row-4 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[2] = 0;
#endif

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[2] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

           sc                  bb            g
     1 2 3 4 5 6 7 8       1 2 3 4 5 6
    -----------------     -------------
    |1 x x          |     |           |     |x|  1
    |0 1 x          |     |           |     |x|  2
    |0 0 1 x x x    |     |           |     |x|  3
    |    0 1 x x    |     |           |     |x|  4
    |    0 0 1 x    | ... |           | ... |x|  5 sc
    |    0 0 0 1 x x|     |      x    |     |x|  6
    |          0 1 x|     |      x    |     |x|  7
    |          0 0 1|     |      x    |     |x|  8
    -----------------     -------------
            .                   .
            .                   .
            .                   .
    -----------------     -------------
    |               |     |x x        |     |x|  1
    |               |     |x x x x x  |     |x|  2
    |               |     |  x x x x  |     |x|  3
    |          0 0 0| ... |  x x M x  | ... |M|  4 bb
    |               |     |  x x x x x|     |x|  5
    |               |     |        x x|     |x|  6
    -----------------     -------------
    */
}

void gmx::IlvesPC::solve_3_asparagine(real *const sc_to_sc_matrix,
                                      real *const sc_to_bb_matrix,
                                      __attribute__((unused))
                                      real *const sc_to_sep_matrix,
                                      real *const sc_g_matrix,
                                      __attribute__((unused))
                                      real *const sc_to_bb_fillins,
                                      real *const bb_to_sc_matrix,
                                      real *const bb_to_bb_matrix,
                                      __attribute__((unused))
                                      real *const bb_to_sep_matrix,
                                      real *const bb_g_matrix,
                                      __attribute__((unused))
                                      real *const bb_to_sc_fillins,
                                      __attribute__((unused))
                                      real *const bb_to_sep_fillins) {
    /*
     *
     * Row 4
     *
     */

    real pivot = bb_to_sc_matrix[0];

    // bb-row-4 = bb-row-4 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[0] = 0;
#endif

    bb_to_sc_matrix[1] -= sc_to_sc_matrix[17] * pivot;
    bb_to_sc_matrix[2] -= sc_to_sc_matrix[18] * pivot;

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[0] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 x x        |     |           |     |x|  1
    |0 1 x        |     |           |     |x|  2
    |0 0 1 x x    |     |           |     |x|  3
    |    0 1 x    | ... |           | ... |x|  4 sc
    |    0 0 1 x x|     |      x    |     |x|  5
    |        0 1 x|     |      x    |     |x|  6
    |        0 0 1|     |      x    |     |x|  7
    ---------------     -------------
           .                  .
           .                  .
           .                  .
    ---------------     -------------
    |             |     |x x        |     |x|  1
    |             |     |x x x x x  |     |x|  2
    |             |     |  x x x x  |     |x|  3
    |        0 M M| ... |  x x M x  | ... |M|  4 bb
    |             |     |  x x x x x|     |x|  5
    |             |     |        x x|     |x|  6
    ---------------     -------------
    */

    pivot = bb_to_sc_matrix[1];

    // bb-row-4 = bb-row-4 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[1] = 0;
#endif

    bb_to_sc_matrix[2] -= sc_to_sc_matrix[21] * pivot;

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[1] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 x x        |     |           |     |x|  1
    |0 1 x        |     |           |     |x|  2
    |0 0 1 x x    |     |           |     |x|  3
    |    0 1 x    | ... |           | ... |x|  4 sc
    |    0 0 1 x x|     |      x    |     |x|  5
    |        0 1 x|     |      x    |     |x|  6
    |        0 0 1|     |      x    |     |x|  7
    ---------------     -------------
           .                  .
           .                  .
           .                  .
    ---------------     -------------
    |             |     |x x        |     |x|  1
    |             |     |x x x x x  |     |x|  2
    |             |     |  x x x x  |     |x|  3
    |        0 0 M| ... |  x x M x  | ... |M|  4 bb
    |             |     |  x x x x x|     |x|  5
    |             |     |        x x|     |x|  6
    ---------------     -------------
    */

    pivot = bb_to_sc_matrix[2];

    // bb-row-4 = bb-row-4 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[2] = 0;
#endif

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[2] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 x x        |     |           |     |x|  1
    |0 1 x        |     |           |     |x|  2
    |0 0 1 x x    |     |           |     |x|  3
    |    0 1 x    | ... |           | ... |x|  4 sc
    |    0 0 1 x x|     |      x    |     |x|  5
    |        0 1 x|     |      x    |     |x|  6
    |        0 0 1|     |      x    |     |x|  7
    ---------------     -------------
           .                  .
           .                  .
           .                  .
    ---------------     -------------
    |             |     |x x        |     |x|  1
    |             |     |x x x x x  |     |x|  2
    |             |     |  x x x x  |     |x|  3
    |        0 0 0| ... |  x x M x  | ... |M|  4 bb
    |             |     |  x x x x x|     |x|  5
    |             |     |        x x|     |x|  6
    ---------------     -------------
    */
}

void gmx::IlvesPC::solve_3_glutamine(real *const sc_to_sc_matrix,
                                     real *const sc_to_bb_matrix,
                                     __attribute__((unused))
                                     real *const sc_to_sep_matrix,
                                     real *const sc_g_matrix,
                                     __attribute__((unused))
                                     real *const sc_to_bb_fillins,
                                     real *const bb_to_sc_matrix,
                                     real *const bb_to_bb_matrix,
                                     __attribute__((unused))
                                     real *const bb_to_sep_matrix,
                                     real *const bb_g_matrix,
                                     __attribute__((unused))
                                     real *const bb_to_sc_fillins,
                                     __attribute__((unused))
                                     real *const bb_to_sep_fillins) {
    /*
     *
     * Row 4
     *
     */

    real pivot = bb_to_sc_matrix[0];

    // bb-row-4 = bb-row-4 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[0] = 0;
#endif

    bb_to_sc_matrix[1] -= sc_to_sc_matrix[32] * pivot;
    bb_to_sc_matrix[2] -= sc_to_sc_matrix[33] * pivot;

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[0] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 x x              |     |           |     |x|  1
    |0 1 x              |     |           |     |x|  2
    |0 0 1 x x          |     |           |     |x|  3
    |    0 1 x          |     |           |     |x|  4
    |    0 0 1 x x x    |     |           |     |x|  5
    |        0 1 x x    | ... |           | ... |x|  6 sc
    |        0 0 1 x    |     |           |     |x|  7
    |        0 0 0 1 x x|     |      x    |     |x|  8
    |              0 1 x|     |      x    |     |x|  9
    |              0 0 1|     |      x    |     |x| 10
    ---------------------     -------------
              .                     .
              .                     .
              .                     .
    ---------------------     -------------
    |                   |     |x x        |     |x|  1
    |                   |     |x x x x x  |     |x|  2
    |                   |     |  x x x x  |     |x|  3
    |              0 M M| ... |  x x M x  | ... |M|  4 bb
    |                   |     |  x x x x x|     |x|  5
    |                   |     |        x x|     |x|  6
    ---------------------     -------------
    */

    pivot = bb_to_sc_matrix[1];

    // bb-row-4 = bb-row-4 - sc-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[1] = 0;
#endif

    bb_to_sc_matrix[2] -= sc_to_sc_matrix[36] * pivot;

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[1] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[8] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 x x              |     |           |     |x|  1
    |0 1 x              |     |           |     |x|  2
    |0 0 1 x x          |     |           |     |x|  3
    |    0 1 x          |     |           |     |x|  4
    |    0 0 1 x x x    |     |           |     |x|  5
    |        0 1 x x    | ... |           | ... |x|  6 sc
    |        0 0 1 x    |     |           |     |x|  7
    |        0 0 0 1 x x|     |      x    |     |x|  8
    |              0 1 x|     |      x    |     |x|  9
    |              0 0 1|     |      x    |     |x| 10
    ---------------------     -------------
              .                     .
              .                     .
              .                     .
    ---------------------     -------------
    |                   |     |x x        |     |x|  1
    |                   |     |x x x x x  |     |x|  2
    |                   |     |  x x x x  |     |x|  3
    |              0 0 M| ... |  x x M x  | ... |M|  4 bb
    |                   |     |  x x x x x|     |x|  5
    |                   |     |        x x|     |x|  6
    ---------------------     -------------
    */

    pivot = bb_to_sc_matrix[2];

    // bb-row-4 = bb-row-4 - sc-row-10 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[2] = 0;
#endif

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[2] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[9] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 x x              |     |           |     |x|  1
    |0 1 x              |     |           |     |x|  2
    |0 0 1 x x          |     |           |     |x|  3
    |    0 1 x          |     |           |     |x|  4
    |    0 0 1 x x x    |     |           |     |x|  5
    |        0 1 x x    | ... |           | ... |x|  6 sc
    |        0 0 1 x    |     |           |     |x|  7
    |        0 0 0 1 x x|     |      x    |     |x|  8
    |              0 1 x|     |      x    |     |x|  9
    |              0 0 1|     |      x    |     |x| 10
    ---------------------     -------------
              .                     .
              .                     .
              .                     .
    ---------------------     -------------
    |                   |     |x x        |     |x|  1
    |                   |     |x x x x x  |     |x|  2
    |                   |     |  x x x x  |     |x|  3
    |              0 0 0| ... |  x x M x  | ... |M|  4 bb
    |                   |     |  x x x x x|     |x|  5
    |                   |     |        x x|     |x|  6
    ---------------------     -------------
    */
}

void gmx::IlvesPC::solve_3_histidine(real *const sc_to_sc_matrix,
                                     real *const sc_to_bb_matrix,
                                     __attribute__((unused))
                                     real *const sc_to_sep_matrix,
                                     real *const sc_g_matrix,
                                     __attribute__((unused))
                                     real *const sc_to_bb_fillins,
                                     real *const bb_to_sc_matrix,
                                     real *const bb_to_bb_matrix,
                                     __attribute__((unused))
                                     real *const bb_to_sep_matrix,
                                     real *const bb_g_matrix,
                                     __attribute__((unused))
                                     real *const bb_to_sc_fillins,
                                     __attribute__((unused))
                                     real *const bb_to_sep_fillins) {
    /*
     *
     * Row 4
     *
     */

    real pivot = bb_to_sc_matrix[0];

    // bb-row-4 = bb-row-4 - sc-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[0] = 0;
#endif

    bb_to_sc_matrix[1] -= sc_to_sc_matrix[35] * pivot;
    bb_to_sc_matrix[2] -= sc_to_sc_matrix[36] * pivot;

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[0] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[8] * pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   x   x            |     |           |     |x|  1
    |  1 x     x          |     |           |     |x|  2
    |0 0 1   x x          |     |           |     |x|  3
    |      1 x     x      |     |           |     |x|  4
    |0   0 0 1 f   x      |     |           |     |x|  5
    |  0 0   0 1 x f      | ... |           | ... |x|  6 sc
    |          0 1 x x    |     |           |     |x|  7
    |      0 0 0 0 1 x    |     |           |     |x|  8
    |            0 0 1 x x|     |      x    |     |x|  9
    |                0 1 x|     |      x    |     |x| 10
    |                0 0 1|     |      x    |     |x| 11
    -----------------------     -------------
               .                      .
               .                      .
               .                      .
    -----------------------     -------------
    |                     |     |x x        |     |x|  1
    |                     |     |x x x x x  |     |x|  2
    |                     |     |  x x x x  |     |x|  3
    |                0 M M| ... |  x x M x  | ... |M|  4 bb
    |                     |     |  x x x x x|     |x|  5
    |                     |     |        x x|     |x|  6
    -----------------------     -------------
    */

    pivot = bb_to_sc_matrix[1];

    // bb-row-4 = bb-row-4 - sc-row-10 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[1] = 0;
#endif

    bb_to_sc_matrix[2] -= sc_to_sc_matrix[39] * pivot;

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[1] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[9] * pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   x   x            |     |           |     |x|  1
    |  1 x     x          |     |           |     |x|  2
    |0 0 1   x x          |     |           |     |x|  3
    |      1 x     x      |     |           |     |x|  4
    |0   0 0 1 f   x      |     |           |     |x|  5
    |  0 0   0 1 x f      | ... |           | ... |x|  6 sc
    |          0 1 x x    |     |           |     |x|  7
    |      0 0 0 0 1 x    |     |           |     |x|  8
    |            0 0 1 x x|     |      x    |     |x|  9
    |                0 1 x|     |      x    |     |x| 10
    |                0 0 1|     |      x    |     |x| 11
    -----------------------     -------------
               .                      .
               .                      .
               .                      .
    -----------------------     -------------
    |                     |     |x x        |     |x|  1
    |                     |     |x x x x x  |     |x|  2
    |                     |     |  x x x x  |     |x|  3
    |                0 0 M| ... |  x x M x  | ... |M|  4 bb
    |                     |     |  x x x x x|     |x|  5
    |                     |     |        x x|     |x|  6
    -----------------------     -------------
    */

    pivot = bb_to_sc_matrix[2];

    // bb-row-4 = bb-row-4 - sc-row-11 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[2] = 0;
#endif

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[2] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[10] * pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   x   x            |     |           |     |x|  1
    |  1 x     x          |     |           |     |x|  2
    |0 0 1   x x          |     |           |     |x|  3
    |      1 x     x      |     |           |     |x|  4
    |0   0 0 1 f   x      |     |           |     |x|  5
    |  0 0   0 1 x f      | ... |           | ... |x|  6 sc
    |          0 1 x x    |     |           |     |x|  7
    |      0 0 0 0 1 x    |     |           |     |x|  8
    |            0 0 1 x x|     |      x    |     |x|  9
    |                0 1 x|     |      x    |     |x| 10
    |                0 0 1|     |      x    |     |x| 11
    -----------------------     -------------
               .                      .
               .                      .
               .                      .
    -----------------------     -------------
    |                     |     |x x        |     |x|  1
    |                     |     |x x x x x  |     |x|  2
    |                     |     |  x x x x  |     |x|  3
    |                0 0 0| ... |  x x M x  | ... |M|  4 bb
    |                     |     |  x x x x x|     |x|  5
    |                     |     |        x x|     |x|  6
    -----------------------     -------------
    */
}

void gmx::IlvesPC::solve_3_lysine(real *const sc_to_sc_matrix,
                                  real *const sc_to_bb_matrix,
                                  __attribute__((unused))
                                  real *const sc_to_sep_matrix,
                                  real *const sc_g_matrix,
                                  __attribute__((unused))
                                  real *const sc_to_bb_fillins,
                                  real *const bb_to_sc_matrix,
                                  real *const bb_to_bb_matrix,
                                  __attribute__((unused))
                                  real *const bb_to_sep_matrix,
                                  real *const bb_g_matrix,
                                  __attribute__((unused))
                                  real *const bb_to_sc_fillins,
                                  __attribute__((unused))
                                  real *const bb_to_sep_fillins) {
    /*
     *
     * Row 4
     *
     */

    real pivot = bb_to_sc_matrix[0];

    // bb-row-4 = bb-row-4 - sc-row-13 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[0] = 0;
#endif

    bb_to_sc_matrix[1] -= sc_to_sc_matrix[61] * pivot;
    bb_to_sc_matrix[2] -= sc_to_sc_matrix[62] * pivot;

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[0] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[12] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 x x x                      |     |           |     |x|  1
    |0 1 x x                      |     |           |     |x|  2
    |0 0 1 x                      |     |           |     |x|  3
    |0 0 0 1 x x x                |     |           |     |x|  4
    |      0 1 x x                |     |           |     |x|  5
    |      0 0 1 x                |     |           |     |x|  6
    |      0 0 0 1 x x x          |     |           |     |x|  7
    |            0 1 x x          | ... |           | ... |x|  8 sc
    |            0 0 1 x          |     |           |     |x|  9
    |            0 0 0 1 x x x    |     |           |     |x| 10
    |                  0 1 x x    |     |           |     |x| 11
    |                  0 0 1 x    |     |           |     |x| 12
    |                  0 0 0 1 x x|     |      x    |     |x| 13
    |                        0 1 x|     |      x    |     |x| 14
    |                        0 0 1|     |      x    |     |x| 15
    -------------------------------     -------------
                   .                          .
                   .                          .
                   .                          .
    -------------------------------     -------------
    |                             |     |x x        |     |x|  1
    |                             |     |x x x x x  |     |x|  2
    |                             |     |  x x x x  |     |x|  3
    |                        0 M M| ... |  x x M x  | ... |M|  4 bb
    |                             |     |  x x x x x|     |x|  5
    |                             |     |        x x|     |x|  6
    -------------------------------     -------------
    */

    pivot = bb_to_sc_matrix[1];

    // bb-row-4 = bb-row-4 - sc-row-14 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[1] = 0;
#endif

    bb_to_sc_matrix[2] -= sc_to_sc_matrix[65] * pivot;

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[1] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[13] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 x x x                      |     |           |     |x|  1
    |0 1 x x                      |     |           |     |x|  2
    |0 0 1 x                      |     |           |     |x|  3
    |0 0 0 1 x x x                |     |           |     |x|  4
    |      0 1 x x                |     |           |     |x|  5
    |      0 0 1 x                |     |           |     |x|  6
    |      0 0 0 1 x x x          |     |           |     |x|  7
    |            0 1 x x          | ... |           | ... |x|  8 sc
    |            0 0 1 x          |     |           |     |x|  9
    |            0 0 0 1 x x x    |     |           |     |x| 10
    |                  0 1 x x    |     |           |     |x| 11
    |                  0 0 1 x    |     |           |     |x| 12
    |                  0 0 0 1 x x|     |      x    |     |x| 13
    |                        0 1 x|     |      x    |     |x| 14
    |                        0 0 1|     |      x    |     |x| 15
    -------------------------------     -------------
                   .                          .
                   .                          .
                   .                          .
    -------------------------------     -------------
    |                             |     |x x        |     |x|  1
    |                             |     |x x x x x  |     |x|  2
    |                             |     |  x x x x  |     |x|  3
    |                        0 0 M| ... |  x x M x  | ... |M|  4 bb
    |                             |     |  x x x x x|     |x|  5
    |                             |     |        x x|     |x|  6
    -------------------------------     -------------
    */

    pivot = bb_to_sc_matrix[2];

    // bb-row-4 = bb-row-4 - sc-row-15 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[2] = 0;
#endif

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[2] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[14] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 x x x                      |     |           |     |x|  1
    |0 1 x x                      |     |           |     |x|  2
    |0 0 1 x                      |     |           |     |x|  3
    |0 0 0 1 x x x                |     |           |     |x|  4
    |      0 1 x x                |     |           |     |x|  5
    |      0 0 1 x                |     |           |     |x|  6
    |      0 0 0 1 x x x          |     |           |     |x|  7
    |            0 1 x x          | ... |           | ... |x|  8 sc
    |            0 0 1 x          |     |           |     |x|  9
    |            0 0 0 1 x x x    |     |           |     |x| 10
    |                  0 1 x x    |     |           |     |x| 11
    |                  0 0 1 x    |     |           |     |x| 12
    |                  0 0 0 1 x x|     |      x    |     |x| 13
    |                        0 1 x|     |      x    |     |x| 14
    |                        0 0 1|     |      x    |     |x| 15
    -------------------------------     -------------
                   .                          .
                   .                          .
                   .                          .
    -------------------------------     -------------
    |                             |     |x x        |     |x|  1
    |                             |     |x x x x x  |     |x|  2
    |                             |     |  x x x x  |     |x|  3
    |                        0 0 0| ... |  x x M x  | ... |M|  4 bb
    |                             |     |  x x x x x|     |x|  5
    |                             |     |        x x|     |x|  6
    -------------------------------     -------------
    */
}

void gmx::IlvesPC::solve_3_arginine(real *const sc_to_sc_matrix,
                                    real *const sc_to_bb_matrix,
                                    __attribute__((unused))
                                    real *const sc_to_sep_matrix,
                                    real *const sc_g_matrix,
                                    __attribute__((unused))
                                    real *const sc_to_bb_fillins,
                                    real *const bb_to_sc_matrix,
                                    real *const bb_to_bb_matrix,
                                    __attribute__((unused))
                                    real *const bb_to_sep_matrix,
                                    real *const bb_g_matrix,
                                    __attribute__((unused))
                                    real *const bb_to_sc_fillins,
                                    __attribute__((unused))
                                    real *const bb_to_sep_fillins) {
    /*
     *
     * Row 4
     *
     */

    real pivot = bb_to_sc_matrix[0];

    // bb-row-4 = bb-row-4 - sc-row-15 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[0] = 0;
#endif

    bb_to_sc_matrix[1] -= sc_to_sc_matrix[63] * pivot;
    bb_to_sc_matrix[2] -= sc_to_sc_matrix[64] * pivot;

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[0] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[14] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 x x                            |     |           |     |x|  1
    |0 1 x                            |     |           |     |x|  2
    |0 0 1     x x                    |     |           |     |x|  3
    |      1 x x                      |     |           |     |x|  4
    |      0 1 x                      |     |           |     |x|  5
    |    0 0 0 1 x                    |     |           |     |x|  6
    |    0     0 1 x x                |     |           |     |x|  7
    |            0 1 x                |     |           |     |x|  8
    |            0 0 1 x x x          | ... |           | ... |x|  9 sc
    |                0 1 x x          |     |           |     |x| 10
    |                0 0 1 x          |     |           |     |x| 11
    |                0 0 0 1 x x x    |     |           |     |x| 12
    |                      0 1 x x    |     |           |     |x| 13
    |                      0 0 1 x    |     |           |     |x| 14
    |                      0 0 0 1 x x|     |      x    |     |x| 15
    |                            0 1 x|     |      x    |     |x| 16
    |                            0 0 1|     |      x    |     |x| 17
    -----------------------------------     -------------
                     .                            .
                     .                            .
                     .                            .
    -----------------------------------     -------------
    |                                 |     |x x        |     |x|  1
    |                                 |     |x x x x x  |     |x|  2
    |                                 |     |  x x x x  |     |x|  3
    |                            0 M M| ... |  x x M x  | ... |M|  4 bb
    |                                 |     |  x x x x x|     |x|  5
    |                                 |     |        x x|     |x|  6
    -----------------------------------     -------------
    */

    pivot = bb_to_sc_matrix[1];

    // bb-row-4 = bb-row-4 - sc-row-16 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[1] = 0;
#endif

    bb_to_sc_matrix[2] -= sc_to_sc_matrix[67] * pivot;

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[1] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[15] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 x x                            |     |           |     |x|  1
    |0 1 x                            |     |           |     |x|  2
    |0 0 1     x x                    |     |           |     |x|  3
    |      1 x x                      |     |           |     |x|  4
    |      0 1 x                      |     |           |     |x|  5
    |    0 0 0 1 x                    |     |           |     |x|  6
    |    0     0 1 x x                |     |           |     |x|  7
    |            0 1 x                |     |           |     |x|  8
    |            0 0 1 x x x          | ... |           | ... |x|  9 sc
    |                0 1 x x          |     |           |     |x| 10
    |                0 0 1 x          |     |           |     |x| 11
    |                0 0 0 1 x x x    |     |           |     |x| 12
    |                      0 1 x x    |     |           |     |x| 13
    |                      0 0 1 x    |     |           |     |x| 14
    |                      0 0 0 1 x x|     |      x    |     |x| 15
    |                            0 1 x|     |      x    |     |x| 16
    |                            0 0 1|     |      x    |     |x| 17
    -----------------------------------     -------------
                     .                            .
                     .                            .
                     .                            .
    -----------------------------------     -------------
    |                                 |     |x x        |     |x|  1
    |                                 |     |x x x x x  |     |x|  2
    |                                 |     |  x x x x  |     |x|  3
    |                            0 0 M| ... |  x x M x  | ... |M|  4 bb
    |                                 |     |  x x x x x|     |x|  5
    |                                 |     |        x x|     |x|  6
    -----------------------------------     -------------
    */

    pivot = bb_to_sc_matrix[2];

    // bb-row-4 = bb-row-4 - sc-row-17 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[2] = 0;
#endif

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[2] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[16] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 x x                            |     |           |     |x|  1
    |0 1 x                            |     |           |     |x|  2
    |0 0 1     x x                    |     |           |     |x|  3
    |      1 x x                      |     |           |     |x|  4
    |      0 1 x                      |     |           |     |x|  5
    |    0 0 0 1 x                    |     |           |     |x|  6
    |    0     0 1 x x                |     |           |     |x|  7
    |            0 1 x                |     |           |     |x|  8
    |            0 0 1 x x x          | ... |           | ... |x|  9 sc
    |                0 1 x x          |     |           |     |x| 10
    |                0 0 1 x          |     |           |     |x| 11
    |                0 0 0 1 x x x    |     |           |     |x| 12
    |                      0 1 x x    |     |           |     |x| 13
    |                      0 0 1 x    |     |           |     |x| 14
    |                      0 0 0 1 x x|     |      x    |     |x| 15
    |                            0 1 x|     |      x    |     |x| 16
    |                            0 0 1|     |      x    |     |x| 17
    -----------------------------------     -------------
                     .                            .
                     .                            .
                     .                            .
    -----------------------------------     -------------
    |                                 |     |x x        |     |x|  1
    |                                 |     |x x x x x  |     |x|  2
    |                                 |     |  x x x x  |     |x|  3
    |                            0 0 0| ... |  x x M x  | ... |M|  4 bb
    |                                 |     |  x x x x x|     |x|  5
    |                                 |     |        x x|     |x|  6
    -----------------------------------     -------------
    */
}

void gmx::IlvesPC::solve_3_serine(real *const sc_to_sc_matrix,
                                  real *const sc_to_bb_matrix,
                                  __attribute__((unused))
                                  real *const sc_to_sep_matrix,
                                  real *const sc_g_matrix,
                                  __attribute__((unused))
                                  real *const sc_to_bb_fillins,
                                  real *const bb_to_sc_matrix,
                                  real *const bb_to_bb_matrix,
                                  __attribute__((unused))
                                  real *const bb_to_sep_matrix,
                                  real *const bb_g_matrix,
                                  __attribute__((unused))
                                  real *const bb_to_sc_fillins,
                                  __attribute__((unused))
                                  real *const bb_to_sep_fillins) {
    /*
     *
     * Row 4
     *
     */

    real pivot = bb_to_sc_matrix[0];

    // bb-row-4 = bb-row-4 - sc-row-2 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[0] = 0;
#endif

    bb_to_sc_matrix[1] -= sc_to_sc_matrix[4] * pivot;
    bb_to_sc_matrix[2] -= sc_to_sc_matrix[5] * pivot;

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[0] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[1] * pivot;

    /*
    Resulting matrix:

       sc              bb            g
     1 2 3 4       1 2 3 4 5 6
    ---------     -------------
    |1 x    |     |           |     |x|  1
    |0 1 x x|     |      x    |     |x|  2
    |  0 1 x| ... |      x    | ... |x|  3 sc
    |  0 0 1|     |      x    |     |x|  4
    ---------     -------------
        .               .
        .               .
        .               .
    ---------     -------------
    |       |     |x x        |     |x|  1
    |       |     |x x x x x  |     |x|  2
    |       |     |  x x x x  |     |x|  3
    |  0 M M| ... |  x x M x  | ... |M|  4 bb
    |       |     |  x x x x x|     |x|  5
    |       |     |        x x|     |x|  6
    ---------     -------------
    */

    pivot = bb_to_sc_matrix[1];

    // bb-row-4 = bb-row-4 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[1] = 0;
#endif

    bb_to_sc_matrix[2] -= sc_to_sc_matrix[8] * pivot;

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[1] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

       sc              bb            g
     1 2 3 4       1 2 3 4 5 6
    ---------     -------------
    |1 x    |     |           |     |x|  1
    |0 1 x x|     |      x    |     |x|  2
    |  0 1 x| ... |      x    | ... |x|  3 sc
    |  0 0 1|     |      x    |     |x|  4
    ---------     -------------
        .               .
        .               .
        .               .
    ---------     -------------
    |       |     |x x        |     |x|  1
    |       |     |x x x x x  |     |x|  2
    |       |     |  x x x x  |     |x|  3
    |  0 0 M| ... |  x x M x  | ... |M|  4 bb
    |       |     |  x x x x x|     |x|  5
    |       |     |        x x|     |x|  6
    ---------     -------------
    */

    pivot = bb_to_sc_matrix[2];

    // bb-row-4 = bb-row-4 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[2] = 0;
#endif

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[2] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

       sc              bb            g
     1 2 3 4       1 2 3 4 5 6
    ---------     -------------
    |1 x    |     |           |     |x|  1
    |0 1 x x|     |      x    |     |x|  2
    |  0 1 x| ... |      x    | ... |x|  3 sc
    |  0 0 1|     |      x    |     |x|  4
    ---------     -------------
        .               .
        .               .
        .               .
    ---------     -------------
    |       |     |x x        |     |x|  1
    |       |     |x x x x x  |     |x|  2
    |       |     |  x x x x  |     |x|  3
    |  0 0 0| ... |  x x M x  | ... |M|  4 bb
    |       |     |  x x x x x|     |x|  5
    |       |     |        x x|     |x|  6
    ---------     -------------
    */
}

void gmx::IlvesPC::solve_3_phenylaline(real *const sc_to_sc_matrix,
                                       real *const sc_to_bb_matrix,
                                       __attribute__((unused))
                                       real *const sc_to_sep_matrix,
                                       real *const sc_g_matrix,
                                       __attribute__((unused))
                                       real *const sc_to_bb_fillins,
                                       real *const bb_to_sc_matrix,
                                       real *const bb_to_bb_matrix,
                                       __attribute__((unused))
                                       real *const bb_to_sep_matrix,
                                       real *const bb_g_matrix,
                                       __attribute__((unused))
                                       real *const bb_to_sc_fillins,
                                       __attribute__((unused))
                                       real *const bb_to_sep_fillins) {
    /*
     *
     * Row 4
     *
     */

    real pivot = bb_to_sc_matrix[0];

    // bb-row-4 = bb-row-4 - sc-row-12 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[0] = 0;
#endif

    bb_to_sc_matrix[1] -= sc_to_sc_matrix[48] * pivot;
    bb_to_sc_matrix[2] -= sc_to_sc_matrix[49] * pivot;

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[0] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[11] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   x             x        |     |           |     |x|  1
    |  1 x   x                  |     |           |     |x|  2
    |0 0 1   x         x        |     |           |     |x|  3
    |      1 x   x              |     |           |     |x|  4
    |  0 0 0 1   x     f        |     |           |     |x|  5
    |          1 x   x          |     |           |     |x|  6
    |      0 0 0 1   x f        |     |           |     |x|  7
    |              1 x   x      | ... |           | ... |x|  8 sc
    |          0 0 0 1 f x      |     |           |     |x|  9
    |0   0   0   0   0 1 x x    |     |           |     |x| 10
    |              0 0 0 1 x    |     |           |     |x| 11
    |                  0 0 1 x x|     |      x    |     |x| 12
    |                      0 1 x|     |      x    |     |x| 13
    |                      0 0 1|     |      x    |     |x| 14
    -----------------------------     -------------
                  .                         .
                  .                         .
                  .                         .
    -----------------------------     -------------
    |                           |     |x x        |     |x|  1
    |                           |     |x x x x x  |     |x|  2
    |                           |     |  x x x x  |     |x|  3
    |                      0 M M| ... |  x x M x  | ... |M|  4 bb
    |                           |     |  x x x x x|     |x|  5
    |                           |     |        x x|     |x|  6
    -----------------------------     -------------
    */

    pivot = bb_to_sc_matrix[1];

    // bb-row-4 = bb-row-4 - sc-row-13 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[1] = 0;
#endif

    bb_to_sc_matrix[2] -= sc_to_sc_matrix[52] * pivot;

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[1] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[12] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   x             x        |     |           |     |x|  1
    |  1 x   x                  |     |           |     |x|  2
    |0 0 1   x         x        |     |           |     |x|  3
    |      1 x   x              |     |           |     |x|  4
    |  0 0 0 1   x     f        |     |           |     |x|  5
    |          1 x   x          |     |           |     |x|  6
    |      0 0 0 1   x f        |     |           |     |x|  7
    |              1 x   x      | ... |           | ... |x|  8 sc
    |          0 0 0 1 f x      |     |           |     |x|  9
    |0   0   0   0   0 1 x x    |     |           |     |x| 10
    |              0 0 0 1 x    |     |           |     |x| 11
    |                  0 0 1 x x|     |      x    |     |x| 12
    |                      0 1 x|     |      x    |     |x| 13
    |                      0 0 1|     |      x    |     |x| 14
    -----------------------------     -------------
                  .                         .
                  .                         .
                  .                         .
    -----------------------------     -------------
    |                           |     |x x        |     |x|  1
    |                           |     |x x x x x  |     |x|  2
    |                           |     |  x x x x  |     |x|  3
    |                      0 0 M| ... |  x x M x  | ... |M|  4 bb
    |                           |     |  x x x x x|     |x|  5
    |                           |     |        x x|     |x|  6
    -----------------------------     -------------
    */

    pivot = bb_to_sc_matrix[2];

    // bb-row-4 = bb-row-4 - sc-row-14 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[2] = 0;
#endif

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[2] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[13] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   x             x        |     |           |     |x|  1
    |  1 x   x                  |     |           |     |x|  2
    |0 0 1   x         x        |     |           |     |x|  3
    |      1 x   x              |     |           |     |x|  4
    |  0 0 0 1   x     f        |     |           |     |x|  5
    |          1 x   x          |     |           |     |x|  6
    |      0 0 0 1   x f        |     |           |     |x|  7
    |              1 x   x      | ... |           | ... |x|  8 sc
    |          0 0 0 1 f x      |     |           |     |x|  9
    |0   0   0   0   0 1 x x    |     |           |     |x| 10
    |              0 0 0 1 x    |     |           |     |x| 11
    |                  0 0 1 x x|     |      x    |     |x| 12
    |                      0 1 x|     |      x    |     |x| 13
    |                      0 0 1|     |      x    |     |x| 14
    -----------------------------     -------------
                  .                         .
                  .                         .
                  .                         .
    -----------------------------     -------------
    |                           |     |x x        |     |x|  1
    |                           |     |x x x x x  |     |x|  2
    |                           |     |  x x x x  |     |x|  3
    |                      0 0 0| ... |  x x M x  | ... |M|  4 bb
    |                           |     |  x x x x x|     |x|  5
    |                           |     |        x x|     |x|  6
    -----------------------------     -------------
    */
}

void gmx::IlvesPC::solve_3_tyrosine(real *const sc_to_sc_matrix,
                                    real *const sc_to_bb_matrix,
                                    __attribute__((unused))
                                    real *const sc_to_sep_matrix,
                                    real *const sc_g_matrix,
                                    __attribute__((unused))
                                    real *const sc_to_bb_fillins,
                                    real *const bb_to_sc_matrix,
                                    real *const bb_to_bb_matrix,
                                    __attribute__((unused))
                                    real *const bb_to_sep_matrix,
                                    real *const bb_g_matrix,
                                    __attribute__((unused))
                                    real *const bb_to_sc_fillins,
                                    __attribute__((unused))
                                    real *const bb_to_sep_fillins) {
    /*
     *
     * Row 4
     *
     */

    real pivot = bb_to_sc_matrix[0];

    // bb-row-4 = bb-row-4 - sc-row-13 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[0] = 0;
#endif

    bb_to_sc_matrix[1] -= sc_to_sc_matrix[51] * pivot;
    bb_to_sc_matrix[2] -= sc_to_sc_matrix[52] * pivot;

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[0] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[12] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       x                    |     |           |     |x|  1
    |  1   x             x        |     |           |     |x|  2
    |    1 x   x                  |     |           |     |x|  3
    |  0 0 1   x         x        |     |           |     |x|  4
    |0       1 x   x              |     |           |     |x|  5
    |    0 0 0 1   x     f        |     |           |     |x|  6
    |            1 x   x          |     |           |     |x|  7
    |        0 0 0 1   x f        | ... |           | ... |x|  8 sc
    |                1 x   x      |     |           |     |x|  9
    |            0 0 0 1 f x      |     |           |     |x| 10
    |  0   0   0   0   0 1 x x    |     |           |     |x| 11
    |                0 0 0 1 x    |     |           |     |x| 12
    |                    0 0 1 x x|     |      x    |     |x| 13
    |                        0 1 x|     |      x    |     |x| 14
    |                        0 0 1|     |      x    |     |x| 15
    -------------------------------     -------------
                   .                          .
                   .                          .
                   .                          .
    -------------------------------     -------------
    |                             |     |x x        |     |x|  1
    |                             |     |x x x x x  |     |x|  2
    |                             |     |  x x x x  |     |x|  3
    |                        0 M M| ... |  x x M x  | ... |M|  4 bb
    |                             |     |  x x x x x|     |x|  5
    |                             |     |        x x|     |x|  6
    -------------------------------     -------------
    */

    pivot = bb_to_sc_matrix[1];

    // bb-row-4 = bb-row-4 - sc-row-14 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[1] = 0;
#endif

    bb_to_sc_matrix[2] -= sc_to_sc_matrix[55] * pivot;

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[1] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[13] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       x                    |     |           |     |x|  1
    |  1   x             x        |     |           |     |x|  2
    |    1 x   x                  |     |           |     |x|  3
    |  0 0 1   x         x        |     |           |     |x|  4
    |0       1 x   x              |     |           |     |x|  5
    |    0 0 0 1   x     f        |     |           |     |x|  6
    |            1 x   x          |     |           |     |x|  7
    |        0 0 0 1   x f        | ... |           | ... |x|  8 sc
    |                1 x   x      |     |           |     |x|  9
    |            0 0 0 1 f x      |     |           |     |x| 10
    |  0   0   0   0   0 1 x x    |     |           |     |x| 11
    |                0 0 0 1 x    |     |           |     |x| 12
    |                    0 0 1 x x|     |      x    |     |x| 13
    |                        0 1 x|     |      x    |     |x| 14
    |                        0 0 1|     |      x    |     |x| 15
    -------------------------------     -------------
                   .                          .
                   .                          .
                   .                          .
    -------------------------------     -------------
    |                             |     |x x        |     |x|  1
    |                             |     |x x x x x  |     |x|  2
    |                             |     |  x x x x  |     |x|  3
    |                        0 0 M| ... |  x x M x  | ... |M|  4 bb
    |                             |     |  x x x x x|     |x|  5
    |                             |     |        x x|     |x|  6
    -------------------------------     -------------
    */

    pivot = bb_to_sc_matrix[2];

    // bb-row-4 = bb-row-4 - sc-row-15 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[2] = 0;
#endif

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[2] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[14] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       x                    |     |           |     |x|  1
    |  1   x             x        |     |           |     |x|  2
    |    1 x   x                  |     |           |     |x|  3
    |  0 0 1   x         x        |     |           |     |x|  4
    |0       1 x   x              |     |           |     |x|  5
    |    0 0 0 1   x     f        |     |           |     |x|  6
    |            1 x   x          |     |           |     |x|  7
    |        0 0 0 1   x f        | ... |           | ... |x|  8 sc
    |                1 x   x      |     |           |     |x|  9
    |            0 0 0 1 f x      |     |           |     |x| 10
    |  0   0   0   0   0 1 x x    |     |           |     |x| 11
    |                0 0 0 1 x    |     |           |     |x| 12
    |                    0 0 1 x x|     |      x    |     |x| 13
    |                        0 1 x|     |      x    |     |x| 14
    |                        0 0 1|     |      x    |     |x| 15
    -------------------------------     -------------
                   .                          .
                   .                          .
                   .                          .
    -------------------------------     -------------
    |                             |     |x x        |     |x|  1
    |                             |     |x x x x x  |     |x|  2
    |                             |     |  x x x x  |     |x|  3
    |                        0 0 0| ... |  x x M x  | ... |M|  4 bb
    |                             |     |  x x x x x|     |x|  5
    |                             |     |        x x|     |x|  6
    -------------------------------     -------------
    */
}

void gmx::IlvesPC::solve_3_tryptophan(real *const sc_to_sc_matrix,
                                      real *const sc_to_bb_matrix,
                                      __attribute__((unused))
                                      real *const sc_to_sep_matrix,
                                      real *const sc_g_matrix,
                                      __attribute__((unused))
                                      real *const sc_to_bb_fillins,
                                      real *const bb_to_sc_matrix,
                                      real *const bb_to_bb_matrix,
                                      __attribute__((unused))
                                      real *const bb_to_sep_matrix,
                                      real *const bb_g_matrix,
                                      __attribute__((unused))
                                      real *const bb_to_sc_fillins,
                                      __attribute__((unused))
                                      real *const bb_to_sep_fillins) {
    /*
     *
     * Row 4
     *
     */

    real pivot = bb_to_sc_matrix[0];

    // bb-row-4 = bb-row-4 - sc-row-17 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[0] = 0;
#endif

    bb_to_sc_matrix[1] -= sc_to_sc_matrix[71] * pivot;
    bb_to_sc_matrix[2] -= sc_to_sc_matrix[72] * pivot;

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[0] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[16] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   x           x                    |     |           |     |x|  1
    |  1 x   x                            |     |           |     |x|  2
    |0 0 1   x       x                    |     |           |     |x|  3
    |      1 x   x                        |     |           |     |x|  4
    |  0 0 0 1   x   f                    |     |           |     |x|  5
    |          1 x x                      |     |           |     |x|  6
    |      0 0 0 1 x f                    |     |           |     |x|  7
    |          0 0 1 f         x   x      |     |           |     |x|  8
    |0   0   0   0 0 1       x x   f      |     |           |     |x|  9
    |                  1   x x            | ... |           | ... |x| 10 sc
    |                    1 x     x        |     |           |     |x| 11
    |                  0 0 1 x   x        |     |           |     |x| 12
    |                0 0   0 1 x f f      |     |           |     |x| 13
    |              0 0       0 1 f x      |     |           |     |x| 14
    |                    0 0 0 0 1 x x    |     |           |     |x| 15
    |              0 0       0 0 0 1 x    |     |           |     |x| 16
    |                            0 0 1 x x|     |      x    |     |x| 17
    |                                0 1 x|     |      x    |     |x| 18
    |                                0 0 1|     |      x    |     |x| 19
    ---------------------------------------     -------------
                       .                              .
                       .                              .
                       .                              .
    ---------------------------------------     -------------
    |                                     |     |x x        |     |x|  1
    |                                     |     |x x x x x  |     |x|  2
    |                                     |     |  x x x x  |     |x|  3
    |                                0 M M| ... |  x x M x  | ... |M|  4 bb
    |                                     |     |  x x x x x|     |x|  5
    |                                     |     |        x x|     |x|  6
    ---------------------------------------     -------------
    */

    pivot = bb_to_sc_matrix[1];

    // bb-row-4 = bb-row-4 - sc-row-18 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[1] = 0;
#endif

    bb_to_sc_matrix[2] -= sc_to_sc_matrix[75] * pivot;

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[1] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[17] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   x           x                    |     |           |     |x|  1
    |  1 x   x                            |     |           |     |x|  2
    |0 0 1   x       x                    |     |           |     |x|  3
    |      1 x   x                        |     |           |     |x|  4
    |  0 0 0 1   x   f                    |     |           |     |x|  5
    |          1 x x                      |     |           |     |x|  6
    |      0 0 0 1 x f                    |     |           |     |x|  7
    |          0 0 1 f         x   x      |     |           |     |x|  8
    |0   0   0   0 0 1       x x   f      |     |           |     |x|  9
    |                  1   x x            | ... |           | ... |x| 10 sc
    |                    1 x     x        |     |           |     |x| 11
    |                  0 0 1 x   x        |     |           |     |x| 12
    |                0 0   0 1 x f f      |     |           |     |x| 13
    |              0 0       0 1 f x      |     |           |     |x| 14
    |                    0 0 0 0 1 x x    |     |           |     |x| 15
    |              0 0       0 0 0 1 x    |     |           |     |x| 16
    |                            0 0 1 x x|     |      x    |     |x| 17
    |                                0 1 x|     |      x    |     |x| 18
    |                                0 0 1|     |      x    |     |x| 19
    ---------------------------------------     -------------
                       .                              .
                       .                              .
                       .                              .
    ---------------------------------------     -------------
    |                                     |     |x x        |     |x|  1
    |                                     |     |x x x x x  |     |x|  2
    |                                     |     |  x x x x  |     |x|  3
    |                                0 0 M| ... |  x x M x  | ... |M|  4 bb
    |                                     |     |  x x x x x|     |x|  5
    |                                     |     |        x x|     |x|  6
    ---------------------------------------     -------------
    */

    pivot = bb_to_sc_matrix[2];

    // bb-row-4 = bb-row-4 - sc-row-19 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[2] = 0;
#endif

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[2] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[18] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   x           x                    |     |           |     |x|  1
    |  1 x   x                            |     |           |     |x|  2
    |0 0 1   x       x                    |     |           |     |x|  3
    |      1 x   x                        |     |           |     |x|  4
    |  0 0 0 1   x   f                    |     |           |     |x|  5
    |          1 x x                      |     |           |     |x|  6
    |      0 0 0 1 x f                    |     |           |     |x|  7
    |          0 0 1 f         x   x      |     |           |     |x|  8
    |0   0   0   0 0 1       x x   f      |     |           |     |x|  9
    |                  1   x x            | ... |           | ... |x| 10 sc
    |                    1 x     x        |     |           |     |x| 11
    |                  0 0 1 x   x        |     |           |     |x| 12
    |                0 0   0 1 x f f      |     |           |     |x| 13
    |              0 0       0 1 f x      |     |           |     |x| 14
    |                    0 0 0 0 1 x x    |     |           |     |x| 15
    |              0 0       0 0 0 1 x    |     |           |     |x| 16
    |                            0 0 1 x x|     |      x    |     |x| 17
    |                                0 1 x|     |      x    |     |x| 18
    |                                0 0 1|     |      x    |     |x| 19
    ---------------------------------------     -------------
                       .                              .
                       .                              .
                       .                              .
    ---------------------------------------     -------------
    |                                     |     |x x        |     |x|  1
    |                                     |     |x x x x x  |     |x|  2
    |                                     |     |  x x x x  |     |x|  3
    |                                0 0 0| ... |  x x M x  | ... |M|  4 bb
    |                                     |     |  x x x x x|     |x|  5
    |                                     |     |        x x|     |x|  6
    ---------------------------------------     -------------
    */
}

void gmx::IlvesPC::solve_3_threonine(real *const sc_to_sc_matrix,
                                     real *const sc_to_bb_matrix,
                                     __attribute__((unused))
                                     real *const sc_to_sep_matrix,
                                     real *const sc_g_matrix,
                                     __attribute__((unused))
                                     real *const sc_to_bb_fillins,
                                     real *const bb_to_sc_matrix,
                                     real *const bb_to_bb_matrix,
                                     __attribute__((unused))
                                     real *const bb_to_sep_matrix,
                                     real *const bb_g_matrix,
                                     __attribute__((unused))
                                     real *const bb_to_sc_fillins,
                                     __attribute__((unused))
                                     real *const bb_to_sep_fillins) {
    /*
     *
     * Row 4
     *
     */

    real pivot = bb_to_sc_matrix[0];

    // bb-row-4 = bb-row-4 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[0] = 0;
#endif

    bb_to_sc_matrix[1] -= sc_to_sc_matrix[16] * pivot;
    bb_to_sc_matrix[2] -= sc_to_sc_matrix[17] * pivot;

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[0] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 x x x      |     |           |     |x|  1
    |0 1 x x      |     |           |     |x|  2
    |0 0 1 x      |     |           |     |x|  3
    |0 0 0 1   x x| ... |      x    | ... |x|  4 sc
    |        1 x  |     |           |     |x|  5
    |      0 0 1 x|     |      x    |     |x|  6
    |      0   0 1|     |      x    |     |x|  7
    ---------------     -------------
           .                  .
           .                  .
           .                  .
    ---------------     -------------
    |             |     |x x        |     |x|  1
    |             |     |x x x x x  |     |x|  2
    |             |     |  x x x x  |     |x|  3
    |      0   M M| ... |  x x M x  | ... |M|  4 bb
    |             |     |  x x x x x|     |x|  5
    |             |     |        x x|     |x|  6
    ---------------     -------------
    */

    pivot = bb_to_sc_matrix[1];

    // bb-row-4 = bb-row-4 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[1] = 0;
#endif

    bb_to_sc_matrix[2] -= sc_to_sc_matrix[23] * pivot;

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[1] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 x x x      |     |           |     |x|  1
    |0 1 x x      |     |           |     |x|  2
    |0 0 1 x      |     |           |     |x|  3
    |0 0 0 1   x x| ... |      x    | ... |x|  4 sc
    |        1 x  |     |           |     |x|  5
    |      0 0 1 x|     |      x    |     |x|  6
    |      0   0 1|     |      x    |     |x|  7
    ---------------     -------------
           .                  .
           .                  .
           .                  .
    ---------------     -------------
    |             |     |x x        |     |x|  1
    |             |     |x x x x x  |     |x|  2
    |             |     |  x x x x  |     |x|  3
    |      0   0 M| ... |  x x M x  | ... |M|  4 bb
    |             |     |  x x x x x|     |x|  5
    |             |     |        x x|     |x|  6
    ---------------     -------------
    */

    pivot = bb_to_sc_matrix[2];

    // bb-row-4 = bb-row-4 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sc_matrix[2] = 0;
#endif

    bb_to_bb_matrix[13] -= sc_to_bb_matrix[2] * pivot;

    bb_g_matrix[3] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 x x x      |     |           |     |x|  1
    |0 1 x x      |     |           |     |x|  2
    |0 0 1 x      |     |           |     |x|  3
    |0 0 0 1   x x| ... |      x    | ... |x|  4 sc
    |        1 x  |     |           |     |x|  5
    |      0 0 1 x|     |      x    |     |x|  6
    |      0   0 1|     |      x    |     |x|  7
    ---------------     -------------
           .                  .
           .                  .
           .                  .
    ---------------     -------------
    |             |     |x x        |     |x|  1
    |             |     |x x x x x  |     |x|  2
    |             |     |  x x x x  |     |x|  3
    |      0   0 0| ... |  x x M x  | ... |M|  4 bb
    |             |     |  x x x x x|     |x|  5
    |             |     |        x x|     |x|  6
    ---------------     -------------
    */
}

// Array of pointer to step 3 solvers.
void (gmx::IlvesPC::*gmx::IlvesPC::step_3_solvers[NUM_TYPES])(real *const,
                                                              real *const,
                                                              real *const,
                                                              real *const,
                                                              real *const,
                                                              real *const,
                                                              real *const,
                                                              real *const,
                                                              real *const,
                                                              real *const,
                                                              real *const) =
    {&gmx::IlvesPC::solve_3_glycine,       &gmx::IlvesPC::solve_3_proline,
     &gmx::IlvesPC::solve_3_cysteine,      &gmx::IlvesPC::solve_3_methionine,
     &gmx::IlvesPC::solve_3_alaline,       &gmx::IlvesPC::solve_3_valine,
     &gmx::IlvesPC::solve_3_leucine,       &gmx::IlvesPC::solve_3_isoleucine,
     &gmx::IlvesPC::solve_3_aspartic_acid, &gmx::IlvesPC::solve_3_glutamic_acid,
     &gmx::IlvesPC::solve_3_asparagine,    &gmx::IlvesPC::solve_3_glutamine,
     &gmx::IlvesPC::solve_3_histidine,     &gmx::IlvesPC::solve_3_lysine,
     &gmx::IlvesPC::solve_3_arginine,      &gmx::IlvesPC::solve_3_serine,
     &gmx::IlvesPC::solve_3_phenylaline,   &gmx::IlvesPC::solve_3_tyrosine,
     &gmx::IlvesPC::solve_3_tryptophan,    &gmx::IlvesPC::solve_3_threonine};

void gmx::IlvesPC::solve_3(const int thread) {
    // Pointers to private data.

    private_data_t *pd = &private_data[thread];

    real *sc_to_sc_matrix = pd->sc_to_sc_matrix.data;
    real *sc_to_bb_matrix = pd->sc_to_bb_matrix.data;
    real *sc_to_sep_matrix = pd->sc_to_sep_matrix.data;

    real *sc_g_matrix = pd->sc_g_matrix.data;

    real *sc_to_bb_fillins = pd->sc_to_bb_fillins.data;

    real *bb_to_sc_matrix = pd->bb_to_sc_matrix.data;
    real *bb_to_bb_matrix = pd->bb_to_bb_matrix.data;
    real *bb_to_sep_matrix = pd->bb_to_sep_matrix.data;

    real *bb_g_matrix = pd->bb_g_matrix.data;

    real *bb_to_sc_fillins = pd->bb_to_sc_fillins.data;
    real *bb_to_sep_fillins = pd->bb_to_sep_fillins.data;

    // Loop through the side-chains assigned to thread.
    for (int i = 0; i < pd->num_side_chains; i++) {
        side_chain_type_t type = mol->side_chain_types[pd->first_side_chain + i];

        // Call current side-chain step 3 solver.
        (this->*step_3_solvers[type])(sc_to_sc_matrix,
                                      sc_to_bb_matrix,
                                      sc_to_sep_matrix,
                                      sc_g_matrix,
                                      sc_to_bb_fillins,
                                      bb_to_sc_matrix,
                                      bb_to_bb_matrix,
                                      bb_to_sep_matrix,
                                      bb_g_matrix,
                                      bb_to_sc_fillins,
                                      bb_to_sep_fillins);

        // Update pointers.
        sc_to_sc_matrix += sc_to_sc_matrix_sizes[type];
        sc_to_bb_matrix += sc_to_bb_matrix_sizes[type];

        sc_g_matrix += sc_g_matrix_sizes[type];

        sc_to_bb_fillins += (type == PROLINE ? SC_TO_BB_PROLINE_FILLINS_SIZE : 0);

        bb_to_sc_matrix += bb_to_sc_matrix_sizes[type];
        bb_to_bb_matrix += (type == PROLINE ? BB_TO_BB_PROLINE_MATRIX_SIZE
                                            : BB_TO_BB_MATRIX_SIZE);
        bb_to_sep_matrix += (type == PROLINE ? BB_TO_SEP_PROLINE_MATRIX_SIZE
                                             : BB_TO_SEP_MATRIX_SIZE);

        bb_g_matrix += (type == PROLINE ? BB_G_PROLINE_MATRIX_SIZE
                                        : BB_G_MATRIX_SIZE);

        bb_to_sc_fillins += (type == PROLINE ? BB_TO_SC_PROLINE_FILLINS_SIZE : 0);
        bb_to_sep_fillins += BB_TO_SEP_FILLINS_SIZE;

        sc_to_sep_matrix += (type == PROLINE ? SC_TO_SEP_PROLINE_MATRIX_SIZE : 0);
    }
}

void gmx::IlvesPC::solve_4_proline(real *const bb_to_bb_matrix,
                                   real *const bb_to_sep_matrix,
                                   real *const bb_g_matrix,
                                   real *const bb_to_sep_fillins) {
    /*
     *
     * Row 1
     *
     */

    real pivot = bb_to_bb_matrix[0];

    // row-1 = row-1 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    bb_to_bb_matrix[0] = 1;
#endif

    bb_to_bb_matrix[1] /= pivot;

    bb_to_sep_matrix[0] /= pivot;

    bb_g_matrix[0] /= pivot;

    /*
    Resulting matrix:

         bb          sep       g
     1 2 3 4 5       1 2
    -----------     -----
    |1 M      |     |M  |     |M|       1
    |x x x x x|     |x  |     |x|       2
    |  x x x x|     |   |     |x| bb    3
    |  x x x x| ... |  f| ... |x|       4
    |  x x x x|     |  x|     |x|       5
    -----------     -----
    */

    /*
     *
     * Row 2
     *
     */

    pivot = bb_to_bb_matrix[2];

    // row-2 = row-2 - (row-1 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_bb_matrix[2] = 0;
#endif

    bb_to_bb_matrix[3] -= bb_to_bb_matrix[1] * pivot;

    bb_to_sep_matrix[1] -= bb_to_sep_matrix[0] * pivot;

    bb_g_matrix[1] -= bb_g_matrix[0] * pivot;

    /*
    Resulting matrix:

         bb          sep       g
     1 2 3 4 5       1 2
    -----------     -----
    |1 M      |     |M  |     |M|       1
    |0 M x x x|     |M  |     |M|       2
    |  x x x x|     |   |     |x| bb    3
    |  x x x x| ... |  f| ... |x|       4
    |  x x x x|     |  x|     |x|       5
    -----------     -----
    */

    pivot = bb_to_bb_matrix[3];

    // row-2 = row-2 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    bb_to_bb_matrix[3] = 1;
#endif

    bb_to_bb_matrix[4] /= pivot;
    bb_to_bb_matrix[5] /= pivot;
    bb_to_bb_matrix[6] /= pivot;

    bb_to_sep_matrix[1] /= pivot;

    bb_g_matrix[1] /= pivot;

    /*
    Resulting matrix:

         bb          sep       g
     1 2 3 4 5       1 2
    -----------     -----
    |1 M      |     |M  |     |M|       1
    |0 1 M M M|     |M  |     |M|       2
    |  x x x x|     |   |     |x| bb    3
    |  x x x x| ... |  f| ... |x|       4
    |  x x x x|     |  x|     |x|       5
    -----------     -----
    */

    /*
     *
     * Row 3
     *
     */

    pivot = bb_to_bb_matrix[7];

    // row-3 = row-3 - (row-2 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_bb_matrix[7] = 0;
#endif

    bb_to_bb_matrix[8] -= bb_to_bb_matrix[4] * pivot;
    bb_to_bb_matrix[9] -= bb_to_bb_matrix[5] * pivot;
    bb_to_bb_matrix[10] -= bb_to_bb_matrix[6] * pivot;

    bb_to_sep_fillins[0] = -bb_to_sep_matrix[1] * pivot;

    bb_g_matrix[2] -= bb_g_matrix[1] * pivot;

    /*
    Resulting matrix:

         bb          sep       g
     1 2 3 4 5       1 2
    -----------     -----
    |1 M      |     |M  |     |M|       1
    |0 1 M M M|     |M  |     |M|       2
    |  0 M M M|     |F  |     |M| bb    3
    |  x x x x| ... |  f| ... |x|       4
    |  x x x x|     |  x|     |x|       5
    -----------     -----
    */

    // row-3 = row-3 / pivot

    pivot = bb_to_bb_matrix[8];

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    bb_to_bb_matrix[8] = 1;
#endif

    bb_to_bb_matrix[9] /= pivot;
    bb_to_bb_matrix[10] /= pivot;

    bb_to_sep_fillins[0] /= pivot;

    bb_g_matrix[2] /= pivot;

    /*
    Resulting matrix:

         bb          sep       g
     1 2 3 4 5       1 2
    -----------     -----
    |1 M      |     |M  |     |M|       1
    |0 1 M M M|     |M  |     |M|       2
    |  0 1 M M|     |F  |     |M| bb    3
    |  x x x x| ... |  f| ... |x|       4
    |  x x x x|     |  x|     |x|       5
    -----------     -----
    */

    /*
     *
     * Row 4
     *
     */

    pivot = bb_to_bb_matrix[11];

    // row-4 = row-4 - (row-2 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_bb_matrix[11] = 0;
#endif

    bb_to_bb_matrix[12] -= bb_to_bb_matrix[4] * pivot;
    bb_to_bb_matrix[13] -= bb_to_bb_matrix[5] * pivot;
    bb_to_bb_matrix[14] -= bb_to_bb_matrix[6] * pivot;

    bb_to_sep_fillins[1] = -bb_to_sep_matrix[1] * pivot;

    bb_g_matrix[3] -= bb_g_matrix[1] * pivot;

    /*
    Resulting matrix:

         bb          sep       g
     1 2 3 4 5       1 2
    -----------     -----
    |1 M      |     |M  |     |M|       1
    |0 1 M M M|     |M  |     |M|       2
    |  0 1 M M|     |F  |     |M| bb    3
    |  0 M M M| ... |F f| ... |M|       4
    |  x x x x|     |  x|     |x|       5
    -----------     -----
    */

    pivot = bb_to_bb_matrix[12];

    // row-4 = row-4 - (row-3 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_bb_matrix[12] = 0;
#endif

    bb_to_bb_matrix[13] -= bb_to_bb_matrix[9] * pivot;
    bb_to_bb_matrix[14] -= bb_to_bb_matrix[10] * pivot;

    bb_to_sep_fillins[1] -= bb_to_sep_fillins[0] * pivot;

    bb_g_matrix[3] -= bb_g_matrix[2] * pivot;

    /*
    Resulting matrix:

         bb          sep       g
     1 2 3 4 5       1 2
    -----------     -----
    |1 M      |     |M  |     |M|       1
    |0 1 M M M|     |M  |     |M|       2
    |  0 1 M M|     |F  |     |M| bb    3
    |  0 0 M M| ... |F f| ... |M|       4
    |  x x x x|     |  x|     |x|       5
    -----------     -----
    */

    pivot = bb_to_bb_matrix[13];

    // row-4 = row-4 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    bb_to_bb_matrix[13] = 1;
#endif

    bb_to_bb_matrix[14] /= pivot;

    bb_to_sep_fillins[1] /= pivot;
    bb_to_sep_fillins[2] /= pivot;

    bb_g_matrix[3] /= pivot;

    /*
    Resulting matrix:

         bb          sep       g
     1 2 3 4 5       1 2
    -----------     -----
    |1 M      |     |M  |     |M|       1
    |0 1 M M M|     |M  |     |M|       2
    |  0 1 M M|     |F  |     |M| bb    3
    |  0 0 1 M| ... |F M| ... |M|       4
    |  x x x x|     |  x|     |x|       5
    -----------     -----
    */

    /*
     *
     * Row 5
     *
     */

    pivot = bb_to_bb_matrix[15];

    // row-5 = row-5 - (row-2 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_bb_matrix[15] = 0;
#endif

    bb_to_bb_matrix[16] -= bb_to_bb_matrix[4] * pivot;
    bb_to_bb_matrix[17] -= bb_to_bb_matrix[5] * pivot;
    bb_to_bb_matrix[18] -= bb_to_bb_matrix[6] * pivot;

    bb_to_sep_fillins[3] = -bb_to_sep_matrix[1] * pivot;

    bb_g_matrix[4] -= bb_g_matrix[1] * pivot;

    /*
    Resulting matrix:

         bb          sep       g
     1 2 3 4 5       1 2
    -----------     -----
    |1 M      |     |M  |     |M|       1
    |0 1 M M M|     |M  |     |M|       2
    |  0 1 M M|     |F  |     |M| bb    3
    |  0 0 1 M| ... |F M| ... |M|       4
    |  0 M M M|     |F x|     |M|       5
    -----------     -----
    */

    pivot = bb_to_bb_matrix[16];

    // row-5 = row-5 - (row-3 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_bb_matrix[16] = 0;
#endif

    bb_to_bb_matrix[17] -= bb_to_bb_matrix[9] * pivot;
    bb_to_bb_matrix[18] -= bb_to_bb_matrix[10] * pivot;

    bb_to_sep_fillins[3] -= bb_to_sep_fillins[0] * pivot;

    bb_g_matrix[4] -= bb_g_matrix[2] * pivot;

    /*
    Resulting matrix:

         bb          sep       g
     1 2 3 4 5       1 2
    -----------     -----
    |1 M      |     |M  |     |M|       1
    |0 1 M M M|     |M  |     |M|       2
    |  0 1 M M|     |F  |     |M| bb    3
    |  0 0 1 M| ... |F M| ... |M|       4
    |  0 0 M M|     |F x|     |M|       5
    -----------     -----
    */

    pivot = bb_to_bb_matrix[17];

    // row-5 = row-5 - (row-4 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_bb_matrix[17] = 0;
#endif

    bb_to_bb_matrix[18] -= bb_to_bb_matrix[14] * pivot;

    bb_to_sep_matrix[2] -= bb_to_sep_fillins[2] * pivot;

    bb_to_sep_fillins[3] -= bb_to_sep_fillins[1] * pivot;

    bb_g_matrix[4] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

         bb          sep       g
     1 2 3 4 5       1 2
    -----------     -----
    |1 M      |     |M  |     |M|       1
    |0 1 M M M|     |M  |     |M|       2
    |  0 1 M M|     |F  |     |M| bb    3
    |  0 0 1 M| ... |F M| ... |M|       4
    |  0 0 0 M|     |F M|     |M|       5
    -----------     -----
    */

    pivot = bb_to_bb_matrix[18];

    // row-4 = row-4 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    bb_to_bb_matrix[18] = 1;
#endif

    bb_to_sep_fillins[3] /= pivot;

    bb_to_sep_matrix[2] /= pivot;

    bb_g_matrix[4] /= pivot;

    /*
    Resulting matrix:

         bb          sep       g
     1 2 3 4 5       1 2
    -----------     -----
    |1 M      |     |M  |     |M|       1
    |0 1 M M M|     |M  |     |M|       2
    |  0 1 M M|     |F  |     |M| bb    3
    |  0 0 1 M| ... |F M| ... |M|       4
    |  0 0 0 1|     |F M|     |M|       5
    -----------     -----
    */
}

void gmx::IlvesPC::solve_4_general(real *const bb_to_bb_matrix,
                                   real *const bb_to_sep_matrix,
                                   real *const bb_g_matrix,
                                   real *const bb_to_sep_fillins) {
    /*
     *
     * Row 1
     *
     */

    real pivot = bb_to_bb_matrix[0];

    // row-1 = row-1 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    bb_to_bb_matrix[0] = 1;
#endif

    bb_to_bb_matrix[1] /= pivot;

    bb_to_sep_matrix[0] /= pivot;

    bb_g_matrix[0] /= pivot;

    /*
    Resulting matrix:

         bb            sep       g
     1 2 3 4 5 6       1 2
    -------------     -----
    |1 M        |     |M  |     |M|       1
    |x x x x x  |     |x  |     |x|       2
    |  x x x x  |     |   |     |x| bb    3
    |  x x x x  | ... |   | ... |x|       4
    |  x x x x x|     |  x|     |x|       5
    |        x x|     |  x|     |x|       6
    -------------     -----
    */

    /*
     *
     * Row 2
     *
     */

    pivot = bb_to_bb_matrix[2];

    // row-2 = row-2 - (row-1 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_bb_matrix[2] = 0;
#endif

    bb_to_bb_matrix[3] -= bb_to_bb_matrix[1] * pivot;

    bb_to_sep_matrix[1] -= bb_to_sep_matrix[0] * pivot;

    bb_g_matrix[1] -= bb_g_matrix[0] * pivot;

    /*
    Resulting matrix:

         bb            sep       g
     1 2 3 4 5 6       1 2
    -------------     -----
    |1 M        |     |M  |     |M|       1
    |0 M x x x  |     |M  |     |M|       2
    |  x x x x  |     |   |     |x| bb    3
    |  x x x x  | ... |   | ... |x|       4
    |  x x x x x|     |  x|     |x|       5
    |        x x|     |  x|     |x|       6
    -------------     -----
    */

    pivot = bb_to_bb_matrix[3];

    // row-2 = row-2 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    bb_to_bb_matrix[3] = 1;
#endif

    bb_to_bb_matrix[4] /= pivot;
    bb_to_bb_matrix[5] /= pivot;
    bb_to_bb_matrix[6] /= pivot;

    bb_to_sep_matrix[1] /= pivot;

    bb_g_matrix[1] /= pivot;

    /*
    Resulting matrix:

         bb            sep       g
     1 2 3 4 5 6       1 2
    -------------     -----
    |1 M        |     |M  |     |M|       1
    |0 1 M M M  |     |M  |     |M|       2
    |  x x x x  |     |   |     |x| bb    3
    |  x x x x  | ... |   | ... |x|       4
    |  x x x x x|     |  x|     |x|       5
    |        x x|     |  x|     |x|       6
    -------------     -----
    */

    /*
     *
     * Row 3
     *
     */

    pivot = bb_to_bb_matrix[7];

    // row-3 = row-3 - (row-2 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_bb_matrix[7] = 0;
#endif

    bb_to_bb_matrix[8] -= bb_to_bb_matrix[4] * pivot;
    bb_to_bb_matrix[9] -= bb_to_bb_matrix[5] * pivot;
    bb_to_bb_matrix[10] -= bb_to_bb_matrix[6] * pivot;

    bb_to_sep_fillins[0] = -bb_to_sep_matrix[1] * pivot;

    bb_g_matrix[2] -= bb_g_matrix[1] * pivot;

    /*
    Resulting matrix:

         bb            sep       g
     1 2 3 4 5 6       1 2
    -------------     -----
    |1 M        |     |M  |     |M|       1
    |0 1 M M M  |     |M  |     |M|       2
    |  0 M M M  |     |F  |     |M| bb    3
    |  x x x x  | ... |   | ... |x|       4
    |  x x x x x|     |  x|     |x|       5
    |        x x|     |  x|     |x|       6
    -------------     -----
    */

    // row-3 = row-3 / pivot

    pivot = bb_to_bb_matrix[8];

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    bb_to_bb_matrix[8] = 1;
#endif

    bb_to_bb_matrix[9] /= pivot;
    bb_to_bb_matrix[10] /= pivot;

    bb_to_sep_fillins[0] /= pivot;

    bb_g_matrix[2] /= pivot;

    /*
    Resulting matrix:

         bb            sep       g
     1 2 3 4 5 6       1 2
    -------------     -----
    |1 M        |     |M  |     |M|       1
    |0 1 M M M  |     |M  |     |M|       2
    |  0 1 M M  |     |F  |     |M| bb    3
    |  x x x x  | ... |   | ... |x|       4
    |  x x x x x|     |  x|     |x|       5
    |        x x|     |  x|     |x|       6
    -------------     -----
    */

    /*
     *
     * Row 4
     *
     */

    pivot = bb_to_bb_matrix[11];

    // row-4 = row-4 - (row-2 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_bb_matrix[11] = 0;
#endif

    bb_to_bb_matrix[12] -= bb_to_bb_matrix[4] * pivot;
    bb_to_bb_matrix[13] -= bb_to_bb_matrix[5] * pivot;
    bb_to_bb_matrix[14] -= bb_to_bb_matrix[6] * pivot;

    bb_to_sep_fillins[1] = -bb_to_sep_matrix[1] * pivot;

    bb_g_matrix[3] -= bb_g_matrix[1] * pivot;

    /*
    Resulting matrix:

         bb            sep       g
     1 2 3 4 5 6       1 2
    -------------     -----
    |1 M        |     |M  |     |M|       1
    |0 1 M M M  |     |M  |     |M|       2
    |  0 1 M M  |     |F  |     |M| bb    3
    |  0 M M M  | ... |F  | ... |M|       4
    |  x x x x x|     |  x|     |x|       5
    |        x x|     |  x|     |x|       6
    -------------     -----
    */

    pivot = bb_to_bb_matrix[12];

    // row-4 = row-4 - (row-3 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_bb_matrix[12] = 0;
#endif

    bb_to_bb_matrix[13] -= bb_to_bb_matrix[9] * pivot;
    bb_to_bb_matrix[14] -= bb_to_bb_matrix[10] * pivot;

    bb_to_sep_fillins[1] -= bb_to_sep_fillins[0] * pivot;

    bb_g_matrix[3] -= bb_g_matrix[2] * pivot;

    /*
    Resulting matrix:

         bb            sep       g
     1 2 3 4 5 6       1 2
    -------------     -----
    |1 M        |     |M  |     |M|       1
    |0 1 M M M  |     |M  |     |M|       2
    |  0 1 M M  |     |F  |     |M| bb    3
    |  0 0 M M  | ... |F  | ... |M|       4
    |  x x x x x|     |  x|     |x|       5
    |        x x|     |  x|     |x|       6
    -------------     -----
    */

    pivot = bb_to_bb_matrix[13];

    // row-4 = row-4 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    bb_to_bb_matrix[13] = 1;
#endif

    bb_to_bb_matrix[14] /= pivot;

    bb_to_sep_fillins[1] /= pivot;

    bb_g_matrix[3] /= pivot;

    /*
    Resulting matrix:

         bb            sep       g
     1 2 3 4 5 6       1 2
    -------------     -----
    |1 M        |     |M  |     |M|       1
    |0 1 M M M  |     |M  |     |M|       2
    |  0 1 M M  |     |F  |     |M| bb    3
    |  0 0 1 M  | ... |F  | ... |M|       4
    |  x x x x x|     |  x|     |x|       5
    |        x x|     |  x|     |x|       6
    -------------     -----
    */

    /*
     *
     * Row 5
     *
     */

    pivot = bb_to_bb_matrix[15];

    // row-5 = row-5 - (row-2 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_bb_matrix[15] = 0;
#endif

    bb_to_bb_matrix[16] -= bb_to_bb_matrix[4] * pivot;
    bb_to_bb_matrix[17] -= bb_to_bb_matrix[5] * pivot;
    bb_to_bb_matrix[18] -= bb_to_bb_matrix[6] * pivot;

    bb_to_sep_fillins[2] = -bb_to_sep_matrix[1] * pivot;

    bb_g_matrix[4] -= bb_g_matrix[1] * pivot;

    /*
    Resulting matrix:

         bb            sep       g
     1 2 3 4 5 6       1 2
    -------------     -----
    |1 M        |     |M  |     |M|       1
    |0 1 M M M  |     |M  |     |M|       2
    |  0 1 M M  |     |F  |     |M| bb    3
    |  0 0 1 M  | ... |F  | ... |M|       4
    |  0 M M M x|     |F x|     |M|       5
    |        x x|     |  x|     |x|       6
    -------------     -----
    */

    pivot = bb_to_bb_matrix[16];

    // row-5 = row-5 - (row-3 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_bb_matrix[16] = 0;
#endif

    bb_to_bb_matrix[17] -= bb_to_bb_matrix[9] * pivot;
    bb_to_bb_matrix[18] -= bb_to_bb_matrix[10] * pivot;

    bb_to_sep_fillins[2] -= bb_to_sep_fillins[0] * pivot;

    bb_g_matrix[4] -= bb_g_matrix[2] * pivot;

    /*
    Resulting matrix:

         bb            sep       g
     1 2 3 4 5 6       1 2
    -------------     -----
    |1 M        |     |M  |     |M|       1
    |0 1 M M M  |     |M  |     |M|       2
    |  0 1 M M  |     |F  |     |M| bb    3
    |  0 0 1 M  | ... |F  | ... |M|       4
    |  0 0 M M x|     |F x|     |M|       5
    |        x x|     |  x|     |x|       6
    -------------     -----
    */

    pivot = bb_to_bb_matrix[17];

    // row-5 = row-5 - (row-4 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_bb_matrix[17] = 0;
#endif

    bb_to_bb_matrix[18] -= bb_to_bb_matrix[14] * pivot;

    bb_to_sep_fillins[2] -= bb_to_sep_fillins[1] * pivot;

    bb_g_matrix[4] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

         bb            sep       g
     1 2 3 4 5 6       1 2
    -------------     -----
    |1 M        |     |M  |     |M|       1
    |0 1 M M M  |     |M  |     |M|       2
    |  0 1 M M  |     |F  |     |M| bb    3
    |  0 0 1 M  | ... |F  | ... |M|       4
    |  0 0 0 M x|     |F x|     |M|       5
    |        x x|     |  x|     |x|       6
    -------------     -----
    */

    pivot = bb_to_bb_matrix[18];

    // row-4 = row-4 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    bb_to_bb_matrix[18] = 1;
#endif

    bb_to_bb_matrix[19] /= pivot;

    bb_to_sep_fillins[2] /= pivot;

    bb_to_sep_matrix[2] /= pivot;

    bb_g_matrix[4] /= pivot;

    /*
    Resulting matrix:

         bb            sep       g
     1 2 3 4 5 6       1 2
    -------------     -----
    |1 M        |     |M  |     |M|       1
    |0 1 M M M  |     |M  |     |M|       2
    |  0 1 M M  |     |F  |     |M| bb    3
    |  0 0 1 M  | ... |F  | ... |M|       4
    |  0 0 0 1 M|     |F M|     |M|       5
    |        x x|     |  x|     |x|       6
    -------------     -----
    */

    /*
     *
     * Row 6
     *
     */

    pivot = bb_to_bb_matrix[20];

    // row-6 = row-6 - (row-5 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_bb_matrix[20] = 0;
#endif

    bb_to_bb_matrix[21] -= bb_to_bb_matrix[19] * pivot;

    bb_to_sep_fillins[3] = -bb_to_sep_fillins[2] * pivot;

    bb_to_sep_matrix[3] -= bb_to_sep_matrix[2] * pivot;

    bb_g_matrix[5] -= bb_g_matrix[4] * pivot;

    /*
    Resulting matrix:

         bb            sep       g
     1 2 3 4 5 6       1 2
    -------------     -----
    |1 M        |     |M  |     |M|       1
    |0 1 M M M  |     |M  |     |M|       2
    |  0 1 M M  |     |F  |     |M| bb    3
    |  0 0 1 M  | ... |F  | ... |M|       4
    |  0 0 0 1 M|     |F M|     |M|       5
    |        0 M|     |F M|     |M|       6
    -------------     -----
    */

    pivot = bb_to_bb_matrix[21];

    // row-6 = row-6 / pivot

#if DEBUG
    // This write can be avoided, this entry will always be 1 after this.
    bb_to_bb_matrix[21] = 1;
#endif

    bb_to_sep_fillins[3] /= pivot;

    bb_to_sep_matrix[3] /= pivot;

    bb_g_matrix[5] /= pivot;

    /*
    Resulting matrix:

         bb            sep       g
     1 2 3 4 5 6       1 2
    -------------     -----
    |1 M        |     |M  |     |M|       1
    |0 1 M M M  |     |M  |     |M|       2
    |  0 1 M M  |     |F  |     |M| bb    3
    |  0 0 1 M  | ... |F  | ... |M|       4
    |  0 0 0 1 M|     |F M|     |M|       5
    |        0 1|     |F M|     |M|       6
    -------------     -----
    */
}

void gmx::IlvesPC::solve_4(const int thread) {
    // Pointers to private data.
    private_data_t *pd = &private_data[thread];

    real *bb_to_bb_matrix = pd->bb_to_bb_matrix.data;
    real *bb_to_sep_matrix = pd->bb_to_sep_matrix.data;

    real *bb_to_sep_fillins = pd->bb_to_sep_fillins.data;

    real *bb_g_matrix = pd->bb_g_matrix.data;

    // Loop through the side-chains assigned to thread.
    for (int i = 0; i < pd->num_side_chains; i++) {
        side_chain_type_t type = mol->side_chain_types[pd->first_side_chain + i];

        if (type == PROLINE) {
            solve_4_proline(bb_to_bb_matrix,
                            bb_to_sep_matrix,
                            bb_g_matrix,
                            bb_to_sep_fillins);

            // Update pointers.
            bb_to_bb_matrix += BB_TO_BB_PROLINE_MATRIX_SIZE;
            bb_to_sep_matrix += BB_TO_SEP_PROLINE_MATRIX_SIZE;

            bb_g_matrix += BB_G_PROLINE_MATRIX_SIZE;
        }
        else {
            solve_4_general(bb_to_bb_matrix,
                            bb_to_sep_matrix,
                            bb_g_matrix,
                            bb_to_sep_fillins);

            // Update pointers.
            bb_to_bb_matrix += BB_TO_BB_MATRIX_SIZE;
            bb_to_sep_matrix += BB_TO_SEP_MATRIX_SIZE;

            bb_g_matrix += BB_G_MATRIX_SIZE;
        }

        // Same for proline and general.
        bb_to_sep_fillins += BB_TO_SEP_FILLINS_SIZE;
    }
}

void gmx::IlvesPC::solve_5(const int thread) {
    // Pointers to private data.
    private_data_t *pd = &private_data[thread];

    real *sc_to_bb_matrix = pd->sc_to_bb_matrix.data;
    real *sc_to_sep_matrix = pd->sc_to_sep_matrix.data;

    real *sc_g_matrix = pd->sc_g_matrix.data;

    real *sc_to_bb_fillins = pd->sc_to_bb_fillins.data;

    real *sep_to_sc_matrix = pd->sep_to_sc_matrix.data;
    real *sep_to_bb_matrix = pd->sep_to_bb_matrix.data;
    real *sep_to_sep_matrix = pd->sep_to_sep_matrix.data;

    real *sep_g_matrix = pd->sep_g_matrix.data;

    real *sep_to_bb_fillins = pd->sep_to_bb_fillins.data;

    for (int i = 0; i < pd->num_side_chains; ++i) {
        side_chain_type_t type = mol->side_chain_types[pd->first_side_chain + i];

        if (type == PROLINE) {
            // Shared row.
            char shared_row = (i == pd->num_side_chains - 1 &&
                               thread < nthreads - 1);
            if (shared_row) {
                if (nthreads > 1) {
                    // Pointer to shared data.
                    shared_data_t *sd = &shared_data[thread];

                    sep_to_sc_matrix = sd->sep_to_sc_matrix.data;
                    sep_to_bb_matrix = &sd->sep_to_bb_matrix.data[1];   // To
                                                                        // avoid
                                                                        // different
                                                                        // indexing.
                    sep_to_sep_matrix = sd->sep_to_sep_matrix.data;

                    sep_g_matrix = sd->sep_g_matrix.data;

                    sep_to_bb_fillins = sd->sep_to_bb_fillins.data;

                    // Acquire mutex.
                    pthread_mutex_lock(&sd->lock);
                }
            }

            real pivot = sep_to_sc_matrix[0];

            // sep-row-1 = sep-row-1 - sc-row-9 * pivot.

#if DEBUG
            // This write can be avoided, this entry will always be 0 after
            // this.
            sep_to_sc_matrix[0] = 0;
#endif
            sep_to_bb_matrix[0] -= sc_to_bb_matrix[3] * pivot;

            sep_to_sep_matrix[0] -= sc_to_sep_matrix[0] * pivot;

            sep_to_bb_fillins[0] = -sc_to_bb_fillins[1] * pivot;

            sep_g_matrix[0] -= sc_g_matrix[8] * pivot;

            if (shared_row) {
                if (nthreads > 1) {
                    // Release mutex if shared row.
                    pthread_mutex_unlock(&shared_data[thread].lock);
                }
            }

            /*
            Resulting matrix:

                    sc                  bb            sep        g
             1 2 3 4 5 6 7 8 9       1 2 3 4 5
            -------------------     -----------     -------
            |1 x         x    |     |      x  |     |     |     |x|  1
            |0 1         x    |     |      x  |     |     |     |x|  2
            |    1 x     x x  |     |         |     |     |     |x|  3
            |    0 1     x x  |     |         |     |     |     |x|  4
            |        1 x   x x| ... |         | ... |     | ... |x|  5 sc
            |        0 1   x x|     |         |     |     |     |x|  6
            |0 0 0 0     1 x  |     |      x  |     |     |     |x|  7
            |    0 0 0 0 0 1 x|     |      f  |     |     |     |x|  8
            |        0 0   0 1|     |      f x|     |  x  |     |x|  9
            -------------------     -----------     -------
                    .
                    .
                    .
            -------------------     -----------     -------
            |                0| ... |      F M| ... |? M ?| ... |M|  1  sep
            -------------------     -----------     -------
            */

            // Update pointers.
            sc_to_sep_matrix += SC_TO_SEP_PROLINE_MATRIX_SIZE;

            sc_to_bb_fillins += SC_TO_BB_PROLINE_FILLINS_SIZE;

            sep_to_sc_matrix += SEP_TO_SC_PROLINE_MATRIX_SIZE;
            sep_to_bb_matrix += SEP_TO_BB_PROLINE_MATRIX_SIZE;

            sep_to_bb_fillins += SEP_TO_BB_PROLINE_FILLINS_SIZE;
        }
        else {   // Not proline
            // Update pointers.
            sep_to_bb_matrix += SEP_TO_BB_MATRIX_SIZE;

            sep_to_bb_fillins += SEP_TO_BB_FILLINS_SIZE;
        }

        // Proline and general pointer updates.

        sc_to_bb_matrix += sc_to_bb_matrix_sizes[type];

        sc_g_matrix += sc_g_matrix_sizes[type];

        sep_to_sep_matrix += SEP_TO_SEP_MATRIX_SIZE;

        sep_g_matrix += SEP_G_MATRIX_SIZE;
    }
}

void gmx::IlvesPC::solve_6_proline_current_row(real *const bb_to_bb_matrix,
                                               real *const bb_to_sep_matrix,
                                               real *const bb_g_matrix,
                                               real *const bb_to_sep_fillins,
                                               real *const sep_to_bb_matrix,
                                               real *const sep_to_sep_matrix,
                                               real *const sep_g_matrix,
                                               real *const sep_to_bb_fillins,
                                               real *const sep_to_sep_fillins) {
    real pivot = sep_to_bb_fillins[0];

    // separation-row = separation-row - bb-to-bb-row-4

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sep_to_bb_fillins[0] = 0;
#endif

    sep_to_bb_matrix[0] -= bb_to_bb_matrix[14] * pivot;

    sep_to_sep_matrix[0] -= bb_to_sep_fillins[2] * pivot;

    sep_to_sep_fillins[0] = -bb_to_sep_fillins[1] * pivot;

    sep_g_matrix[0] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

         bb           sep        g
     1 2 3 4 5       1 2 3
    -----------     -------
    |1 x      |     |x    |     |x|       1
    |0 1 x x x|     |x    |     |x|       2
    |  0 1 x x|     |f    |     |x| bb    3
    |  0 0 1 x| ... |f f  | ... |x|       4
    |  0 0 0 1|     |f x  |     |x|       5
    -----------     -------
         .             .
         .             .
         .             .
    -----------     -------
    |      0 M|     |F M ?|     |M| sep   1 ? Can be 0 or fillin.
    -----------     -------
    */

    pivot = sep_to_bb_matrix[0];

    // separation-row = separation-row - bb-to-bb-row-5

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sep_to_bb_matrix[0] = 0;
#endif

    sep_to_sep_matrix[0] -= bb_to_sep_matrix[2] * pivot;

    sep_to_sep_fillins[0] -= bb_to_sep_fillins[3] * pivot;

    sep_g_matrix[0] -= bb_g_matrix[4] * pivot;

    /*
    Resulting matrix:

         bb           sep        g
     1 2 3 4 5       1 2 3
    -----------     -------
    |1 x      |     |x    |     |x|       1
    |0 1 x x x|     |x    |     |x|       2
    |  0 1 x x|     |f    |     |x| bb    3
    |  0 0 1 x| ... |f f  | ... |x|       4
    |  0 0 0 1|     |f x  |     |x|       5
    -----------     -------
        .              .
        .              .
        .              .
    -----------     -------
    |      0 0|     |F M ?|     |M| sep   1 ? Can be 0 or fillin.
    -----------     -------
    */
}

void gmx::IlvesPC::solve_6_general_current_row(real *const bb_to_bb_matrix,
                                               real *const bb_to_sep_matrix,
                                               real *const bb_g_matrix,
                                               real *const bb_to_sep_fillins,
                                               real *const sep_to_bb_matrix,
                                               real *const sep_to_sep_matrix,
                                               real *const sep_g_matrix,
                                               real *const sep_to_sep_fillins) {
    real pivot = sep_to_bb_matrix[0];

    // separation-row = separation-row - bb-to-bb-row-5

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sep_to_bb_matrix[0] = 0;
#endif

    sep_to_bb_matrix[1] -= bb_to_bb_matrix[19] * pivot;

    sep_to_sep_matrix[0] -= bb_to_sep_matrix[2] * pivot;

    sep_to_sep_fillins[0] = -bb_to_sep_fillins[2] * pivot;

    sep_g_matrix[0] -= bb_g_matrix[4] * pivot;

    /*
    Resulting matrix:

         bb             sep        g
     1 2 3 4 5 6       1 2 3
    -------------     -------
    |1 x        |     |x    |     |x|       1
    |0 1 x x x  |     |x    |     |x|       2
    |  0 1 x x  |     |f    |     |x| bb    3
    |  0 0 1 x  | ... |f    | ... |x|       4
    |  0 0 0 1 x|     |f x  |     |x|       5
    |        0 1|     |f x  |     |x|       6
    -------------     -------
          .              .
          .              .
          .              .
    -------------     -------
    |        0 M|     |F M ?|     |M| sep   1 ? Can be 0 or fillin.
    -------------     -------
    */

    pivot = sep_to_bb_matrix[1];

    // separation-row = separation-row - bb-to-bb-row-6

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sep_to_bb_matrix[1] = 0;
#endif

    sep_to_sep_matrix[0] -= bb_to_sep_matrix[3] * pivot;

    sep_to_sep_fillins[0] -= bb_to_sep_fillins[3] * pivot;

    sep_g_matrix[0] -= bb_g_matrix[5] * pivot;

    /*
    Resulting matrix:

         bb             sep        g
     1 2 3 4 5 6       1 2 3
    -------------     -------
    |1 x        |     |x    |     |x|       1
    |0 1 x x x  |     |x    |     |x|       2
    |  0 1 x x  |     |f    |     |x| bb    3
    |  0 0 1 x  | ... |f    | ... |x|       4
    |  0 0 0 1 x|     |f x  |     |x|       5
    |        0 1|     |f x  |     |x|       6
    -------------     -------
          .              .
          .              .
          .              .
    -------------     -------
    |        0 0|     |F M ?|     |M| sep   1 ? Can be 0 or fillin.
    -------------     -------
    */
}

void gmx::IlvesPC::solve_6_previous_row_proline(real *const bb_to_bb_matrix,
                                                real *const bb_to_sep_matrix,
                                                real *const bb_g_matrix,
                                                real *const bb_to_sep_fillins,
                                                real *const sep_to_bb_matrix,
                                                real *const sep_to_sep_matrix,
                                                real *const sep_g_matrix,
                                                real *const sep_to_bb_fillins,
                                                real *const sep_to_sep_fillins) {
    real pivot = sep_to_bb_matrix[2];

    // separation-row = separation-row - bb-to-bb-row-1

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sep_to_bb_matrix[2] = 0;
#endif

    sep_to_bb_matrix[3] -= bb_to_bb_matrix[1] * pivot;

    sep_to_sep_matrix[0] -= bb_to_sep_matrix[0] * pivot;

    sep_g_matrix[0] -= bb_g_matrix[0] * pivot;

    /*
    Resulting matrix:

         bb           sep        g
     1 2 3 4 5       1 2 3
    -----------     -------
    |1 x      |     |  x  |     |x|       1
    |0 1 x x x|     |  x  |     |x|       2
    |  0 1 x x|     |  f  |     |x| bb    3
    |  0 0 1 x| ... |  f f| ... |x|       4
    |  0 0 0 1|     |  f x|     |x|       5
    -----------     -------
          .            .
          .            .
          .            .
    -----------     -------
    |0 M      |     |? M  |     |M| sep   1
    -----------     -------
    */

    pivot = sep_to_bb_matrix[3];

    // separation-row = separation-row - bb-to-bb-row-2

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sep_to_bb_matrix[3] = 0;
#endif

    sep_to_bb_fillins[0] = -bb_to_bb_matrix[4] * pivot;
    sep_to_bb_fillins[1] = -bb_to_bb_matrix[5] * pivot;
    sep_to_bb_fillins[2] = -bb_to_bb_matrix[6] * pivot;

    sep_to_sep_matrix[0] -= bb_to_sep_matrix[1] * pivot;

    sep_g_matrix[0] -= bb_g_matrix[1] * pivot;

    /*
    Resulting matrix:

         bb           sep        g
     1 2 3 4 5       1 2 3
    -----------     -------
    |1 x      |     |  x  |     |x|       1
    |0 1 x x x|     |  x  |     |x|       2
    |  0 1 x x|     |  f  |     |x| bb    3
    |  0 0 1 x| ... |  f f| ... |x|       4
    |  0 0 0 1|     |  f x|     |x|       5
    -----------     -------
          .            .
          .            .
          .            .
    -----------     -------
    |0 0 F F F|     |? M  |     |M| sep   1
    -----------     -------
    */

    pivot = sep_to_bb_fillins[0];

    // separation-row = separation-row - bb-to-bb-row-3

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sep_to_bb_fillins[0] = 0;
#endif

    sep_to_bb_fillins[1] -= bb_to_bb_matrix[9] * pivot;
    sep_to_bb_fillins[2] -= bb_to_bb_matrix[10] * pivot;

    sep_to_sep_matrix[0] -= bb_to_sep_fillins[0] * pivot;

    sep_g_matrix[0] -= bb_g_matrix[2] * pivot;

    /*
    Resulting matrix:

         bb           sep        g
     1 2 3 4 5       1 2 3
    -----------     -------
    |1 x      |     |  x  |     |x|       1
    |0 1 x x x|     |  x  |     |x|       2
    |  0 1 x x|     |  f  |     |x| bb    3
    |  0 0 1 x| ... |  f f| ... |x|       4
    |  0 0 0 1|     |  f x|     |x|       5
    -----------     -------
          .            .
          .            .
          .            .
    -----------     -------
    |0 0 0 F F|     |? M  |     |M| sep   1
    -----------     -------
    */

    pivot = sep_to_bb_fillins[1];

    // separation-row = separation-row - bb-to-bb-row-4

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sep_to_bb_fillins[1] = 0;
#endif

    sep_to_bb_fillins[2] -= bb_to_bb_matrix[14] * pivot;

    sep_to_sep_matrix[0] -= bb_to_sep_fillins[1] * pivot;

    sep_to_sep_fillins[1] = -bb_to_sep_fillins[2] * pivot;

    sep_g_matrix[0] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

         bb          sep         g
     1 2 3 4 5       1 2 3
    -----------     -------
    |1 x      |     |  x  |     |x|       1
    |0 1 x x x|     |  x  |     |x|       2
    |  0 1 x x|     |  f  |     |x| bb    3
    |  0 0 1 x| ... |  f f| ... |x|       4
    |  0 0 0 1|     |  f x|     |x|       5
    -----------     -------
          .            .
          .            .
          .            .
    -----------     -------
    |0 0 0 0 F|     |? M F|     |M| sep   1
    -----------     -------
    */

    pivot = sep_to_bb_fillins[2];

    // separation-row = separation-row - bb-to-bb-row-5

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sep_to_bb_fillins[2] = 0;
#endif

    sep_to_sep_matrix[0] -= bb_to_sep_fillins[3] * pivot;

    sep_to_sep_fillins[1] -= bb_to_sep_matrix[2] * pivot;

    sep_g_matrix[0] -= bb_g_matrix[4] * pivot;

    /*
    Resulting matrix:

         bb           sep        g
     1 2 3 4 5       1 2 3
    -----------     -------
    |1 x      |     |  x  |     |x|       1
    |0 1 x x x|     |  x  |     |x|       2
    |  0 1 x x|     |  f  |     |x| bb    3
    |  0 0 1 x| ... |  f  | ... |x|       4
    |  0 0 0 1|     |  f x|     |x|       5
    -----------     -------
          .            .
          .            .
          .            .
    -----------     -------
    |0 0 0 0 0|     |? M F|     |M| sep   1
    -----------     -------
    */
}

void gmx::IlvesPC::solve_6_previous_row_general(real *const bb_to_bb_matrix,
                                                real *const bb_to_sep_matrix,
                                                real *const bb_g_matrix,
                                                real *const bb_to_sep_fillins,
                                                real *const sep_to_bb_matrix,
                                                real *const sep_to_sep_matrix,
                                                real *const sep_g_matrix,
                                                real *const sep_to_bb_fillins,
                                                real *const sep_to_sep_fillins) {
    real pivot = sep_to_bb_matrix[2];

    // separation-row = separation-row - bb-to-bb-row-1

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sep_to_bb_matrix[2] = 0;
#endif

    sep_to_bb_matrix[3] -= bb_to_bb_matrix[1] * pivot;

    sep_to_sep_matrix[0] -= bb_to_sep_matrix[0] * pivot;

    sep_g_matrix[0] -= bb_g_matrix[0] * pivot;

    /*
    Resulting matrix:

         bb             sep        g
     1 2 3 4 5 6       1 2 3
    -------------     -------
    |1 x        |     |  x  |     |x|       1
    |0 1 x x x  |     |  x  |     |x|       2
    |  0 1 x x  |     |  f  |     |x| bb    3
    |  0 0 1 x  | ... |  f  | ... |x|       4
    |  0 0 0 1 x|     |  f x|     |x|       5
    |        0 1|     |  f x|     |x|       6
    -------------     -------
          .              .
          .              .
          .              .
    -------------     -------
    |0 M        |     |? M  |     |M| sep   1
    -------------     -------
    */

    pivot = sep_to_bb_matrix[3];

    // separation-row = separation-row - bb-to-bb-row-2

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sep_to_bb_matrix[3] = 0;
#endif

    sep_to_bb_fillins[0] = -bb_to_bb_matrix[4] * pivot;
    sep_to_bb_fillins[1] = -bb_to_bb_matrix[5] * pivot;
    sep_to_bb_fillins[2] = -bb_to_bb_matrix[6] * pivot;

    sep_to_sep_matrix[0] -= bb_to_sep_matrix[1] * pivot;

    sep_g_matrix[0] -= bb_g_matrix[1] * pivot;

    /*
    Resulting matrix:

         bb             sep        g
     1 2 3 4 5 6       1 2 3
    -------------     -------
    |1 x        |     |  x  |     |x|       1
    |0 1 x x x  |     |  x  |     |x|       2
    |  0 1 x x  |     |  f  |     |x| bb    3
    |  0 0 1 x  | ... |  f  | ... |x|       4
    |  0 0 0 1 x|     |  f x|     |x|       5
    |        0 1|     |  f x|     |x|       6
    -------------     -------
          .              .
          .              .
          .              .
    -------------     -------
    |0 0 F F F  |     |? M  |     |M| sep   1
    -------------     -------
    */

    pivot = sep_to_bb_fillins[0];

    // separation-row = separation-row - bb-to-bb-row-3

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sep_to_bb_fillins[0] = 0;
#endif

    sep_to_bb_fillins[1] -= bb_to_bb_matrix[9] * pivot;
    sep_to_bb_fillins[2] -= bb_to_bb_matrix[10] * pivot;

    sep_to_sep_matrix[0] -= bb_to_sep_fillins[0] * pivot;

    sep_g_matrix[0] -= bb_g_matrix[2] * pivot;

    /*
    Resulting matrix:

         bb             sep        g
     1 2 3 4 5 6       1 2 3
    -------------     -------
    |1 x        |     |  x  |     |x|       1
    |0 1 x x x  |     |  x  |     |x|       2
    |  0 1 x x  |     |  f  |     |x| bb    3
    |  0 0 1 x  | ... |  f  | ... |x|       4
    |  0 0 0 1 x|     |  f x|     |x|       5
    |        0 1|     |  f x|     |x|       6
    -------------     -------
          .              .
          .              .
          .              .
    -------------     -------
    |0 0 0 F F  |     |? M  |     |M| sep   1
    -------------     -------
    */

    pivot = sep_to_bb_fillins[1];

    // separation-row = separation-row - bb-to-bb-row-4

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sep_to_bb_fillins[1] = 0;
#endif

    sep_to_bb_fillins[2] -= bb_to_bb_matrix[14] * pivot;

    sep_to_sep_matrix[0] -= bb_to_sep_fillins[1] * pivot;

    sep_g_matrix[0] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

         bb            sep         g
     1 2 3 4 5 6       1 2 3
    -------------     -------
    |1 x        |     |  x  |     |x|       1
    |0 1 x x x  |     |  x  |     |x|       2
    |  0 1 x x  |     |  f  |     |x| bb    3
    |  0 0 1 x  | ... |  f  | ... |x|       4
    |  0 0 0 1 x|     |  f x|     |x|       5
    |        0 1|     |  f x|     |x|       6
    -------------     -------
          .              .
          .              .
          .              .
    -------------     -------
    |0 0 0 0 F  |     |? M  |     |M| sep   1
    -------------     -------
    */

    pivot = sep_to_bb_fillins[2];

    // separation-row = separation-row - bb-to-bb-row-5

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sep_to_bb_fillins[2] = 0;
#endif

    sep_to_bb_fillins[3] = -bb_to_bb_matrix[19] * pivot;

    sep_to_sep_matrix[0] -= bb_to_sep_fillins[2] * pivot;

    sep_to_sep_fillins[1] = -bb_to_sep_matrix[2] * pivot;

    sep_g_matrix[0] -= bb_g_matrix[4] * pivot;

    /*
    Resulting matrix:

         bb             sep        g
     1 2 3 4 5 6       1 2 3
    -------------     -------
    |1 x        |     |  x  |     |x|       1
    |0 1 x x x  |     |  x  |     |x|       2
    |  0 1 x x  |     |  f  |     |x| bb    3
    |  0 0 1 x  | ... |  f  | ... |x|       4
    |  0 0 0 1 x|     |  f x|     |x|       5
    |        0 1|     |  f x|     |x|       6
    -------------     -------
          .              .
          .              .
          .              .
    -------------     -------
    |0 0 0 0 0 F|     |? M F|     |M| sep   1
    -------------     -------
    */

    pivot = sep_to_bb_fillins[3];

    // separation-row = separation-row - bb-to-bb-row-6

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sep_to_bb_fillins[3] = 0;
#endif

    sep_to_sep_matrix[0] -= bb_to_sep_fillins[3] * pivot;

    sep_to_sep_fillins[1] -= bb_to_sep_matrix[3] * pivot;

    sep_g_matrix[0] -= bb_g_matrix[5] * pivot;

    /*
    Resulting matrix:

         bb            sep         g
     1 2 3 4 5 6       1 2 3
    -------------     -------
    |1 x        |     |  x  |     |x|       1
    |0 1 x x x  |     |  x  |     |x|       2
    |  0 1 x x  |     |  f  |     |x| bb    3
    |  0 0 1 x  | ... |  f  | ... |x|       4
    |  0 0 0 1 x|     |  f x|     |x|       5
    |        0 1|     |  f x|     |x|       6
    -------------     -------
          .              .
          .              .
          .              .
    -------------     -------
    |0 0 0 0 0 0|     |? M F|     |M| sep   1
    -------------     -------
    */
}

void gmx::IlvesPC::solve_6(const int thread) {
    // Pointers to private data.
    private_data_t *pd = &private_data[thread];

    real *bb_to_bb_matrix = pd->bb_to_bb_matrix.data;
    real *bb_to_sep_matrix = pd->bb_to_sep_matrix.data;

    real *bb_g_matrix = pd->bb_g_matrix.data;

    real *bb_to_sep_fillins = pd->bb_to_sep_fillins.data;

    real *sep_to_bb_matrix = pd->sep_to_bb_matrix.data;
    real *sep_to_sep_matrix = pd->sep_to_sep_matrix.data;

    real *sep_g_matrix = pd->sep_g_matrix.data;

    real *sep_to_bb_fillins = pd->sep_to_bb_fillins.data;
    real *sep_to_sep_fillins = pd->sep_to_sep_fillins.data;

    // Initialized to get rid of a warning.
    real *prev_sep_to_bb_matrix = NULL;
    real *prev_sep_to_sep_matrix = NULL;

    real *prev_sep_g_matrix = NULL;

    real *prev_sep_to_bb_fillins = NULL;
    real *prev_sep_to_sep_fillins = NULL;

    side_chain_type_t prev_type;

    if (thread > 0) {   // Thread 0 has no previous row.
        prev_type = mol->side_chain_types[pd->first_side_chain - 1];
    }

    // Loop through each SEP row.
    for (int i = 0; i < pd->num_side_chains; ++i) {
        side_chain_type_t type = mol->side_chain_types[pd->first_side_chain + i];

        // In order to avoid having different functions for different cases:
        // shared-row/private-row, different combinations of
        // proline-separation-row and non-proline-separation-row, etc., there
        // are only two functions for cleaning the previous row and two others
        // for cleaning the current row. Calling this functions with the right
        // pointer for each submatrix allows to cover every possible case.

        // Shared previous row.
        if (i == 0) {
            if (nthreads > 1) {
                if (thread > 0) {   // First thread has no previous row.
                    shared_data_t *sd = &shared_data[thread - 1];

                    pthread_mutex_lock(&sd->lock);

                    if (type == PROLINE) {
                        solve_6_previous_row_proline(bb_to_bb_matrix,
                                                     bb_to_sep_matrix,
                                                     bb_g_matrix,
                                                     bb_to_sep_fillins,
                                                     sd->sep_to_bb_matrix.data,
                                                     sd->sep_to_sep_matrix.data,
                                                     sd->sep_g_matrix.data,
                                                     &sd->sep_to_bb_fillins.data[1],
                                                     sd->sep_to_sep_fillins.data);
                    }
                    else {
                        solve_6_previous_row_general(bb_to_bb_matrix,
                                                     bb_to_sep_matrix,
                                                     bb_g_matrix,
                                                     bb_to_sep_fillins,
                                                     sd->sep_to_bb_matrix.data,
                                                     sd->sep_to_sep_matrix.data,
                                                     sd->sep_g_matrix.data,
                                                     &sd->sep_to_bb_fillins.data[1],
                                                     sd->sep_to_sep_fillins.data);
                    }

                    pthread_mutex_unlock(&sd->lock);
                }
            }
        }
        else {   // Private previous row.
            if (type == PROLINE) {
                solve_6_previous_row_proline(bb_to_bb_matrix,
                                             bb_to_sep_matrix,
                                             bb_g_matrix,
                                             bb_to_sep_fillins,
                                             (prev_type == PROLINE
                                                  ? &prev_sep_to_bb_matrix[-1]
                                                  : prev_sep_to_bb_matrix),
                                             prev_sep_to_sep_matrix,
                                             prev_sep_g_matrix,
                                             (prev_type == PROLINE
                                                  ? &prev_sep_to_bb_fillins[1]
                                                  : prev_sep_to_bb_fillins),
                                             prev_sep_to_sep_fillins);
            }
            else {
                solve_6_previous_row_general(bb_to_bb_matrix,
                                             bb_to_sep_matrix,
                                             bb_g_matrix,
                                             bb_to_sep_fillins,
                                             (prev_type == PROLINE
                                                  ? &prev_sep_to_bb_matrix[-1]
                                                  : prev_sep_to_bb_matrix),
                                             prev_sep_to_sep_matrix,
                                             prev_sep_g_matrix,
                                             (prev_type == PROLINE
                                                  ? &prev_sep_to_bb_fillins[1]
                                                  : prev_sep_to_bb_fillins),
                                             prev_sep_to_sep_fillins);
            }
        }

        // Shared current row.
        if (i == pd->num_side_chains - 1 && thread < nthreads - 1) {
            // Thread N-1 has no shared row.
            if (nthreads > 1) {
                shared_data_t *sd = &shared_data[thread];

                pthread_mutex_lock(&sd->lock);

                if (type == PROLINE) {
                    solve_6_proline_current_row(bb_to_bb_matrix,
                                                bb_to_sep_matrix,
                                                bb_g_matrix,
                                                bb_to_sep_fillins,
                                                &sd->sep_to_bb_matrix.data[1],
                                                sd->sep_to_sep_matrix.data,
                                                sd->sep_g_matrix.data,
                                                sd->sep_to_bb_fillins.data,
                                                sd->sep_to_sep_fillins.data);
                }
                else {
                    solve_6_general_current_row(bb_to_bb_matrix,
                                                bb_to_sep_matrix,
                                                bb_g_matrix,
                                                bb_to_sep_fillins,
                                                sd->sep_to_bb_matrix.data,
                                                sd->sep_to_sep_matrix.data,
                                                sd->sep_g_matrix.data,
                                                sd->sep_to_sep_fillins.data);
                }

                pthread_mutex_unlock(&sd->lock);
            }
        }
        else {   // Private current row.
            if (type == PROLINE) {
                solve_6_proline_current_row(bb_to_bb_matrix,
                                            bb_to_sep_matrix,
                                            bb_g_matrix,
                                            bb_to_sep_fillins,
                                            sep_to_bb_matrix,
                                            sep_to_sep_matrix,
                                            sep_g_matrix,
                                            sep_to_bb_fillins,
                                            sep_to_sep_fillins);
            }
            else {
                solve_6_general_current_row(bb_to_bb_matrix,
                                            bb_to_sep_matrix,
                                            bb_g_matrix,
                                            bb_to_sep_fillins,
                                            sep_to_bb_matrix,
                                            sep_to_sep_matrix,
                                            sep_g_matrix,
                                            sep_to_sep_fillins);
            }
        }
        // Update pointers.
        prev_sep_to_bb_matrix = sep_to_bb_matrix;
        prev_sep_to_sep_matrix = sep_to_sep_matrix;

        prev_sep_g_matrix = sep_g_matrix;

        prev_sep_to_bb_fillins = sep_to_bb_fillins;
        prev_sep_to_sep_fillins = sep_to_sep_fillins;

        prev_type = type;

        bb_to_bb_matrix += (type == PROLINE ? BB_TO_BB_PROLINE_MATRIX_SIZE
                                            : BB_TO_BB_MATRIX_SIZE);
        bb_to_sep_matrix += (type == PROLINE ? BB_TO_SEP_PROLINE_MATRIX_SIZE
                                             : BB_TO_SEP_MATRIX_SIZE);

        bb_g_matrix += (type == PROLINE ? BB_G_PROLINE_MATRIX_SIZE
                                        : BB_G_MATRIX_SIZE);

        bb_to_sep_fillins += BB_TO_SEP_FILLINS_SIZE;

        sep_to_bb_matrix += (type == PROLINE ? SEP_TO_BB_PROLINE_MATRIX_SIZE
                                             : SEP_TO_BB_MATRIX_SIZE);
        sep_to_sep_matrix += SEP_TO_SEP_MATRIX_SIZE;

        sep_g_matrix += SEP_G_MATRIX_SIZE;

        sep_to_bb_fillins += (type == PROLINE ? SEP_TO_BB_PROLINE_FILLINS_SIZE
                                              : SEP_TO_BB_FILLINS_SIZE);

        sep_to_sep_fillins += SEP_TO_SEP_FILLINS_SIZE;
    }
}

void gmx::IlvesPC::solve_7(const int thread) {
    // Pointers to private data.
    private_data_t *pd = &private_data[thread];

    real *sep_to_sep_matrix = pd->sep_to_sep_matrix.data;
    real *sep_g_matrix = pd->sep_g_matrix.data;
    real *sep_to_sep_fillins = pd->sep_to_sep_fillins.data;

    // Initialized to get rid of a warning.
    real *prev_sep_g_matrix = NULL;
    real *prev_sep_to_sep_fillins = NULL;

    for (int i = 0; i < pd->num_side_chains; i++) {
        // Left fillin -> 0

        if (i > 0) {   // No previous row if i == 0.
            // Initialized to ged rid of a warning.
            real *diagonal_entry = NULL;
            real *g_entry = NULL;
            real *left_fillin_entry = NULL;

            // Shared row.
            char shared_row = i == pd->num_side_chains - 1 && thread < nthreads - 1;
            if (shared_row) {
                if (nthreads > 1) {
                    shared_data_t *sd = &shared_data[thread];

                    // Acquire mutex.
                    pthread_mutex_lock(&sd->lock);

                    diagonal_entry = &sd->sep_to_sep_matrix.data[0];
                    g_entry = &sd->sep_g_matrix.data[0];
                    left_fillin_entry = &sd->sep_to_sep_fillins.data[0];
                }
            }
            // Private row.
            else {
                diagonal_entry = &sep_to_sep_matrix[0];
                g_entry = &sep_g_matrix[0];
                left_fillin_entry = &sep_to_sep_fillins[0];
            }

            real pivot = *left_fillin_entry;

            // line = line - prev-line * pivot

            // Now left-fillin is the new left fillin entry.
            *left_fillin_entry = -prev_sep_to_sep_fillins[0] * pivot;

            *diagonal_entry -= prev_sep_to_sep_fillins[1] * pivot;

            *g_entry -= prev_sep_g_matrix[0] * pivot;

            if (shared_row) {
                // Release mutex if shared row.
                if (nthreads > 1) {
                    pthread_mutex_unlock(&shared_data[thread].lock);
                }
            }

            /*
            Resulting matrix:

                          sep                    g
            -------------------------------
            |x f                          |     |x|      1
            |0 M f                        |     |M|      2
            |  0 M f                      |     |M|      3
            |    0 M f                    |     |M|      Shared row 1
            |      f x f                  |     |x|      1
            |      F 0 M f                |     |M|      2
            |      F   0 M f              |     |M| sep  3
            |      F     0 M f            |     |M|      Shared row 2
            |              f x f          |     |x|      1
            |              F 0 M f        |     |M|      2
            |              F   0 M f      |     |M|      3
            |              F     0 M f    |     |M|      Shared row 3
            |                      f x f  |     |x|      1
            |                      F 0 M f|     |M|      2
            |                      F   0 M|     |M|      3
            -------------------------------
            */
        }

        // Diagonal entry -> 1

        if (i < pd->num_side_chains - 1 || thread == nthreads - 1) {   // No
                                                                       // need
                                                                       // to do
                                                                       // it on
                                                                       // shared
                                                                       // rows.

            real pivot = sep_to_sep_matrix[0];

            // line = line / pivot

#if DEBUG
            // This write can be avoided, this entry will always be 1 after
            // this.
            sep_to_sep_matrix[0] = 1;
#endif

            sep_to_sep_fillins[0] /= pivot;
            sep_to_sep_fillins[1] /= pivot;

            sep_g_matrix[0] /= pivot;

            /*
            Resulting matrix:

                          sep                    g
            -------------------------------
            |1 M                          |     |x|      1
            |0 1 M                        |     |M|      2
            |  0 1 M                      |     |M|      3
            |    0 M f                    |     |M|      Shared row 1
            |      M 1 M                  |     |M|      1
            |      F 0 1 M                |     |M|      2
            |      F   0 1 M              |     |M| sep  3
            |      F     0 M f            |     |M|      Shared row 2
            |              M 1 M          |     |M|      1
            |              F 0 1 M        |     |M|      2
            |              F   0 1 M      |     |M|      3
            |              F     0 M f    |     |M|      Shared row 3
            |                      M 1 M  |     |M|      1
            |                      F 0 1 M|     |M|      2
            |                      F   0 1|     |M|      3
            -------------------------------
            */
        }

        // Update pointers
        prev_sep_g_matrix = sep_g_matrix;
        prev_sep_to_sep_fillins = sep_to_sep_fillins;

        sep_to_sep_matrix += SEP_TO_SEP_MATRIX_SIZE;
        sep_g_matrix += SEP_G_MATRIX_SIZE;
        sep_to_sep_fillins += SEP_TO_SEP_FILLINS_SIZE;
    }
}

void gmx::IlvesPC::solve_8(const int thread) {
    private_data_t *pd = &private_data[thread];

    // Pointing to the first entry of the last submatrix of each type.
    real *sep_g_matrix = &pd->sep_g_matrix.data[pd->sep_g_matrix.size - SEP_G_MATRIX_SIZE];
    real *sep_to_sep_fillins = &pd->sep_to_sep_fillins
                                    .data[pd->sep_to_sep_fillins.size - SEP_TO_SEP_FILLINS_SIZE];

    real *prev_sep_g_matrix = NULL;
    real *prev_sep_to_sep_fillins = NULL;

    for (int i = pd->num_side_chains - 1; i >= 0; --i) {
        // Right fillin -> 0

        // There is previous row and that previous row is not a shared row.
        if (i < pd->num_side_chains - 2 ||
            (thread == nthreads - 1 && i < pd->num_side_chains - 1)) {
            real pivot = sep_to_sep_fillins[1];

            // line = line - prev-line * pivot

            // Now right-fillin is the new right-fillin entry.
            sep_to_sep_fillins[1] = -prev_sep_to_sep_fillins[1] * pivot;
            sep_to_sep_fillins[0] -= prev_sep_to_sep_fillins[0] * pivot;

            sep_g_matrix[0] -= prev_sep_g_matrix[0] * pivot;

            /*
            Resulting matrix:

                          sep                    g
            -------------------------------
            |1 0   F                      |     |M|      1
            |0 1 0 F                      |     |M|      2
            |  0 1 f                      |     |x|      3
            |    0 x f                    |     |x|      Shared row 1
            |      M 1 0   F              |     |M|      1
            |      M 0 1 0 F              |     |M|      2
            |      f   0 1 f              |     |x| sep  3
            |      f     0 x f            |     |x|      Shared row 2
            |              M 1 0   F      |     |M|      1
            |              M 0 1 0 F      |     |M|      2
            |              f   0 1 f      |     |x|      3
            |              f     0 x f    |     |x|      Shared row 3
            |                      M 1 0  |     |M|      1
            |                      M 0 1 0|     |M|      2
            |                      f   0 1|     |x|      3
            -------------------------------
            */
        }

        // Update pointers
        prev_sep_g_matrix = sep_g_matrix;
        prev_sep_to_sep_fillins = sep_to_sep_fillins;

        sep_g_matrix -= SEP_G_MATRIX_SIZE;
        sep_to_sep_fillins -= SEP_TO_SEP_FILLINS_SIZE;
    }

    if (nthreads > 1) {
        // Update the (thread - 1)th shared row, if there is a shared row and a
        // previous row. No shared row if thread == 0, No previous row if thread
        // has less than 1 private separation rows.
        if ((thread > 0 && pd->num_side_chains > 1) || (thread == nthreads - 1)) {
            shared_data_t *sd = &shared_data[thread - 1];

            // Acquire mutex.
            pthread_mutex_lock(&sd->lock);

            real pivot = sd->sep_to_sep_fillins.data[1];

            // schur-row = row - prev-row * pivot

            // Now right-fillin is the new right-fillin entry.
            sd->sep_to_sep_fillins.data[1] = -prev_sep_to_sep_fillins[1] * pivot;
            sd->sep_to_sep_matrix.data[0] -= prev_sep_to_sep_fillins[0] * pivot;

            sd->sep_g_matrix.data[0] -= prev_sep_g_matrix[0] * pivot;

            /*
            Resulting matrix:

                            sep                  g
            -------------------------------
            |1 0   F                      |     |M|      1
            |0 1 0 F                      |     |M|      2
            |  0 1 f                      |     |x|      3
            |    0 M 0     F              |     |M|      Shared row 1
            |      M 1 0   F              |     |M|      1
            |      M 0 1 0 F              |     |M|      2
            |      f   0 1 f              |     |x| sep  3
            |      f     0 M 0     F      |     |M|      Shared row 2
            |              M 1 0   F      |     |M|      1
            |              M 0 1 0 F      |     |M|      2
            |              f   0 1 f      |     |x|      3
            |              f     0 M 0    |     |M|      Shared row 3
            |                      M 1 0  |     |M|      1
            |                      M 0 1 0|     |M|      2
            |                      f   0 1|     |x|      3
            -------------------------------
            */

            // Release mutex.
            pthread_mutex_unlock(&sd->lock);
        }
    }
}

void gmx::IlvesPC::solve_9() {
    if (nthreads > 1) {
        // Initialized to get rid of a warning.
        real prev_super = 0.0;
        real prev_g = 0.0;

        for (int k = 0; k < nthreads - 1; k++) {
            shared_data_t *sd = &shared_data[k];

            /*
             * sub-diagonal -> 0
             */

            real pivot = sd->sep_to_sep_fillins.data[0];

            // row = row - (prev-row * pivot)

            if (k > 0) {
#if DEBUG
                // This write can be avoided, this entry will always be 0 after
                // this.
                sd->sep_to_sep_fillins.data[0] = 0;
#endif
                sd->sep_to_sep_matrix.data[0] -= prev_super * pivot;

                sd->sep_g_matrix.data[0] -= prev_g * pivot;
            }

            /*
            Resulting matrix:

              bb           g
             2 3 4
            -------
            |x x  |     |x|      1 Schur row 1
            |0 M x| ..  |M| bb   2 Schur row 2
            |  0 M|     |M|      3 Schur row 3
            -------
            */

            /*
             * diagonal -> 1
             */

            pivot = sd->sep_to_sep_matrix.data[0];

            // row = row / pivot

#if DEBUG
            // This write can be avoided, this entry will always be 1 after
            // this.
            sd->sep_to_sep_matrix.data[0] = 1;
#endif

            sd->sep_to_sep_fillins.data[1] /= pivot;

            sd->sep_g_matrix.data[0] /= pivot;

            /*
            Resulting matrix:

                bb       g
             2 3 4
            -------
            |1 M  |     |M|      1 Schur row 1
            |0 1 M| ..  |M| bb   2 Schur row 2
            |  0 1|     |M|      3 Schur row 3
            -------
            */

            // Update pointers
            prev_super = sd->sep_to_sep_fillins.data[1];
            prev_g = sd->sep_g_matrix.data[0];
        }
    }
}

void gmx::IlvesPC::solve_10() {
    if (nthreads > 1) {
        real prev_g = 0;   // Initialized to get rid of a warning.

        for (int k = nthreads - 2; k >= 0; k--) {
            shared_data_t *sd = &shared_data[k];
            private_data_t *pd = &private_data[k];

            /*
             * super -> 0
             */

            real pivot = sd->sep_to_sep_fillins.data[1];

            // row = row - (prev-row * pivot)

            if (k < nthreads - 2) {
#if DEBUG
                // This write can be avoided, this entry will always be 0 after
                // this.
                sd->sep_to_sep_fillins.data[1] = 0;
#endif

                sd->sep_g_matrix.data[0] -= prev_g * pivot;
            }

            prev_g = sd->sep_g_matrix.data[0];

            // Copy g into private data. This is must be done in order to call
            // update_positions() at the end.
            pd->sep_g_matrix.data[pd->sep_g_matrix.size - 1] = sd->sep_g_matrix.data[0];

            /*
            Resulting matrix:

              bb         g
             2 3 4
            -------
            |1 0  |     |M|      1 Private thread 0
            |0 1 0| ..  |M| bb   2 Shared
            |  0 1|     |x|      3 Private thread 1
            -------
            */
        }
    }
}

void gmx::IlvesPC::solve_11(const int thread) {
    if (nthreads > 1) {
        // Reference to thread private data.
        private_data_t *pd = &private_data[thread];

        real *sep_g_matrix = pd->sep_g_matrix.data;

        real *sep_to_sep_fillins = pd->sep_to_sep_fillins.data;

        if (thread > 0) {   // No previous shared row for thread 0.
            real schur_line_g = shared_data[thread - 1].sep_g_matrix.data[0];

            // Loop through the SEP rows.
            // The last private row of a thread is a copy of it's shared row
            // (must not be modified).
            int num_iter = (thread == nthreads - 1 ? pd->num_side_chains
                                                   : pd->num_side_chains - 1);
            for (int i = 0; i < num_iter; i++) {
                real pivot = sep_to_sep_fillins[i * SEP_TO_SEP_FILLINS_SIZE + 0];

                // row = row - (prev-schur-row * pivot)

#if DEBUG
                // This write can be avoided, this entry will always be 0 after
                // this.
                sep_to_sep_fillins[i * SEP_TO_SEP_FILLINS_SIZE + 0] = 0;
#endif

                sep_g_matrix[i * SEP_G_MATRIX_SIZE + 0] -= schur_line_g * pivot;

                /*
                Resulting matrix:

                                sep                  g
                -------------------------------
                |1 0   f                      |     |x|      1
                |0 1 0 f                      |     |x|      2
                |  0 1 f                      |     |x|      3
                |    0 1 0     0              |     |x|      Shared row 1
                |      0 1 0   f              |     |M|      1
                |      0 0 1 0 f              |     |M|      2
                |      0   0 1 f              |     |M| sep  3
                |      0     0 1 0     0      |     |x|      Shared row 2
                |              0 1 0   f      |     |M|      1
                |              0 0 1 0 f      |     |M|      2
                |              0   0 1 f      |     |M|      3
                |              0     0 1 0    |     |x|      Shared row 3
                |                      0 1 0  |     |M|      1
                |                      0 0 1 0|     |M|      2
                |                      0   0 1|     |M|      3
                -------------------------------
                */
            }
        }
    }
}

void gmx::IlvesPC::solve_12(const int thread) {
    if (nthreads > 1) {
        // Reference to thread private data.
        private_data_t *pd = &private_data[thread];

        real *sep_g_matrix = pd->sep_g_matrix.data;

        real *sep_to_sep_fillins = pd->sep_to_sep_fillins.data;

        if (thread < nthreads - 1) {   // No previous shared row for thread N.
            shared_data_t *sd = &shared_data[thread];

            real schur_line_g = sd->sep_g_matrix.data[0];

            // Loop through the SEP rows.
            // The last private row of a thread is a copy of it's shared row
            // (must not be modified).
            for (int i = 0; i < pd->num_side_chains - 1; i++) {
                real pivot = sep_to_sep_fillins[i * SEP_TO_SEP_FILLINS_SIZE + 1];

                // row = row - (schur-row * pivot)

#if DEBUG
                // This write can be avoided, this entry will always be 0 after
                // this.
                sep_to_sep_fillins[i * SEP_TO_SEP_FILLINS_SIZE + 1] = 0;
#endif

                sep_g_matrix[i * SEP_G_MATRIX_SIZE + 0] -= schur_line_g * pivot;

                /*
                                sep                  g
                -------------------------------
                |1 0   0                      |     |M|      1
                |0 1 0 0                      |     |M|      2
                |  0 1 0                      |     |M|      3
                |    0 1 0     0              |     |x|      Shared row 1
                |      0 1 0   0              |     |M|      1
                |      0 0 1 0 0              |     |M|      2
                |      0   0 1 0              |     |M| sep  3
                |      0     0 1 0     0      |     |x|      Shared row 2
                |              0 1 0   0      |     |M|      1
                |              0 0 1 0 0      |     |M|      2
                |              0   0 1 0      |     |M|      3
                |              0     0 1 0    |     |x|      Shared row 3
                |                      0 1 0  |     |x|      1
                |                      0 0 1 0|     |x|      2
                |                      0   0 1|     |x|      3
                -------------------------------
                */
            }
        }
    }
}

void gmx::IlvesPC::solve_13_proline(real *bb_to_sep_matrix,
                                    real *bb_g_matrix,
                                    real *bb_to_sep_fillins,
                                    real sep_g_entry,
                                    real prev_sep_g_entry) {
    /*
     *
     * Row 1
     *
     */

    real pivot = bb_to_sep_matrix[0];

    // bb-row-1 = bb-row-1 - (prev-sep-row * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sep_matrix[0] = 0;
#endif

    bb_g_matrix[0] -= prev_sep_g_entry * pivot;

    /*
    Resulting matrix:

         bb            sep       g
     1 2 3 4 5       1 2
    -----------     -----
    |1 x      |     |0  |     |M|       1
    |0 1 x x x|     |x  |     |x|       2
    |  0 1 x x|     |f  |     |x| bb    3 Nth Backbone Block
    |  0 0 1 x| ... |f f| ... |x|       4
    |  0 0 0 1|     |f x|     |x|       5
    -----------     -----
                      .
                      .
                    -----
                    |1  |     |x| sep   1 N - 1th separation row
                    |  1|     |x|       2 Nth separation row
                    -----
    */

    /*
     *
     * Row 2
     *
     */

    pivot = bb_to_sep_matrix[1];

    // bb-row-2 = bb-row-2 - (prev-sep-row * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sep_matrix[1] = 0;
#endif

    bb_g_matrix[1] -= prev_sep_g_entry * pivot;

    /*
    Resulting matrix:

         bb          sep       g
     1 2 3 4 5       1 2
    -----------     -----
    |1 x      |     |0  |     |M|       1
    |0 1 x x x|     |0  |     |M|       2
    |  0 1 x x|     |f  |     |x| bb    3 Nth Backbone Block
    |  0 0 1 x| ... |f f| ... |x|       4
    |  0 0 0 1|     |f x|     |x|       5
    -----------     -----
                      .
                      .
                    -----
                    |1  |     |x| sep   1 N - 1th separation row
                    |  1|     |x|       2 Nth separation row
                    -----
    */

    /*
     *
     * Row 3
     *
     */

    pivot = bb_to_sep_fillins[0];

    // bb-row-3 = bb-row-3 - (prev-sep-row * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sep_fillins[0] = 0;
#endif

    bb_g_matrix[2] -= prev_sep_g_entry * pivot;

    /*
    Resulting matrix:

         bb          sep       g
     1 2 3 4 5       1 2
    -----------     -----
    |1 x      |     |0  |     |M|       1
    |0 1 x x x|     |0  |     |M|       2
    |  0 1 x x|     |0  |     |M| bb    3 Nth Backbone Block
    |  0 0 1 x| ... |f f| ... |x|       4
    |  0 0 0 1|     |f x|     |x|       5
    -----------     -----
                      .
                      .
                    -----
                    |1  |     |x| sep   1 N - 1th separation row
                    |  1|     |x|       2 Nth separation row
                    -----
    */

    /*
     *
     * Row 4
     *
     */

    pivot = bb_to_sep_fillins[1];

    // bb-row-4 = bb-row-4 - (prev-sep-row * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sep_fillins[1] = 0;
#endif

    bb_g_matrix[3] -= prev_sep_g_entry * pivot;

    /*
    Resulting matrix:

         bb          sep       g
     1 2 3 4 5       1 2
    -----------     -----
    |1 x      |     |0  |     |M|       1
    |0 1 x x x|     |0  |     |M|       2
    |  0 1 x x|     |0  |     |M| bb    3 Nth Backbone Block
    |  0 0 1 x| ... |0 f| ... |M|       4
    |  0 0 0 1|     |f x|     |M|       5
    -----------     -----
                      .
                      .
                    -----
                    |1  |     |x| sep   1 N - 1th separation row
                    |  1|     |x|       2 Nth separation row
                    -----
    */

    pivot = bb_to_sep_fillins[2];

    // bb-row-4 = bb-row-4 - (sep-row * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sep_fillins[2] = 0;
#endif

    bb_g_matrix[3] -= sep_g_entry * pivot;

    /*
    Resulting matrix:

         bb          sep       g
     1 2 3 4 5       1 2
    -----------     -----
    |1 x      |     |0  |     |M|       1
    |0 1 x x x|     |0  |     |M|       2
    |  0 1 x x|     |0  |     |M| bb    3 Nth Backbone Block
    |  0 0 1 x| ... |0 0| ... |M|       4
    |  0 0 0 1|     |f x|     |M|       5
    -----------     -----
                      .
                      .
                    -----
                    |1  |     |x| sep   1 N - 1th separation row
                    |  1|     |x|       2 Nth separation row
                    -----
    */

    /*
     *
     * Row 5
     *
     */

    pivot = bb_to_sep_fillins[3];

    // bb-row-5 = bb-row-5 - (prev-sep-row * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sep_fillins[3] = 0;
#endif

    bb_g_matrix[4] -= prev_sep_g_entry * pivot;

    /*
    Resulting matrix:

         bb          sep       g
     1 2 3 4 5       1 2
    -----------     -----
    |1 x      |     |0  |     |M|       1
    |0 1 x x x|     |0  |     |M|       2
    |  0 1 x x|     |0  |     |M| bb    3 Nth Backbone Block
    |  0 0 1 x| ... |0 0| ... |M|       4
    |  0 0 0 1|     |0 x|     |M|       5
    -----------     -----
                      .
                      .
                    -----
                    |1  |     |x| sep   1 N - 1th separation row
                    |  1|     |x|       2 Nth separation row
                    -----
    */

    pivot = bb_to_sep_matrix[2];

    // bb-row-5 = bb-row-5 - (sep-row * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sep_matrix[2] = 0;
#endif

    bb_g_matrix[4] -= sep_g_entry * pivot;

    /*
    Resulting matrix:

         bb          sep       g
     1 2 3 4 5       1 2
    -----------     -----
    |1 x      |     |0  |     |M|       1
    |0 1 x x x|     |0  |     |M|       2
    |  0 1 x x|     |0  |     |M| bb    3 Nth Backbone Block
    |  0 0 1 x| ... |0 0| ... |M|       4
    |  0 0 0 1|     |0 0|     |M|       5
    -----------     -----
                      .
                      .
                    -----
                    |1  |     |x| sep   1 N - 1th separation row
                    |  1|     |x|       2 Nth separation row
                    -----
    */
}

void gmx::IlvesPC::solve_13_general(real *bb_to_sep_matrix,
                                    real *bb_g_matrix,
                                    real *bb_to_sep_fillins,
                                    real sep_g_entry,
                                    real prev_sep_g_entry) {
    /*
     *
     * Row 1
     *
     */

    real pivot = bb_to_sep_matrix[0];

    // bb-row-1 = bb-row-1 - (prev-sep-row * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sep_matrix[0] = 0;
#endif

    bb_g_matrix[0] -= prev_sep_g_entry * pivot;

    /*
    Resulting matrix:

         bb            sep       g
     1 2 3 4 5 6       1 2
    -------------     -----
    |1 x        |     |0  |     |M|       1
    |0 1 x x x  |     |x  |     |x|       2
    |  0 1 x x  |     |f  |     |x| bb    3 Nth Backbone Block
    |  0 0 1 x  | ... |f  | ... |x|       4
    |  0 0 0 1 x|     |f x|     |x|       5
    |        0 1|     |f x|     |x|       6
    -------------     -----
                        .
                        .
                      -----
                      |1  |     |x| sep   1 N - 1th separation row
                      |  1|     |x|       2 Nth separation row
                      -----
    */

    /*
     *
     * Row 2
     *
     */

    pivot = bb_to_sep_matrix[1];

    // bb-row-2 = bb-row-2 - (prev-sep-row * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sep_matrix[1] = 0;
#endif

    bb_g_matrix[1] -= prev_sep_g_entry * pivot;

    /*
    Resulting matrix:

         bb            sep       g
     1 2 3 4 5 6       1 2
    -------------     -----
    |1 x        |     |0  |     |M|       1
    |0 1 x x x  |     |0  |     |M|       2
    |  0 1 x x  |     |f  |     |x| bb    3 Nth Backbone Block
    |  0 0 1 x  | ... |f  | ... |x|       4
    |  0 0 0 1 x|     |f x|     |x|       5
    |        0 1|     |f x|     |x|       6
    -------------     -----
                        .
                        .
                      -----
                      |1  |     |x| sep   1 N - 1th separation row
                      |  1|     |x|       2 Nth separation row
                      -----
    */

    /*
     *
     * Row 3
     *
     */

    pivot = bb_to_sep_fillins[0];

    // bb-row-3 = bb-row-3 - (prev-sep-row * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sep_fillins[0] = 0;
#endif

    bb_g_matrix[2] -= prev_sep_g_entry * pivot;

    /*
    Resulting matrix:

         bb            sep       g
     1 2 3 4 5 6       1 2
    -------------     -----
    |1 x        |     |0  |     |M|       1
    |0 1 x x x  |     |0  |     |M|       2
    |  0 1 x x  |     |0  |     |M| bb    3 Nth Backbone Block
    |  0 0 1 x  | ... |f  | ... |x|       4
    |  0 0 0 1 x|     |f x|     |x|       5
    |        0 1|     |f x|     |x|       6
    -------------     -----
                        .
                        .
                      -----
                      |1  |     |x| sep   1 N - 1th separation row
                      |  1|     |x|       2 Nth separation row
                      -----
    */

    /*
     *
     * Row 4
     *
     */

    pivot = bb_to_sep_fillins[1];

    // bb-row-4 = bb-row-4 - (prev-sep-row * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sep_fillins[1] = 0;
#endif

    bb_g_matrix[3] -= prev_sep_g_entry * pivot;

    /*
    Resulting matrix:

         bb            sep       g
     1 2 3 4 5 6       1 2
    -------------     -----
    |1 x        |     |0  |     |M|       1
    |0 1 x x x  |     |0  |     |M|       2
    |  0 1 x x  |     |0  |     |M| bb    3 Nth Backbone Block
    |  0 0 1 x  | ... |0  | ... |M|       4
    |  0 0 0 1 x|     |f x|     |x|       5
    |        0 1|     |f x|     |x|       6
    -------------     -----
                        .
                        .
                      -----
                      |1  |     |x| sep   1 N - 1th separation row
                      |  1|     |x|       2 Nth separation row
                      -----
    */

    /*
     *
     * Row 5
     *
     */

    pivot = bb_to_sep_fillins[2];

    // bb-row-5 = bb-row-5 - (prev-sep-row * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sep_fillins[2] = 0;
#endif

    bb_g_matrix[4] -= prev_sep_g_entry * pivot;

    /*
    Resulting matrix:

         bb            sep       g
     1 2 3 4 5 6       1 2
    -------------     -----
    |1 x        |     |0  |     |M|       1
    |0 1 x x x  |     |0  |     |M|       2
    |  0 1 x x  |     |0  |     |M| bb    3 Nth Backbone Block
    |  0 0 1 x  | ... |0  | ... |M|       4
    |  0 0 0 1 x|     |0 x|     |M|       5
    |        0 1|     |f x|     |x|       6
    -------------     -----
                        .
                        .
                      -----
                      |1  |     |x| sep   1 N - 1th separation row
                      |  1|     |x|       2 Nth separation row
                      -----
    */

    pivot = bb_to_sep_matrix[2];

    // bb-row-5 = bb-row-5 - (sep-row * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sep_matrix[2] = 0;
#endif

    bb_g_matrix[4] -= sep_g_entry * pivot;

    /*
    Resulting matrix:

         bb            sep       g
     1 2 3 4 5 6       1 2
    -------------     -----
    |1 x        |     |0  |     |M|       1
    |0 1 x x x  |     |0  |     |M|       2
    |  0 1 x x  |     |0  |     |M| bb    3 Nth Backbone Block
    |  0 0 1 x  | ... |0  | ... |M|       4
    |  0 0 0 1 x|     |0 0|     |M|       5
    |        0 1|     |f x|     |x|       6
    -------------     -----
                        .
                        .
                      -----
                      |1  |     |x| sep   1 N - 1th separation row
                      |  1|     |x|       2 Nth separation row
                      -----
    */

    /*
     *
     * Row 6
     *
     */

    pivot = bb_to_sep_fillins[3];

    // bb-row-6 = bb-row-6 - (prev-sep-row * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sep_fillins[3] = 0;
#endif

    bb_g_matrix[5] -= prev_sep_g_entry * pivot;

    /*
    Resulting matrix:

         bb            sep       g
     1 2 3 4 5 6       1 2
    -------------     -----
    |1 x        |     |0  |     |M|       1
    |0 1 x x x  |     |0  |     |M|       2
    |  0 1 x x  |     |0  |     |M| bb    3 Nth Backbone Block
    |  0 0 1 x  | ... |0  | ... |M|       4
    |  0 0 0 1 x|     |0 0|     |M|       5
    |        0 1|     |0 x|     |M|       6
    -------------     -----
                        .
                        .
                      -----
                      |1  |     |x| sep   1 N - 1th separation row
                      |  1|     |x|       2 Nth separation row
                      -----
    */

    pivot = bb_to_sep_matrix[3];

    // bb-row-6 = bb-row-6 - (sep-row * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_sep_matrix[3] = 0;
#endif

    bb_g_matrix[5] -= sep_g_entry * pivot;

    /*
    Resulting matrix:

         bb            sep       g
     1 2 3 4 5 6       1 2
    -------------     -----
    |1 x        |     |0  |     |M|       1
    |0 1 x x x  |     |0  |     |M|       2
    |  0 1 x x  |     |0  |     |M| bb    3 Nth Backbone Block
    |  0 0 1 x  | ... |0  | ... |M|       4
    |  0 0 0 1 x|     |0 0|     |M|       5
    |        0 1|     |0 0|     |M|       6
    -------------     -----
                        .
                        .
                      -----
                      |1  |     |x| sep   1 N - 1th separation row
                      |  1|     |x|       2 Nth separation row
                      -----
    */
}

void gmx::IlvesPC::solve_13(const int thread) {
    // Reference to thread private data.
    private_data_t *pd = &private_data[thread];

    real *bb_to_sep_matrix = pd->bb_to_sep_matrix.data;
    real *bb_g_matrix = pd->bb_g_matrix.data;

    real *bb_to_sep_fillins = pd->bb_to_sep_fillins.data;

    real prev_sep_g_entry = 0;

    // Thread 0 has no previous shared row.
    if (nthreads > 1) {
        if (thread > 0) {
            prev_sep_g_entry = shared_data[thread - 1].sep_g_matrix.data[0];
        }
    }

    for (int i = 0; i < pd->num_side_chains; i++) {
        side_chain_type_t type = mol->side_chain_types[pd->first_side_chain + i];

        real sep_g_entry = 0.0;   // Initialized to get rid of a warning.

        if (i == pd->num_side_chains - 1 && thread < nthreads - 1) {
            if (nthreads > 1) {
                sep_g_entry = shared_data[thread].sep_g_matrix.data[0];
            }
        }
        else {
            sep_g_entry = pd->sep_g_matrix.data[i];
        }

        if (type == PROLINE) {
            solve_13_proline(bb_to_sep_matrix,
                             bb_g_matrix,
                             bb_to_sep_fillins,
                             sep_g_entry,
                             prev_sep_g_entry);
        }
        else {
            solve_13_general(bb_to_sep_matrix,
                             bb_g_matrix,
                             bb_to_sep_fillins,
                             sep_g_entry,
                             prev_sep_g_entry);
        }

        // Update pointers.
        prev_sep_g_entry = sep_g_entry;

        bb_to_sep_matrix += (type == PROLINE ? BB_TO_SEP_PROLINE_MATRIX_SIZE
                                             : BB_TO_SEP_MATRIX_SIZE);

        bb_g_matrix += (type == PROLINE ? BB_G_PROLINE_MATRIX_SIZE
                                        : BB_G_MATRIX_SIZE);

        bb_to_sep_fillins += BB_TO_SEP_FILLINS_SIZE;
    }
}

void gmx::IlvesPC::solve_14(const int thread) {
    // Reference to thread private data.
    private_data_t *pd = &private_data[thread];

    real *sc_to_sep_matrix = pd->sc_to_sep_matrix.data;

    real *sc_g_matrix = pd->sc_g_matrix.data;

    real *sep_g_matrix = pd->sep_g_matrix.data;

    for (int i = 0; i < pd->num_side_chains; ++i) {
        side_chain_type_t type = mol->side_chain_types[pd->first_side_chain + i];

        if (type == PROLINE) {
            real pivot = sc_to_sep_matrix[0];

            // sc-row-9 = sc-row-9 - (sep-row * pivot)

#if DEBUG
            // This write can be avoided, this entry will always be 0 after
            // this.
            sc_to_sep_matrix[0] = 0;
#endif

            sc_g_matrix[8] -= sep_g_matrix[0] * pivot;

            /*
            Resultant matrix:

            sep      g

            ---
            | |     |x|  1
            | |     |x|  2
            | |     |x|  3
            | |     |x|  4
            | | ... |x|  5 sc
            | |     |x|  6
            | |     |x|  7
            | |     |x|  8
            |0|     |M|  9
            ---
             .
             .
            ---
            |1| ... |x| sep   1 Nth separation row
            ---
            */

            // Update pointers.

            sc_to_sep_matrix += SC_TO_SEP_PROLINE_MATRIX_SIZE;
        }

        // Proline and non-proline side-chains.
        sc_g_matrix += sc_g_matrix_sizes[type];
        sep_g_matrix += SEP_G_MATRIX_SIZE;
    }
}

void gmx::IlvesPC::solve_15_proline(real *const bb_to_bb_matrix,
                                    real *const bb_g_matrix) {
    /*
     *
     * Row 4
     *
     */

    real pivot = bb_to_bb_matrix[14];

    // row-4 = row-4 - (row-5 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_bb_matrix[14] = 0;
#endif

    bb_g_matrix[3] -= bb_g_matrix[4] * pivot;

    /*
    Resulting matrix:

         bb          sep       g
     1 2 3 4 5       1 2
    -----------     -----
    |1 x      |     |0  |     |x|       1
    |0 1 x x x|     |0  |     |x|       2
    |  0 1 x x|     |0  |     |x| bb    3
    |  0 0 1 0| ... |0 0| ... |M|       4
    |  0 0 0 1|     |0 0|     |M|       5
    -----------     -----
    */

    /*
     *
     * Row 3
     *
     */

    pivot = bb_to_bb_matrix[10];

    // row-3 = row-3 - (row-5 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_bb_matrix[10] = 0;
#endif

    bb_g_matrix[2] -= bb_g_matrix[4] * pivot;

    /*
    Resulting matrix:

         bb          sep       g
     1 2 3 4 5       1 2
    -----------     -----
    |1 x      |     |0  |     |x|       1
    |0 1 x x x|     |0  |     |x|       2
    |  0 1 x 0|     |0  |     |M| bb    3
    |  0 0 1 0| ... |0 0| ... |M|       4
    |  0 0 0 1|     |0 0|     |M|       5
    -----------     -----
    */

    pivot = bb_to_bb_matrix[9];

    // row-3 = row-3 - (row-4 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_bb_matrix[9] = 0;
#endif

    bb_g_matrix[2] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

         bb          sep       g
     1 2 3 4 5       1 2
    -----------     -----
    |1 x      |     |0  |     |x|       1
    |0 1 x x x|     |0  |     |x|       2
    |  0 1 0 0|     |0  |     |M| bb    3
    |  0 0 1 0| ... |0 0| ... |M|       4
    |  0 0 0 1|     |0 0|     |M|       5
    -----------     -----
    */

    /*
     *
     * Row 2
     *
     */

    pivot = bb_to_bb_matrix[6];

    // row-2 = row-2 - (row-5 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_bb_matrix[6] = 0;
#endif

    bb_g_matrix[1] -= bb_g_matrix[4] * pivot;

    /*
    Resulting matrix:

         bb          sep       g
     1 2 3 4 5       1 2
    -----------     -----
    |1 x      |     |0  |     |x|       1
    |0 1 x x 0|     |0  |     |M|       2
    |  0 1 0 0|     |0  |     |M| bb    3
    |  0 0 1 0| ... |0 0| ... |M|       4
    |  0 0 0 1|     |0 0|     |M|       5
    -----------     -----
    */

    pivot = bb_to_bb_matrix[5];

    // row-2 = row-2 - (row-4 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_bb_matrix[5] = 0;
#endif

    bb_g_matrix[1] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

         bb          sep       g
     1 2 3 4 5       1 2
    -----------     -----
    |1 x      |     |0  |     |x|       1
    |0 1 x 0 0|     |0  |     |M|       2
    |  0 1 0 0|     |0  |     |M| bb    3
    |  0 0 1 0| ... |0 0| ... |M|       4
    |  0 0 0 1|     |0 0|     |M|       5
    -----------     -----
    */

    pivot = bb_to_bb_matrix[4];

    // row-2 = row-2 - (row-3 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_bb_matrix[4] = 0;
#endif

    bb_g_matrix[1] -= bb_g_matrix[2] * pivot;

    /*
    Resulting matrix:

         bb          sep       g
     1 2 3 4 5       1 2
    -----------     -----
    |1 x      |     |0  |     |x|       1
    |0 1 0 0 0|     |0  |     |M|       2
    |  0 1 0 0|     |0  |     |M| bb    3
    |  0 0 1 0| ... |0 0| ... |M|       4
    |  0 0 0 1|     |0 0|     |M|       5
    -----------     -----
    */

    /*
     *
     * Row 1
     *
     */

    pivot = bb_to_bb_matrix[1];

    // row-1 = row-1 - (row-2 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_bb_matrix[1] = 0;
#endif

    bb_g_matrix[0] -= bb_g_matrix[1] * pivot;

    /*
    Resulting matrix:

         bb          sep       g
     1 2 3 4 5       1 2
    -----------     -----
    |1 0      |     |0  |     |M|       1
    |0 1 0 0 0|     |0  |     |M|       2
    |  0 1 0 0|     |0  |     |M| bb    3
    |  0 0 1 0| ... |0 0| ... |M|       4
    |  0 0 0 1|     |0 0|     |M|       5
    -----------     -----
    */
}

void gmx::IlvesPC::solve_15_general(real *const bb_to_bb_matrix,
                                    real *const bb_g_matrix) {
    /*
     *
     * Row 5
     *
     */

    real pivot = bb_to_bb_matrix[19];

    // row-5 = row-5 - (row-6 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_bb_matrix[19] = 0;
#endif

    bb_g_matrix[4] -= bb_g_matrix[5] * pivot;

    /*
    Resulting matrix:

         bb            sep       g
     1 2 3 4 5 6       1 2
    -------------     -----
    |1 x        |     |0  |     |x|       1
    |0 1 x x x  |     |0  |     |x|       2
    |  0 1 x x  |     |0  |     |x| bb    3
    |  0 0 1 x  | ... |0  | ... |x|       4
    |  0 0 0 1 0|     |0 0|     |M|       5
    |        0 1|     |0 0|     |x|       6
    -------------     -----
    */

    /*
     *
     * Row 4
     *
     */

    pivot = bb_to_bb_matrix[14];

    // row-4 = row-4 - (row-5 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_bb_matrix[14] = 0;
#endif

    bb_g_matrix[3] -= bb_g_matrix[4] * pivot;

    /*
    Resulting matrix:

         bb            sep       g
     1 2 3 4 5 6       1 2
    -------------     -----
    |1 x        |     |0  |     |x|       1
    |0 1 x x x  |     |0  |     |x|       2
    |  0 1 x x  |     |0  |     |x| bb    3
    |  0 0 1 0  | ... |0  | ... |M|       4
    |  0 0 0 1 0|     |0 0|     |M|       5
    |        0 1|     |0 0|     |x|       6
    -------------     -----
    */

    /*
     *
     * Row 3
     *
     */

    pivot = bb_to_bb_matrix[10];

    // row-3 = row-3 - (row-5 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_bb_matrix[10] = 0;
#endif

    bb_g_matrix[2] -= bb_g_matrix[4] * pivot;

    /*
    Resulting matrix:

         bb            sep       g
     1 2 3 4 5 6       1 2
    -------------     -----
    |1 x        |     |0  |     |x|       1
    |0 1 x x x  |     |0  |     |x|       2
    |  0 1 x 0  |     |0  |     |M| bb    3
    |  0 0 1 0  | ... |0  | ... |M|       4
    |  0 0 0 1 0|     |0 0|     |M|       5
    |        0 1|     |0 0|     |x|       6
    -------------     -----
    */

    pivot = bb_to_bb_matrix[9];

    // row-3 = row-3 - (row-4 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_bb_matrix[9] = 0;
#endif

    bb_g_matrix[2] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

         bb            sep       g
     1 2 3 4 5 6       1 2
    -------------     -----
    |1 x        |     |0  |     |x|       1
    |0 1 x x x  |     |0  |     |x|       2
    |  0 1 0 0  |     |0  |     |M| bb    3
    |  0 0 1 0  | ... |0  | ... |M|       4
    |  0 0 0 1 0|     |0 0|     |M|       5
    |        0 1|     |0 0|     |x|       6
    -------------     -----
    */

    /*
     *
     * Row 2
     *
     */

    pivot = bb_to_bb_matrix[6];

    // row-2 = row-2 - (row-5 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_bb_matrix[6] = 0;
#endif

    bb_g_matrix[1] -= bb_g_matrix[4] * pivot;

    /*
    Resulting matrix:

         bb            sep       g
     1 2 3 4 5 6       1 2
    -------------     -----
    |1 x        |     |0  |     |x|       1
    |0 1 x x 0  |     |0  |     |M|       2
    |  0 1 0 0  |     |0  |     |M| bb    3
    |  0 0 1 0  | ... |0  | ... |M|       4
    |  0 0 0 1 0|     |0 0|     |M|       5
    |        0 1|     |0 0|     |x|       6
    -------------     -----
    */

    pivot = bb_to_bb_matrix[5];

    // row-2 = row-2 - (row-4 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_bb_matrix[5] = 0;
#endif

    bb_g_matrix[1] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

         bb            sep       g
     1 2 3 4 5 6       1 2
    -------------     -----
    |1 x        |     |0  |     |x|       1
    |0 1 x 0 0  |     |0  |     |M|       2
    |  0 1 0 0  |     |0  |     |M| bb    3
    |  0 0 1 0  | ... |0  | ... |M|       4
    |  0 0 0 1 0|     |0 0|     |M|       5
    |        0 1|     |0 0|     |x|       6
    -------------     -----
    */

    pivot = bb_to_bb_matrix[4];

    // row-2 = row-2 - (row-3 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_bb_matrix[4] = 0;
#endif

    bb_g_matrix[1] -= bb_g_matrix[2] * pivot;

    /*
    Resulting matrix:

         bb            sep       g
     1 2 3 4 5 6       1 2
    -------------     -----
    |1 x        |     |0  |     |x|       1
    |0 1 0 0 0  |     |0  |     |M|       2
    |  0 1 0 0  |     |0  |     |M| bb    3
    |  0 0 1 0  | ... |0  | ... |M|       4
    |  0 0 0 1 0|     |0 0|     |M|       5
    |        0 1|     |0 0|     |x|       6
    -------------     -----
    */

    /*
     *
     * Row 1
     *
     */

    pivot = bb_to_bb_matrix[1];

    // row-1 = row-1 - (row-2 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    bb_to_bb_matrix[1] = 0;
#endif

    bb_g_matrix[0] -= bb_g_matrix[1] * pivot;

    /*
    Resulting matrix:

         bb            sep       g
     1 2 3 4 5 6       1 2
    -------------     -----
    |1 0        |     |0  |     |M|       1
    |0 1 0 0 0  |     |0  |     |M|       2
    |  0 1 0 0  |     |0  |     |M| bb    3
    |  0 0 1 0  | ... |0  | ... |M|       4
    |  0 0 0 1 0|     |0 0|     |M|       5
    |        0 1|     |0 0|     |x|       6
    -------------     -----
    */
}

void gmx::IlvesPC::solve_15(const int thread) {
    // Pointers to private data.
    private_data_t *pd = &private_data[thread];

    real *bb_to_bb_matrix = pd->bb_to_bb_matrix.data;

    real *bb_g_matrix = pd->bb_g_matrix.data;

    // Loop through the side-chains assigned to thread.
    for (int i = 0; i < pd->num_side_chains; i++) {
        side_chain_type_t type = mol->side_chain_types[pd->first_side_chain + i];

        if (type == PROLINE) {
            solve_15_proline(bb_to_bb_matrix, bb_g_matrix);

            // Update pointers.
            bb_to_bb_matrix += BB_TO_BB_PROLINE_MATRIX_SIZE;
            bb_g_matrix += BB_G_PROLINE_MATRIX_SIZE;
        }
        else {
            solve_15_general(bb_to_bb_matrix, bb_g_matrix);

            // Update pointers.
            bb_to_bb_matrix += BB_TO_BB_MATRIX_SIZE;
            bb_g_matrix += BB_G_MATRIX_SIZE;
        }
    }
}

void gmx::IlvesPC::solve_16_glycine(__attribute__((unused))
                                    real *const sc_to_bb_matrix,
                                    __attribute__((unused)) real *const sc_g_matrix,
                                    __attribute__((unused))
                                    real *const sc_to_bb_fillins,
                                    __attribute__((unused))
                                    real *const bb_g_matrix) {}

void gmx::IlvesPC::solve_16_proline(real *const sc_to_bb_matrix,
                                    real *const sc_g_matrix,
                                    real *const sc_to_bb_fillins,
                                    real *const bb_g_matrix) {
    /*
     *
     * Row 9
     *
     */

    real pivot = sc_to_bb_matrix[3];

    // sc-row-9 = sc-row-9 - bb-row-14 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[3] = 0;
#endif

    sc_g_matrix[8] -= bb_g_matrix[4] * pivot;

    /*
    Resulting matrix:

            sc                  bb           g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------
    |1 x         x    |     |      x  |     |x|  1
    |0 1         x    |     |      x  |     |x|  2
    |    1 x     x x  |     |         |     |x|  3
    |    0 1     x x  |     |         |     |x|  4
    |        1 x   x x| ... |         | ... |x|  5 sc
    |        0 1   x x|     |         |     |x|  6
    |0 0 0 0     1 x  |     |      x  |     |x|  7
    |    0 0 0 0 0 1 x|     |      f  |     |x|  8
    |        0 0   0 1|     |      f 0|     |M|  9
    -------------------     -----------
             .                   .
             .                   .
             .                   .
    -------------------     -----------
    |                 |     |1 0      |     |x|  1
    |                 |     |0 1 0 0 0|     |x|  2
    |                 | ... |  0 1 0 0| ... |x|  3 bb
    |0 0         0 0 0|     |  0 0 1 0|     |x|  4
    |                0|     |  0 0 0 1|     |x|  5
    -------------------     -----------
    */

    pivot = sc_to_bb_fillins[1];

    // sc-row-9 = sc-row-9 - bb-row-13 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_fillins[1] = 0;
#endif

    sc_g_matrix[8] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

            sc                  bb           g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------
    |1 x         x    |     |      x  |     |x|  1
    |0 1         x    |     |      x  |     |x|  2
    |    1 x     x x  |     |         |     |x|  3
    |    0 1     x x  |     |         |     |x|  4
    |        1 x   x x| ... |         | ... |x|  5 sc
    |        0 1   x x|     |         |     |x|  6
    |0 0 0 0     1 x  |     |      x  |     |x|  7
    |    0 0 0 0 0 1 x|     |      f  |     |x|  8
    |        0 0   0 1|     |      0 0|     |M|  9
    -------------------     -----------
             .                   .
             .                   .
             .                   .
    -------------------     -----------
    |                 |     |1 0      |     |x|  1
    |                 |     |0 1 0 0 0|     |x|  2
    |                 | ... |  0 1 0 0| ... |x|  3 bb
    |0 0         0 0 0|     |  0 0 1 0|     |x|  4
    |                0|     |  0 0 0 1|     |x|  5
    -------------------     -----------
    */

    /*
     *
     * Row 8
     *
     */

    pivot = sc_to_bb_fillins[0];

    // sc-row-8 = sc-row-8 - bb-row-13 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_fillins[0] = 0;
#endif

    sc_g_matrix[7] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

            sc                  bb           g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------
    |1 x         x    |     |      x  |     |x|  1
    |0 1         x    |     |      x  |     |x|  2
    |    1 x     x x  |     |         |     |x|  3
    |    0 1     x x  |     |         |     |x|  4
    |        1 x   x x| ... |         | ... |x|  5 sc
    |        0 1   x x|     |         |     |x|  6
    |0 0 0 0     1 x  |     |      x  |     |x|  7
    |    0 0 0 0 0 1 x|     |      0  |     |M|  8
    |        0 0   0 1|     |      0 0|     |M|  9
    -------------------     -----------
             .                   .
             .                   .
             .                   .
    -------------------     -----------
    |                 |     |1 0      |     |x|  1
    |                 |     |0 1 0 0 0|     |x|  2
    |                 | ... |  0 1 0 0| ... |x|  3 bb
    |0 0         0 0 0|     |  0 0 1 0|     |x|  4
    |                0|     |  0 0 0 1|     |x|  5
    -------------------     -----------
    */

    /*
     *
     * Row 7
     *
     */

    pivot = sc_to_bb_matrix[2];

    // sc-row-7 = sc-row-7 - bb-row-13 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[2] = 0;
#endif

    sc_g_matrix[6] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

            sc                  bb           g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------
    |1 x         x    |     |      x  |     |x|  1
    |0 1         x    |     |      x  |     |x|  2
    |    1 x     x x  |     |         |     |x|  3
    |    0 1     x x  |     |         |     |x|  4
    |        1 x   x x| ... |         | ... |x|  5 sc
    |        0 1   x x|     |         |     |x|  6
    |0 0 0 0     1 x  |     |      0  |     |M|  7
    |    0 0 0 0 0 1 x|     |      0  |     |M|  8
    |        0 0   0 1|     |      0 0|     |M|  9
    -------------------     -----------
             .                   .
             .                   .
             .                   .
    -------------------     -----------
    |                 |     |1 0      |     |x|  1
    |                 |     |0 1 0 0 0|     |x|  2
    |                 | ... |  0 1 0 0| ... |x|  3 bb
    |0 0         0 0 0|     |  0 0 1 0|     |x|  4
    |                0|     |  0 0 0 1|     |x|  5
    -------------------     -----------
    */

    /*
     *
     * Row 2
     *
     */

    pivot = sc_to_bb_matrix[1];

    // sc-row-2 = sc-row-2 - bb-row-13 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[1] = 0;
#endif

    sc_g_matrix[1] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

            sc                  bb           g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------
    |1 x         x    |     |      x  |     |x|  1
    |0 1         x    |     |      0  |     |M|  2
    |    1 x     x x  |     |         |     |x|  3
    |    0 1     x x  |     |         |     |x|  4
    |        1 x   x x| ... |         | ... |x|  5 sc
    |        0 1   x x|     |         |     |x|  6
    |0 0 0 0     1 x  |     |      0  |     |M|  7
    |    0 0 0 0 0 1 x|     |      0  |     |M|  8
    |        0 0   0 1|     |      0 0|     |M|  9
    -------------------     -----------
             .                   .
             .                   .
             .                   .
    -------------------     -----------
    |                 |     |1 0      |     |x|  1
    |                 |     |0 1 0 0 0|     |x|  2
    |                 | ... |  0 1 0 0| ... |x|  3 bb
    |0 0         0 0 0|     |  0 0 1 0|     |x|  4
    |                0|     |  0 0 0 1|     |x|  5
    -------------------     -----------
    */

    /*
     *
     * Row 1
     *
     */

    pivot = sc_to_bb_matrix[0];

    // sc-row-1 = sc-row-1 - bb-row-13 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[0] = 0;
#endif

    sc_g_matrix[0] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

            sc                  bb           g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------
    |1 x         x    |     |      0  |     |M|  1
    |0 1         x    |     |      0  |     |M|  2
    |    1 x     x x  |     |         |     |x|  3
    |    0 1     x x  |     |         |     |x|  4
    |        1 x   x x| ... |         | ... |x|  5 sc
    |        0 1   x x|     |         |     |x|  6
    |0 0 0 0     1 x  |     |      0  |     |M|  7
    |    0 0 0 0 0 1 x|     |      0  |     |M|  8
    |        0 0   0 1|     |      0 0|     |M|  9
    -------------------     -----------
             .                   .
             .                   .
             .                   .
    -------------------     -----------
    |                 |     |1 0      |     |x|  1
    |                 |     |0 1 0 0 0|     |x|  2
    |                 | ... |  0 1 0 0| ... |x|  3 bb
    |0 0         0 0 0|     |  0 0 1 0|     |x|  4
    |                0|     |  0 0 0 1|     |x|  5
    -------------------     -----------
    */
}

void gmx::IlvesPC::solve_16_cysteine(real *const sc_to_bb_matrix,
                                     real *const sc_g_matrix,
                                     __attribute__((unused))
                                     real *const sc_to_bb_fillins,
                                     real *const bb_g_matrix) {
    /*
     *
     * Row 4
     *
     */

    real pivot = sc_to_bb_matrix[2];

    // sc-row-4 = sc-row-4 - bb-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[2] = 0;
#endif

    sc_g_matrix[3] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

       sc              bb            g
     1 2 3 4       1 2 3 4 5 6
    ---------     -------------
    |1 x    |     |           |     |x|  1
    |0 1 x x|     |      x    |     |x|  2
    |  0 1 x| ... |      x    | ... |x|  3 sc
    |  0 0 1|     |      0    |     |M|  4
    ---------     -------------
        .               .
        .               .
        .               .
    ---------     -------------
    |       |     |1 0        |     |x|  1
    |       |     |0 1 0 0 0  |     |x|  2
    |       |     |  0 1 0 0  |     |x|  3
    |  0 0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |       |     |  0 0 0 1 0|     |x|  5
    |       |     |        0 1|     |x|  6
    ---------     -------------
    */

    /*
     *
     * Row 3
     *
     */

    pivot = sc_to_bb_matrix[1];

    // sc-row-3 = sc-row-3 - bb-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[1] = 0;
#endif

    sc_g_matrix[2] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

       sc              bb            g
     1 2 3 4       1 2 3 4 5 6
    ---------     -------------
    |1 x    |     |           |     |x|  1
    |0 1 x x|     |      x    |     |x|  2
    |  0 1 x| ... |      0    | ... |M|  3 sc
    |  0 0 1|     |      0    |     |M|  4
    ---------     -------------
        .               .
        .               .
        .               .
    ---------     -------------
    |       |     |1 0        |     |x|  1
    |       |     |0 1 0 0 0  |     |x|  2
    |       |     |  0 1 0 0  |     |x|  3
    |  0 0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |       |     |  0 0 0 1 0|     |x|  5
    |       |     |        0 1|     |x|  6
    ---------     -------------
    */

    /*
     *
     * Row 2
     *
     */

    pivot = sc_to_bb_matrix[0];

    // sc-row-2 = sc-row-2 - bb-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[0] = 0;
#endif

    sc_g_matrix[1] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

       sc              bb            g
     1 2 3 4       1 2 3 4 5 6
    ---------     -------------
    |1 x    |     |           |     |x|  1
    |0 1 x x|     |      0    |     |M|  2
    |  0 1 x| ... |      0    | ... |M|  3 sc
    |  0 0 1|     |      0    |     |M|  4
    ---------     -------------
        .               .
        .               .
        .               .
    ---------     -------------
    |       |     |1 0        |     |x|  1
    |       |     |0 1 0 0 0  |     |x|  2
    |       |     |  0 1 0 0  |     |x|  3
    |  0 0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |       |     |  0 0 0 1 0|     |x|  5
    |       |     |        0 1|     |x|  6
    ---------     -------------
    */
}

void gmx::IlvesPC::solve_16_methionine(real *const sc_to_bb_matrix,
                                       real *const sc_g_matrix,
                                       __attribute__((unused))
                                       real *const sc_to_bb_fillins,
                                       real *const bb_g_matrix) {
    /*
     *
     * Row 10
     *
     */

    real pivot = sc_to_bb_matrix[2];

    // sc-row-10 = sc-row-10 - bb-row-14 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[2] = 0;
#endif

    sc_g_matrix[9] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 x x x            |     |           |     |x|  1
    |0 1 x x            |     |           |     |x|  2
    |0 0 1 x            |     |           |     |x|  3
    |0 0 0 1 x          |     |           |     |x|  4
    |      0 1 x x x    |     |           |     |x|  5
    |        0 1 x x    | ... |           | ... |x|  6 sc
    |        0 0 1 x    |     |           |     |x|  7
    |        0 0 0 1 x x|     |      x    |     |x|  8
    |              0 1 x|     |      x    |     |x|  9
    |              0 0 1|     |      0    |     |M| 10
    ---------------------     -------------
              .                     .
              .                     .
              .                     .
    ---------------------     -------------
    |                   |     |1 0        |     |x|  1
    |                   |     |0 1 0 0 0  |     |x|  2
    |                   |     |  0 1 0 0  |     |x|  3
    |              0 0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |                   |     |  0 0 0 1 0|     |x|  5
    |                   |     |        0 1|     |x|  6
    ---------------------     -------------
    */

    /*
     *
     * Row 9
     *
     */

    pivot = sc_to_bb_matrix[1];

    // sc-row-9 = sc-row-9 - bb-row-14 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[1] = 0;
#endif

    sc_g_matrix[8] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 x x x            |     |           |     |x|  1
    |0 1 x x            |     |           |     |x|  2
    |0 0 1 x            |     |           |     |x|  3
    |0 0 0 1 x          |     |           |     |x|  4
    |      0 1 x x x    |     |           |     |x|  5
    |        0 1 x x    | ... |           | ... |x|  6 sc
    |        0 0 1 x    |     |           |     |x|  7
    |        0 0 0 1 x x|     |      x    |     |x|  8
    |              0 1 x|     |      0    |     |M|  9
    |              0 0 1|     |      0    |     |M| 10
    ---------------------     -------------
              .                     .
              .                     .
              .                     .
    ---------------------     -------------
    |                   |     |1 0        |     |x|  1
    |                   |     |0 1 0 0 0  |     |x|  2
    |                   |     |  0 1 0 0  |     |x|  3
    |              0 0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |                   |     |  0 0 0 1 0|     |x|  5
    |                   |     |        0 1|     |x|  6
    ---------------------     -------------
    */

    /*
     *
     * Row 8
     *
     */

    pivot = sc_to_bb_matrix[0];

    // sc-row-8 = sc-row-8 - bb-row-14 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[0] = 0;
#endif

    sc_g_matrix[7] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 x x x            |     |           |     |x|  1
    |0 1 x x            |     |           |     |x|  2
    |0 0 1 x            |     |           |     |x|  3
    |0 0 0 1 x          |     |           |     |x|  4
    |      0 1 x x x    |     |           |     |x|  5
    |        0 1 x x    | ... |           | ... |x|  6 sc
    |        0 0 1 x    |     |           |     |x|  7
    |        0 0 0 1 x x|     |      0    |     |M|  8
    |              0 1 x|     |      0    |     |M|  9
    |              0 0 1|     |      0    |     |M| 10
    ---------------------     -------------
              .                     .
              .                     .
              .                     .
    ---------------------     -------------
    |                   |     |1 0        |     |x|  1
    |                   |     |0 1 0 0 0  |     |x|  2
    |                   |     |  0 1 0 0  |     |x|  3
    |              0 0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |                   |     |  0 0 0 1 0|     |x|  5
    |                   |     |        0 1|     |x|  6
    ---------------------     -------------
    */
}

void gmx::IlvesPC::solve_16_alaline(real *const sc_to_bb_matrix,
                                    real *const sc_g_matrix,
                                    __attribute__((unused))
                                    real *const sc_to_bb_fillins,
                                    real *const bb_g_matrix) {
    /*
     *
     * Row 3
     *
     */

    real pivot = sc_to_bb_matrix[2];

    // sc-row-3 = sc-row-3 - bb-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[2] = 0;
#endif

    sc_g_matrix[2] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

      sc             bb            g
     1 2 3       1 2 3 4 5 6
    -------     -------------
    |1 x x|     |      x    |     |x|  1
    |0 1 x| ... |      x    | ... |x|  2 sc
    |0 0 1|     |      0    |     |M|  3
    -------     -------------
       .              .
       .              .
       .              .
    -------     -------------
    |     |     |1 0        |     |x|  1
    |     |     |0 1 0 0 0  |     |x|  2
    |     |     |  0 1 0 0  |     |x|  3
    |0 0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |     |     |  0 0 0 1 0|     |x|  5
    |     |     |        0 1|     |x|  6
    -------     -------------
    */

    /*
     *
     * Row 2
     *
     */

    pivot = sc_to_bb_matrix[1];

    // sc-row-2 = sc-row-2 - bb-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[1] = 0;
#endif

    sc_g_matrix[1] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

      sc             bb            g
     1 2 3       1 2 3 4 5 6
    -------     -------------
    |1 x x|     |      x    |     |x|  1
    |0 1 x| ... |      0    | ... |M|  2 sc
    |0 0 1|     |      0    |     |M|  3
    -------     -------------
       .              .
       .              .
       .              .
    -------     -------------
    |     |     |1 0        |     |x|  1
    |     |     |0 1 0 0 0  |     |x|  2
    |     |     |  0 1 0 0  |     |x|  3
    |0 0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |     |     |  0 0 0 1 0|     |x|  5
    |     |     |        0 1|     |x|  6
    -------     -------------
    */

    /*
     *
     * Row 1
     *
     */

    pivot = sc_to_bb_matrix[0];

    // sc-row-1 = sc-row-1 - bb-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[0] = 0;
#endif

    sc_g_matrix[0] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

      sc             bb            g
     1 2 3       1 2 3 4 5 6
    -------     -------------
    |1 x x|     |      0    |     |M|  1
    |0 1 x| ... |      0    | ... |M|  2 sc
    |0 0 1|     |      0    |     |M|  3
    -------     -------------
       .              .
       .              .
       .              .
    -------     -------------
    |     |     |1 0        |     |x|  1
    |     |     |0 1 0 0 0  |     |x|  2
    |     |     |  0 1 0 0  |     |x|  3
    |0 0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |     |     |  0 0 0 1 0|     |x|  5
    |     |     |        0 1|     |x|  6
    -------     -------------
    */
}

void gmx::IlvesPC::solve_16_valine(real *const sc_to_bb_matrix,
                                   real *const sc_g_matrix,
                                   __attribute__((unused))
                                   real *const sc_to_bb_fillins,
                                   real *const bb_g_matrix) {
    /*
     *
     * Row 9
     *
     */

    real pivot = sc_to_bb_matrix[2];

    // sc-row-9 = sc-row-9 - bb-row-13 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[2] = 0;
#endif

    sc_g_matrix[8] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

            sc                   bb            g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5 6
    -------------------     -------------
    |1 x x x          |     |           |     |x|  1
    |0 1 x x          |     |           |     |x|  2
    |0 0 1 x          |     |           |     |x|  3
    |0 0 0 1       x x|     |      x    |     |x|  4
    |        1 x x x  | ... |           | ... |x|  5 sc
    |        0 1 x x  |     |           |     |x|  6
    |        0 0 1 x  |     |           |     |x|  7
    |      0 0 0 0 1 x|     |      x    |     |x|  8
    |      0       0 1|     |      0    |     |M|  9
    -------------------     -------------
             .                    .
             .                    .
             .                    .
    -------------------     -------------
    |                 |     |1 0        |     |x|  1
    |                 |     |0 1 0 0 0  |     |x|  2
    |                 |     |  0 1 0 0  |     |x|  3
    |      0       0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |                 |     |  0 0 0 1 0|     |x|  5
    |                 |     |        0 1|     |x|  6
    -------------------     -------------
    */

    /*
     *
     * Row 8
     *
     */

    pivot = sc_to_bb_matrix[1];

    // sc-row-8 = sc-row-8 - bb-row-13 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[1] = 0;
#endif

    sc_g_matrix[7] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

            sc                   bb            g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5 6
    -------------------     -------------
    |1 x x x          |     |           |     |x|  1
    |0 1 x x          |     |           |     |x|  2
    |0 0 1 x          |     |           |     |x|  3
    |0 0 0 1       x x|     |      x    |     |x|  4
    |        1 x x x  | ... |           | ... |x|  5 sc
    |        0 1 x x  |     |           |     |x|  6
    |        0 0 1 x  |     |           |     |x|  7
    |      0 0 0 0 1 x|     |      0    |     |M|  8
    |      0       0 1|     |      0    |     |M|  9
    -------------------     -------------
             .                    .
             .                    .
             .                    .
    -------------------     -------------
    |                 |     |1 0        |     |x|  1
    |                 |     |0 1 0 0 0  |     |x|  2
    |                 |     |  0 1 0 0  |     |x|  3
    |      0       0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |                 |     |  0 0 0 1 0|     |x|  5
    |                 |     |        0 1|     |x|  6
    -------------------     -------------
    */

    /*
     *
     * Row 4
     *
     */

    pivot = sc_to_bb_matrix[0];

    // sc-row-4 = sc-row-4 - bb-row-13 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[0] = 0;
#endif

    sc_g_matrix[3] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

            sc                   bb            g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5 6
    -------------------     -------------
    |1 x x x          |     |           |     |x|  1
    |0 1 x x          |     |           |     |x|  2
    |0 0 1 x          |     |           |     |x|  3
    |0 0 0 1       x x|     |      0    |     |M|  4
    |        1 x x x  | ... |           | ... |x|  5 sc
    |        0 1 x x  |     |           |     |x|  6
    |        0 0 1 x  |     |           |     |x|  7
    |      0 0 0 0 1 x|     |      0    |     |M|  8
    |      0       0 1|     |      0    |     |M|  9
    -------------------     -------------
             .                    .
             .                    .
             .                    .
    -------------------     -------------
    |                 |     |1 0        |     |x|  1
    |                 |     |0 1 0 0 0  |     |x|  2
    |                 |     |  0 1 0 0  |     |x|  3
    |      0       0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |                 |     |  0 0 0 1 0|     |x|  5
    |                 |     |        0 1|     |x|  6
    -------------------     -------------
    */
}

void gmx::IlvesPC::solve_16_leucine(real *const sc_to_bb_matrix,
                                    real *const sc_g_matrix,
                                    __attribute__((unused))
                                    real *const sc_to_bb_fillins,
                                    real *const bb_g_matrix) {
    /*
     *
     * Row 12
     *
     */

    real pivot = sc_to_bb_matrix[2];

    // sc-row-12 = sc-row-12 - bb-row-16 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[2] = 0;
#endif

    sc_g_matrix[11] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x x x                |     |           |     |x|  1
    |0 1 x x                |     |           |     |x|  2
    |0 0 1 x                |     |           |     |x|  3
    |0 0 0 1       x x x    |     |           |     |x|  4
    |        1 x x x        |     |           |     |x|  5
    |        0 1 x x        |     |           |     |x|  6
    |        0 0 1 x        | ... |           | ... |x|  7 sc
    |      0 0 0 0 1 x x    |     |           |     |x|  8
    |      0       0 1 x    |     |           |     |x|  9
    |      0       0 0 1 x x|     |      x    |     |x| 10
    |                  0 1 x|     |      x    |     |x| 11
    |                  0 0 1|     |      0    |     |M| 12
    -------------------------     -------------
                .                       .
                .                       .
                .                       .
    -------------------------     -------------
    |                       |     |1 0        |     |x|  1
    |                       |     |0 1 0 0 0  |     |x|  2
    |                       |     |  0 1 0 0  |     |x|  3
    |                  0 0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |                       |     |  0 0 0 1 0|     |x|  5
    |                       |     |        0 1|     |x|  6
    -------------------------     -------------
    */

    /*
     *
     * Row 11
     *
     */

    pivot = sc_to_bb_matrix[1];

    // sc-row-11 = sc-row-11 - bb-row-16 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[1] = 0;
#endif

    sc_g_matrix[10] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x x x                |     |           |     |x|  1
    |0 1 x x                |     |           |     |x|  2
    |0 0 1 x                |     |           |     |x|  3
    |0 0 0 1       x x x    |     |           |     |x|  4
    |        1 x x x        |     |           |     |x|  5
    |        0 1 x x        |     |           |     |x|  6
    |        0 0 1 x        | ... |           | ... |x|  7 sc
    |      0 0 0 0 1 x x    |     |           |     |x|  8
    |      0       0 1 x    |     |           |     |x|  9
    |      0       0 0 1 x x|     |      x    |     |x| 10
    |                  0 1 x|     |      0    |     |M| 11
    |                  0 0 1|     |      0    |     |M| 12
    -------------------------     -------------
                .                       .
                .                       .
                .                       .
    -------------------------     -------------
    |                       |     |1 0        |     |x|  1
    |                       |     |0 1 0 0 0  |     |x|  2
    |                       |     |  0 1 0 0  |     |x|  3
    |                  0 0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |                       |     |  0 0 0 1 0|     |x|  5
    |                       |     |        0 1|     |x|  6
    -------------------------     -------------
    */

    /*
     *
     * Row 10
     *
     */

    pivot = sc_to_bb_matrix[0];

    // sc-row-10 = sc-row-10 - bb-row-16 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[0] = 0;
#endif

    sc_g_matrix[9] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x x x                |     |           |     |x|  1
    |0 1 x x                |     |           |     |x|  2
    |0 0 1 x                |     |           |     |x|  3
    |0 0 0 1       x x x    |     |           |     |x|  4
    |        1 x x x        |     |           |     |x|  5
    |        0 1 x x        |     |           |     |x|  6
    |        0 0 1 x        | ... |           | ... |x|  7 sc
    |      0 0 0 0 1 x x    |     |           |     |x|  8
    |      0       0 1 x    |     |           |     |x|  9
    |      0       0 0 1 x x|     |      0    |     |M| 10
    |                  0 1 x|     |      0    |     |M| 11
    |                  0 0 1|     |      0    |     |M| 12
    -------------------------     -------------
                .                       .
                .                       .
                .                       .
    -------------------------     -------------
    |                       |     |1 0        |     |x|  1
    |                       |     |0 1 0 0 0  |     |x|  2
    |                       |     |  0 1 0 0  |     |x|  3
    |                  0 0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |                       |     |  0 0 0 1 0|     |x|  5
    |                       |     |        0 1|     |x|  6
    -------------------------     -------------
    */
}

void gmx::IlvesPC::solve_16_isoleucine(real *const sc_to_bb_matrix,
                                       real *const sc_g_matrix,
                                       __attribute__((unused))
                                       real *const sc_to_bb_fillins,
                                       real *const bb_g_matrix) {
    /*
     *
     * Row 12
     *
     */

    real pivot = sc_to_bb_matrix[2];

    // sc-row-12 = sc-row-12 - bb-row-16 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[2] = 0;
#endif

    sc_g_matrix[11] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x x x                |     |           |     |x|  1
    |0 1 x x                |     |           |     |x|  2
    |0 0 1 x                |     |           |     |x|  3
    |0 0 0 1 x x x          |     |           |     |x|  4
    |      0 1 x x          |     |           |     |x|  5
    |      0 0 1 x          |     |           |     |x|  6
    |      0 0 0 1       x x| ... |      x    | ... |x|  7 sc
    |              1 x x x  |     |           |     |x|  8
    |              0 1 x x  |     |           |     |x|  9
    |              0 0 1 x  |     |           |     |x| 10
    |            0 0 0 0 1 x|     |      x    |     |x| 11
    |            0       0 1|     |      0    |     |M| 12
    -------------------------     -------------
                .                       .
                .                       .
                .                       .
    -------------------------     -------------
    |                       |     |1 0        |     |x|  1
    |                       |     |0 1 0 0 0  |     |x|  2
    |                       |     |  0 1 0 0  |     |x|  3
    |            0       0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |                       |     |  0 0 0 1 0|     |x|  5
    |                       |     |        0 1|     |x|  6
    -------------------------     -------------
    */

    /*
     *
     * Row 11
     *
     */

    pivot = sc_to_bb_matrix[1];

    // sc-row-11 = sc-row-11 - bb-row-16 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[1] = 0;
#endif

    sc_g_matrix[10] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x x x                |     |           |     |x|  1
    |0 1 x x                |     |           |     |x|  2
    |0 0 1 x                |     |           |     |x|  3
    |0 0 0 1 x x x          |     |           |     |x|  4
    |      0 1 x x          |     |           |     |x|  5
    |      0 0 1 x          |     |           |     |x|  6
    |      0 0 0 1       x x| ... |      x    | ... |x|  7 sc
    |              1 x x x  |     |           |     |x|  8
    |              0 1 x x  |     |           |     |x|  9
    |              0 0 1 x  |     |           |     |x| 10
    |            0 0 0 0 1 x|     |      0    |     |M| 11
    |            0       0 1|     |      0    |     |M| 12
    -------------------------     -------------
                .                       .
                .                       .
                .                       .
    -------------------------     -------------
    |                       |     |1 0        |     |x|  1
    |                       |     |0 1 0 0 0  |     |x|  2
    |                       |     |  0 1 0 0  |     |x|  3
    |            0       0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |                       |     |  0 0 0 1 0|     |x|  5
    |                       |     |        0 1|     |x|  6
    -------------------------     -------------
    */

    /*
     *
     * Row 7
     *
     */

    pivot = sc_to_bb_matrix[0];

    // sc-row-7 = sc-row-7 - bb-row-16 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[0] = 0;
#endif

    sc_g_matrix[6] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x x x                |     |           |     |x|  1
    |0 1 x x                |     |           |     |x|  2
    |0 0 1 x                |     |           |     |x|  3
    |0 0 0 1 x x x          |     |           |     |x|  4
    |      0 1 x x          |     |           |     |x|  5
    |      0 0 1 x          |     |           |     |x|  6
    |      0 0 0 1       x x| ... |      0    | ... |M|  7 sc
    |              1 x x x  |     |           |     |x|  8
    |              0 1 x x  |     |           |     |x|  9
    |              0 0 1 x  |     |           |     |x| 10
    |            0 0 0 0 1 x|     |      0    |     |M| 11
    |            0       0 1|     |      0    |     |M| 12
    -------------------------     -------------
                .                       .
                .                       .
                .                       .
    -------------------------     -------------
    |                       |     |1 0        |     |x|  1
    |                       |     |0 1 0 0 0  |     |x|  2
    |                       |     |  0 1 0 0  |     |x|  3
    |            0       0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |                       |     |  0 0 0 1 0|     |x|  5
    |                       |     |        0 1|     |x|  6
    -------------------------     -------------
    */
}

void gmx::IlvesPC::solve_16_aspartic_acid(real *const sc_to_bb_matrix,
                                          real *const sc_g_matrix,
                                          __attribute__((unused))
                                          real *const sc_to_bb_fillins,
                                          real *const bb_g_matrix) {
    /*
     *
     * Row 5
     *
     */

    real pivot = sc_to_bb_matrix[2];

    // sc-row-5 = sc-row-5 - bb-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[2] = 0;
#endif

    sc_g_matrix[4] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

        sc               bb            g
     1 2 3 4 5       1 2 3 4 5 6
    -----------     -------------
    |1 x x    |     |           |     |x|  1
    |0 1 x    |     |           |     |x|  2
    |0 0 1 x x| ... |      x    | ... |x|  3 sc
    |    0 1 x|     |      x    |     |x|  4
    |    0 0 1|     |      0    |     |M|  5
    -----------     -------------
         .                .
         .                .
         .                .
    -----------     -------------
    |         |     |1 0        |     |x|  1
    |         |     |0 1 0 0 0  |     |x|  2
    |         |     |  0 1 0 0  |     |x|  3
    |    0 0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |         |     |  0 0 0 1 0|     |x|  5
    |         |     |        0 1|     |x|  6
    -----------     -------------
    */

    /*
     *
     * Row 4
     *
     */

    pivot = sc_to_bb_matrix[1];

    // sc-row-4 = sc-row-4 - bb-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[1] = 0;
#endif

    sc_g_matrix[3] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

        sc               bb            g
     1 2 3 4 5       1 2 3 4 5 6
    -----------     -------------
    |1 x x    |     |           |     |x|  1
    |0 1 x    |     |           |     |x|  2
    |0 0 1 x x| ... |      x    | ... |x|  3 sc
    |    0 1 x|     |      0    |     |M|  4
    |    0 0 1|     |      0    |     |M|  5
    -----------     -------------
         .                .
         .                .
         .                .
    -----------     -------------
    |         |     |1 0        |     |x|  1
    |         |     |0 1 0 0 0  |     |x|  2
    |         |     |  0 1 0 0  |     |x|  3
    |    0 0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |         |     |  0 0 0 1 0|     |x|  5
    |         |     |        0 1|     |x|  6
    -----------     -------------
    */

    /*
     *
     * Row 3
     *
     */

    pivot = sc_to_bb_matrix[0];

    // sc-row-3 = sc-row-3 - bb-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[0] = 0;
#endif

    sc_g_matrix[2] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

        sc               bb            g
     1 2 3 4 5       1 2 3 4 5 6
    -----------     -------------
    |1 x x    |     |           |     |x|  1
    |0 1 x    |     |           |     |x|  2
    |0 0 1 x x| ... |      0    | ... |M|  3 sc
    |    0 1 x|     |      0    |     |M|  4
    |    0 0 1|     |      0    |     |M|  5
    -----------     -------------
         .                .
         .                .
         .                .
    -----------     -------------
    |         |     |1 0        |     |x|  1
    |         |     |0 1 0 0 0  |     |x|  2
    |         |     |  0 1 0 0  |     |x|  3
    |    0 0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |         |     |  0 0 0 1 0|     |x|  5
    |         |     |        0 1|     |x|  6
    -----------     -------------
    */
}

void gmx::IlvesPC::solve_16_glutamic_acid(real *const sc_to_bb_matrix,
                                          real *const sc_g_matrix,
                                          __attribute__((unused))
                                          real *const sc_to_bb_fillins,
                                          real *const bb_g_matrix) {
    /*
     *
     * Row 8
     *
     */

    real pivot = sc_to_bb_matrix[2];

    // sc-row-8 = sc-row-8 - bb-row-12 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[2] = 0;
#endif

    sc_g_matrix[7] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

           sc                  bb            g
     1 2 3 4 5 6 7 8       1 2 3 4 5 6
    -----------------     -------------
    |1 x x          |     |           |     |x|  1
    |0 1 x          |     |           |     |x|  2
    |0 0 1 x x x    |     |           |     |x|  3
    |    0 1 x x    |     |           |     |x|  4
    |    0 0 1 x    | ... |           | ... |x|  5 sc
    |    0 0 0 1 x x|     |      x    |     |x|  6
    |          0 1 x|     |      x    |     |x|  7
    |          0 0 1|     |      0    |     |M|  8
    -----------------     -------------
            .                   .
            .                   .
            .                   .
    -----------------     -------------
    |               |     |1 0        |     |x|  1
    |               |     |0 1 0 0 0  |     |x|  2
    |               |     |  0 1 0 0  |     |x|  3
    |          0 0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |               |     |  0 0 0 1 0|     |x|  5
    |               |     |        0 1|     |x|  6
    -----------------     -------------
    */

    /*
     *
     * Row 7
     *
     */

    pivot = sc_to_bb_matrix[1];

    // sc-row-7 = sc-row-7 - bb-row-12 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[1] = 0;
#endif

    sc_g_matrix[6] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

           sc                  bb            g
     1 2 3 4 5 6 7 8       1 2 3 4 5 6
    -----------------     -------------
    |1 x x          |     |           |     |x|  1
    |0 1 x          |     |           |     |x|  2
    |0 0 1 x x x    |     |           |     |x|  3
    |    0 1 x x    |     |           |     |x|  4
    |    0 0 1 x    | ... |           | ... |x|  5 sc
    |    0 0 0 1 x x|     |      x    |     |x|  6
    |          0 1 x|     |      0    |     |M|  7
    |          0 0 1|     |      0    |     |M|  8
    -----------------     -------------
            .                   .
            .                   .
            .                   .
    -----------------     -------------
    |               |     |1 0        |     |x|  1
    |               |     |0 1 0 0 0  |     |x|  2
    |               |     |  0 1 0 0  |     |x|  3
    |          0 0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |               |     |  0 0 0 1 0|     |x|  5
    |               |     |        0 1|     |x|  6
    -----------------     -------------
    */

    /*
     *
     * Row 6
     *
     */

    pivot = sc_to_bb_matrix[0];

    // sc-row-6 = sc-row-6 - bb-row-12 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[0] = 0;
#endif

    sc_g_matrix[5] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

           sc                  bb            g
     1 2 3 4 5 6 7 8       1 2 3 4 5 6
    -----------------     -------------
    |1 x x          |     |           |     |x|  1
    |0 1 x          |     |           |     |x|  2
    |0 0 1 x x x    |     |           |     |x|  3
    |    0 1 x x    |     |           |     |x|  4
    |    0 0 1 x    | ... |           | ... |x|  5 sc
    |    0 0 0 1 x x|     |      0    |     |M|  6
    |          0 1 x|     |      0    |     |M|  7
    |          0 0 1|     |      0    |     |M|  8
    -----------------     -------------
            .                   .
            .                   .
            .                   .
    -----------------     -------------
    |               |     |1 0        |     |x|  1
    |               |     |0 1 0 0 0  |     |x|  2
    |               |     |  0 1 0 0  |     |x|  3
    |          0 0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |               |     |  0 0 0 1 0|     |x|  5
    |               |     |        0 1|     |x|  6
    -----------------     -------------
    */
}

void gmx::IlvesPC::solve_16_asparagine(real *const sc_to_bb_matrix,
                                       real *const sc_g_matrix,
                                       __attribute__((unused))
                                       real *const sc_to_bb_fillins,
                                       real *const bb_g_matrix) {
    /*
     *
     * Row 7
     *
     */

    real pivot = sc_to_bb_matrix[2];

    // sc-row-7 = sc-row-7 - bb-row-11 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[2] = 0;
#endif

    sc_g_matrix[6] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 x x        |     |           |     |x|  1
    |0 1 x        |     |           |     |x|  2
    |0 0 1 x x    |     |           |     |x|  3
    |    0 1 x    | ... |           | ... |x|  4 sc
    |    0 0 1 x x|     |      x    |     |x|  5
    |        0 1 x|     |      x    |     |x|  6
    |        0 0 1|     |      0    |     |M|  7
    ---------------     -------------
           .                  .
           .                  .
           .                  .
    ---------------     -------------
    |             |     |1 0        |     |x|  1
    |             |     |0 1 0 0 0  |     |x|  2
    |             |     |  0 1 0 0  |     |x|  3
    |        0 0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |             |     |  0 0 0 1 0|     |x|  5
    |             |     |        0 1|     |x|  6
    ---------------     -------------
    */

    /*
     *
     * Row 6
     *
     */

    pivot = sc_to_bb_matrix[1];

    // sc-row-6 = sc-row-6 - bb-row-11 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[1] = 0;
#endif

    sc_g_matrix[5] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 x x        |     |           |     |x|  1
    |0 1 x        |     |           |     |x|  2
    |0 0 1 x x    |     |           |     |x|  3
    |    0 1 x    | ... |           | ... |x|  4 sc
    |    0 0 1 x x|     |      x    |     |x|  5
    |        0 1 x|     |      0    |     |M|  6
    |        0 0 1|     |      0    |     |M|  7
    ---------------     -------------
           .                  .
           .                  .
           .                  .
    ---------------     -------------
    |             |     |1 0        |     |x|  1
    |             |     |0 1 0 0 0  |     |x|  2
    |             |     |  0 1 0 0  |     |x|  3
    |        0 0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |             |     |  0 0 0 1 0|     |x|  5
    |             |     |        0 1|     |x|  6
    ---------------     -------------
    */

    /*
     *
     * Row 5
     *
     */

    pivot = sc_to_bb_matrix[0];

    // sc-row-5 = sc-row-5 - bb-row-11 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[0] = 0;
#endif

    sc_g_matrix[4] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 x x        |     |           |     |x|  1
    |0 1 x        |     |           |     |x|  2
    |0 0 1 x x    |     |           |     |x|  3
    |    0 1 x    | ... |           | ... |x|  4 sc
    |    0 0 1 x x|     |      0    |     |M|  5
    |        0 1 x|     |      0    |     |M|  6
    |        0 0 1|     |      0    |     |M|  7
    ---------------     -------------
           .                  .
           .                  .
           .                  .
    ---------------     -------------
    |             |     |1 0        |     |x|  1
    |             |     |0 1 0 0 0  |     |x|  2
    |             |     |  0 1 0 0  |     |x|  3
    |        0 0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |             |     |  0 0 0 1 0|     |x|  5
    |             |     |        0 1|     |x|  6
    ---------------     -------------
    */
}

void gmx::IlvesPC::solve_16_glutamine(real *const sc_to_bb_matrix,
                                      real *const sc_g_matrix,
                                      __attribute__((unused))
                                      real *const sc_to_bb_fillins,
                                      real *const bb_g_matrix) {
    /*
     *
     * Row 10
     *
     */

    real pivot = sc_to_bb_matrix[2];

    // sc-row-10 = sc-row-10 - bb-row-14 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[2] = 0;
#endif

    sc_g_matrix[9] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 x x              |     |           |     |x|  1
    |0 1 x              |     |           |     |x|  2
    |0 0 1 x x          |     |           |     |x|  3
    |    0 1 x          |     |           |     |x|  4
    |    0 0 1 x x x    |     |           |     |x|  5
    |        0 1 x x    | ... |           | ... |x|  6 sc
    |        0 0 1 x    |     |           |     |x|  7
    |        0 0 0 1 x x|     |      x    |     |x|  8
    |              0 1 x|     |      x    |     |x|  9
    |              0 0 1|     |      0    |     |M| 10
    ---------------------     -------------
              .                     .
              .                     .
              .                     .
    ---------------------     -------------
    |                   |     |1 0        |     |x|  1
    |                   |     |0 1 0 0 0  |     |x|  2
    |                   |     |  0 1 0 0  |     |x|  3
    |              0 0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |                   |     |  0 0 0 1 0|     |x|  5
    |                   |     |        0 1|     |x|  6
    ---------------------     -------------
    */

    /*
     *
     * Row 9
     *
     */

    pivot = sc_to_bb_matrix[1];

    // sc-row-9 = sc-row-9 - bb-row-14 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[1] = 0;
#endif

    sc_g_matrix[8] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 x x              |     |           |     |x|  1
    |0 1 x              |     |           |     |x|  2
    |0 0 1 x x          |     |           |     |x|  3
    |    0 1 x          |     |           |     |x|  4
    |    0 0 1 x x x    |     |           |     |x|  5
    |        0 1 x x    | ... |           | ... |x|  6 sc
    |        0 0 1 x    |     |           |     |x|  7
    |        0 0 0 1 x x|     |      x    |     |x|  8
    |              0 1 x|     |      0    |     |M|  9
    |              0 0 1|     |      0    |     |M| 10
    ---------------------     -------------
              .                     .
              .                     .
              .                     .
    ---------------------     -------------
    |                   |     |1 0        |     |x|  1
    |                   |     |0 1 0 0 0  |     |x|  2
    |                   |     |  0 1 0 0  |     |x|  3
    |              0 0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |                   |     |  0 0 0 1 0|     |x|  5
    |                   |     |        0 1|     |x|  6
    ---------------------     -------------
    */

    /*
     *
     * Row 8
     *
     */

    pivot = sc_to_bb_matrix[0];

    // sc-row-8 = sc-row-8 - bb-row-14 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[0] = 0;
#endif

    sc_g_matrix[7] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 x x              |     |           |     |x|  1
    |0 1 x              |     |           |     |x|  2
    |0 0 1 x x          |     |           |     |x|  3
    |    0 1 x          |     |           |     |x|  4
    |    0 0 1 x x x    |     |           |     |x|  5
    |        0 1 x x    | ... |           | ... |x|  6 sc
    |        0 0 1 x    |     |           |     |x|  7
    |        0 0 0 1 x x|     |      0    |     |M|  8
    |              0 1 x|     |      0    |     |M|  9
    |              0 0 1|     |      0    |     |M| 10
    ---------------------     -------------
              .                     .
              .                     .
              .                     .
    ---------------------     -------------
    |                   |     |1 0        |     |x|  1
    |                   |     |0 1 0 0 0  |     |x|  2
    |                   |     |  0 1 0 0  |     |x|  3
    |              0 0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |                   |     |  0 0 0 1 0|     |x|  5
    |                   |     |        0 1|     |x|  6
    ---------------------     -------------
    */
}

void gmx::IlvesPC::solve_16_histidine(real *const sc_to_bb_matrix,
                                      real *const sc_g_matrix,
                                      __attribute__((unused))
                                      real *const sc_to_bb_fillins,
                                      real *const bb_g_matrix) {
    /*
     *
     * Row 11
     *
     */

    real pivot = sc_to_bb_matrix[2];

    // sc-row-11 = sc-row-11 - bb-row-15 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[2] = 0;
#endif

    sc_g_matrix[10] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   x   x            |     |           |     |x|  1
    |  1 x     x          |     |           |     |x|  2
    |0 0 1   x x          |     |           |     |x|  3
    |      1 x     x      |     |           |     |x|  4
    |0   0 0 1 f   x      |     |           |     |x|  5
    |  0 0   0 1 x f      | ... |           | ... |x|  6 sc
    |          0 1 x x    |     |           |     |x|  7
    |      0 0 0 0 1 x    |     |           |     |x|  8
    |            0 0 1 x x|     |      x    |     |x|  9
    |                0 1 x|     |      x    |     |x| 10
    |                0 0 1|     |      0    |     |M| 11
    -----------------------     -------------
               .                      .
               .                      .
               .                      .
    -----------------------     -------------
    |                     |     |1 0        |     |x|  1
    |                     |     |0 1 0 0 0  |     |x|  2
    |                     |     |  0 1 0 0  |     |x|  3
    |                0 0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |                     |     |  0 0 0 1 0|     |x|  5
    |                     |     |        0 1|     |x|  6
    -----------------------     -------------
    */

    /*
     *
     * Row 10
     *
     */

    pivot = sc_to_bb_matrix[1];

    // sc-row-10 = sc-row-10 - bb-row-15 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[1] = 0;
#endif

    sc_g_matrix[9] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   x   x            |     |           |     |x|  1
    |  1 x     x          |     |           |     |x|  2
    |0 0 1   x x          |     |           |     |x|  3
    |      1 x     x      |     |           |     |x|  4
    |0   0 0 1 f   x      |     |           |     |x|  5
    |  0 0   0 1 x f      | ... |           | ... |x|  6 sc
    |          0 1 x x    |     |           |     |x|  7
    |      0 0 0 0 1 x    |     |           |     |x|  8
    |            0 0 1 x x|     |      x    |     |x|  9
    |                0 1 x|     |      0    |     |M| 10
    |                0 0 1|     |      0    |     |M| 11
    -----------------------     -------------
               .                      .
               .                      .
               .                      .
    -----------------------     -------------
    |                     |     |1 0        |     |x|  1
    |                     |     |0 1 0 0 0  |     |x|  2
    |                     |     |  0 1 0 0  |     |x|  3
    |                0 0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |                     |     |  0 0 0 1 0|     |x|  5
    |                     |     |        0 1|     |x|  6
    -----------------------     -------------
    */

    /*
     *
     * Row 9
     *
     */

    pivot = sc_to_bb_matrix[0];

    // sc-row-9 = sc-row-9 - bb-row-15 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[0] = 0;
#endif

    sc_g_matrix[8] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   x   x            |     |           |     |x|  1
    |  1 x     x          |     |           |     |x|  2
    |0 0 1   x x          |     |           |     |x|  3
    |      1 x     x      |     |           |     |x|  4
    |0   0 0 1 f   x      |     |           |     |x|  5
    |  0 0   0 1 x f      | ... |           | ... |x|  6 sc
    |          0 1 x x    |     |           |     |x|  7
    |      0 0 0 0 1 x    |     |           |     |x|  8
    |            0 0 1 x x|     |      0    |     |M|  9
    |                0 1 x|     |      0    |     |M| 10
    |                0 0 1|     |      0    |     |M| 11
    -----------------------     -------------
               .                      .
               .                      .
               .                      .
    -----------------------     -------------
    |                     |     |1 0        |     |x|  1
    |                     |     |0 1 0 0 0  |     |x|  2
    |                     |     |  0 1 0 0  |     |x|  3
    |                0 0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |                     |     |  0 0 0 1 0|     |x|  5
    |                     |     |        0 1|     |x|  6
    -----------------------     -------------
    */
}

void gmx::IlvesPC::solve_16_lysine(real *const sc_to_bb_matrix,
                                   real *const sc_g_matrix,
                                   __attribute__((unused))
                                   real *const sc_to_bb_fillins,
                                   real *const bb_g_matrix) {
    /*
     *
     * Row 15
     *
     */

    real pivot = sc_to_bb_matrix[2];

    // sc-row-15 = sc-row-15 - bb-row-19 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[2] = 0;
#endif

    sc_g_matrix[14] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 x x x                      |     |           |     |x|  1
    |0 1 x x                      |     |           |     |x|  2
    |0 0 1 x                      |     |           |     |x|  3
    |0 0 0 1 x x x                |     |           |     |x|  4
    |      0 1 x x                |     |           |     |x|  5
    |      0 0 1 x                |     |           |     |x|  6
    |      0 0 0 1 x x x          |     |           |     |x|  7
    |            0 1 x x          | ... |           | ... |x|  8 sc
    |            0 0 1 x          |     |           |     |x|  9
    |            0 0 0 1 x x x    |     |           |     |x| 10
    |                  0 1 x x    |     |           |     |x| 11
    |                  0 0 1 x    |     |           |     |x| 12
    |                  0 0 0 1 x x|     |      x    |     |x| 13
    |                        0 1 x|     |      x    |     |x| 14
    |                        0 0 1|     |      0    |     |M| 15
    -------------------------------     -------------
                   .                          .
                   .                          .
                   .                          .
    -------------------------------     -------------
    |                             |     |1 0        |     |x|  1
    |                             |     |0 1 0 0 0  |     |x|  2
    |                             |     |  0 1 0 0  |     |x|  3
    |                        0 0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |                             |     |  0 0 0 1 0|     |x|  5
    |                             |     |        0 1|     |x|  6
    -------------------------------     -------------
    */

    /*
     *
     * Row 14
     *
     */

    pivot = sc_to_bb_matrix[1];

    // sc-row-14 = sc-row-14 - bb-row-19 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[1] = 0;
#endif

    sc_g_matrix[13] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 x x x                      |     |           |     |x|  1
    |0 1 x x                      |     |           |     |x|  2
    |0 0 1 x                      |     |           |     |x|  3
    |0 0 0 1 x x x                |     |           |     |x|  4
    |      0 1 x x                |     |           |     |x|  5
    |      0 0 1 x                |     |           |     |x|  6
    |      0 0 0 1 x x x          |     |           |     |x|  7
    |            0 1 x x          | ... |           | ... |x|  8 sc
    |            0 0 1 x          |     |           |     |x|  9
    |            0 0 0 1 x x x    |     |           |     |x| 10
    |                  0 1 x x    |     |           |     |x| 11
    |                  0 0 1 x    |     |           |     |x| 12
    |                  0 0 0 1 x x|     |      x    |     |x| 13
    |                        0 1 x|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |M| 15
    -------------------------------     -------------
                   .                          .
                   .                          .
                   .                          .
    -------------------------------     -------------
    |                             |     |1 0        |     |x|  1
    |                             |     |0 1 0 0 0  |     |x|  2
    |                             |     |  0 1 0 0  |     |x|  3
    |                        0 0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |                             |     |  0 0 0 1 0|     |x|  5
    |                             |     |        0 1|     |x|  6
    -------------------------------     -------------
    */

    /*
     *
     * Row 13
     *
     */

    pivot = sc_to_bb_matrix[0];

    // sc-row-13 = sc-row-13 - bb-row-19 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[0] = 0;
#endif

    sc_g_matrix[12] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 x x x                      |     |           |     |x|  1
    |0 1 x x                      |     |           |     |x|  2
    |0 0 1 x                      |     |           |     |x|  3
    |0 0 0 1 x x x                |     |           |     |x|  4
    |      0 1 x x                |     |           |     |x|  5
    |      0 0 1 x                |     |           |     |x|  6
    |      0 0 0 1 x x x          |     |           |     |x|  7
    |            0 1 x x          | ... |           | ... |x|  8 sc
    |            0 0 1 x          |     |           |     |x|  9
    |            0 0 0 1 x x x    |     |           |     |x| 10
    |                  0 1 x x    |     |           |     |x| 11
    |                  0 0 1 x    |     |           |     |x| 12
    |                  0 0 0 1 x x|     |      0    |     |M| 13
    |                        0 1 x|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |M| 15
    -------------------------------     -------------
                   .                          .
                   .                          .
                   .                          .
    -------------------------------     -------------
    |                             |     |1 0        |     |x|  1
    |                             |     |0 1 0 0 0  |     |x|  2
    |                             |     |  0 1 0 0  |     |x|  3
    |                        0 0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |                             |     |  0 0 0 1 0|     |x|  5
    |                             |     |        0 1|     |x|  6
    -------------------------------     -------------
    */
}

void gmx::IlvesPC::solve_16_arginine(real *const sc_to_bb_matrix,
                                     real *const sc_g_matrix,
                                     __attribute__((unused))
                                     real *const sc_to_bb_fillins,
                                     real *const bb_g_matrix) {
    /*
     *
     * Row 17
     *
     */

    real pivot = sc_to_bb_matrix[2];

    // sc-row-17 = sc-row-17 - bb-row-21 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[2] = 0;
#endif

    sc_g_matrix[16] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 x x                            |     |           |     |x|  1
    |0 1 x                            |     |           |     |x|  2
    |0 0 1     x x                    |     |           |     |x|  3
    |      1 x x                      |     |           |     |x|  4
    |      0 1 x                      |     |           |     |x|  5
    |    0 0 0 1 x                    |     |           |     |x|  6
    |    0     0 1 x x                |     |           |     |x|  7
    |            0 1 x                |     |           |     |x|  8
    |            0 0 1 x x x          | ... |           | ... |x|  9 sc
    |                0 1 x x          |     |           |     |x| 10
    |                0 0 1 x          |     |           |     |x| 11
    |                0 0 0 1 x x x    |     |           |     |x| 12
    |                      0 1 x x    |     |           |     |x| 13
    |                      0 0 1 x    |     |           |     |x| 14
    |                      0 0 0 1 x x|     |      x    |     |x| 15
    |                            0 1 x|     |      x    |     |x| 16
    |                            0 0 1|     |      0    |     |M| 17
    -----------------------------------     -------------
                     .                            .
                     .                            .
                     .                            .
    -----------------------------------     -------------
    |                                 |     |1 0        |     |x|  1
    |                                 |     |0 1 0 0 0  |     |x|  2
    |                                 |     |  0 1 0 0  |     |x|  3
    |                            0 0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |                                 |     |  0 0 0 1 0|     |x|  5
    |                                 |     |        0 1|     |x|  6
    -----------------------------------     -------------
    */

    /*
     *
     * Row 16
     *
     */

    pivot = sc_to_bb_matrix[1];

    // sc-row-16 = sc-row-16 - bb-row-21 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[1] = 0;
#endif

    sc_g_matrix[15] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 x x                            |     |           |     |x|  1
    |0 1 x                            |     |           |     |x|  2
    |0 0 1     x x                    |     |           |     |x|  3
    |      1 x x                      |     |           |     |x|  4
    |      0 1 x                      |     |           |     |x|  5
    |    0 0 0 1 x                    |     |           |     |x|  6
    |    0     0 1 x x                |     |           |     |x|  7
    |            0 1 x                |     |           |     |x|  8
    |            0 0 1 x x x          | ... |           | ... |x|  9 sc
    |                0 1 x x          |     |           |     |x| 10
    |                0 0 1 x          |     |           |     |x| 11
    |                0 0 0 1 x x x    |     |           |     |x| 12
    |                      0 1 x x    |     |           |     |x| 13
    |                      0 0 1 x    |     |           |     |x| 14
    |                      0 0 0 1 x x|     |      x    |     |x| 15
    |                            0 1 x|     |      0    |     |M| 16
    |                            0 0 1|     |      0    |     |M| 17
    -----------------------------------     -------------
                     .                            .
                     .                            .
                     .                            .
    -----------------------------------     -------------
    |                                 |     |1 0        |     |x|  1
    |                                 |     |0 1 0 0 0  |     |x|  2
    |                                 |     |  0 1 0 0  |     |x|  3
    |                            0 0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |                                 |     |  0 0 0 1 0|     |x|  5
    |                                 |     |        0 1|     |x|  6
    -----------------------------------     -------------
    */

    /*
     *
     * Row 15
     *
     */

    pivot = sc_to_bb_matrix[0];

    // sc-row-15 = sc-row-15 - bb-row-21 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[0] = 0;
#endif

    sc_g_matrix[14] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 x x                            |     |           |     |x|  1
    |0 1 x                            |     |           |     |x|  2
    |0 0 1     x x                    |     |           |     |x|  3
    |      1 x x                      |     |           |     |x|  4
    |      0 1 x                      |     |           |     |x|  5
    |    0 0 0 1 x                    |     |           |     |x|  6
    |    0     0 1 x x                |     |           |     |x|  7
    |            0 1 x                |     |           |     |x|  8
    |            0 0 1 x x x          | ... |           | ... |x|  9 sc
    |                0 1 x x          |     |           |     |x| 10
    |                0 0 1 x          |     |           |     |x| 11
    |                0 0 0 1 x x x    |     |           |     |x| 12
    |                      0 1 x x    |     |           |     |x| 13
    |                      0 0 1 x    |     |           |     |x| 14
    |                      0 0 0 1 x x|     |      0    |     |M| 15
    |                            0 1 x|     |      0    |     |M| 16
    |                            0 0 1|     |      0    |     |M| 17
    -----------------------------------     -------------
                     .                            .
                     .                            .
                     .                            .
    -----------------------------------     -------------
    |                                 |     |1 0        |     |x|  1
    |                                 |     |0 1 0 0 0  |     |x|  2
    |                                 |     |  0 1 0 0  |     |x|  3
    |                            0 0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |                                 |     |  0 0 0 1 0|     |x|  5
    |                                 |     |        0 1|     |x|  6
    -----------------------------------     -------------
    */
}

void gmx::IlvesPC::solve_16_serine(real *const sc_to_bb_matrix,
                                   real *const sc_g_matrix,
                                   __attribute__((unused))
                                   real *const sc_to_bb_fillins,
                                   real *const bb_g_matrix) {
    /*
     *
     * Row 4
     *
     */

    real pivot = sc_to_bb_matrix[2];

    // sc-row-4 = sc-row-4 - bb-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[2] = 0;
#endif

    sc_g_matrix[3] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

       sc              bb            g
     1 2 3 4       1 2 3 4 5 6
    ---------     -------------
    |1 x    |     |           |     |x|  1
    |0 1 x x|     |      x    |     |x|  2
    |  0 1 x| ... |      x    | ... |x|  3 sc
    |  0 0 1|     |      0    |     |M|  4
    ---------     -------------
        .               .
        .               .
        .               .
    ---------     -------------
    |       |     |1 0        |     |x|  1
    |       |     |0 1 0 0 0  |     |x|  2
    |       |     |  0 1 0 0  |     |x|  3
    |  0 0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |       |     |  0 0 0 1 0|     |x|  5
    |       |     |        0 1|     |x|  6
    ---------     -------------
    */

    /*
     *
     * Row 3
     *
     */

    pivot = sc_to_bb_matrix[1];

    // sc-row-3 = sc-row-3 - bb-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[1] = 0;
#endif

    sc_g_matrix[2] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

       sc              bb            g
     1 2 3 4       1 2 3 4 5 6
    ---------     -------------
    |1 x    |     |           |     |x|  1
    |0 1 x x|     |      x    |     |x|  2
    |  0 1 x| ... |      0    | ... |M|  3 sc
    |  0 0 1|     |      0    |     |M|  4
    ---------     -------------
        .               .
        .               .
        .               .
    ---------     -------------
    |       |     |1 0        |     |x|  1
    |       |     |0 1 0 0 0  |     |x|  2
    |       |     |  0 1 0 0  |     |x|  3
    |  0 0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |       |     |  0 0 0 1 0|     |x|  5
    |       |     |        0 1|     |x|  6
    ---------     -------------
    */

    /*
     *
     * Row 2
     *
     */

    pivot = sc_to_bb_matrix[0];

    // sc-row-2 = sc-row-2 - bb-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[0] = 0;
#endif

    sc_g_matrix[1] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

       sc              bb            g
     1 2 3 4       1 2 3 4 5 6
    ---------     -------------
    |1 x    |     |           |     |x|  1
    |0 1 x x|     |      0    |     |M|  2
    |  0 1 x| ... |      0    | ... |M|  3 sc
    |  0 0 1|     |      0    |     |M|  4
    ---------     -------------
        .               .
        .               .
        .               .
    ---------     -------------
    |       |     |1 0        |     |x|  1
    |       |     |0 1 0 0 0  |     |x|  2
    |       |     |  0 1 0 0  |     |x|  3
    |  0 0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |       |     |  0 0 0 1 0|     |x|  5
    |       |     |        0 1|     |x|  6
    ---------     -------------
    */
}

void gmx::IlvesPC::solve_16_phenylaline(real *const sc_to_bb_matrix,
                                        real *const sc_g_matrix,
                                        __attribute__((unused))
                                        real *const sc_to_bb_fillins,
                                        real *const bb_g_matrix) {
    /*
     *
     * Row 14
     *
     */

    real pivot = sc_to_bb_matrix[2];

    // sc-row-14 = sc-row-14 - bb-row-18 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[2] = 0;
#endif

    sc_g_matrix[13] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   x             x        |     |           |     |x|  1
    |  1 x   x                  |     |           |     |x|  2
    |0 0 1   x         x        |     |           |     |x|  3
    |      1 x   x              |     |           |     |x|  4
    |  0 0 0 1   x     f        |     |           |     |x|  5
    |          1 x   x          |     |           |     |x|  6
    |      0 0 0 1   x f        |     |           |     |x|  7
    |              1 x   x      | ... |           | ... |x|  8 sc
    |          0 0 0 1 f x      |     |           |     |x|  9
    |0   0   0   0   0 1 x x    |     |           |     |x| 10
    |              0 0 0 1 x    |     |           |     |x| 11
    |                  0 0 1 x x|     |      x    |     |x| 12
    |                      0 1 x|     |      x    |     |x| 13
    |                      0 0 1|     |      0    |     |M| 14
    -----------------------------     -------------
                  .                         .
                  .                         .
                  .                         .
    -----------------------------     -------------
    |                           |     |1 0        |     |x|  1
    |                           |     |0 1 0 0 0  |     |x|  2
    |                           |     |  0 1 0 0  |     |x|  3
    |                      0 0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |                           |     |  0 0 0 1 0|     |x|  5
    |                           |     |        0 1|     |x|  6
    -----------------------------     -------------
    */

    /*
     *
     * Row 13
     *
     */

    pivot = sc_to_bb_matrix[1];

    // sc-row-13 = sc-row-13 - bb-row-18 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[1] = 0;
#endif

    sc_g_matrix[12] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   x             x        |     |           |     |x|  1
    |  1 x   x                  |     |           |     |x|  2
    |0 0 1   x         x        |     |           |     |x|  3
    |      1 x   x              |     |           |     |x|  4
    |  0 0 0 1   x     f        |     |           |     |x|  5
    |          1 x   x          |     |           |     |x|  6
    |      0 0 0 1   x f        |     |           |     |x|  7
    |              1 x   x      | ... |           | ... |x|  8 sc
    |          0 0 0 1 f x      |     |           |     |x|  9
    |0   0   0   0   0 1 x x    |     |           |     |x| 10
    |              0 0 0 1 x    |     |           |     |x| 11
    |                  0 0 1 x x|     |      x    |     |x| 12
    |                      0 1 x|     |      0    |     |M| 13
    |                      0 0 1|     |      0    |     |M| 14
    -----------------------------     -------------
                  .                         .
                  .                         .
                  .                         .
    -----------------------------     -------------
    |                           |     |1 0        |     |x|  1
    |                           |     |0 1 0 0 0  |     |x|  2
    |                           |     |  0 1 0 0  |     |x|  3
    |                      0 0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |                           |     |  0 0 0 1 0|     |x|  5
    |                           |     |        0 1|     |x|  6
    -----------------------------     -------------
    */

    /*
     *
     * Row 12
     *
     */

    pivot = sc_to_bb_matrix[0];

    // sc-row-12 = sc-row-12 - bb-row-18 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[0] = 0;
#endif

    sc_g_matrix[11] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   x             x        |     |           |     |x|  1
    |  1 x   x                  |     |           |     |x|  2
    |0 0 1   x         x        |     |           |     |x|  3
    |      1 x   x              |     |           |     |x|  4
    |  0 0 0 1   x     f        |     |           |     |x|  5
    |          1 x   x          |     |           |     |x|  6
    |      0 0 0 1   x f        |     |           |     |x|  7
    |              1 x   x      | ... |           | ... |x|  8 sc
    |          0 0 0 1 f x      |     |           |     |x|  9
    |0   0   0   0   0 1 x x    |     |           |     |x| 10
    |              0 0 0 1 x    |     |           |     |x| 11
    |                  0 0 1 x x|     |      0    |     |M| 12
    |                      0 1 x|     |      0    |     |M| 13
    |                      0 0 1|     |      0    |     |M| 14
    -----------------------------     -------------
                  .                         .
                  .                         .
                  .                         .
    -----------------------------     -------------
    |                           |     |1 0        |     |x|  1
    |                           |     |0 1 0 0 0  |     |x|  2
    |                           |     |  0 1 0 0  |     |x|  3
    |                      0 0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |                           |     |  0 0 0 1 0|     |x|  5
    |                           |     |        0 1|     |x|  6
    -----------------------------     -------------
    */
}

void gmx::IlvesPC::solve_16_tyrosine(real *const sc_to_bb_matrix,
                                     real *const sc_g_matrix,
                                     __attribute__((unused))
                                     real *const sc_to_bb_fillins,
                                     real *const bb_g_matrix) {
    /*
     *
     * Row 15
     *
     */

    real pivot = sc_to_bb_matrix[2];

    // sc-row-15 = sc-row-15 - bb-row-19 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[2] = 0;
#endif

    sc_g_matrix[14] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       x                    |     |           |     |x|  1
    |  1   x             x        |     |           |     |x|  2
    |    1 x   x                  |     |           |     |x|  3
    |  0 0 1   x         x        |     |           |     |x|  4
    |0       1 x   x              |     |           |     |x|  5
    |    0 0 0 1   x     f        |     |           |     |x|  6
    |            1 x   x          |     |           |     |x|  7
    |        0 0 0 1   x f        | ... |           | ... |x|  8 sc
    |                1 x   x      |     |           |     |x|  9
    |            0 0 0 1 f x      |     |           |     |x| 10
    |  0   0   0   0   0 1 x x    |     |           |     |x| 11
    |                0 0 0 1 x    |     |           |     |x| 12
    |                    0 0 1 x x|     |      x    |     |x| 13
    |                        0 1 x|     |      x    |     |x| 14
    |                        0 0 1|     |      0    |     |M| 15
    -------------------------------     -------------
                   .                          .
                   .                          .
                   .                          .
    -------------------------------     -------------
    |                             |     |1 0        |     |x|  1
    |                             |     |0 1 0 0 0  |     |x|  2
    |                             |     |  0 1 0 0  |     |x|  3
    |                        0 0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |                             |     |  0 0 0 1 0|     |x|  5
    |                             |     |        0 1|     |x|  6
    -------------------------------     -------------
    */

    /*
     *
     * Row 14
     *
     */

    pivot = sc_to_bb_matrix[1];

    // sc-row-14 = sc-row-14 - bb-row-19 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[1] = 0;
#endif

    sc_g_matrix[13] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       x                    |     |           |     |x|  1
    |  1   x             x        |     |           |     |x|  2
    |    1 x   x                  |     |           |     |x|  3
    |  0 0 1   x         x        |     |           |     |x|  4
    |0       1 x   x              |     |           |     |x|  5
    |    0 0 0 1   x     f        |     |           |     |x|  6
    |            1 x   x          |     |           |     |x|  7
    |        0 0 0 1   x f        | ... |           | ... |x|  8 sc
    |                1 x   x      |     |           |     |x|  9
    |            0 0 0 1 f x      |     |           |     |x| 10
    |  0   0   0   0   0 1 x x    |     |           |     |x| 11
    |                0 0 0 1 x    |     |           |     |x| 12
    |                    0 0 1 x x|     |      x    |     |x| 13
    |                        0 1 x|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |M| 15
    -------------------------------     -------------
                   .                          .
                   .                          .
                   .                          .
    -------------------------------     -------------
    |                             |     |1 0        |     |x|  1
    |                             |     |0 1 0 0 0  |     |x|  2
    |                             |     |  0 1 0 0  |     |x|  3
    |                        0 0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |                             |     |  0 0 0 1 0|     |x|  5
    |                             |     |        0 1|     |x|  6
    -------------------------------     -------------
    */

    /*
     *
     * Row 13
     *
     */

    pivot = sc_to_bb_matrix[0];

    // sc-row-13 = sc-row-13 - bb-row-19 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[0] = 0;
#endif

    sc_g_matrix[12] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       x                    |     |           |     |x|  1
    |  1   x             x        |     |           |     |x|  2
    |    1 x   x                  |     |           |     |x|  3
    |  0 0 1   x         x        |     |           |     |x|  4
    |0       1 x   x              |     |           |     |x|  5
    |    0 0 0 1   x     f        |     |           |     |x|  6
    |            1 x   x          |     |           |     |x|  7
    |        0 0 0 1   x f        | ... |           | ... |x|  8 sc
    |                1 x   x      |     |           |     |x|  9
    |            0 0 0 1 f x      |     |           |     |x| 10
    |  0   0   0   0   0 1 x x    |     |           |     |x| 11
    |                0 0 0 1 x    |     |           |     |x| 12
    |                    0 0 1 x x|     |      0    |     |M| 13
    |                        0 1 x|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |M| 15
    -------------------------------     -------------
                   .                          .
                   .                          .
                   .                          .
    -------------------------------     -------------
    |                             |     |1 0        |     |x|  1
    |                             |     |0 1 0 0 0  |     |x|  2
    |                             |     |  0 1 0 0  |     |x|  3
    |                        0 0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |                             |     |  0 0 0 1 0|     |x|  5
    |                             |     |        0 1|     |x|  6
    -------------------------------     -------------
    */
}

void gmx::IlvesPC::solve_16_tryptophan(real *const sc_to_bb_matrix,
                                       real *const sc_g_matrix,
                                       __attribute__((unused))
                                       real *const sc_to_bb_fillins,
                                       real *const bb_g_matrix) {
    /*
     *
     * Row 19
     *
     */

    real pivot = sc_to_bb_matrix[2];

    // sc-row-19 = sc-row-19 - bb-row-23 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[2] = 0;
#endif

    sc_g_matrix[18] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   x           x                    |     |           |     |x|  1
    |  1 x   x                            |     |           |     |x|  2
    |0 0 1   x       x                    |     |           |     |x|  3
    |      1 x   x                        |     |           |     |x|  4
    |  0 0 0 1   x   f                    |     |           |     |x|  5
    |          1 x x                      |     |           |     |x|  6
    |      0 0 0 1 x f                    |     |           |     |x|  7
    |          0 0 1 f         x   x      |     |           |     |x|  8
    |0   0   0   0 0 1       x x   f      |     |           |     |x|  9
    |                  1   x x            | ... |           | ... |x| 10 sc
    |                    1 x     x        |     |           |     |x| 11
    |                  0 0 1 x   x        |     |           |     |x| 12
    |                0 0   0 1 x f f      |     |           |     |x| 13
    |              0 0       0 1 f x      |     |           |     |x| 14
    |                    0 0 0 0 1 x x    |     |           |     |x| 15
    |              0 0       0 0 0 1 x    |     |           |     |x| 16
    |                            0 0 1 x x|     |      x    |     |x| 17
    |                                0 1 x|     |      x    |     |x| 18
    |                                0 0 1|     |      0    |     |M| 19
    ---------------------------------------     -------------
                       .                              .
                       .                              .
                       .                              .
    ---------------------------------------     -------------
    |                                     |     |1 0        |     |x|  1
    |                                     |     |0 1 0 0 0  |     |x|  2
    |                                     |     |  0 1 0 0  |     |x|  3
    |                                0 0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |                                     |     |  0 0 0 1 0|     |x|  5
    |                                     |     |        0 1|     |x|  6
    ---------------------------------------     -------------
    */

    /*
     *
     * Row 18
     *
     */

    pivot = sc_to_bb_matrix[1];

    // sc-row-18 = sc-row-18 - bb-row-23 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[1] = 0;
#endif

    sc_g_matrix[17] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   x           x                    |     |           |     |x|  1
    |  1 x   x                            |     |           |     |x|  2
    |0 0 1   x       x                    |     |           |     |x|  3
    |      1 x   x                        |     |           |     |x|  4
    |  0 0 0 1   x   f                    |     |           |     |x|  5
    |          1 x x                      |     |           |     |x|  6
    |      0 0 0 1 x f                    |     |           |     |x|  7
    |          0 0 1 f         x   x      |     |           |     |x|  8
    |0   0   0   0 0 1       x x   f      |     |           |     |x|  9
    |                  1   x x            | ... |           | ... |x| 10 sc
    |                    1 x     x        |     |           |     |x| 11
    |                  0 0 1 x   x        |     |           |     |x| 12
    |                0 0   0 1 x f f      |     |           |     |x| 13
    |              0 0       0 1 f x      |     |           |     |x| 14
    |                    0 0 0 0 1 x x    |     |           |     |x| 15
    |              0 0       0 0 0 1 x    |     |           |     |x| 16
    |                            0 0 1 x x|     |      x    |     |x| 17
    |                                0 1 x|     |      0    |     |M| 18
    |                                0 0 1|     |      0    |     |M| 19
    ---------------------------------------     -------------
                       .                              .
                       .                              .
                       .                              .
    ---------------------------------------     -------------
    |                                     |     |1 0        |     |x|  1
    |                                     |     |0 1 0 0 0  |     |x|  2
    |                                     |     |  0 1 0 0  |     |x|  3
    |                                0 0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |                                     |     |  0 0 0 1 0|     |x|  5
    |                                     |     |        0 1|     |x|  6
    ---------------------------------------     -------------
    */

    /*
     *
     * Row 17
     *
     */

    pivot = sc_to_bb_matrix[0];

    // sc-row-17 = sc-row-17 - bb-row-23 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[0] = 0;
#endif

    sc_g_matrix[16] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   x           x                    |     |           |     |x|  1
    |  1 x   x                            |     |           |     |x|  2
    |0 0 1   x       x                    |     |           |     |x|  3
    |      1 x   x                        |     |           |     |x|  4
    |  0 0 0 1   x   f                    |     |           |     |x|  5
    |          1 x x                      |     |           |     |x|  6
    |      0 0 0 1 x f                    |     |           |     |x|  7
    |          0 0 1 f         x   x      |     |           |     |x|  8
    |0   0   0   0 0 1       x x   f      |     |           |     |x|  9
    |                  1   x x            | ... |           | ... |x| 10 sc
    |                    1 x     x        |     |           |     |x| 11
    |                  0 0 1 x   x        |     |           |     |x| 12
    |                0 0   0 1 x f f      |     |           |     |x| 13
    |              0 0       0 1 f x      |     |           |     |x| 14
    |                    0 0 0 0 1 x x    |     |           |     |x| 15
    |              0 0       0 0 0 1 x    |     |           |     |x| 16
    |                            0 0 1 x x|     |      0    |     |M| 17
    |                                0 1 x|     |      0    |     |M| 18
    |                                0 0 1|     |      0    |     |M| 19
    ---------------------------------------     -------------
                       .                              .
                       .                              .
                       .                              .
    ---------------------------------------     -------------
    |                                     |     |1 0        |     |x|  1
    |                                     |     |0 1 0 0 0  |     |x|  2
    |                                     |     |  0 1 0 0  |     |x|  3
    |                                0 0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |                                     |     |  0 0 0 1 0|     |x|  5
    |                                     |     |        0 1|     |x|  6
    ---------------------------------------     -------------
    */
}

void gmx::IlvesPC::solve_16_threonine(real *const sc_to_bb_matrix,
                                      real *const sc_g_matrix,
                                      __attribute__((unused))
                                      real *const sc_to_bb_fillins,
                                      real *const bb_g_matrix) {
    /*
     *
     * Row 7
     *
     */

    real pivot = sc_to_bb_matrix[2];

    // sc-row-7 = sc-row-7 - bb-row-11 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[2] = 0;
#endif

    sc_g_matrix[6] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 x x x      |     |           |     |x|  1
    |0 1 x x      |     |           |     |x|  2
    |0 0 1 x      |     |           |     |x|  3
    |0 0 0 1   x x| ... |      x    | ... |x|  4 sc
    |        1 x  |     |           |     |x|  5
    |      0 0 1 x|     |      x    |     |x|  6
    |      0   0 1|     |      0    |     |M|  7
    ---------------     -------------
           .                  .
           .                  .
           .                  .
    ---------------     -------------
    |             |     |1 0        |     |x|  1
    |             |     |0 1 0 0 0  |     |x|  2
    |             |     |  0 1 0 0  |     |x|  3
    |      0   0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |             |     |  0 0 0 1 0|     |x|  5
    |             |     |        0 1|     |x|  6
    ---------------     -------------
    */

    /*
     *
     * Row 6
     *
     */

    pivot = sc_to_bb_matrix[1];

    // sc-row-6 = sc-row-6 - bb-row-11 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[1] = 0;
#endif

    sc_g_matrix[5] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 x x x      |     |           |     |x|  1
    |0 1 x x      |     |           |     |x|  2
    |0 0 1 x      |     |           |     |x|  3
    |0 0 0 1   x x| ... |      x    | ... |x|  4 sc
    |        1 x  |     |           |     |x|  5
    |      0 0 1 x|     |      0    |     |M|  6
    |      0   0 1|     |      0    |     |M|  7
    ---------------     -------------
           .                  .
           .                  .
           .                  .
    ---------------     -------------
    |             |     |1 0        |     |x|  1
    |             |     |0 1 0 0 0  |     |x|  2
    |             |     |  0 1 0 0  |     |x|  3
    |      0   0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |             |     |  0 0 0 1 0|     |x|  5
    |             |     |        0 1|     |x|  6
    ---------------     -------------
    */

    /*
     *
     * Row 4
     *
     */

    pivot = sc_to_bb_matrix[0];

    // sc-row-4 = sc-row-4 - bb-row-11 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_bb_matrix[0] = 0;
#endif

    sc_g_matrix[3] -= bb_g_matrix[3] * pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 x x x      |     |           |     |x|  1
    |0 1 x x      |     |           |     |x|  2
    |0 0 1 x      |     |           |     |x|  3
    |0 0 0 1   x x| ... |      0    | ... |M|  4 sc
    |        1 x  |     |           |     |x|  5
    |      0 0 1 x|     |      0    |     |M|  6
    |      0   0 1|     |      0    |     |M|  7
    ---------------     -------------
           .                  .
           .                  .
           .                  .
    ---------------     -------------
    |             |     |1 0        |     |x|  1
    |             |     |0 1 0 0 0  |     |x|  2
    |             |     |  0 1 0 0  |     |x|  3
    |      0   0 0| ... |  0 0 1 0  | ... |x|  4 bb
    |             |     |  0 0 0 1 0|     |x|  5
    |             |     |        0 1|     |x|  6
    ---------------     -------------
    */
}

// Array of pointer to step 16 solvers.
void (gmx::IlvesPC::*(gmx::IlvesPC::step_16_solvers)[NUM_TYPES])(real *const,
                                                                 real *const,
                                                                 real *const,
                                                                 real *const) =
    {&gmx::IlvesPC::solve_16_glycine,
     &gmx::IlvesPC::solve_16_proline,
     &gmx::IlvesPC::solve_16_cysteine,
     &gmx::IlvesPC::solve_16_methionine,
     &gmx::IlvesPC::solve_16_alaline,
     &gmx::IlvesPC::solve_16_valine,
     &gmx::IlvesPC::solve_16_leucine,
     &gmx::IlvesPC::solve_16_isoleucine,
     &gmx::IlvesPC::solve_16_aspartic_acid,
     &gmx::IlvesPC::solve_16_glutamic_acid,
     &gmx::IlvesPC::solve_16_asparagine,
     &gmx::IlvesPC::solve_16_glutamine,
     &gmx::IlvesPC::solve_16_histidine,
     &gmx::IlvesPC::solve_16_lysine,
     &gmx::IlvesPC::solve_16_arginine,
     &gmx::IlvesPC::solve_16_serine,
     &gmx::IlvesPC::solve_16_phenylaline,
     &gmx::IlvesPC::solve_16_tyrosine,
     &gmx::IlvesPC::solve_16_tryptophan,
     &gmx::IlvesPC::solve_16_threonine};

void gmx::IlvesPC::solve_16(const int thread) {
    // Pointers to private data.

    private_data_t *pd = &private_data[thread];

    real *sc_to_bb_matrix = pd->sc_to_bb_matrix.data;

    real *sc_g_matrix = pd->sc_g_matrix.data;

    real *sc_to_bb_fillins = pd->sc_to_bb_fillins.data;

    real *bb_g_matrix = pd->bb_g_matrix.data;

    // Loop through the side-chains assigned to thread.
    for (int i = 0; i < pd->num_side_chains; i++) {
        side_chain_type_t type = mol->side_chain_types[pd->first_side_chain + i];

        // Call current side-chain step 2 solver.
        (this->*step_16_solvers[type])(sc_to_bb_matrix,
                                       sc_g_matrix,
                                       sc_to_bb_fillins,
                                       bb_g_matrix);

        // Update pointers.
        sc_to_bb_matrix += sc_to_bb_matrix_sizes[type];

        sc_g_matrix += sc_g_matrix_sizes[type];

        sc_to_bb_fillins += (type == PROLINE ? SC_TO_BB_PROLINE_FILLINS_SIZE : 0);

        bb_g_matrix += (type == PROLINE ? BB_G_PROLINE_MATRIX_SIZE
                                        : BB_G_MATRIX_SIZE);
    }
}

void gmx::IlvesPC::solve_17_glycine(__attribute__((unused))
                                    real *const sc_to_sc_matrix,
                                    __attribute__((unused)) real *const sc_g_matrix,
                                    __attribute__((unused))
                                    real *const sc_to_sc_fillins) {}

void gmx::IlvesPC::solve_17_proline(real *const sc_to_sc_matrix,
                                    real *const sc_g_matrix,
                                    __attribute__((unused))
                                    real *const sc_to_sc_fillins) {
    /*
     *
     * Row 8
     *
     */

    real pivot = sc_to_sc_matrix[34];

    // sc-row-8 = sc-row-8 - sc-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[34] = 0;
#endif

    sc_g_matrix[7] -= sc_g_matrix[8] * pivot;

    /*
    Resulting matrix:

            sc                  bb           g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------
    |1 x         x    |     |      0  |     |x|  1
    |0 1         x    |     |      0  |     |x|  2
    |    1 x     x x  |     |         |     |x|  3
    |    0 1     x x  |     |         |     |x|  4
    |        1 x   x x| ... |         | ... |x|  5 sc
    |        0 1   x x|     |         |     |x|  6
    |0 0 0 0     1 x  |     |      0  |     |x|  7
    |    0 0 0 0 0 1 0|     |      0  |     |M|  8
    |        0 0   0 1|     |      0 0|     |x|  9
    -------------------     -----------
    */

    /*
     *
     * Row 7
     *
     */

    pivot = sc_to_sc_matrix[27];

    // sc-row-7 = sc-row-7 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[27] = 0;
#endif

    sc_g_matrix[6] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

            sc                  bb           g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------
    |1 x         x    |     |      0  |     |x|  1
    |0 1         x    |     |      0  |     |x|  2
    |    1 x     x x  |     |         |     |x|  3
    |    0 1     x x  |     |         |     |x|  4
    |        1 x   x x| ... |         | ... |x|  5 sc
    |        0 1   x x|     |         |     |x|  6
    |0 0 0 0     1 0  |     |      0  |     |M|  7
    |    0 0 0 0 0 1 0|     |      0  |     |M|  8
    |        0 0   0 1|     |      0 0|     |x|  9
    -------------------     -----------
    */

    /*
     *
     * Row 6
     *
     */

    pivot = sc_to_sc_matrix[21];

    // sc-row-6 = sc-row-6 - sc-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[21] = 0;
#endif

    sc_g_matrix[5] -= sc_g_matrix[8] * pivot;

    /*
    Resulting matrix:

            sc                  bb           g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------
    |1 x         x    |     |      0  |     |x|  1
    |0 1         x    |     |      0  |     |x|  2
    |    1 x     x x  |     |         |     |x|  3
    |    0 1     x x  |     |         |     |x|  4
    |        1 x   x x| ... |         | ... |x|  5 sc
    |        0 1   x 0|     |         |     |M|  6
    |0 0 0 0     1 0  |     |      0  |     |M|  7
    |    0 0 0 0 0 1 0|     |      0  |     |M|  8
    |        0 0   0 1|     |      0 0|     |x|  9
    -------------------     -----------
    */

    pivot = sc_to_sc_matrix[20];

    // sc-row-6 = sc-row-6 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[20] = 0;
#endif

    sc_g_matrix[5] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

            sc                  bb           g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------
    |1 x         x    |     |      0  |     |x|  1
    |0 1         x    |     |      0  |     |x|  2
    |    1 x     x x  |     |         |     |x|  3
    |    0 1     x x  |     |         |     |x|  4
    |        1 x   x x| ... |         | ... |x|  5 sc
    |        0 1   0 0|     |         |     |M|  6
    |0 0 0 0     1 0  |     |      0  |     |M|  7
    |    0 0 0 0 0 1 0|     |      0  |     |M|  8
    |        0 0   0 1|     |      0 0|     |x|  9
    -------------------     -----------
    */

    /*
     *
     * Row 5
     *
     */

    pivot = sc_to_sc_matrix[17];

    // sc-row-5 = sc-row-5 - sc-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[17] = 0;
#endif

    sc_g_matrix[4] -= sc_g_matrix[8] * pivot;

    /*
    Resulting matrix:

            sc                  bb           g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------
    |1 x         x    |     |      0  |     |x|  1
    |0 1         x    |     |      0  |     |x|  2
    |    1 x     x x  |     |         |     |x|  3
    |    0 1     x x  |     |         |     |x|  4
    |        1 x   x 0| ... |         | ... |M|  5 sc
    |        0 1   0 0|     |         |     |M|  6
    |0 0 0 0     1 0  |     |      0  |     |M|  7
    |    0 0 0 0 0 1 0|     |      0  |     |M|  8
    |        0 0   0 1|     |      0 0|     |x|  9
    -------------------     -----------
    */

    pivot = sc_to_sc_matrix[16];

    // sc-row-5 = sc-row-5 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[16] = 0;
#endif

    sc_g_matrix[4] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

            sc                  bb           g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------
    |1 x         x    |     |      0  |     |x|  1
    |0 1         x    |     |      0  |     |x|  2
    |    1 x     x x  |     |         |     |x|  3
    |    0 1     x x  |     |         |     |x|  4
    |        1 x   0 0| ... |         | ... |M|  5 sc
    |        0 1   0 0|     |         |     |M|  6
    |0 0 0 0     1 0  |     |      0  |     |M|  7
    |    0 0 0 0 0 1 0|     |      0  |     |M|  8
    |        0 0   0 1|     |      0 0|     |x|  9
    -------------------     -----------
    */

    pivot = sc_to_sc_matrix[15];

    // sc-row-5 = sc-row-5 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[15] = 0;
#endif

    sc_g_matrix[4] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

            sc                  bb           g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------
    |1 x         x    |     |      0  |     |x|  1
    |0 1         x    |     |      0  |     |x|  2
    |    1 x     x x  |     |         |     |x|  3
    |    0 1     x x  |     |         |     |x|  4
    |        1 0   0 0| ... |         | ... |M|  5 sc
    |        0 1   0 0|     |         |     |M|  6
    |0 0 0 0     1 0  |     |      0  |     |M|  7
    |    0 0 0 0 0 1 0|     |      0  |     |M|  8
    |        0 0   0 1|     |      0 0|     |x|  9
    -------------------     -----------
    */

    /*
     *
     * Row 4
     *
     */

    pivot = sc_to_sc_matrix[13];

    // sc-row-4 = sc-row-4 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[13] = 0;
#endif

    sc_g_matrix[3] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

            sc                  bb           g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------
    |1 x         x    |     |      0  |     |x|  1
    |0 1         x    |     |      0  |     |x|  2
    |    1 x     x x  |     |         |     |x|  3
    |    0 1     x 0  |     |         |     |M|  4
    |        1 0   0 0| ... |         | ... |M|  5 sc
    |        0 1   0 0|     |         |     |M|  6
    |0 0 0 0     1 0  |     |      0  |     |M|  7
    |    0 0 0 0 0 1 0|     |      0  |     |M|  8
    |        0 0   0 1|     |      0 0|     |x|  9
    -------------------     -----------
    */

    pivot = sc_to_sc_matrix[12];

    // sc-row-4 = sc-row-4 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[12] = 0;
#endif

    sc_g_matrix[3] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

            sc                  bb           g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------
    |1 x         x    |     |      0  |     |x|  1
    |0 1         x    |     |      0  |     |x|  2
    |    1 x     x x  |     |         |     |x|  3
    |    0 1     0 0  |     |         |     |M|  4
    |        1 0   0 0| ... |         | ... |M|  5 sc
    |        0 1   0 0|     |         |     |M|  6
    |0 0 0 0     1 0  |     |      0  |     |M|  7
    |    0 0 0 0 0 1 0|     |      0  |     |M|  8
    |        0 0   0 1|     |      0 0|     |x|  9
    -------------------     -----------
    */

    /*
     *
     * Row 3
     *
     */

    pivot = sc_to_sc_matrix[9];

    // sc-row-3 = sc-row-3 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[9] = 0;
#endif

    sc_g_matrix[2] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

            sc                  bb           g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------
    |1 x         x    |     |      0  |     |x|  1
    |0 1         x    |     |      0  |     |x|  2
    |    1 x     x 0  |     |         |     |M|  3
    |    0 1     0 0  |     |         |     |M|  4
    |        1 0   0 0| ... |         | ... |M|  5 sc
    |        0 1   0 0|     |         |     |M|  6
    |0 0 0 0     1 0  |     |      0  |     |M|  7
    |    0 0 0 0 0 1 0|     |      0  |     |M|  8
    |        0 0   0 1|     |      0 0|     |x|  9
    -------------------     -----------
    */

    pivot = sc_to_sc_matrix[8];

    // sc-row-3 = sc-row-3 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[8] = 0;
#endif

    sc_g_matrix[2] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

            sc                  bb           g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------
    |1 x         x    |     |      0  |     |x|  1
    |0 1         x    |     |      0  |     |x|  2
    |    1 x     0 0  |     |         |     |M|  3
    |    0 1     0 0  |     |         |     |M|  4
    |        1 0   0 0| ... |         | ... |M|  5 sc
    |        0 1   0 0|     |         |     |M|  6
    |0 0 0 0     1 0  |     |      0  |     |M|  7
    |    0 0 0 0 0 1 0|     |      0  |     |M|  8
    |        0 0   0 1|     |      0 0|     |x|  9
    -------------------     -----------
    */

    pivot = sc_to_sc_matrix[7];

    // sc-row-3 = sc-row-3 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[7] = 0;
#endif

    sc_g_matrix[2] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

            sc                  bb           g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------
    |1 x         x    |     |      0  |     |x|  1
    |0 1         x    |     |      0  |     |x|  2
    |    1 0     0 0  |     |         |     |M|  3
    |    0 1     0 0  |     |         |     |M|  4
    |        1 0   0 0| ... |         | ... |M|  5 sc
    |        0 1   0 0|     |         |     |M|  6
    |0 0 0 0     1 0  |     |      0  |     |M|  7
    |    0 0 0 0 0 1 0|     |      0  |     |M|  8
    |        0 0   0 1|     |      0 0|     |x|  9
    -------------------     -----------
    */

    /*
     *
     * Row 2
     *
     */

    pivot = sc_to_sc_matrix[5];

    // sc-row-2 = sc-row-2 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[5] = 0;
#endif

    sc_g_matrix[1] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

            sc                  bb           g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------
    |1 x         x    |     |      0  |     |x|  1
    |0 1         0    |     |      0  |     |M|  2
    |    1 0     0 0  |     |         |     |M|  3
    |    0 1     0 0  |     |         |     |M|  4
    |        1 0   0 0| ... |         | ... |M|  5 sc
    |        0 1   0 0|     |         |     |M|  6
    |0 0 0 0     1 0  |     |      0  |     |M|  7
    |    0 0 0 0 0 1 0|     |      0  |     |M|  8
    |        0 0   0 1|     |      0 0|     |x|  9
    -------------------     -----------
    */

    /*
     *
     * Row 1
     *
     */

    pivot = sc_to_sc_matrix[2];

    // sc-row-1 = sc-row-1 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[2] = 0;
#endif

    sc_g_matrix[0] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

            sc                  bb           g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------
    |1 x         0    |     |      0  |     |M|  1
    |0 1         0    |     |      0  |     |M|  2
    |    1 0     0 0  |     |         |     |M|  3
    |    0 1     0 0  |     |         |     |M|  4
    |        1 0   0 0| ... |         | ... |M|  5 sc
    |        0 1   0 0|     |         |     |M|  6
    |0 0 0 0     1 0  |     |      0  |     |M|  7
    |    0 0 0 0 0 1 0|     |      0  |     |M|  8
    |        0 0   0 1|     |      0 0|     |x|  9
    -------------------     -----------
    */

    pivot = sc_to_sc_matrix[1];

    // sc-row-1 = sc-row-1 - sc-row-2 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[1] = 0;
#endif

    sc_g_matrix[0] -= sc_g_matrix[1] * pivot;

    /*
    Resulting matrix:

            sc                  bb           g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5
    -------------------     -----------
    |1 0         0    |     |      0  |     |M|  1
    |0 1         0    |     |      0  |     |M|  2
    |    1 0     0 0  |     |         |     |M|  3
    |    0 1     0 0  |     |         |     |M|  4
    |        1 0   0 0| ... |         | ... |M|  5 sc
    |        0 1   0 0|     |         |     |M|  6
    |0 0 0 0     1 0  |     |      0  |     |M|  7
    |    0 0 0 0 0 1 0|     |      0  |     |M|  8
    |        0 0   0 1|     |      0 0|     |x|  9
    -------------------     -----------
    */
}

void gmx::IlvesPC::solve_17_cysteine(real *const sc_to_sc_matrix,
                                     real *const sc_g_matrix,
                                     __attribute__((unused))
                                     real *const sc_to_sc_fillins) {
    /*
     *
     * Row 3
     *
     */

    real pivot = sc_to_sc_matrix[8];

    // sc-row-3 = sc-row-3 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[8] = 0;
#endif

    sc_g_matrix[2] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

       sc              bb            g
     1 2 3 4       1 2 3 4 5 6
    ---------     -------------
    |1 x    |     |           |     |x|  1
    |0 1 x x|     |      0    |     |x|  2
    |  0 1 0| ... |      0    | ... |M|  3 sc
    |  0 0 1|     |      0    |     |x|  4
    ---------     -------------
    */

    /*
     *
     * Row 2
     *
     */

    pivot = sc_to_sc_matrix[5];

    // sc-row-2 = sc-row-2 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[5] = 0;
#endif

    sc_g_matrix[1] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

       sc              bb            g
     1 2 3 4       1 2 3 4 5 6
    ---------     -------------
    |1 x    |     |           |     |x|  1
    |0 1 x 0|     |      0    |     |M|  2
    |  0 1 0| ... |      0    | ... |M|  3 sc
    |  0 0 1|     |      0    |     |x|  4
    ---------     -------------
    */

    pivot = sc_to_sc_matrix[4];

    // sc-row-2 = sc-row-2 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[4] = 0;
#endif

    sc_g_matrix[1] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

       sc              bb            g
     1 2 3 4       1 2 3 4 5 6
    ---------     -------------
    |1 x    |     |           |     |x|  1
    |0 1 0 0|     |      0    |     |M|  2
    |  0 1 0| ... |      0    | ... |M|  3 sc
    |  0 0 1|     |      0    |     |x|  4
    ---------     -------------
    */

    /*
     *
     * Row 1
     *
     */

    pivot = sc_to_sc_matrix[1];

    // sc-row-1 = sc-row-1 - sc-row-2 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[1] = 0;
#endif

    sc_g_matrix[0] -= sc_g_matrix[1] * pivot;

    /*
    Resulting matrix:

       sc              bb            g
     1 2 3 4       1 2 3 4 5 6
    ---------     -------------
    |1 0    |     |           |     |M|  1
    |0 1 0 0|     |      0    |     |M|  2
    |  0 1 0| ... |      0    | ... |M|  3 sc
    |  0 0 1|     |      0    |     |x|  4
    ---------     -------------
    */
}

void gmx::IlvesPC::solve_17_methionine(real *const sc_to_sc_matrix,
                                       real *const sc_g_matrix,
                                       __attribute__((unused))
                                       real *const sc_to_sc_fillins) {
    /*
     *
     * Row 9
     *
     */

    real pivot = sc_to_sc_matrix[38];

    // sc-row-9 = sc-row-9 - sc-row-10 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[38] = 0;
#endif

    sc_g_matrix[8] -= sc_g_matrix[9] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 x x x            |     |           |     |x|  1
    |0 1 x x            |     |           |     |x|  2
    |0 0 1 x            |     |           |     |x|  3
    |0 0 0 1 x          |     |           |     |x|  4
    |      0 1 x x x    |     |           |     |x|  5
    |        0 1 x x    | ... |           | ... |x|  6 sc
    |        0 0 1 x    |     |           |     |x|  7
    |        0 0 0 1 x x|     |      0    |     |x|  8
    |              0 1 0|     |      0    |     |M|  9
    |              0 0 1|     |      0    |     |x| 10
    ---------------------     -------------
    */

    /*
     *
     * Row 8
     *
     */

    pivot = sc_to_sc_matrix[35];

    // sc-row-8 = sc-row-8 - sc-row-10 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[35] = 0;
#endif

    sc_g_matrix[7] -= sc_g_matrix[9] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 x x x            |     |           |     |x|  1
    |0 1 x x            |     |           |     |x|  2
    |0 0 1 x            |     |           |     |x|  3
    |0 0 0 1 x          |     |           |     |x|  4
    |      0 1 x x x    |     |           |     |x|  5
    |        0 1 x x    | ... |           | ... |x|  6 sc
    |        0 0 1 x    |     |           |     |x|  7
    |        0 0 0 1 x 0|     |      0    |     |M|  8
    |              0 1 0|     |      0    |     |M|  9
    |              0 0 1|     |      0    |     |x| 10
    ---------------------     -------------
    */

    pivot = sc_to_sc_matrix[34];

    // sc-row-8 = sc-row-8 - sc-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[34] = 0;
#endif

    sc_g_matrix[7] -= sc_g_matrix[8] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 x x x            |     |           |     |x|  1
    |0 1 x x            |     |           |     |x|  2
    |0 0 1 x            |     |           |     |x|  3
    |0 0 0 1 x          |     |           |     |x|  4
    |      0 1 x x x    |     |           |     |x|  5
    |        0 1 x x    | ... |           | ... |x|  6 sc
    |        0 0 1 x    |     |           |     |x|  7
    |        0 0 0 1 0 0|     |      0    |     |M|  8
    |              0 1 0|     |      0    |     |M|  9
    |              0 0 1|     |      0    |     |x| 10
    ---------------------     -------------
    */

    /*
     *
     * Row 7
     *
     */

    pivot = sc_to_sc_matrix[29];

    // sc-row-7 = sc-row-7 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[29] = 0;
#endif

    sc_g_matrix[6] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 x x x            |     |           |     |x|  1
    |0 1 x x            |     |           |     |x|  2
    |0 0 1 x            |     |           |     |x|  3
    |0 0 0 1 x          |     |           |     |x|  4
    |      0 1 x x x    |     |           |     |x|  5
    |        0 1 x x    | ... |           | ... |x|  6 sc
    |        0 0 1 0    |     |           |     |M|  7
    |        0 0 0 1 0 0|     |      0    |     |M|  8
    |              0 1 0|     |      0    |     |M|  9
    |              0 0 1|     |      0    |     |x| 10
    ---------------------     -------------
    */

    /*
     *
     * Row 6
     *
     */

    pivot = sc_to_sc_matrix[25];

    // sc-row-6 = sc-row-6 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[25] = 0;
#endif

    sc_g_matrix[5] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 x x x            |     |           |     |x|  1
    |0 1 x x            |     |           |     |x|  2
    |0 0 1 x            |     |           |     |x|  3
    |0 0 0 1 x          |     |           |     |x|  4
    |      0 1 x x x    |     |           |     |x|  5
    |        0 1 x 0    | ... |           | ... |M|  6 sc
    |        0 0 1 0    |     |           |     |M|  7
    |        0 0 0 1 0 0|     |      0    |     |M|  8
    |              0 1 0|     |      0    |     |M|  9
    |              0 0 1|     |      0    |     |x| 10
    ---------------------     -------------
    */

    pivot = sc_to_sc_matrix[24];

    // sc-row-6 = sc-row-6 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[24] = 0;
#endif

    sc_g_matrix[5] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 x x x            |     |           |     |x|  1
    |0 1 x x            |     |           |     |x|  2
    |0 0 1 x            |     |           |     |x|  3
    |0 0 0 1 x          |     |           |     |x|  4
    |      0 1 x x x    |     |           |     |x|  5
    |        0 1 0 0    | ... |           | ... |M|  6 sc
    |        0 0 1 0    |     |           |     |M|  7
    |        0 0 0 1 0 0|     |      0    |     |M|  8
    |              0 1 0|     |      0    |     |M|  9
    |              0 0 1|     |      0    |     |x| 10
    ---------------------     -------------
    */

    /*
     *
     * Row 5
     *
     */

    pivot = sc_to_sc_matrix[21];

    // sc-row-5 = sc-row-5 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[21] = 0;
#endif

    sc_g_matrix[4] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 x x x            |     |           |     |x|  1
    |0 1 x x            |     |           |     |x|  2
    |0 0 1 x            |     |           |     |x|  3
    |0 0 0 1 x          |     |           |     |x|  4
    |      0 1 x x 0    |     |           |     |M|  5
    |        0 1 0 0    | ... |           | ... |M|  6 sc
    |        0 0 1 0    |     |           |     |M|  7
    |        0 0 0 1 0 0|     |      0    |     |M|  8
    |              0 1 0|     |      0    |     |M|  9
    |              0 0 1|     |      0    |     |x| 10
    ---------------------     -------------
    */

    pivot = sc_to_sc_matrix[20];

    // sc-row-5 = sc-row-5 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[20] = 0;
#endif

    sc_g_matrix[4] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 x x x            |     |           |     |x|  1
    |0 1 x x            |     |           |     |x|  2
    |0 0 1 x            |     |           |     |x|  3
    |0 0 0 1 x          |     |           |     |x|  4
    |      0 1 x 0 0    |     |           |     |M|  5
    |        0 1 0 0    | ... |           | ... |M|  6 sc
    |        0 0 1 0    |     |           |     |M|  7
    |        0 0 0 1 0 0|     |      0    |     |M|  8
    |              0 1 0|     |      0    |     |M|  9
    |              0 0 1|     |      0    |     |x| 10
    ---------------------     -------------
    */

    pivot = sc_to_sc_matrix[19];

    // sc-row-5 = sc-row-5 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[19] = 0;
#endif

    sc_g_matrix[4] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 x x x            |     |           |     |x|  1
    |0 1 x x            |     |           |     |x|  2
    |0 0 1 x            |     |           |     |x|  3
    |0 0 0 1 x          |     |           |     |x|  4
    |      0 1 0 0 0    |     |           |     |M|  5
    |        0 1 0 0    | ... |           | ... |M|  6 sc
    |        0 0 1 0    |     |           |     |M|  7
    |        0 0 0 1 0 0|     |      0    |     |M|  8
    |              0 1 0|     |      0    |     |M|  9
    |              0 0 1|     |      0    |     |x| 10
    ---------------------     -------------
    */

    /*
     *
     * Row 4
     *
     */

    pivot = sc_to_sc_matrix[16];

    // sc-row-4 = sc-row-4 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[16] = 0;
#endif

    sc_g_matrix[3] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 x x x            |     |           |     |x|  1
    |0 1 x x            |     |           |     |x|  2
    |0 0 1 x            |     |           |     |x|  3
    |0 0 0 1 0          |     |           |     |M|  4
    |      0 1 0 0 0    |     |           |     |M|  5
    |        0 1 0 0    | ... |           | ... |M|  6 sc
    |        0 0 1 0    |     |           |     |M|  7
    |        0 0 0 1 0 0|     |      0    |     |M|  8
    |              0 1 0|     |      0    |     |M|  9
    |              0 0 1|     |      0    |     |x| 10
    ---------------------     -------------
    */

    /*
     *
     * Row 3
     *
     */

    pivot = sc_to_sc_matrix[11];

    // sc-row-3 = sc-row-3 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[11] = 0;
#endif

    sc_g_matrix[2] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 x x x            |     |           |     |x|  1
    |0 1 x x            |     |           |     |x|  2
    |0 0 1 0            |     |           |     |M|  3
    |0 0 0 1 0          |     |           |     |M|  4
    |      0 1 0 0 0    |     |           |     |M|  5
    |        0 1 0 0    | ... |           | ... |M|  6 sc
    |        0 0 1 0    |     |           |     |M|  7
    |        0 0 0 1 0 0|     |      0    |     |M|  8
    |              0 1 0|     |      0    |     |M|  9
    |              0 0 1|     |      0    |     |x| 10
    ---------------------     -------------
    */

    /*
     *
     * Row 2
     *
     */

    pivot = sc_to_sc_matrix[7];

    // sc-row-2 = sc-row-2 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[7] = 0;
#endif

    sc_g_matrix[1] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 x x x            |     |           |     |x|  1
    |0 1 x 0            |     |           |     |M|  2
    |0 0 1 0            |     |           |     |M|  3
    |0 0 0 1 0          |     |           |     |M|  4
    |      0 1 0 0 0    |     |           |     |M|  5
    |        0 1 0 0    | ... |           | ... |M|  6 sc
    |        0 0 1 0    |     |           |     |M|  7
    |        0 0 0 1 0 0|     |      0    |     |M|  8
    |              0 1 0|     |      0    |     |M|  9
    |              0 0 1|     |      0    |     |x| 10
    ---------------------     -------------
    */

    pivot = sc_to_sc_matrix[6];

    // sc-row-2 = sc-row-2 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[6] = 0;
#endif

    sc_g_matrix[1] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 x x x            |     |           |     |x|  1
    |0 1 0 0            |     |           |     |M|  2
    |0 0 1 0            |     |           |     |M|  3
    |0 0 0 1 0          |     |           |     |M|  4
    |      0 1 0 0 0    |     |           |     |M|  5
    |        0 1 0 0    | ... |           | ... |M|  6 sc
    |        0 0 1 0    |     |           |     |M|  7
    |        0 0 0 1 0 0|     |      0    |     |M|  8
    |              0 1 0|     |      0    |     |M|  9
    |              0 0 1|     |      0    |     |x| 10
    ---------------------     -------------
    */

    /*
     *
     * Row 1
     *
     */

    pivot = sc_to_sc_matrix[3];

    // sc-row-1 = sc-row-1 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[3] = 0;
#endif

    sc_g_matrix[0] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 x x 0            |     |           |     |M|  1
    |0 1 0 0            |     |           |     |M|  2
    |0 0 1 0            |     |           |     |M|  3
    |0 0 0 1 0          |     |           |     |M|  4
    |      0 1 0 0 0    |     |           |     |M|  5
    |        0 1 0 0    | ... |           | ... |M|  6 sc
    |        0 0 1 0    |     |           |     |M|  7
    |        0 0 0 1 0 0|     |      0    |     |M|  8
    |              0 1 0|     |      0    |     |M|  9
    |              0 0 1|     |      0    |     |x| 10
    ---------------------     -------------
    */

    pivot = sc_to_sc_matrix[2];

    // sc-row-1 = sc-row-1 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[2] = 0;
#endif

    sc_g_matrix[0] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 x 0 0            |     |           |     |M|  1
    |0 1 0 0            |     |           |     |M|  2
    |0 0 1 0            |     |           |     |M|  3
    |0 0 0 1 0          |     |           |     |M|  4
    |      0 1 0 0 0    |     |           |     |M|  5
    |        0 1 0 0    | ... |           | ... |M|  6 sc
    |        0 0 1 0    |     |           |     |M|  7
    |        0 0 0 1 0 0|     |      0    |     |M|  8
    |              0 1 0|     |      0    |     |M|  9
    |              0 0 1|     |      0    |     |x| 10
    ---------------------     -------------
    */

    pivot = sc_to_sc_matrix[1];

    // sc-row-1 = sc-row-1 - sc-row-2 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[1] = 0;
#endif

    sc_g_matrix[0] -= sc_g_matrix[1] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 0 0 0            |     |           |     |M|  1
    |0 1 0 0            |     |           |     |M|  2
    |0 0 1 0            |     |           |     |M|  3
    |0 0 0 1 0          |     |           |     |M|  4
    |      0 1 0 0 0    |     |           |     |M|  5
    |        0 1 0 0    | ... |           | ... |M|  6 sc
    |        0 0 1 0    |     |           |     |M|  7
    |        0 0 0 1 0 0|     |      0    |     |M|  8
    |              0 1 0|     |      0    |     |M|  9
    |              0 0 1|     |      0    |     |x| 10
    ---------------------     -------------
    */
}

void gmx::IlvesPC::solve_17_alaline(real *const sc_to_sc_matrix,
                                    real *const sc_g_matrix,
                                    __attribute__((unused))
                                    real *const sc_to_sc_fillins) {
    /*
     *
     * Row 2
     *
     */

    real pivot = sc_to_sc_matrix[5];

    // sc-row-2 = sc-row-2 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[5] = 0;
#endif

    sc_g_matrix[1] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

      sc             bb            g
     1 2 3       1 2 3 4 5 6
    -------     -------------
    |1 x x|     |      0    |     |x|  1
    |0 1 0| ... |      0    | ... |M|  2 sc
    |0 0 1|     |      0    |     |x|  3
    -------     -------------
    */

    /*
     *
     * Row 1
     *
     */

    pivot = sc_to_sc_matrix[2];

    // sc-row-1 = sc-row-1 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[2] = 0;
#endif

    sc_g_matrix[0] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

      sc             bb            g
     1 2 3       1 2 3 4 5 6
    -------     -------------
    |1 x 0|     |      0    |     |M|  1
    |0 1 0| ... |      0    | ... |M|  2 sc
    |0 0 1|     |      0    |     |x|  3
    -------     -------------
    */

    pivot = sc_to_sc_matrix[1];

    // sc-row-1 = sc-row-1 - sc-row-2 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[1] = 0;
#endif

    sc_g_matrix[0] -= sc_g_matrix[1] * pivot;

    /*
    Resulting matrix:

      sc             bb            g
     1 2 3       1 2 3 4 5 6
    -------     -------------
    |1 0 0|     |      0    |     |M|  1
    |0 1 0| ... |      0    | ... |M|  2 sc
    |0 0 1|     |      0    |     |x|  3
    -------     -------------
    */
}

void gmx::IlvesPC::solve_17_valine(real *const sc_to_sc_matrix,
                                   real *const sc_g_matrix,
                                   __attribute__((unused))
                                   real *const sc_to_sc_fillins) {
    /*
     *
     * Row 8
     *
     */

    real pivot = sc_to_sc_matrix[35];

    // sc-row-8 = sc-row-8 - sc-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[35] = 0;
#endif

    sc_g_matrix[7] -= sc_g_matrix[8] * pivot;

    /*
    Resulting matrix:

            sc                   bb            g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5 6
    -------------------     -------------
    |1 x x x          |     |           |     |x|  1
    |0 1 x x          |     |           |     |x|  2
    |0 0 1 x          |     |           |     |x|  3
    |0 0 0 1       x x|     |      0    |     |x|  4
    |        1 x x x  | ... |           | ... |x|  5 sc
    |        0 1 x x  |     |           |     |x|  6
    |        0 0 1 x  |     |           |     |x|  7
    |      0 0 0 0 1 0|     |      0    |     |M|  8
    |      0       0 1|     |      0    |     |x|  9
    -------------------     -------------
    */

    /*
     *
     * Row 7
     *
     */

    pivot = sc_to_sc_matrix[29];

    // sc-row-7 = sc-row-7 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[29] = 0;
#endif

    sc_g_matrix[6] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

            sc                   bb            g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5 6
    -------------------     -------------
    |1 x x x          |     |           |     |x|  1
    |0 1 x x          |     |           |     |x|  2
    |0 0 1 x          |     |           |     |x|  3
    |0 0 0 1       x x|     |      0    |     |x|  4
    |        1 x x x  | ... |           | ... |x|  5 sc
    |        0 1 x x  |     |           |     |x|  6
    |        0 0 1 0  |     |           |     |M|  7
    |      0 0 0 0 1 0|     |      0    |     |M|  8
    |      0       0 1|     |      0    |     |x|  9
    -------------------     -------------
    */

    /*
     *
     * Row 6
     *
     */

    pivot = sc_to_sc_matrix[25];

    // sc-row-6 = sc-row-6 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[25] = 0;
#endif

    sc_g_matrix[5] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

            sc                   bb            g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5 6
    -------------------     -------------
    |1 x x x          |     |           |     |x|  1
    |0 1 x x          |     |           |     |x|  2
    |0 0 1 x          |     |           |     |x|  3
    |0 0 0 1       x x|     |      0    |     |x|  4
    |        1 x x x  | ... |           | ... |x|  5 sc
    |        0 1 x 0  |     |           |     |M|  6
    |        0 0 1 0  |     |           |     |M|  7
    |      0 0 0 0 1 0|     |      0    |     |M|  8
    |      0       0 1|     |      0    |     |x|  9
    -------------------     -------------
    */

    pivot = sc_to_sc_matrix[24];

    // sc-row-6 = sc-row-6 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[24] = 0;
#endif

    sc_g_matrix[5] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

            sc                   bb            g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5 6
    -------------------     -------------
    |1 x x x          |     |           |     |x|  1
    |0 1 x x          |     |           |     |x|  2
    |0 0 1 x          |     |           |     |x|  3
    |0 0 0 1       x x|     |      0    |     |x|  4
    |        1 x x x  | ... |           | ... |x|  5 sc
    |        0 1 0 0  |     |           |     |M|  6
    |        0 0 1 0  |     |           |     |M|  7
    |      0 0 0 0 1 0|     |      0    |     |M|  8
    |      0       0 1|     |      0    |     |x|  9
    -------------------     -------------
    */

    /*
     *
     * Row 5
     *
     */

    pivot = sc_to_sc_matrix[21];

    // sc-row-5 = sc-row-5 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[21] = 0;
#endif

    sc_g_matrix[4] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

            sc                   bb            g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5 6
    -------------------     -------------
    |1 x x x          |     |           |     |x|  1
    |0 1 x x          |     |           |     |x|  2
    |0 0 1 x          |     |           |     |x|  3
    |0 0 0 1       x x|     |      0    |     |x|  4
    |        1 x x 0  | ... |           | ... |M|  5 sc
    |        0 1 0 0  |     |           |     |M|  6
    |        0 0 1 0  |     |           |     |M|  7
    |      0 0 0 0 1 0|     |      0    |     |M|  8
    |      0       0 1|     |      0    |     |x|  9
    -------------------     -------------
    */

    pivot = sc_to_sc_matrix[20];

    // sc-row-5 = sc-row-5 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[20] = 0;
#endif

    sc_g_matrix[4] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

            sc                   bb            g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5 6
    -------------------     -------------
    |1 x x x          |     |           |     |x|  1
    |0 1 x x          |     |           |     |x|  2
    |0 0 1 x          |     |           |     |x|  3
    |0 0 0 1       x x|     |      0    |     |x|  4
    |        1 x 0 0  | ... |           | ... |M|  5 sc
    |        0 1 0 0  |     |           |     |M|  6
    |        0 0 1 0  |     |           |     |M|  7
    |      0 0 0 0 1 0|     |      0    |     |M|  8
    |      0       0 1|     |      0    |     |x|  9
    -------------------     -------------
    */

    pivot = sc_to_sc_matrix[19];

    // sc-row-5 = sc-row-5 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[19] = 0;
#endif

    sc_g_matrix[4] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

            sc                   bb            g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5 6
    -------------------     -------------
    |1 x x x          |     |           |     |x|  1
    |0 1 x x          |     |           |     |x|  2
    |0 0 1 x          |     |           |     |x|  3
    |0 0 0 1       x x|     |      0    |     |x|  4
    |        1 0 0 0  | ... |           | ... |M|  5 sc
    |        0 1 0 0  |     |           |     |M|  6
    |        0 0 1 0  |     |           |     |M|  7
    |      0 0 0 0 1 0|     |      0    |     |M|  8
    |      0       0 1|     |      0    |     |x|  9
    -------------------     -------------
    */

    /*
     *
     * Row 4
     *
     */

    pivot = sc_to_sc_matrix[17];

    // sc-row-4 = sc-row-4 - sc-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[17] = 0;
#endif

    sc_g_matrix[3] -= sc_g_matrix[8] * pivot;

    /*
    Resulting matrix:

            sc                   bb            g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5 6
    -------------------     -------------
    |1 x x x          |     |           |     |x|  1
    |0 1 x x          |     |           |     |x|  2
    |0 0 1 x          |     |           |     |x|  3
    |0 0 0 1       x 0|     |      0    |     |M|  4
    |        1 0 0 0  | ... |           | ... |M|  5 sc
    |        0 1 0 0  |     |           |     |M|  6
    |        0 0 1 0  |     |           |     |M|  7
    |      0 0 0 0 1 0|     |      0    |     |M|  8
    |      0       0 1|     |      0    |     |x|  9
    -------------------     -------------
    */

    pivot = sc_to_sc_matrix[16];

    // sc-row-4 = sc-row-4 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[16] = 0;
#endif

    sc_g_matrix[3] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

            sc                   bb            g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5 6
    -------------------     -------------
    |1 x x x          |     |           |     |x|  1
    |0 1 x x          |     |           |     |x|  2
    |0 0 1 x          |     |           |     |x|  3
    |0 0 0 1       0 0|     |      0    |     |M|  4
    |        1 0 0 0  | ... |           | ... |M|  5 sc
    |        0 1 0 0  |     |           |     |M|  6
    |        0 0 1 0  |     |           |     |M|  7
    |      0 0 0 0 1 0|     |      0    |     |M|  8
    |      0       0 1|     |      0    |     |x|  9
    -------------------     -------------
    */

    /*
     *
     * Row 3
     *
     */

    pivot = sc_to_sc_matrix[11];

    // sc-row-3 = sc-row-3 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[11] = 0;
#endif

    sc_g_matrix[2] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

            sc                   bb            g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5 6
    -------------------     -------------
    |1 x x x          |     |           |     |x|  1
    |0 1 x x          |     |           |     |x|  2
    |0 0 1 0          |     |           |     |M|  3
    |0 0 0 1       0 0|     |      0    |     |M|  4
    |        1 0 0 0  | ... |           | ... |M|  5 sc
    |        0 1 0 0  |     |           |     |M|  6
    |        0 0 1 0  |     |           |     |M|  7
    |      0 0 0 0 1 0|     |      0    |     |M|  8
    |      0       0 1|     |      0    |     |x|  9
    -------------------     -------------
    */

    /*
     *
     * Row 2
     *
     */

    pivot = sc_to_sc_matrix[7];

    // sc-row-2 = sc-row-2 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[7] = 0;
#endif

    sc_g_matrix[1] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

            sc                   bb            g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5 6
    -------------------     -------------
    |1 x x x          |     |           |     |x|  1
    |0 1 x 0          |     |           |     |M|  2
    |0 0 1 0          |     |           |     |M|  3
    |0 0 0 1       0 0|     |      0    |     |M|  4
    |        1 0 0 0  | ... |           | ... |M|  5 sc
    |        0 1 0 0  |     |           |     |M|  6
    |        0 0 1 0  |     |           |     |M|  7
    |      0 0 0 0 1 0|     |      0    |     |M|  8
    |      0       0 1|     |      0    |     |x|  9
    -------------------     -------------
    */

    pivot = sc_to_sc_matrix[6];

    // sc-row-2 = sc-row-2 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[6] = 0;
#endif

    sc_g_matrix[1] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

            sc                   bb            g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5 6
    -------------------     -------------
    |1 x x x          |     |           |     |x|  1
    |0 1 0 0          |     |           |     |M|  2
    |0 0 1 0          |     |           |     |M|  3
    |0 0 0 1       0 0|     |      0    |     |M|  4
    |        1 0 0 0  | ... |           | ... |M|  5 sc
    |        0 1 0 0  |     |           |     |M|  6
    |        0 0 1 0  |     |           |     |M|  7
    |      0 0 0 0 1 0|     |      0    |     |M|  8
    |      0       0 1|     |      0    |     |x|  9
    -------------------     -------------
    */

    /*
     *
     * Row 1
     *
     */

    pivot = sc_to_sc_matrix[3];

    // sc-row-1 = sc-row-1 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[3] = 0;
#endif

    sc_g_matrix[0] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

            sc                   bb            g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5 6
    -------------------     -------------
    |1 x x 0          |     |           |     |M|  1
    |0 1 0 0          |     |           |     |M|  2
    |0 0 1 0          |     |           |     |M|  3
    |0 0 0 1       0 0|     |      0    |     |M|  4
    |        1 0 0 0  | ... |           | ... |M|  5 sc
    |        0 1 0 0  |     |           |     |M|  6
    |        0 0 1 0  |     |           |     |M|  7
    |      0 0 0 0 1 0|     |      0    |     |M|  8
    |      0       0 1|     |      0    |     |x|  9
    -------------------     -------------
    */

    pivot = sc_to_sc_matrix[2];

    // sc-row-1 = sc-row-1 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[2] = 0;
#endif

    sc_g_matrix[0] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

            sc                   bb            g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5 6
    -------------------     -------------
    |1 x 0 0          |     |           |     |M|  1
    |0 1 0 0          |     |           |     |M|  2
    |0 0 1 0          |     |           |     |M|  3
    |0 0 0 1       0 0|     |      0    |     |M|  4
    |        1 0 0 0  | ... |           | ... |M|  5 sc
    |        0 1 0 0  |     |           |     |M|  6
    |        0 0 1 0  |     |           |     |M|  7
    |      0 0 0 0 1 0|     |      0    |     |M|  8
    |      0       0 1|     |      0    |     |x|  9
    -------------------     -------------
    */

    pivot = sc_to_sc_matrix[1];

    // sc-row-1 = sc-row-1 - sc-row-2 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[1] = 0;
#endif

    sc_g_matrix[0] -= sc_g_matrix[1] * pivot;

    /*
    Resulting matrix:

            sc                   bb            g
     1 2 3 4 5 6 7 8 9       1 2 3 4 5 6
    -------------------     -------------
    |1 0 0 0          |     |           |     |M|  1
    |0 1 0 0          |     |           |     |M|  2
    |0 0 1 0          |     |           |     |M|  3
    |0 0 0 1       0 0|     |      0    |     |M|  4
    |        1 0 0 0  | ... |           | ... |M|  5 sc
    |        0 1 0 0  |     |           |     |M|  6
    |        0 0 1 0  |     |           |     |M|  7
    |      0 0 0 0 1 0|     |      0    |     |M|  8
    |      0       0 1|     |      0    |     |x|  9
    -------------------     -------------
    */
}

void gmx::IlvesPC::solve_17_leucine(real *const sc_to_sc_matrix,
                                    real *const sc_g_matrix,
                                    __attribute__((unused))
                                    real *const sc_to_sc_fillins) {
    /*
     *
     * Row 11
     *
     */

    real pivot = sc_to_sc_matrix[50];

    // sc-row-11 = sc-row-11 - sc-row-12 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[50] = 0;
#endif

    sc_g_matrix[10] -= sc_g_matrix[11] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x x x                |     |           |     |x|  1
    |0 1 x x                |     |           |     |x|  2
    |0 0 1 x                |     |           |     |x|  3
    |0 0 0 1       x x x    |     |           |     |x|  4
    |        1 x x x        |     |           |     |x|  5
    |        0 1 x x        |     |           |     |x|  6
    |        0 0 1 x        | ... |           | ... |x|  7 sc
    |      0 0 0 0 1 x x    |     |           |     |x|  8
    |      0       0 1 x    |     |           |     |x|  9
    |      0       0 0 1 x x|     |      0    |     |x| 10
    |                  0 1 0|     |      0    |     |M| 11
    |                  0 0 1|     |      0    |     |x| 12
    -------------------------     -------------
    */

    /*
     *
     * Row 10
     *
     */

    pivot = sc_to_sc_matrix[47];

    // sc-row-10 = sc-row-10 - sc-row-12 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[47] = 0;
#endif

    sc_g_matrix[9] -= sc_g_matrix[11] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x x x                |     |           |     |x|  1
    |0 1 x x                |     |           |     |x|  2
    |0 0 1 x                |     |           |     |x|  3
    |0 0 0 1       x x x    |     |           |     |x|  4
    |        1 x x x        |     |           |     |x|  5
    |        0 1 x x        |     |           |     |x|  6
    |        0 0 1 x        | ... |           | ... |x|  7 sc
    |      0 0 0 0 1 x x    |     |           |     |x|  8
    |      0       0 1 x    |     |           |     |x|  9
    |      0       0 0 1 x 0|     |      0    |     |M| 10
    |                  0 1 0|     |      0    |     |M| 11
    |                  0 0 1|     |      0    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[46];

    // sc-row-10 = sc-row-10 - sc-row-11 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[46] = 0;
#endif

    sc_g_matrix[9] -= sc_g_matrix[10] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x x x                |     |           |     |x|  1
    |0 1 x x                |     |           |     |x|  2
    |0 0 1 x                |     |           |     |x|  3
    |0 0 0 1       x x x    |     |           |     |x|  4
    |        1 x x x        |     |           |     |x|  5
    |        0 1 x x        |     |           |     |x|  6
    |        0 0 1 x        | ... |           | ... |x|  7 sc
    |      0 0 0 0 1 x x    |     |           |     |x|  8
    |      0       0 1 x    |     |           |     |x|  9
    |      0       0 0 1 0 0|     |      0    |     |M| 10
    |                  0 1 0|     |      0    |     |M| 11
    |                  0 0 1|     |      0    |     |x| 12
    -------------------------     -------------
    */

    /*
     *
     * Row 9
     *
     */

    pivot = sc_to_sc_matrix[41];

    // sc-row-9 = sc-row-9 - sc-row-10 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[41] = 0;
#endif

    sc_g_matrix[8] -= sc_g_matrix[9] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x x x                |     |           |     |x|  1
    |0 1 x x                |     |           |     |x|  2
    |0 0 1 x                |     |           |     |x|  3
    |0 0 0 1       x x x    |     |           |     |x|  4
    |        1 x x x        |     |           |     |x|  5
    |        0 1 x x        |     |           |     |x|  6
    |        0 0 1 x        | ... |           | ... |x|  7 sc
    |      0 0 0 0 1 x x    |     |           |     |x|  8
    |      0       0 1 0    |     |           |     |M|  9
    |      0       0 0 1 0 0|     |      0    |     |M| 10
    |                  0 1 0|     |      0    |     |M| 11
    |                  0 0 1|     |      0    |     |x| 12
    -------------------------     -------------
    */

    /*
     *
     * Row 8
     *
     */

    pivot = sc_to_sc_matrix[37];

    // sc-row-8 = sc-row-8 - sc-row-10 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[37] = 0;
#endif

    sc_g_matrix[7] -= sc_g_matrix[9] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x x x                |     |           |     |x|  1
    |0 1 x x                |     |           |     |x|  2
    |0 0 1 x                |     |           |     |x|  3
    |0 0 0 1       x x x    |     |           |     |x|  4
    |        1 x x x        |     |           |     |x|  5
    |        0 1 x x        |     |           |     |x|  6
    |        0 0 1 x        | ... |           | ... |x|  7 sc
    |      0 0 0 0 1 x 0    |     |           |     |M|  8
    |      0       0 1 0    |     |           |     |M|  9
    |      0       0 0 1 0 0|     |      0    |     |M| 10
    |                  0 1 0|     |      0    |     |M| 11
    |                  0 0 1|     |      0    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[36];

    // sc-row-8 = sc-row-8 - sc-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[36] = 0;
#endif

    sc_g_matrix[7] -= sc_g_matrix[8] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x x x                |     |           |     |x|  1
    |0 1 x x                |     |           |     |x|  2
    |0 0 1 x                |     |           |     |x|  3
    |0 0 0 1       x x x    |     |           |     |x|  4
    |        1 x x x        |     |           |     |x|  5
    |        0 1 x x        |     |           |     |x|  6
    |        0 0 1 x        | ... |           | ... |x|  7 sc
    |      0 0 0 0 1 0 0    |     |           |     |M|  8
    |      0       0 1 0    |     |           |     |M|  9
    |      0       0 0 1 0 0|     |      0    |     |M| 10
    |                  0 1 0|     |      0    |     |M| 11
    |                  0 0 1|     |      0    |     |x| 12
    -------------------------     -------------
    */

    /*
     *
     * Row 7
     *
     */

    pivot = sc_to_sc_matrix[30];

    // sc-row-7 = sc-row-7 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[30] = 0;
#endif

    sc_g_matrix[6] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x x x                |     |           |     |x|  1
    |0 1 x x                |     |           |     |x|  2
    |0 0 1 x                |     |           |     |x|  3
    |0 0 0 1       x x x    |     |           |     |x|  4
    |        1 x x x        |     |           |     |x|  5
    |        0 1 x x        |     |           |     |x|  6
    |        0 0 1 0        | ... |           | ... |M|  7 sc
    |      0 0 0 0 1 0 0    |     |           |     |M|  8
    |      0       0 1 0    |     |           |     |M|  9
    |      0       0 0 1 0 0|     |      0    |     |M| 10
    |                  0 1 0|     |      0    |     |M| 11
    |                  0 0 1|     |      0    |     |x| 12
    -------------------------     -------------
    */

    /*
     *
     * Row 6
     *
     */

    pivot = sc_to_sc_matrix[26];

    // sc-row-6 = sc-row-6 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[26] = 0;
#endif

    sc_g_matrix[5] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x x x                |     |           |     |x|  1
    |0 1 x x                |     |           |     |x|  2
    |0 0 1 x                |     |           |     |x|  3
    |0 0 0 1       x x x    |     |           |     |x|  4
    |        1 x x x        |     |           |     |x|  5
    |        0 1 x 0        |     |           |     |M|  6
    |        0 0 1 0        | ... |           | ... |M|  7 sc
    |      0 0 0 0 1 0 0    |     |           |     |M|  8
    |      0       0 1 0    |     |           |     |M|  9
    |      0       0 0 1 0 0|     |      0    |     |M| 10
    |                  0 1 0|     |      0    |     |M| 11
    |                  0 0 1|     |      0    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[25];

    // sc-row-6 = sc-row-6 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[25] = 0;
#endif

    sc_g_matrix[5] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x x x                |     |           |     |x|  1
    |0 1 x x                |     |           |     |x|  2
    |0 0 1 x                |     |           |     |x|  3
    |0 0 0 1       x x x    |     |           |     |x|  4
    |        1 x x x        |     |           |     |x|  5
    |        0 1 0 0        |     |           |     |M|  6
    |        0 0 1 0        | ... |           | ... |M|  7 sc
    |      0 0 0 0 1 0 0    |     |           |     |M|  8
    |      0       0 1 0    |     |           |     |M|  9
    |      0       0 0 1 0 0|     |      0    |     |M| 10
    |                  0 1 0|     |      0    |     |M| 11
    |                  0 0 1|     |      0    |     |x| 12
    -------------------------     -------------
    */

    /*
     *
     * Row 5
     *
     */

    pivot = sc_to_sc_matrix[22];

    // sc-row-5 = sc-row-5 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[22] = 0;
#endif

    sc_g_matrix[4] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x x x                |     |           |     |x|  1
    |0 1 x x                |     |           |     |x|  2
    |0 0 1 x                |     |           |     |x|  3
    |0 0 0 1       x x x    |     |           |     |x|  4
    |        1 x x 0        |     |           |     |M|  5
    |        0 1 0 0        |     |           |     |M|  6
    |        0 0 1 0        | ... |           | ... |M|  7 sc
    |      0 0 0 0 1 0 0    |     |           |     |M|  8
    |      0       0 1 0    |     |           |     |M|  9
    |      0       0 0 1 0 0|     |      0    |     |M| 10
    |                  0 1 0|     |      0    |     |M| 11
    |                  0 0 1|     |      0    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[21];

    // sc-row-5 = sc-row-5 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[21] = 0;
#endif

    sc_g_matrix[4] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x x x                |     |           |     |x|  1
    |0 1 x x                |     |           |     |x|  2
    |0 0 1 x                |     |           |     |x|  3
    |0 0 0 1       x x x    |     |           |     |x|  4
    |        1 x 0 0        |     |           |     |M|  5
    |        0 1 0 0        |     |           |     |M|  6
    |        0 0 1 0        | ... |           | ... |M|  7 sc
    |      0 0 0 0 1 0 0    |     |           |     |M|  8
    |      0       0 1 0    |     |           |     |M|  9
    |      0       0 0 1 0 0|     |      0    |     |M| 10
    |                  0 1 0|     |      0    |     |M| 11
    |                  0 0 1|     |      0    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[20];

    // sc-row-5 = sc-row-5 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[20] = 0;
#endif

    sc_g_matrix[4] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x x x                |     |           |     |x|  1
    |0 1 x x                |     |           |     |x|  2
    |0 0 1 x                |     |           |     |x|  3
    |0 0 0 1       x x x    |     |           |     |x|  4
    |        1 0 0 0        |     |           |     |M|  5
    |        0 1 0 0        |     |           |     |M|  6
    |        0 0 1 0        | ... |           | ... |M|  7 sc
    |      0 0 0 0 1 0 0    |     |           |     |M|  8
    |      0       0 1 0    |     |           |     |M|  9
    |      0       0 0 1 0 0|     |      0    |     |M| 10
    |                  0 1 0|     |      0    |     |M| 11
    |                  0 0 1|     |      0    |     |x| 12
    -------------------------     -------------
    */

    /*
     *
     * Row 4
     *
     */

    pivot = sc_to_sc_matrix[18];

    // sc-row-4 = sc-row-4 - sc-row-10 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[18] = 0;
#endif

    sc_g_matrix[3] -= sc_g_matrix[9] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x x x                |     |           |     |x|  1
    |0 1 x x                |     |           |     |x|  2
    |0 0 1 x                |     |           |     |x|  3
    |0 0 0 1       x x 0    |     |           |     |M|  4
    |        1 0 0 0        |     |           |     |M|  5
    |        0 1 0 0        |     |           |     |M|  6
    |        0 0 1 0        | ... |           | ... |M|  7 sc
    |      0 0 0 0 1 0 0    |     |           |     |M|  8
    |      0       0 1 0    |     |           |     |M|  9
    |      0       0 0 1 0 0|     |      0    |     |M| 10
    |                  0 1 0|     |      0    |     |M| 11
    |                  0 0 1|     |      0    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[17];

    // sc-row-4 = sc-row-4 - sc-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[17] = 0;
#endif

    sc_g_matrix[3] -= sc_g_matrix[8] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x x x                |     |           |     |x|  1
    |0 1 x x                |     |           |     |x|  2
    |0 0 1 x                |     |           |     |x|  3
    |0 0 0 1       x 0 0    |     |           |     |M|  4
    |        1 0 0 0        |     |           |     |M|  5
    |        0 1 0 0        |     |           |     |M|  6
    |        0 0 1 0        | ... |           | ... |M|  7 sc
    |      0 0 0 0 1 0 0    |     |           |     |M|  8
    |      0       0 1 0    |     |           |     |M|  9
    |      0       0 0 1 0 0|     |      0    |     |M| 10
    |                  0 1 0|     |      0    |     |M| 11
    |                  0 0 1|     |      0    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[16];

    // sc-row-4 = sc-row-4 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[16] = 0;
#endif

    sc_g_matrix[3] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x x x                |     |           |     |x|  1
    |0 1 x x                |     |           |     |x|  2
    |0 0 1 x                |     |           |     |x|  3
    |0 0 0 1       0 0 0    |     |           |     |M|  4
    |        1 0 0 0        |     |           |     |M|  5
    |        0 1 0 0        |     |           |     |M|  6
    |        0 0 1 0        | ... |           | ... |M|  7 sc
    |      0 0 0 0 1 0 0    |     |           |     |M|  8
    |      0       0 1 0    |     |           |     |M|  9
    |      0       0 0 1 0 0|     |      0    |     |M| 10
    |                  0 1 0|     |      0    |     |M| 11
    |                  0 0 1|     |      0    |     |x| 12
    -------------------------     -------------
    */

    /*
     *
     * Row 3
     *
     */

    pivot = sc_to_sc_matrix[11];

    // sc-row-3 = sc-row-3 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[11] = 0;
#endif

    sc_g_matrix[2] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x x x                |     |           |     |x|  1
    |0 1 x x                |     |           |     |x|  2
    |0 0 1 0                |     |           |     |M|  3
    |0 0 0 1       0 0 0    |     |           |     |M|  4
    |        1 0 0 0        |     |           |     |M|  5
    |        0 1 0 0        |     |           |     |M|  6
    |        0 0 1 0        | ... |           | ... |M|  7 sc
    |      0 0 0 0 1 0 0    |     |           |     |M|  8
    |      0       0 1 0    |     |           |     |M|  9
    |      0       0 0 1 0 0|     |      0    |     |M| 10
    |                  0 1 0|     |      0    |     |M| 11
    |                  0 0 1|     |      0    |     |x| 12
    -------------------------     -------------
    */

    /*
     *
     * Row 2
     *
     */

    pivot = sc_to_sc_matrix[7];

    // sc-row-2 = sc-row-2 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[7] = 0;
#endif

    sc_g_matrix[1] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x x x                |     |           |     |x|  1
    |0 1 x 0                |     |           |     |M|  2
    |0 0 1 0                |     |           |     |M|  3
    |0 0 0 1       0 0 0    |     |           |     |M|  4
    |        1 0 0 0        |     |           |     |M|  5
    |        0 1 0 0        |     |           |     |M|  6
    |        0 0 1 0        | ... |           | ... |M|  7 sc
    |      0 0 0 0 1 0 0    |     |           |     |M|  8
    |      0       0 1 0    |     |           |     |M|  9
    |      0       0 0 1 0 0|     |      0    |     |M| 10
    |                  0 1 0|     |      0    |     |M| 11
    |                  0 0 1|     |      0    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[6];

    // sc-row-2 = sc-row-2 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[6] = 0;
#endif

    sc_g_matrix[1] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x x x                |     |           |     |x|  1
    |0 1 0 0                |     |           |     |M|  2
    |0 0 1 0                |     |           |     |M|  3
    |0 0 0 1       0 0 0    |     |           |     |M|  4
    |        1 0 0 0        |     |           |     |M|  5
    |        0 1 0 0        |     |           |     |M|  6
    |        0 0 1 0        | ... |           | ... |M|  7 sc
    |      0 0 0 0 1 0 0    |     |           |     |M|  8
    |      0       0 1 0    |     |           |     |M|  9
    |      0       0 0 1 0 0|     |      0    |     |M| 10
    |                  0 1 0|     |      0    |     |M| 11
    |                  0 0 1|     |      0    |     |x| 12
    -------------------------     -------------
    */

    /*
     *
     * Row 1
     *
     */

    pivot = sc_to_sc_matrix[3];

    // sc-row-1 = sc-row-1 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[3] = 0;
#endif

    sc_g_matrix[0] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x x 0                |     |           |     |M|  1
    |0 1 0 0                |     |           |     |M|  2
    |0 0 1 0                |     |           |     |M|  3
    |0 0 0 1       0 0 0    |     |           |     |M|  4
    |        1 0 0 0        |     |           |     |M|  5
    |        0 1 0 0        |     |           |     |M|  6
    |        0 0 1 0        | ... |           | ... |M|  7 sc
    |      0 0 0 0 1 0 0    |     |           |     |M|  8
    |      0       0 1 0    |     |           |     |M|  9
    |      0       0 0 1 0 0|     |      0    |     |M| 10
    |                  0 1 0|     |      0    |     |M| 11
    |                  0 0 1|     |      0    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[2];

    // sc-row-1 = sc-row-1 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[2] = 0;
#endif

    sc_g_matrix[0] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x 0 0                |     |           |     |M|  1
    |0 1 0 0                |     |           |     |M|  2
    |0 0 1 0                |     |           |     |M|  3
    |0 0 0 1       0 0 0    |     |           |     |M|  4
    |        1 0 0 0        |     |           |     |M|  5
    |        0 1 0 0        |     |           |     |M|  6
    |        0 0 1 0        | ... |           | ... |M|  7 sc
    |      0 0 0 0 1 0 0    |     |           |     |M|  8
    |      0       0 1 0    |     |           |     |M|  9
    |      0       0 0 1 0 0|     |      0    |     |M| 10
    |                  0 1 0|     |      0    |     |M| 11
    |                  0 0 1|     |      0    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[1];

    // sc-row-1 = sc-row-1 - sc-row-2 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[1] = 0;
#endif

    sc_g_matrix[0] -= sc_g_matrix[1] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 0 0 0                |     |           |     |M|  1
    |0 1 0 0                |     |           |     |M|  2
    |0 0 1 0                |     |           |     |M|  3
    |0 0 0 1       0 0 0    |     |           |     |M|  4
    |        1 0 0 0        |     |           |     |M|  5
    |        0 1 0 0        |     |           |     |M|  6
    |        0 0 1 0        | ... |           | ... |M|  7 sc
    |      0 0 0 0 1 0 0    |     |           |     |M|  8
    |      0       0 1 0    |     |           |     |M|  9
    |      0       0 0 1 0 0|     |      0    |     |M| 10
    |                  0 1 0|     |      0    |     |M| 11
    |                  0 0 1|     |      0    |     |x| 12
    -------------------------     -------------
    */
}

void gmx::IlvesPC::solve_17_isoleucine(real *const sc_to_sc_matrix,
                                       real *const sc_g_matrix,
                                       __attribute__((unused))
                                       real *const sc_to_sc_fillins) {
    /*
     *
     * Row 11
     *
     */

    real pivot = sc_to_sc_matrix[50];

    // sc-row-11 = sc-row-11 - sc-row-12 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[50] = 0;
#endif

    sc_g_matrix[10] -= sc_g_matrix[11] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x x x                |     |           |     |x|  1
    |0 1 x x                |     |           |     |x|  2
    |0 0 1 x                |     |           |     |x|  3
    |0 0 0 1 x x x          |     |           |     |x|  4
    |      0 1 x x          |     |           |     |x|  5
    |      0 0 1 x          |     |           |     |x|  6
    |      0 0 0 1       x x| ... |      0    | ... |x|  7 sc
    |              1 x x x  |     |           |     |x|  8
    |              0 1 x x  |     |           |     |x|  9
    |              0 0 1 x  |     |           |     |x| 10
    |            0 0 0 0 1 0|     |      0    |     |M| 11
    |            0       0 1|     |      0    |     |x| 12
    -------------------------     -------------
    */

    /*
     *
     * Row 10
     *
     */

    pivot = sc_to_sc_matrix[44];

    // sc-row-10 = sc-row-10 - sc-row-11 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[44] = 0;
#endif

    sc_g_matrix[9] -= sc_g_matrix[10] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x x x                |     |           |     |x|  1
    |0 1 x x                |     |           |     |x|  2
    |0 0 1 x                |     |           |     |x|  3
    |0 0 0 1 x x x          |     |           |     |x|  4
    |      0 1 x x          |     |           |     |x|  5
    |      0 0 1 x          |     |           |     |x|  6
    |      0 0 0 1       x x| ... |      0    | ... |x|  7 sc
    |              1 x x x  |     |           |     |x|  8
    |              0 1 x x  |     |           |     |x|  9
    |              0 0 1 0  |     |           |     |M| 10
    |            0 0 0 0 1 0|     |      0    |     |M| 11
    |            0       0 1|     |      0    |     |x| 12
    -------------------------     -------------
    */

    /*
     *
     * Row 9
     *
     */

    pivot = sc_to_sc_matrix[40];

    // sc-row-9 = sc-row-9 - sc-row-11 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[40] = 0;
#endif

    sc_g_matrix[8] -= sc_g_matrix[10] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x x x                |     |           |     |x|  1
    |0 1 x x                |     |           |     |x|  2
    |0 0 1 x                |     |           |     |x|  3
    |0 0 0 1 x x x          |     |           |     |x|  4
    |      0 1 x x          |     |           |     |x|  5
    |      0 0 1 x          |     |           |     |x|  6
    |      0 0 0 1       x x| ... |      0    | ... |x|  7 sc
    |              1 x x x  |     |           |     |x|  8
    |              0 1 x 0  |     |           |     |M|  9
    |              0 0 1 0  |     |           |     |M| 10
    |            0 0 0 0 1 0|     |      0    |     |M| 11
    |            0       0 1|     |      0    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[39];

    // sc-row-9 = sc-row-9 - sc-row-10 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[39] = 0;
#endif

    sc_g_matrix[8] -= sc_g_matrix[9] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x x x                |     |           |     |x|  1
    |0 1 x x                |     |           |     |x|  2
    |0 0 1 x                |     |           |     |x|  3
    |0 0 0 1 x x x          |     |           |     |x|  4
    |      0 1 x x          |     |           |     |x|  5
    |      0 0 1 x          |     |           |     |x|  6
    |      0 0 0 1       x x| ... |      0    | ... |x|  7 sc
    |              1 x x x  |     |           |     |x|  8
    |              0 1 0 0  |     |           |     |M|  9
    |              0 0 1 0  |     |           |     |M| 10
    |            0 0 0 0 1 0|     |      0    |     |M| 11
    |            0       0 1|     |      0    |     |x| 12
    -------------------------     -------------
    */

    /*
     *
     * Row 8
     *
     */

    pivot = sc_to_sc_matrix[36];

    // sc-row-8 = sc-row-8 - sc-row-11 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[36] = 0;
#endif

    sc_g_matrix[7] -= sc_g_matrix[10] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x x x                |     |           |     |x|  1
    |0 1 x x                |     |           |     |x|  2
    |0 0 1 x                |     |           |     |x|  3
    |0 0 0 1 x x x          |     |           |     |x|  4
    |      0 1 x x          |     |           |     |x|  5
    |      0 0 1 x          |     |           |     |x|  6
    |      0 0 0 1       x x| ... |      0    | ... |x|  7 sc
    |              1 x x 0  |     |           |     |M|  8
    |              0 1 0 0  |     |           |     |M|  9
    |              0 0 1 0  |     |           |     |M| 10
    |            0 0 0 0 1 0|     |      0    |     |M| 11
    |            0       0 1|     |      0    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[35];

    // sc-row-8 = sc-row-8 - sc-row-10 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[35] = 0;
#endif

    sc_g_matrix[7] -= sc_g_matrix[9] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x x x                |     |           |     |x|  1
    |0 1 x x                |     |           |     |x|  2
    |0 0 1 x                |     |           |     |x|  3
    |0 0 0 1 x x x          |     |           |     |x|  4
    |      0 1 x x          |     |           |     |x|  5
    |      0 0 1 x          |     |           |     |x|  6
    |      0 0 0 1       x x| ... |      0    | ... |x|  7 sc
    |              1 x 0 0  |     |           |     |M|  8
    |              0 1 0 0  |     |           |     |M|  9
    |              0 0 1 0  |     |           |     |M| 10
    |            0 0 0 0 1 0|     |      0    |     |M| 11
    |            0       0 1|     |      0    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[34];

    // sc-row-8 = sc-row-8 - sc-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[34] = 0;
#endif

    sc_g_matrix[7] -= sc_g_matrix[8] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x x x                |     |           |     |x|  1
    |0 1 x x                |     |           |     |x|  2
    |0 0 1 x                |     |           |     |x|  3
    |0 0 0 1 x x x          |     |           |     |x|  4
    |      0 1 x x          |     |           |     |x|  5
    |      0 0 1 x          |     |           |     |x|  6
    |      0 0 0 1       x x| ... |      0    | ... |x|  7 sc
    |              1 0 0 0  |     |           |     |M|  8
    |              0 1 0 0  |     |           |     |M|  9
    |              0 0 1 0  |     |           |     |M| 10
    |            0 0 0 0 1 0|     |      0    |     |M| 11
    |            0       0 1|     |      0    |     |x| 12
    -------------------------     -------------
    */

    /*
     *
     * Row 7
     *
     */

    pivot = sc_to_sc_matrix[32];

    // sc-row-7 = sc-row-7 - sc-row-12 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[32] = 0;
#endif

    sc_g_matrix[6] -= sc_g_matrix[11] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x x x                |     |           |     |x|  1
    |0 1 x x                |     |           |     |x|  2
    |0 0 1 x                |     |           |     |x|  3
    |0 0 0 1 x x x          |     |           |     |x|  4
    |      0 1 x x          |     |           |     |x|  5
    |      0 0 1 x          |     |           |     |x|  6
    |      0 0 0 1       x 0| ... |      0    | ... |M|  7 sc
    |              1 0 0 0  |     |           |     |M|  8
    |              0 1 0 0  |     |           |     |M|  9
    |              0 0 1 0  |     |           |     |M| 10
    |            0 0 0 0 1 0|     |      0    |     |M| 11
    |            0       0 1|     |      0    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[31];

    // sc-row-7 = sc-row-7 - sc-row-11 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[31] = 0;
#endif

    sc_g_matrix[6] -= sc_g_matrix[10] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x x x                |     |           |     |x|  1
    |0 1 x x                |     |           |     |x|  2
    |0 0 1 x                |     |           |     |x|  3
    |0 0 0 1 x x x          |     |           |     |x|  4
    |      0 1 x x          |     |           |     |x|  5
    |      0 0 1 x          |     |           |     |x|  6
    |      0 0 0 1       0 0| ... |      0    | ... |M|  7 sc
    |              1 0 0 0  |     |           |     |M|  8
    |              0 1 0 0  |     |           |     |M|  9
    |              0 0 1 0  |     |           |     |M| 10
    |            0 0 0 0 1 0|     |      0    |     |M| 11
    |            0       0 1|     |      0    |     |x| 12
    -------------------------     -------------
    */

    /*
     *
     * Row 6
     *
     */

    pivot = sc_to_sc_matrix[26];

    // sc-row-6 = sc-row-6 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[26] = 0;
#endif

    sc_g_matrix[5] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x x x                |     |           |     |x|  1
    |0 1 x x                |     |           |     |x|  2
    |0 0 1 x                |     |           |     |x|  3
    |0 0 0 1 x x x          |     |           |     |x|  4
    |      0 1 x x          |     |           |     |x|  5
    |      0 0 1 0          |     |           |     |M|  6
    |      0 0 0 1       0 0| ... |      0    | ... |M|  7 sc
    |              1 0 0 0  |     |           |     |M|  8
    |              0 1 0 0  |     |           |     |M|  9
    |              0 0 1 0  |     |           |     |M| 10
    |            0 0 0 0 1 0|     |      0    |     |M| 11
    |            0       0 1|     |      0    |     |x| 12
    -------------------------     -------------
    */

    /*
     *
     * Row 5
     *
     */

    pivot = sc_to_sc_matrix[22];

    // sc-row-5 = sc-row-5 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[22] = 0;
#endif

    sc_g_matrix[4] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x x x                |     |           |     |x|  1
    |0 1 x x                |     |           |     |x|  2
    |0 0 1 x                |     |           |     |x|  3
    |0 0 0 1 x x x          |     |           |     |x|  4
    |      0 1 x 0          |     |           |     |M|  5
    |      0 0 1 0          |     |           |     |M|  6
    |      0 0 0 1       0 0| ... |      0    | ... |M|  7 sc
    |              1 0 0 0  |     |           |     |M|  8
    |              0 1 0 0  |     |           |     |M|  9
    |              0 0 1 0  |     |           |     |M| 10
    |            0 0 0 0 1 0|     |      0    |     |M| 11
    |            0       0 1|     |      0    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[21];

    // sc-row-5 = sc-row-5 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[21] = 0;
#endif

    sc_g_matrix[4] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x x x                |     |           |     |x|  1
    |0 1 x x                |     |           |     |x|  2
    |0 0 1 x                |     |           |     |x|  3
    |0 0 0 1 x x x          |     |           |     |x|  4
    |      0 1 0 0          |     |           |     |M|  5
    |      0 0 1 0          |     |           |     |M|  6
    |      0 0 0 1       0 0| ... |      0    | ... |M|  7 sc
    |              1 0 0 0  |     |           |     |M|  8
    |              0 1 0 0  |     |           |     |M|  9
    |              0 0 1 0  |     |           |     |M| 10
    |            0 0 0 0 1 0|     |      0    |     |M| 11
    |            0       0 1|     |      0    |     |x| 12
    -------------------------     -------------
    */

    /*
     *
     * Row 4
     *
     */

    pivot = sc_to_sc_matrix[18];

    // sc-row-4 = sc-row-4 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[18] = 0;
#endif

    sc_g_matrix[3] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x x x                |     |           |     |x|  1
    |0 1 x x                |     |           |     |x|  2
    |0 0 1 x                |     |           |     |x|  3
    |0 0 0 1 x x 0          |     |           |     |M|  4
    |      0 1 0 0          |     |           |     |M|  5
    |      0 0 1 0          |     |           |     |M|  6
    |      0 0 0 1       0 0| ... |      0    | ... |M|  7 sc
    |              1 0 0 0  |     |           |     |M|  8
    |              0 1 0 0  |     |           |     |M|  9
    |              0 0 1 0  |     |           |     |M| 10
    |            0 0 0 0 1 0|     |      0    |     |M| 11
    |            0       0 1|     |      0    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[17];

    // sc-row-4 = sc-row-4 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[17] = 0;
#endif

    sc_g_matrix[3] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x x x                |     |           |     |x|  1
    |0 1 x x                |     |           |     |x|  2
    |0 0 1 x                |     |           |     |x|  3
    |0 0 0 1 x 0 0          |     |           |     |M|  4
    |      0 1 0 0          |     |           |     |M|  5
    |      0 0 1 0          |     |           |     |M|  6
    |      0 0 0 1       0 0| ... |      0    | ... |M|  7 sc
    |              1 0 0 0  |     |           |     |M|  8
    |              0 1 0 0  |     |           |     |M|  9
    |              0 0 1 0  |     |           |     |M| 10
    |            0 0 0 0 1 0|     |      0    |     |M| 11
    |            0       0 1|     |      0    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[16];

    // sc-row-4 = sc-row-4 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[16] = 0;
#endif

    sc_g_matrix[3] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x x x                |     |           |     |x|  1
    |0 1 x x                |     |           |     |x|  2
    |0 0 1 x                |     |           |     |x|  3
    |0 0 0 1 0 0 0          |     |           |     |M|  4
    |      0 1 0 0          |     |           |     |M|  5
    |      0 0 1 0          |     |           |     |M|  6
    |      0 0 0 1       0 0| ... |      0    | ... |M|  7 sc
    |              1 0 0 0  |     |           |     |M|  8
    |              0 1 0 0  |     |           |     |M|  9
    |              0 0 1 0  |     |           |     |M| 10
    |            0 0 0 0 1 0|     |      0    |     |M| 11
    |            0       0 1|     |      0    |     |x| 12
    -------------------------     -------------
    */

    /*
     *
     * Row 3
     *
     */

    pivot = sc_to_sc_matrix[11];

    // sc-row-3 = sc-row-3 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[11] = 0;
#endif

    sc_g_matrix[2] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x x x                |     |           |     |x|  1
    |0 1 x x                |     |           |     |x|  2
    |0 0 1 0                |     |           |     |M|  3
    |0 0 0 1 0 0 0          |     |           |     |M|  4
    |      0 1 0 0          |     |           |     |M|  5
    |      0 0 1 0          |     |           |     |M|  6
    |      0 0 0 1       0 0| ... |      0    | ... |M|  7 sc
    |              1 0 0 0  |     |           |     |M|  8
    |              0 1 0 0  |     |           |     |M|  9
    |              0 0 1 0  |     |           |     |M| 10
    |            0 0 0 0 1 0|     |      0    |     |M| 11
    |            0       0 1|     |      0    |     |x| 12
    -------------------------     -------------
    */

    /*
     *
     * Row 2
     *
     */

    pivot = sc_to_sc_matrix[7];

    // sc-row-2 = sc-row-2 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[7] = 0;
#endif

    sc_g_matrix[1] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x x x                |     |           |     |x|  1
    |0 1 x 0                |     |           |     |M|  2
    |0 0 1 0                |     |           |     |M|  3
    |0 0 0 1 0 0 0          |     |           |     |M|  4
    |      0 1 0 0          |     |           |     |M|  5
    |      0 0 1 0          |     |           |     |M|  6
    |      0 0 0 1       0 0| ... |      0    | ... |M|  7 sc
    |              1 0 0 0  |     |           |     |M|  8
    |              0 1 0 0  |     |           |     |M|  9
    |              0 0 1 0  |     |           |     |M| 10
    |            0 0 0 0 1 0|     |      0    |     |M| 11
    |            0       0 1|     |      0    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[6];

    // sc-row-2 = sc-row-2 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[6] = 0;
#endif

    sc_g_matrix[1] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x x x                |     |           |     |x|  1
    |0 1 0 0                |     |           |     |M|  2
    |0 0 1 0                |     |           |     |M|  3
    |0 0 0 1 0 0 0          |     |           |     |M|  4
    |      0 1 0 0          |     |           |     |M|  5
    |      0 0 1 0          |     |           |     |M|  6
    |      0 0 0 1       0 0| ... |      0    | ... |M|  7 sc
    |              1 0 0 0  |     |           |     |M|  8
    |              0 1 0 0  |     |           |     |M|  9
    |              0 0 1 0  |     |           |     |M| 10
    |            0 0 0 0 1 0|     |      0    |     |M| 11
    |            0       0 1|     |      0    |     |x| 12
    -------------------------     -------------
    */

    /*
     *
     * Row 1
     *
     */

    pivot = sc_to_sc_matrix[3];

    // sc-row-1 = sc-row-1 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[3] = 0;
#endif

    sc_g_matrix[0] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x x 0                |     |           |     |M|  1
    |0 1 0 0                |     |           |     |M|  2
    |0 0 1 0                |     |           |     |M|  3
    |0 0 0 1 0 0 0          |     |           |     |M|  4
    |      0 1 0 0          |     |           |     |M|  5
    |      0 0 1 0          |     |           |     |M|  6
    |      0 0 0 1       0 0| ... |      0    | ... |M|  7 sc
    |              1 0 0 0  |     |           |     |M|  8
    |              0 1 0 0  |     |           |     |M|  9
    |              0 0 1 0  |     |           |     |M| 10
    |            0 0 0 0 1 0|     |      0    |     |M| 11
    |            0       0 1|     |      0    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[2];

    // sc-row-1 = sc-row-1 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[2] = 0;
#endif

    sc_g_matrix[0] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 x 0 0                |     |           |     |M|  1
    |0 1 0 0                |     |           |     |M|  2
    |0 0 1 0                |     |           |     |M|  3
    |0 0 0 1 0 0 0          |     |           |     |M|  4
    |      0 1 0 0          |     |           |     |M|  5
    |      0 0 1 0          |     |           |     |M|  6
    |      0 0 0 1       0 0| ... |      0    | ... |M|  7 sc
    |              1 0 0 0  |     |           |     |M|  8
    |              0 1 0 0  |     |           |     |M|  9
    |              0 0 1 0  |     |           |     |M| 10
    |            0 0 0 0 1 0|     |      0    |     |M| 11
    |            0       0 1|     |      0    |     |x| 12
    -------------------------     -------------
    */

    pivot = sc_to_sc_matrix[1];

    // sc-row-1 = sc-row-1 - sc-row-2 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[1] = 0;
#endif

    sc_g_matrix[0] -= sc_g_matrix[1] * pivot;

    /*
    Resulting matrix:

               sc                      bb            g
     1 2 3 4 5 6 7 8 9101112       1 2 3 4 5 6
    -------------------------     -------------
    |1 0 0 0                |     |           |     |M|  1
    |0 1 0 0                |     |           |     |M|  2
    |0 0 1 0                |     |           |     |M|  3
    |0 0 0 1 0 0 0          |     |           |     |M|  4
    |      0 1 0 0          |     |           |     |M|  5
    |      0 0 1 0          |     |           |     |M|  6
    |      0 0 0 1       0 0| ... |      0    | ... |M|  7 sc
    |              1 0 0 0  |     |           |     |M|  8
    |              0 1 0 0  |     |           |     |M|  9
    |              0 0 1 0  |     |           |     |M| 10
    |            0 0 0 0 1 0|     |      0    |     |M| 11
    |            0       0 1|     |      0    |     |x| 12
    -------------------------     -------------
    */
}

void gmx::IlvesPC::solve_17_aspartic_acid(real *const sc_to_sc_matrix,
                                          real *const sc_g_matrix,
                                          __attribute__((unused))
                                          real *const sc_to_sc_fillins) {
    /*
     *
     * Row 4
     *
     */

    real pivot = sc_to_sc_matrix[13];

    // sc-row-4 = sc-row-4 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[13] = 0;
#endif

    sc_g_matrix[3] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

        sc               bb            g
     1 2 3 4 5       1 2 3 4 5 6
    -----------     -------------
    |1 x x    |     |           |     |x|  1
    |0 1 x    |     |           |     |x|  2
    |0 0 1 x x| ... |      0    | ... |x|  3 sc
    |    0 1 0|     |      0    |     |M|  4
    |    0 0 1|     |      0    |     |x|  5
    -----------     -------------
    */

    /*
     *
     * Row 3
     *
     */

    pivot = sc_to_sc_matrix[10];

    // sc-row-3 = sc-row-3 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[10] = 0;
#endif

    sc_g_matrix[2] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

        sc               bb            g
     1 2 3 4 5       1 2 3 4 5 6
    -----------     -------------
    |1 x x    |     |           |     |x|  1
    |0 1 x    |     |           |     |x|  2
    |0 0 1 x 0| ... |      0    | ... |M|  3 sc
    |    0 1 0|     |      0    |     |M|  4
    |    0 0 1|     |      0    |     |x|  5
    -----------     -------------
    */

    pivot = sc_to_sc_matrix[9];

    // sc-row-3 = sc-row-3 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[9] = 0;
#endif

    sc_g_matrix[2] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

        sc               bb            g
     1 2 3 4 5       1 2 3 4 5 6
    -----------     -------------
    |1 x x    |     |           |     |x|  1
    |0 1 x    |     |           |     |x|  2
    |0 0 1 0 0| ... |      0    | ... |M|  3 sc
    |    0 1 0|     |      0    |     |M|  4
    |    0 0 1|     |      0    |     |x|  5
    -----------     -------------
    */

    /*
     *
     * Row 2
     *
     */

    pivot = sc_to_sc_matrix[5];

    // sc-row-2 = sc-row-2 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[5] = 0;
#endif

    sc_g_matrix[1] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

        sc               bb            g
     1 2 3 4 5       1 2 3 4 5 6
    -----------     -------------
    |1 x x    |     |           |     |x|  1
    |0 1 0    |     |           |     |M|  2
    |0 0 1 0 0| ... |      0    | ... |M|  3 sc
    |    0 1 0|     |      0    |     |M|  4
    |    0 0 1|     |      0    |     |x|  5
    -----------     -------------
    */

    /*
     *
     * Row 1
     *
     */

    pivot = sc_to_sc_matrix[2];

    // sc-row-1 = sc-row-1 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[2] = 0;
#endif

    sc_g_matrix[0] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

        sc               bb            g
     1 2 3 4 5       1 2 3 4 5 6
    -----------     -------------
    |1 x 0    |     |           |     |M|  1
    |0 1 0    |     |           |     |M|  2
    |0 0 1 0 0| ... |      0    | ... |M|  3 sc
    |    0 1 0|     |      0    |     |M|  4
    |    0 0 1|     |      0    |     |x|  5
    -----------     -------------
    */

    pivot = sc_to_sc_matrix[1];

    // sc-row-1 = sc-row-1 - sc-row-2 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[1] = 0;
#endif

    sc_g_matrix[0] -= sc_g_matrix[1] * pivot;

    /*
    Resulting matrix:

        sc               bb            g
     1 2 3 4 5       1 2 3 4 5 6
    -----------     -------------
    |1 0 0    |     |           |     |M|  1
    |0 1 0    |     |           |     |M|  2
    |0 0 1 0 0| ... |      0    | ... |M|  3 sc
    |    0 1 0|     |      0    |     |M|  4
    |    0 0 1|     |      0    |     |x|  5
    -----------     -------------
    */
}

void gmx::IlvesPC::solve_17_glutamic_acid(real *const sc_to_sc_matrix,
                                          real *const sc_g_matrix,
                                          __attribute__((unused))
                                          real *const sc_to_sc_fillins) {
    /*
     *
     * Row 7
     *
     */

    real pivot = sc_to_sc_matrix[28];

    // sc-row-7 = sc-row-7 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[28] = 0;
#endif

    sc_g_matrix[6] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

           sc                  bb            g
     1 2 3 4 5 6 7 8       1 2 3 4 5 6
    -----------------     -------------
    |1 x x          |     |           |     |x|  1
    |0 1 x          |     |           |     |x|  2
    |0 0 1 x x x    |     |           |     |x|  3
    |    0 1 x x    |     |           |     |x|  4
    |    0 0 1 x    | ... |           | ... |x|  5 sc
    |    0 0 0 1 x x|     |      0    |     |x|  6
    |          0 1 0|     |      0    |     |M|  7
    |          0 0 1|     |      0    |     |x|  8
    -----------------     -------------
    */

    /*
     *
     * Row 6
     *
     */

    pivot = sc_to_sc_matrix[25];

    // sc-row-6 = sc-row-6 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[25] = 0;
#endif

    sc_g_matrix[5] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

           sc                  bb            g
     1 2 3 4 5 6 7 8       1 2 3 4 5 6
    -----------------     -------------
    |1 x x          |     |           |     |x|  1
    |0 1 x          |     |           |     |x|  2
    |0 0 1 x x x    |     |           |     |x|  3
    |    0 1 x x    |     |           |     |x|  4
    |    0 0 1 x    | ... |           | ... |x|  5 sc
    |    0 0 0 1 x 0|     |      0    |     |M|  6
    |          0 1 0|     |      0    |     |M|  7
    |          0 0 1|     |      0    |     |x|  8
    -----------------     -------------
    */

    pivot = sc_to_sc_matrix[24];

    // sc-row-6 = sc-row-6 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[24] = 0;
#endif

    sc_g_matrix[5] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

           sc                  bb            g
     1 2 3 4 5 6 7 8       1 2 3 4 5 6
    -----------------     -------------
    |1 x x          |     |           |     |x|  1
    |0 1 x          |     |           |     |x|  2
    |0 0 1 x x x    |     |           |     |x|  3
    |    0 1 x x    |     |           |     |x|  4
    |    0 0 1 x    | ... |           | ... |x|  5 sc
    |    0 0 0 1 0 0|     |      0    |     |M|  6
    |          0 1 0|     |      0    |     |M|  7
    |          0 0 1|     |      0    |     |x|  8
    -----------------     -------------
    */

    /*
     *
     * Row 5
     *
     */

    pivot = sc_to_sc_matrix[19];

    // sc-row-5 = sc-row-5 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[19] = 0;
#endif

    sc_g_matrix[4] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

           sc                  bb            g
     1 2 3 4 5 6 7 8       1 2 3 4 5 6
    -----------------     -------------
    |1 x x          |     |           |     |x|  1
    |0 1 x          |     |           |     |x|  2
    |0 0 1 x x x    |     |           |     |x|  3
    |    0 1 x x    |     |           |     |x|  4
    |    0 0 1 0    | ... |           | ... |M|  5 sc
    |    0 0 0 1 0 0|     |      0    |     |M|  6
    |          0 1 0|     |      0    |     |M|  7
    |          0 0 1|     |      0    |     |x|  8
    -----------------     -------------
    */

    /*
     *
     * Row 4
     *
     */

    pivot = sc_to_sc_matrix[15];

    // sc-row-4 = sc-row-4 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[15] = 0;
#endif

    sc_g_matrix[3] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

           sc                  bb            g
     1 2 3 4 5 6 7 8       1 2 3 4 5 6
    -----------------     -------------
    |1 x x          |     |           |     |x|  1
    |0 1 x          |     |           |     |x|  2
    |0 0 1 x x x    |     |           |     |x|  3
    |    0 1 x 0    |     |           |     |M|  4
    |    0 0 1 0    | ... |           | ... |M|  5 sc
    |    0 0 0 1 0 0|     |      0    |     |M|  6
    |          0 1 0|     |      0    |     |M|  7
    |          0 0 1|     |      0    |     |x|  8
    -----------------     -------------
    */

    pivot = sc_to_sc_matrix[14];

    // sc-row-4 = sc-row-4 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[14] = 0;
#endif

    sc_g_matrix[3] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

           sc                  bb            g
     1 2 3 4 5 6 7 8       1 2 3 4 5 6
    -----------------     -------------
    |1 x x          |     |           |     |x|  1
    |0 1 x          |     |           |     |x|  2
    |0 0 1 x x x    |     |           |     |x|  3
    |    0 1 0 0    |     |           |     |M|  4
    |    0 0 1 0    | ... |           | ... |M|  5 sc
    |    0 0 0 1 0 0|     |      0    |     |M|  6
    |          0 1 0|     |      0    |     |M|  7
    |          0 0 1|     |      0    |     |x|  8
    -----------------     -------------
    */

    /*
     *
     * Row 3
     *
     */

    pivot = sc_to_sc_matrix[11];

    // sc-row-3 = sc-row-3 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[11] = 0;
#endif

    sc_g_matrix[2] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

           sc                  bb            g
     1 2 3 4 5 6 7 8       1 2 3 4 5 6
    -----------------     -------------
    |1 x x          |     |           |     |x|  1
    |0 1 x          |     |           |     |x|  2
    |0 0 1 x x 0    |     |           |     |M|  3
    |    0 1 0 0    |     |           |     |M|  4
    |    0 0 1 0    | ... |           | ... |M|  5 sc
    |    0 0 0 1 0 0|     |      0    |     |M|  6
    |          0 1 0|     |      0    |     |M|  7
    |          0 0 1|     |      0    |     |x|  8
    -----------------     -------------
    */

    pivot = sc_to_sc_matrix[10];

    // sc-row-3 = sc-row-3 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[10] = 0;
#endif

    sc_g_matrix[2] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

           sc                  bb            g
     1 2 3 4 5 6 7 8       1 2 3 4 5 6
    -----------------     -------------
    |1 x x          |     |           |     |x|  1
    |0 1 x          |     |           |     |x|  2
    |0 0 1 x 0 0    |     |           |     |M|  3
    |    0 1 0 0    |     |           |     |M|  4
    |    0 0 1 0    | ... |           | ... |M|  5 sc
    |    0 0 0 1 0 0|     |      0    |     |M|  6
    |          0 1 0|     |      0    |     |M|  7
    |          0 0 1|     |      0    |     |x|  8
    -----------------     -------------
    */

    pivot = sc_to_sc_matrix[9];

    // sc-row-3 = sc-row-3 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[9] = 0;
#endif

    sc_g_matrix[2] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

           sc                  bb            g
     1 2 3 4 5 6 7 8       1 2 3 4 5 6
    -----------------     -------------
    |1 x x          |     |           |     |x|  1
    |0 1 x          |     |           |     |x|  2
    |0 0 1 0 0 0    |     |           |     |M|  3
    |    0 1 0 0    |     |           |     |M|  4
    |    0 0 1 0    | ... |           | ... |M|  5 sc
    |    0 0 0 1 0 0|     |      0    |     |M|  6
    |          0 1 0|     |      0    |     |M|  7
    |          0 0 1|     |      0    |     |x|  8
    -----------------     -------------
    */

    /*
     *
     * Row 2
     *
     */

    pivot = sc_to_sc_matrix[5];

    // sc-row-2 = sc-row-2 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[5] = 0;
#endif

    sc_g_matrix[1] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

           sc                  bb            g
     1 2 3 4 5 6 7 8       1 2 3 4 5 6
    -----------------     -------------
    |1 x x          |     |           |     |x|  1
    |0 1 0          |     |           |     |M|  2
    |0 0 1 0 0 0    |     |           |     |M|  3
    |    0 1 0 0    |     |           |     |M|  4
    |    0 0 1 0    | ... |           | ... |M|  5 sc
    |    0 0 0 1 0 0|     |      0    |     |M|  6
    |          0 1 0|     |      0    |     |M|  7
    |          0 0 1|     |      0    |     |x|  8
    -----------------     -------------
    */

    /*
     *
     * Row 1
     *
     */

    pivot = sc_to_sc_matrix[2];

    // sc-row-1 = sc-row-1 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[2] = 0;
#endif

    sc_g_matrix[0] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

           sc                  bb            g
     1 2 3 4 5 6 7 8       1 2 3 4 5 6
    -----------------     -------------
    |1 x 0          |     |           |     |M|  1
    |0 1 0          |     |           |     |M|  2
    |0 0 1 0 0 0    |     |           |     |M|  3
    |    0 1 0 0    |     |           |     |M|  4
    |    0 0 1 0    | ... |           | ... |M|  5 sc
    |    0 0 0 1 0 0|     |      0    |     |M|  6
    |          0 1 0|     |      0    |     |M|  7
    |          0 0 1|     |      0    |     |x|  8
    -----------------     -------------
    */

    pivot = sc_to_sc_matrix[1];

    // sc-row-1 = sc-row-1 - sc-row-2 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[1] = 0;
#endif

    sc_g_matrix[0] -= sc_g_matrix[1] * pivot;

    /*
    Resulting matrix:

           sc                  bb            g
     1 2 3 4 5 6 7 8       1 2 3 4 5 6
    -----------------     -------------
    |1 0 0          |     |           |     |M|  1
    |0 1 0          |     |           |     |M|  2
    |0 0 1 0 0 0    |     |           |     |M|  3
    |    0 1 0 0    |     |           |     |M|  4
    |    0 0 1 0    | ... |           | ... |M|  5 sc
    |    0 0 0 1 0 0|     |      0    |     |M|  6
    |          0 1 0|     |      0    |     |M|  7
    |          0 0 1|     |      0    |     |x|  8
    -----------------     -------------
    */
}

void gmx::IlvesPC::solve_17_asparagine(real *const sc_to_sc_matrix,
                                       real *const sc_g_matrix,
                                       __attribute__((unused))
                                       real *const sc_to_sc_fillins) {
    /*
     *
     * Row 6
     *
     */

    real pivot = sc_to_sc_matrix[21];

    // sc-row-6 = sc-row-6 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[21] = 0;
#endif

    sc_g_matrix[5] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 x x        |     |           |     |x|  1
    |0 1 x        |     |           |     |x|  2
    |0 0 1 x x    |     |           |     |x|  3
    |    0 1 x    | ... |           | ... |x|  4 sc
    |    0 0 1 x x|     |      0    |     |x|  5
    |        0 1 0|     |      0    |     |M|  6
    |        0 0 1|     |      0    |     |x|  7
    ---------------     -------------
    */

    /*
     *
     * Row 5
     *
     */

    pivot = sc_to_sc_matrix[18];

    // sc-row-5 = sc-row-5 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[18] = 0;
#endif

    sc_g_matrix[4] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 x x        |     |           |     |x|  1
    |0 1 x        |     |           |     |x|  2
    |0 0 1 x x    |     |           |     |x|  3
    |    0 1 x    | ... |           | ... |x|  4 sc
    |    0 0 1 x 0|     |      0    |     |M|  5
    |        0 1 0|     |      0    |     |M|  6
    |        0 0 1|     |      0    |     |x|  7
    ---------------     -------------
    */

    pivot = sc_to_sc_matrix[17];

    // sc-row-5 = sc-row-5 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[17] = 0;
#endif

    sc_g_matrix[4] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 x x        |     |           |     |x|  1
    |0 1 x        |     |           |     |x|  2
    |0 0 1 x x    |     |           |     |x|  3
    |    0 1 x    | ... |           | ... |x|  4 sc
    |    0 0 1 0 0|     |      0    |     |M|  5
    |        0 1 0|     |      0    |     |M|  6
    |        0 0 1|     |      0    |     |x|  7
    ---------------     -------------
    */

    /*
     *
     * Row 4
     *
     */

    pivot = sc_to_sc_matrix[13];

    // sc-row-4 = sc-row-4 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[13] = 0;
#endif

    sc_g_matrix[3] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 x x        |     |           |     |x|  1
    |0 1 x        |     |           |     |x|  2
    |0 0 1 x x    |     |           |     |x|  3
    |    0 1 0    | ... |           | ... |M|  4 sc
    |    0 0 1 0 0|     |      0    |     |M|  5
    |        0 1 0|     |      0    |     |M|  6
    |        0 0 1|     |      0    |     |x|  7
    ---------------     -------------
    */

    /*
     *
     * Row 3
     *
     */

    pivot = sc_to_sc_matrix[10];

    // sc-row-3 = sc-row-3 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[10] = 0;
#endif

    sc_g_matrix[2] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 x x        |     |           |     |x|  1
    |0 1 x        |     |           |     |x|  2
    |0 0 1 x 0    |     |           |     |M|  3
    |    0 1 0    | ... |           | ... |M|  4 sc
    |    0 0 1 0 0|     |      0    |     |M|  5
    |        0 1 0|     |      0    |     |M|  6
    |        0 0 1|     |      0    |     |x|  7
    ---------------     -------------
    */

    pivot = sc_to_sc_matrix[9];

    // sc-row-3 = sc-row-3 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[9] = 0;
#endif

    sc_g_matrix[2] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 x x        |     |           |     |x|  1
    |0 1 x        |     |           |     |x|  2
    |0 0 1 0 0    |     |           |     |M|  3
    |    0 1 0    | ... |           | ... |M|  4 sc
    |    0 0 1 0 0|     |      0    |     |M|  5
    |        0 1 0|     |      0    |     |M|  6
    |        0 0 1|     |      0    |     |x|  7
    ---------------     -------------
    */

    /*
     *
     * Row 2
     *
     */

    pivot = sc_to_sc_matrix[5];

    // sc-row-2 = sc-row-2 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[5] = 0;
#endif

    sc_g_matrix[1] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 x x        |     |           |     |x|  1
    |0 1 0        |     |           |     |M|  2
    |0 0 1 0 0    |     |           |     |M|  3
    |    0 1 0    | ... |           | ... |M|  4 sc
    |    0 0 1 0 0|     |      0    |     |M|  5
    |        0 1 0|     |      0    |     |M|  6
    |        0 0 1|     |      0    |     |x|  7
    ---------------     -------------
    */

    /*
     *
     * Row 1
     *
     */

    pivot = sc_to_sc_matrix[2];

    // sc-row-1 = sc-row-1 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[2] = 0;
#endif

    sc_g_matrix[0] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 x 0        |     |           |     |M|  1
    |0 1 0        |     |           |     |M|  2
    |0 0 1 0 0    |     |           |     |M|  3
    |    0 1 0    | ... |           | ... |M|  4 sc
    |    0 0 1 0 0|     |      0    |     |M|  5
    |        0 1 0|     |      0    |     |M|  6
    |        0 0 1|     |      0    |     |x|  7
    ---------------     -------------
    */

    pivot = sc_to_sc_matrix[1];

    // sc-row-1 = sc-row-1 - sc-row-2 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[1] = 0;
#endif

    sc_g_matrix[0] -= sc_g_matrix[1] * pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 0 0        |     |           |     |M|  1
    |0 1 0        |     |           |     |M|  2
    |0 0 1 0 0    |     |           |     |M|  3
    |    0 1 0    | ... |           | ... |M|  4 sc
    |    0 0 1 0 0|     |      0    |     |M|  5
    |        0 1 0|     |      0    |     |M|  6
    |        0 0 1|     |      0    |     |x|  7
    ---------------     -------------
    */
}

void gmx::IlvesPC::solve_17_glutamine(real *const sc_to_sc_matrix,
                                      real *const sc_g_matrix,
                                      __attribute__((unused))
                                      real *const sc_to_sc_fillins) {
    /*
     *
     * Row 9
     *
     */

    real pivot = sc_to_sc_matrix[36];

    // sc-row-9 = sc-row-9 - sc-row-10 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[36] = 0;
#endif

    sc_g_matrix[8] -= sc_g_matrix[9] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 x x              |     |           |     |x|  1
    |0 1 x              |     |           |     |x|  2
    |0 0 1 x x          |     |           |     |x|  3
    |    0 1 x          |     |           |     |x|  4
    |    0 0 1 x x x    |     |           |     |x|  5
    |        0 1 x x    | ... |           | ... |x|  6 sc
    |        0 0 1 x    |     |           |     |x|  7
    |        0 0 0 1 x x|     |      0    |     |x|  8
    |              0 1 0|     |      0    |     |M|  9
    |              0 0 1|     |      0    |     |x| 10
    ---------------------     -------------
    */

    /*
     *
     * Row 8
     *
     */

    pivot = sc_to_sc_matrix[33];

    // sc-row-8 = sc-row-8 - sc-row-10 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[33] = 0;
#endif

    sc_g_matrix[7] -= sc_g_matrix[9] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 x x              |     |           |     |x|  1
    |0 1 x              |     |           |     |x|  2
    |0 0 1 x x          |     |           |     |x|  3
    |    0 1 x          |     |           |     |x|  4
    |    0 0 1 x x x    |     |           |     |x|  5
    |        0 1 x x    | ... |           | ... |x|  6 sc
    |        0 0 1 x    |     |           |     |x|  7
    |        0 0 0 1 x 0|     |      0    |     |M|  8
    |              0 1 0|     |      0    |     |M|  9
    |              0 0 1|     |      0    |     |x| 10
    ---------------------     -------------
    */

    pivot = sc_to_sc_matrix[32];

    // sc-row-8 = sc-row-8 - sc-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[32] = 0;
#endif

    sc_g_matrix[7] -= sc_g_matrix[8] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 x x              |     |           |     |x|  1
    |0 1 x              |     |           |     |x|  2
    |0 0 1 x x          |     |           |     |x|  3
    |    0 1 x          |     |           |     |x|  4
    |    0 0 1 x x x    |     |           |     |x|  5
    |        0 1 x x    | ... |           | ... |x|  6 sc
    |        0 0 1 x    |     |           |     |x|  7
    |        0 0 0 1 0 0|     |      0    |     |M|  8
    |              0 1 0|     |      0    |     |M|  9
    |              0 0 1|     |      0    |     |x| 10
    ---------------------     -------------
    */

    /*
     *
     * Row 7
     *
     */

    pivot = sc_to_sc_matrix[27];

    // sc-row-7 = sc-row-7 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[27] = 0;
#endif

    sc_g_matrix[6] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 x x              |     |           |     |x|  1
    |0 1 x              |     |           |     |x|  2
    |0 0 1 x x          |     |           |     |x|  3
    |    0 1 x          |     |           |     |x|  4
    |    0 0 1 x x x    |     |           |     |x|  5
    |        0 1 x x    | ... |           | ... |x|  6 sc
    |        0 0 1 0    |     |           |     |M|  7
    |        0 0 0 1 0 0|     |      0    |     |M|  8
    |              0 1 0|     |      0    |     |M|  9
    |              0 0 1|     |      0    |     |x| 10
    ---------------------     -------------
    */

    /*
     *
     * Row 6
     *
     */

    pivot = sc_to_sc_matrix[23];

    // sc-row-6 = sc-row-6 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[23] = 0;
#endif

    sc_g_matrix[5] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 x x              |     |           |     |x|  1
    |0 1 x              |     |           |     |x|  2
    |0 0 1 x x          |     |           |     |x|  3
    |    0 1 x          |     |           |     |x|  4
    |    0 0 1 x x x    |     |           |     |x|  5
    |        0 1 x 0    | ... |           | ... |M|  6 sc
    |        0 0 1 0    |     |           |     |M|  7
    |        0 0 0 1 0 0|     |      0    |     |M|  8
    |              0 1 0|     |      0    |     |M|  9
    |              0 0 1|     |      0    |     |x| 10
    ---------------------     -------------
    */

    pivot = sc_to_sc_matrix[22];

    // sc-row-6 = sc-row-6 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[22] = 0;
#endif

    sc_g_matrix[5] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 x x              |     |           |     |x|  1
    |0 1 x              |     |           |     |x|  2
    |0 0 1 x x          |     |           |     |x|  3
    |    0 1 x          |     |           |     |x|  4
    |    0 0 1 x x x    |     |           |     |x|  5
    |        0 1 0 0    | ... |           | ... |M|  6 sc
    |        0 0 1 0    |     |           |     |M|  7
    |        0 0 0 1 0 0|     |      0    |     |M|  8
    |              0 1 0|     |      0    |     |M|  9
    |              0 0 1|     |      0    |     |x| 10
    ---------------------     -------------
    */

    /*
     *
     * Row 5
     *
     */

    pivot = sc_to_sc_matrix[19];

    // sc-row-5 = sc-row-5 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[19] = 0;
#endif

    sc_g_matrix[4] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 x x              |     |           |     |x|  1
    |0 1 x              |     |           |     |x|  2
    |0 0 1 x x          |     |           |     |x|  3
    |    0 1 x          |     |           |     |x|  4
    |    0 0 1 x x 0    |     |           |     |M|  5
    |        0 1 0 0    | ... |           | ... |M|  6 sc
    |        0 0 1 0    |     |           |     |M|  7
    |        0 0 0 1 0 0|     |      0    |     |M|  8
    |              0 1 0|     |      0    |     |M|  9
    |              0 0 1|     |      0    |     |x| 10
    ---------------------     -------------
    */

    pivot = sc_to_sc_matrix[18];

    // sc-row-5 = sc-row-5 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[18] = 0;
#endif

    sc_g_matrix[4] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 x x              |     |           |     |x|  1
    |0 1 x              |     |           |     |x|  2
    |0 0 1 x x          |     |           |     |x|  3
    |    0 1 x          |     |           |     |x|  4
    |    0 0 1 x 0 0    |     |           |     |M|  5
    |        0 1 0 0    | ... |           | ... |M|  6 sc
    |        0 0 1 0    |     |           |     |M|  7
    |        0 0 0 1 0 0|     |      0    |     |M|  8
    |              0 1 0|     |      0    |     |M|  9
    |              0 0 1|     |      0    |     |x| 10
    ---------------------     -------------
    */

    pivot = sc_to_sc_matrix[17];

    // sc-row-5 = sc-row-5 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[17] = 0;
#endif

    sc_g_matrix[4] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 x x              |     |           |     |x|  1
    |0 1 x              |     |           |     |x|  2
    |0 0 1 x x          |     |           |     |x|  3
    |    0 1 x          |     |           |     |x|  4
    |    0 0 1 0 0 0    |     |           |     |M|  5
    |        0 1 0 0    | ... |           | ... |M|  6 sc
    |        0 0 1 0    |     |           |     |M|  7
    |        0 0 0 1 0 0|     |      0    |     |M|  8
    |              0 1 0|     |      0    |     |M|  9
    |              0 0 1|     |      0    |     |x| 10
    ---------------------     -------------
    */

    /*
     *
     * Row 4
     *
     */

    pivot = sc_to_sc_matrix[13];

    // sc-row-4 = sc-row-4 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[13] = 0;
#endif

    sc_g_matrix[3] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 x x              |     |           |     |x|  1
    |0 1 x              |     |           |     |x|  2
    |0 0 1 x x          |     |           |     |x|  3
    |    0 1 0          |     |           |     |M|  4
    |    0 0 1 0 0 0    |     |           |     |M|  5
    |        0 1 0 0    | ... |           | ... |M|  6 sc
    |        0 0 1 0    |     |           |     |M|  7
    |        0 0 0 1 0 0|     |      0    |     |M|  8
    |              0 1 0|     |      0    |     |M|  9
    |              0 0 1|     |      0    |     |x| 10
    ---------------------     -------------
    */

    /*
     *
     * Row 3
     *
     */

    pivot = sc_to_sc_matrix[10];

    // sc-row-3 = sc-row-3 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[10] = 0;
#endif

    sc_g_matrix[2] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 x x              |     |           |     |x|  1
    |0 1 x              |     |           |     |x|  2
    |0 0 1 x 0          |     |           |     |M|  3
    |    0 1 0          |     |           |     |M|  4
    |    0 0 1 0 0 0    |     |           |     |M|  5
    |        0 1 0 0    | ... |           | ... |M|  6 sc
    |        0 0 1 0    |     |           |     |M|  7
    |        0 0 0 1 0 0|     |      0    |     |M|  8
    |              0 1 0|     |      0    |     |M|  9
    |              0 0 1|     |      0    |     |x| 10
    ---------------------     -------------
    */

    pivot = sc_to_sc_matrix[9];

    // sc-row-3 = sc-row-3 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[9] = 0;
#endif

    sc_g_matrix[2] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 x x              |     |           |     |x|  1
    |0 1 x              |     |           |     |x|  2
    |0 0 1 0 0          |     |           |     |M|  3
    |    0 1 0          |     |           |     |M|  4
    |    0 0 1 0 0 0    |     |           |     |M|  5
    |        0 1 0 0    | ... |           | ... |M|  6 sc
    |        0 0 1 0    |     |           |     |M|  7
    |        0 0 0 1 0 0|     |      0    |     |M|  8
    |              0 1 0|     |      0    |     |M|  9
    |              0 0 1|     |      0    |     |x| 10
    ---------------------     -------------
    */

    /*
     *
     * Row 2
     *
     */

    pivot = sc_to_sc_matrix[5];

    // sc-row-2 = sc-row-2 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[5] = 0;
#endif

    sc_g_matrix[1] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 x x              |     |           |     |x|  1
    |0 1 0              |     |           |     |M|  2
    |0 0 1 0 0          |     |           |     |M|  3
    |    0 1 0          |     |           |     |M|  4
    |    0 0 1 0 0 0    |     |           |     |M|  5
    |        0 1 0 0    | ... |           | ... |M|  6 sc
    |        0 0 1 0    |     |           |     |M|  7
    |        0 0 0 1 0 0|     |      0    |     |M|  8
    |              0 1 0|     |      0    |     |M|  9
    |              0 0 1|     |      0    |     |x| 10
    ---------------------     -------------
    */

    /*
     *
     * Row 1
     *
     */

    pivot = sc_to_sc_matrix[2];

    // sc-row-1 = sc-row-1 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[2] = 0;
#endif

    sc_g_matrix[0] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 x 0              |     |           |     |M|  1
    |0 1 0              |     |           |     |M|  2
    |0 0 1 0 0          |     |           |     |M|  3
    |    0 1 0          |     |           |     |M|  4
    |    0 0 1 0 0 0    |     |           |     |M|  5
    |        0 1 0 0    | ... |           | ... |M|  6 sc
    |        0 0 1 0    |     |           |     |M|  7
    |        0 0 0 1 0 0|     |      0    |     |M|  8
    |              0 1 0|     |      0    |     |M|  9
    |              0 0 1|     |      0    |     |x| 10
    ---------------------     -------------
    */

    pivot = sc_to_sc_matrix[1];

    // sc-row-1 = sc-row-1 - sc-row-2 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[1] = 0;
#endif

    sc_g_matrix[0] -= sc_g_matrix[1] * pivot;

    /*
    Resulting matrix:

             sc                    bb            g
     1 2 3 4 5 6 7 8 910       1 2 3 4 5 6
    ---------------------     -------------
    |1 0 0              |     |           |     |M|  1
    |0 1 0              |     |           |     |M|  2
    |0 0 1 0 0          |     |           |     |M|  3
    |    0 1 0          |     |           |     |M|  4
    |    0 0 1 0 0 0    |     |           |     |M|  5
    |        0 1 0 0    | ... |           | ... |M|  6 sc
    |        0 0 1 0    |     |           |     |M|  7
    |        0 0 0 1 0 0|     |      0    |     |M|  8
    |              0 1 0|     |      0    |     |M|  9
    |              0 0 1|     |      0    |     |x| 10
    ---------------------     -------------
    */
}

void gmx::IlvesPC::solve_17_histidine(real *const sc_to_sc_matrix,
                                      real *const sc_g_matrix,
                                      real *const sc_to_sc_fillins) {
    /*
     *
     * Row 10
     *
     */

    real pivot = sc_to_sc_matrix[39];

    // sc-row-10 = sc-row-10 - sc-row-11 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[39] = 0;
#endif

    sc_g_matrix[9] -= sc_g_matrix[10] * pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   x   x            |     |           |     |x|  1
    |  1 x     x          |     |           |     |x|  2
    |0 0 1   x x          |     |           |     |x|  3
    |      1 x     x      |     |           |     |x|  4
    |0   0 0 1 f   x      |     |           |     |x|  5
    |  0 0   0 1 x f      | ... |           | ... |x|  6 sc
    |          0 1 x x    |     |           |     |x|  7
    |      0 0 0 0 1 x    |     |           |     |x|  8
    |            0 0 1 x x|     |      0    |     |x|  9
    |                0 1 0|     |      0    |     |M| 10
    |                0 0 1|     |      0    |     |x| 11
    -----------------------     -------------
    */

    /*
     *
     * Row 9
     *
     */

    pivot = sc_to_sc_matrix[36];

    // sc-row-9 = sc-row-9 - sc-row-11 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[36] = 0;
#endif

    sc_g_matrix[8] -= sc_g_matrix[10] * pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   x   x            |     |           |     |x|  1
    |  1 x     x          |     |           |     |x|  2
    |0 0 1   x x          |     |           |     |x|  3
    |      1 x     x      |     |           |     |x|  4
    |0   0 0 1 f   x      |     |           |     |x|  5
    |  0 0   0 1 x f      | ... |           | ... |x|  6 sc
    |          0 1 x x    |     |           |     |x|  7
    |      0 0 0 0 1 x    |     |           |     |x|  8
    |            0 0 1 x 0|     |      0    |     |M|  9
    |                0 1 0|     |      0    |     |M| 10
    |                0 0 1|     |      0    |     |x| 11
    -----------------------     -------------
    */

    pivot = sc_to_sc_matrix[35];

    // sc-row-9 = sc-row-9 - sc-row-10 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[35] = 0;
#endif

    sc_g_matrix[8] -= sc_g_matrix[9] * pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   x   x            |     |           |     |x|  1
    |  1 x     x          |     |           |     |x|  2
    |0 0 1   x x          |     |           |     |x|  3
    |      1 x     x      |     |           |     |x|  4
    |0   0 0 1 f   x      |     |           |     |x|  5
    |  0 0   0 1 x f      | ... |           | ... |x|  6 sc
    |          0 1 x x    |     |           |     |x|  7
    |      0 0 0 0 1 x    |     |           |     |x|  8
    |            0 0 1 0 0|     |      0    |     |M|  9
    |                0 1 0|     |      0    |     |M| 10
    |                0 0 1|     |      0    |     |x| 11
    -----------------------     -------------
    */

    /*
     *
     * Row 8
     *
     */

    pivot = sc_to_sc_matrix[31];

    // sc-row-8 = sc-row-8 - sc-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[31] = 0;
#endif

    sc_g_matrix[7] -= sc_g_matrix[8] * pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   x   x            |     |           |     |x|  1
    |  1 x     x          |     |           |     |x|  2
    |0 0 1   x x          |     |           |     |x|  3
    |      1 x     x      |     |           |     |x|  4
    |0   0 0 1 f   x      |     |           |     |x|  5
    |  0 0   0 1 x f      | ... |           | ... |x|  6 sc
    |          0 1 x x    |     |           |     |x|  7
    |      0 0 0 0 1 0    |     |           |     |M|  8
    |            0 0 1 0 0|     |      0    |     |M|  9
    |                0 1 0|     |      0    |     |M| 10
    |                0 0 1|     |      0    |     |x| 11
    -----------------------     -------------
    */

    /*
     *
     * Row 7
     *
     */

    pivot = sc_to_sc_matrix[26];

    // sc-row-7 = sc-row-7 - sc-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[26] = 0;
#endif

    sc_g_matrix[6] -= sc_g_matrix[8] * pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   x   x            |     |           |     |x|  1
    |  1 x     x          |     |           |     |x|  2
    |0 0 1   x x          |     |           |     |x|  3
    |      1 x     x      |     |           |     |x|  4
    |0   0 0 1 f   x      |     |           |     |x|  5
    |  0 0   0 1 x f      | ... |           | ... |x|  6 sc
    |          0 1 x 0    |     |           |     |M|  7
    |      0 0 0 0 1 0    |     |           |     |M|  8
    |            0 0 1 0 0|     |      0    |     |M|  9
    |                0 1 0|     |      0    |     |M| 10
    |                0 0 1|     |      0    |     |x| 11
    -----------------------     -------------
    */

    pivot = sc_to_sc_matrix[25];

    // sc-row-7 = sc-row-7 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[25] = 0;
#endif

    sc_g_matrix[6] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   x   x            |     |           |     |x|  1
    |  1 x     x          |     |           |     |x|  2
    |0 0 1   x x          |     |           |     |x|  3
    |      1 x     x      |     |           |     |x|  4
    |0   0 0 1 f   x      |     |           |     |x|  5
    |  0 0   0 1 x f      | ... |           | ... |x|  6 sc
    |          0 1 0 0    |     |           |     |M|  7
    |      0 0 0 0 1 0    |     |           |     |M|  8
    |            0 0 1 0 0|     |      0    |     |M|  9
    |                0 1 0|     |      0    |     |M| 10
    |                0 0 1|     |      0    |     |x| 11
    -----------------------     -------------
    */

    /*
     *
     * Row 6
     *
     */

    pivot = sc_to_sc_fillins[2];

    // sc-row-6 = sc-row-6 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_fillins[2] = 0;
#endif

    sc_g_matrix[5] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   x   x            |     |           |     |x|  1
    |  1 x     x          |     |           |     |x|  2
    |0 0 1   x x          |     |           |     |x|  3
    |      1 x     x      |     |           |     |x|  4
    |0   0 0 1 f   x      |     |           |     |x|  5
    |  0 0   0 1 x 0      | ... |           | ... |M|  6 sc
    |          0 1 0 0    |     |           |     |M|  7
    |      0 0 0 0 1 0    |     |           |     |M|  8
    |            0 0 1 0 0|     |      0    |     |M|  9
    |                0 1 0|     |      0    |     |M| 10
    |                0 0 1|     |      0    |     |x| 11
    -----------------------     -------------
    */

    pivot = sc_to_sc_matrix[22];

    // sc-row-6 = sc-row-6 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[22] = 0;
#endif

    sc_g_matrix[5] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   x   x            |     |           |     |x|  1
    |  1 x     x          |     |           |     |x|  2
    |0 0 1   x x          |     |           |     |x|  3
    |      1 x     x      |     |           |     |x|  4
    |0   0 0 1 f   x      |     |           |     |x|  5
    |  0 0   0 1 0 0      | ... |           | ... |M|  6 sc
    |          0 1 0 0    |     |           |     |M|  7
    |      0 0 0 0 1 0    |     |           |     |M|  8
    |            0 0 1 0 0|     |      0    |     |M|  9
    |                0 1 0|     |      0    |     |M| 10
    |                0 0 1|     |      0    |     |x| 11
    -----------------------     -------------
    */

    /*
     *
     * Row 5
     *
     */

    pivot = sc_to_sc_matrix[18];

    // sc-row-5 = sc-row-5 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[18] = 0;
#endif

    sc_g_matrix[4] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   x   x            |     |           |     |x|  1
    |  1 x     x          |     |           |     |x|  2
    |0 0 1   x x          |     |           |     |x|  3
    |      1 x     x      |     |           |     |x|  4
    |0   0 0 1 f   0      |     |           |     |M|  5
    |  0 0   0 1 0 0      | ... |           | ... |M|  6 sc
    |          0 1 0 0    |     |           |     |M|  7
    |      0 0 0 0 1 0    |     |           |     |M|  8
    |            0 0 1 0 0|     |      0    |     |M|  9
    |                0 1 0|     |      0    |     |M| 10
    |                0 0 1|     |      0    |     |x| 11
    -----------------------     -------------
    */

    pivot = sc_to_sc_fillins[0];

    // sc-row-5 = sc-row-5 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_fillins[0] = 0;
#endif

    sc_g_matrix[4] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   x   x            |     |           |     |x|  1
    |  1 x     x          |     |           |     |x|  2
    |0 0 1   x x          |     |           |     |x|  3
    |      1 x     x      |     |           |     |x|  4
    |0   0 0 1 0   0      |     |           |     |M|  5
    |  0 0   0 1 0 0      | ... |           | ... |M|  6 sc
    |          0 1 0 0    |     |           |     |M|  7
    |      0 0 0 0 1 0    |     |           |     |M|  8
    |            0 0 1 0 0|     |      0    |     |M|  9
    |                0 1 0|     |      0    |     |M| 10
    |                0 0 1|     |      0    |     |x| 11
    -----------------------     -------------
    */

    /*
     *
     * Row 4
     *
     */

    pivot = sc_to_sc_matrix[13];

    // sc-row-4 = sc-row-4 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[13] = 0;
#endif

    sc_g_matrix[3] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   x   x            |     |           |     |x|  1
    |  1 x     x          |     |           |     |x|  2
    |0 0 1   x x          |     |           |     |x|  3
    |      1 x     0      |     |           |     |M|  4
    |0   0 0 1 0   0      |     |           |     |M|  5
    |  0 0   0 1 0 0      | ... |           | ... |M|  6 sc
    |          0 1 0 0    |     |           |     |M|  7
    |      0 0 0 0 1 0    |     |           |     |M|  8
    |            0 0 1 0 0|     |      0    |     |M|  9
    |                0 1 0|     |      0    |     |M| 10
    |                0 0 1|     |      0    |     |x| 11
    -----------------------     -------------
    */

    pivot = sc_to_sc_matrix[12];

    // sc-row-4 = sc-row-4 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[12] = 0;
#endif

    sc_g_matrix[3] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   x   x            |     |           |     |x|  1
    |  1 x     x          |     |           |     |x|  2
    |0 0 1   x x          |     |           |     |x|  3
    |      1 0     0      |     |           |     |M|  4
    |0   0 0 1 0   0      |     |           |     |M|  5
    |  0 0   0 1 0 0      | ... |           | ... |M|  6 sc
    |          0 1 0 0    |     |           |     |M|  7
    |      0 0 0 0 1 0    |     |           |     |M|  8
    |            0 0 1 0 0|     |      0    |     |M|  9
    |                0 1 0|     |      0    |     |M| 10
    |                0 0 1|     |      0    |     |x| 11
    -----------------------     -------------
    */

    /*
     *
     * Row 3
     *
     */

    pivot = sc_to_sc_matrix[10];

    // sc-row-3 = sc-row-3 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[10] = 0;
#endif

    sc_g_matrix[2] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   x   x            |     |           |     |x|  1
    |  1 x     x          |     |           |     |x|  2
    |0 0 1   x 0          |     |           |     |M|  3
    |      1 0     0      |     |           |     |M|  4
    |0   0 0 1 0   0      |     |           |     |M|  5
    |  0 0   0 1 0 0      | ... |           | ... |M|  6 sc
    |          0 1 0 0    |     |           |     |M|  7
    |      0 0 0 0 1 0    |     |           |     |M|  8
    |            0 0 1 0 0|     |      0    |     |M|  9
    |                0 1 0|     |      0    |     |M| 10
    |                0 0 1|     |      0    |     |x| 11
    -----------------------     -------------
    */

    pivot = sc_to_sc_matrix[9];

    // sc-row-3 = sc-row-3 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[9] = 0;
#endif

    sc_g_matrix[2] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   x   x            |     |           |     |x|  1
    |  1 x     x          |     |           |     |x|  2
    |0 0 1   0 0          |     |           |     |M|  3
    |      1 0     0      |     |           |     |M|  4
    |0   0 0 1 0   0      |     |           |     |M|  5
    |  0 0   0 1 0 0      | ... |           | ... |M|  6 sc
    |          0 1 0 0    |     |           |     |M|  7
    |      0 0 0 0 1 0    |     |           |     |M|  8
    |            0 0 1 0 0|     |      0    |     |M|  9
    |                0 1 0|     |      0    |     |M| 10
    |                0 0 1|     |      0    |     |x| 11
    -----------------------     -------------
    */

    /*
     *
     * Row 2
     *
     */

    pivot = sc_to_sc_matrix[5];

    // sc-row-2 = sc-row-2 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[5] = 0;
#endif

    sc_g_matrix[1] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   x   x            |     |           |     |x|  1
    |  1 x     0          |     |           |     |M|  2
    |0 0 1   0 0          |     |           |     |M|  3
    |      1 0     0      |     |           |     |M|  4
    |0   0 0 1 0   0      |     |           |     |M|  5
    |  0 0   0 1 0 0      | ... |           | ... |M|  6 sc
    |          0 1 0 0    |     |           |     |M|  7
    |      0 0 0 0 1 0    |     |           |     |M|  8
    |            0 0 1 0 0|     |      0    |     |M|  9
    |                0 1 0|     |      0    |     |M| 10
    |                0 0 1|     |      0    |     |x| 11
    -----------------------     -------------
    */

    pivot = sc_to_sc_matrix[4];

    // sc-row-2 = sc-row-2 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[4] = 0;
#endif

    sc_g_matrix[1] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   x   x            |     |           |     |x|  1
    |  1 0     0          |     |           |     |M|  2
    |0 0 1   0 0          |     |           |     |M|  3
    |      1 0     0      |     |           |     |M|  4
    |0   0 0 1 0   0      |     |           |     |M|  5
    |  0 0   0 1 0 0      | ... |           | ... |M|  6 sc
    |          0 1 0 0    |     |           |     |M|  7
    |      0 0 0 0 1 0    |     |           |     |M|  8
    |            0 0 1 0 0|     |      0    |     |M|  9
    |                0 1 0|     |      0    |     |M| 10
    |                0 0 1|     |      0    |     |x| 11
    -----------------------     -------------
    */

    /*
     *
     * Row 1
     *
     */

    pivot = sc_to_sc_matrix[2];

    // sc-row-1 = sc-row-1 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[2] = 0;
#endif

    sc_g_matrix[0] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   x   0            |     |           |     |M|  1
    |  1 0     0          |     |           |     |M|  2
    |0 0 1   0 0          |     |           |     |M|  3
    |      1 0     0      |     |           |     |M|  4
    |0   0 0 1 0   0      |     |           |     |M|  5
    |  0 0   0 1 0 0      | ... |           | ... |M|  6 sc
    |          0 1 0 0    |     |           |     |M|  7
    |      0 0 0 0 1 0    |     |           |     |M|  8
    |            0 0 1 0 0|     |      0    |     |M|  9
    |                0 1 0|     |      0    |     |M| 10
    |                0 0 1|     |      0    |     |x| 11
    -----------------------     -------------
    */

    pivot = sc_to_sc_matrix[1];

    // sc-row-1 = sc-row-1 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[1] = 0;
#endif

    sc_g_matrix[0] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

              sc                     bb            g
     1 2 3 4 5 6 7 8 91011       1 2 3 4 5 6
    -----------------------     -------------
    |1   0   0            |     |           |     |M|  1
    |  1 0     0          |     |           |     |M|  2
    |0 0 1   0 0          |     |           |     |M|  3
    |      1 0     0      |     |           |     |M|  4
    |0   0 0 1 0   0      |     |           |     |M|  5
    |  0 0   0 1 0 0      | ... |           | ... |M|  6 sc
    |          0 1 0 0    |     |           |     |M|  7
    |      0 0 0 0 1 0    |     |           |     |M|  8
    |            0 0 1 0 0|     |      0    |     |M|  9
    |                0 1 0|     |      0    |     |M| 10
    |                0 0 1|     |      0    |     |x| 11
    -----------------------     -------------
    */
}

void gmx::IlvesPC::solve_17_lysine(real *const sc_to_sc_matrix,
                                   real *const sc_g_matrix,
                                   __attribute__((unused))
                                   real *const sc_to_sc_fillins) {
    /*
     *
     * Row 14
     *
     */

    real pivot = sc_to_sc_matrix[65];

    // sc-row-14 = sc-row-14 - sc-row-15 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[65] = 0;
#endif

    sc_g_matrix[13] -= sc_g_matrix[14] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 x x x                      |     |           |     |x|  1
    |0 1 x x                      |     |           |     |x|  2
    |0 0 1 x                      |     |           |     |x|  3
    |0 0 0 1 x x x                |     |           |     |x|  4
    |      0 1 x x                |     |           |     |x|  5
    |      0 0 1 x                |     |           |     |x|  6
    |      0 0 0 1 x x x          |     |           |     |x|  7
    |            0 1 x x          | ... |           | ... |x|  8 sc
    |            0 0 1 x          |     |           |     |x|  9
    |            0 0 0 1 x x x    |     |           |     |x| 10
    |                  0 1 x x    |     |           |     |x| 11
    |                  0 0 1 x    |     |           |     |x| 12
    |                  0 0 0 1 x x|     |      0    |     |x| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 13
     *
     */

    pivot = sc_to_sc_matrix[62];

    // sc-row-13 = sc-row-13 - sc-row-15 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[62] = 0;
#endif

    sc_g_matrix[12] -= sc_g_matrix[14] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 x x x                      |     |           |     |x|  1
    |0 1 x x                      |     |           |     |x|  2
    |0 0 1 x                      |     |           |     |x|  3
    |0 0 0 1 x x x                |     |           |     |x|  4
    |      0 1 x x                |     |           |     |x|  5
    |      0 0 1 x                |     |           |     |x|  6
    |      0 0 0 1 x x x          |     |           |     |x|  7
    |            0 1 x x          | ... |           | ... |x|  8 sc
    |            0 0 1 x          |     |           |     |x|  9
    |            0 0 0 1 x x x    |     |           |     |x| 10
    |                  0 1 x x    |     |           |     |x| 11
    |                  0 0 1 x    |     |           |     |x| 12
    |                  0 0 0 1 x 0|     |      0    |     |M| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[61];

    // sc-row-13 = sc-row-13 - sc-row-14 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[61] = 0;
#endif

    sc_g_matrix[12] -= sc_g_matrix[13] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 x x x                      |     |           |     |x|  1
    |0 1 x x                      |     |           |     |x|  2
    |0 0 1 x                      |     |           |     |x|  3
    |0 0 0 1 x x x                |     |           |     |x|  4
    |      0 1 x x                |     |           |     |x|  5
    |      0 0 1 x                |     |           |     |x|  6
    |      0 0 0 1 x x x          |     |           |     |x|  7
    |            0 1 x x          | ... |           | ... |x|  8 sc
    |            0 0 1 x          |     |           |     |x|  9
    |            0 0 0 1 x x x    |     |           |     |x| 10
    |                  0 1 x x    |     |           |     |x| 11
    |                  0 0 1 x    |     |           |     |x| 12
    |                  0 0 0 1 0 0|     |      0    |     |M| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 12
     *
     */

    pivot = sc_to_sc_matrix[56];

    // sc-row-12 = sc-row-12 - sc-row-13 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[56] = 0;
#endif

    sc_g_matrix[11] -= sc_g_matrix[12] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 x x x                      |     |           |     |x|  1
    |0 1 x x                      |     |           |     |x|  2
    |0 0 1 x                      |     |           |     |x|  3
    |0 0 0 1 x x x                |     |           |     |x|  4
    |      0 1 x x                |     |           |     |x|  5
    |      0 0 1 x                |     |           |     |x|  6
    |      0 0 0 1 x x x          |     |           |     |x|  7
    |            0 1 x x          | ... |           | ... |x|  8 sc
    |            0 0 1 x          |     |           |     |x|  9
    |            0 0 0 1 x x x    |     |           |     |x| 10
    |                  0 1 x x    |     |           |     |x| 11
    |                  0 0 1 0    |     |           |     |M| 12
    |                  0 0 0 1 0 0|     |      0    |     |M| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 11
     *
     */

    pivot = sc_to_sc_matrix[52];

    // sc-row-11 = sc-row-11 - sc-row-13 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[52] = 0;
#endif

    sc_g_matrix[10] -= sc_g_matrix[12] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 x x x                      |     |           |     |x|  1
    |0 1 x x                      |     |           |     |x|  2
    |0 0 1 x                      |     |           |     |x|  3
    |0 0 0 1 x x x                |     |           |     |x|  4
    |      0 1 x x                |     |           |     |x|  5
    |      0 0 1 x                |     |           |     |x|  6
    |      0 0 0 1 x x x          |     |           |     |x|  7
    |            0 1 x x          | ... |           | ... |x|  8 sc
    |            0 0 1 x          |     |           |     |x|  9
    |            0 0 0 1 x x x    |     |           |     |x| 10
    |                  0 1 x 0    |     |           |     |M| 11
    |                  0 0 1 0    |     |           |     |M| 12
    |                  0 0 0 1 0 0|     |      0    |     |M| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[51];

    // sc-row-11 = sc-row-11 - sc-row-12 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[51] = 0;
#endif

    sc_g_matrix[10] -= sc_g_matrix[11] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 x x x                      |     |           |     |x|  1
    |0 1 x x                      |     |           |     |x|  2
    |0 0 1 x                      |     |           |     |x|  3
    |0 0 0 1 x x x                |     |           |     |x|  4
    |      0 1 x x                |     |           |     |x|  5
    |      0 0 1 x                |     |           |     |x|  6
    |      0 0 0 1 x x x          |     |           |     |x|  7
    |            0 1 x x          | ... |           | ... |x|  8 sc
    |            0 0 1 x          |     |           |     |x|  9
    |            0 0 0 1 x x x    |     |           |     |x| 10
    |                  0 1 0 0    |     |           |     |M| 11
    |                  0 0 1 0    |     |           |     |M| 12
    |                  0 0 0 1 0 0|     |      0    |     |M| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 10
     *
     */

    pivot = sc_to_sc_matrix[48];

    // sc-row-10 = sc-row-10 - sc-row-13 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[48] = 0;
#endif

    sc_g_matrix[9] -= sc_g_matrix[12] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 x x x                      |     |           |     |x|  1
    |0 1 x x                      |     |           |     |x|  2
    |0 0 1 x                      |     |           |     |x|  3
    |0 0 0 1 x x x                |     |           |     |x|  4
    |      0 1 x x                |     |           |     |x|  5
    |      0 0 1 x                |     |           |     |x|  6
    |      0 0 0 1 x x x          |     |           |     |x|  7
    |            0 1 x x          | ... |           | ... |x|  8 sc
    |            0 0 1 x          |     |           |     |x|  9
    |            0 0 0 1 x x 0    |     |           |     |M| 10
    |                  0 1 0 0    |     |           |     |M| 11
    |                  0 0 1 0    |     |           |     |M| 12
    |                  0 0 0 1 0 0|     |      0    |     |M| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[47];

    // sc-row-10 = sc-row-10 - sc-row-12 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[47] = 0;
#endif

    sc_g_matrix[9] -= sc_g_matrix[11] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 x x x                      |     |           |     |x|  1
    |0 1 x x                      |     |           |     |x|  2
    |0 0 1 x                      |     |           |     |x|  3
    |0 0 0 1 x x x                |     |           |     |x|  4
    |      0 1 x x                |     |           |     |x|  5
    |      0 0 1 x                |     |           |     |x|  6
    |      0 0 0 1 x x x          |     |           |     |x|  7
    |            0 1 x x          | ... |           | ... |x|  8 sc
    |            0 0 1 x          |     |           |     |x|  9
    |            0 0 0 1 x 0 0    |     |           |     |M| 10
    |                  0 1 0 0    |     |           |     |M| 11
    |                  0 0 1 0    |     |           |     |M| 12
    |                  0 0 0 1 0 0|     |      0    |     |M| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[46];

    // sc-row-10 = sc-row-10 - sc-row-11 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[46] = 0;
#endif

    sc_g_matrix[9] -= sc_g_matrix[10] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 x x x                      |     |           |     |x|  1
    |0 1 x x                      |     |           |     |x|  2
    |0 0 1 x                      |     |           |     |x|  3
    |0 0 0 1 x x x                |     |           |     |x|  4
    |      0 1 x x                |     |           |     |x|  5
    |      0 0 1 x                |     |           |     |x|  6
    |      0 0 0 1 x x x          |     |           |     |x|  7
    |            0 1 x x          | ... |           | ... |x|  8 sc
    |            0 0 1 x          |     |           |     |x|  9
    |            0 0 0 1 0 0 0    |     |           |     |M| 10
    |                  0 1 0 0    |     |           |     |M| 11
    |                  0 0 1 0    |     |           |     |M| 12
    |                  0 0 0 1 0 0|     |      0    |     |M| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 9
     *
     */

    pivot = sc_to_sc_matrix[41];

    // sc-row-9 = sc-row-9 - sc-row-10 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[41] = 0;
#endif

    sc_g_matrix[8] -= sc_g_matrix[9] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 x x x                      |     |           |     |x|  1
    |0 1 x x                      |     |           |     |x|  2
    |0 0 1 x                      |     |           |     |x|  3
    |0 0 0 1 x x x                |     |           |     |x|  4
    |      0 1 x x                |     |           |     |x|  5
    |      0 0 1 x                |     |           |     |x|  6
    |      0 0 0 1 x x x          |     |           |     |x|  7
    |            0 1 x x          | ... |           | ... |x|  8 sc
    |            0 0 1 0          |     |           |     |M|  9
    |            0 0 0 1 0 0 0    |     |           |     |M| 10
    |                  0 1 0 0    |     |           |     |M| 11
    |                  0 0 1 0    |     |           |     |M| 12
    |                  0 0 0 1 0 0|     |      0    |     |M| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 8
     *
     */

    pivot = sc_to_sc_matrix[37];

    // sc-row-8 = sc-row-8 - sc-row-10 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[37] = 0;
#endif

    sc_g_matrix[7] -= sc_g_matrix[9] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 x x x                      |     |           |     |x|  1
    |0 1 x x                      |     |           |     |x|  2
    |0 0 1 x                      |     |           |     |x|  3
    |0 0 0 1 x x x                |     |           |     |x|  4
    |      0 1 x x                |     |           |     |x|  5
    |      0 0 1 x                |     |           |     |x|  6
    |      0 0 0 1 x x x          |     |           |     |x|  7
    |            0 1 x 0          | ... |           | ... |M|  8 sc
    |            0 0 1 0          |     |           |     |M|  9
    |            0 0 0 1 0 0 0    |     |           |     |M| 10
    |                  0 1 0 0    |     |           |     |M| 11
    |                  0 0 1 0    |     |           |     |M| 12
    |                  0 0 0 1 0 0|     |      0    |     |M| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[36];

    // sc-row-8 = sc-row-8 - sc-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[36] = 0;
#endif

    sc_g_matrix[7] -= sc_g_matrix[8] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 x x x                      |     |           |     |x|  1
    |0 1 x x                      |     |           |     |x|  2
    |0 0 1 x                      |     |           |     |x|  3
    |0 0 0 1 x x x                |     |           |     |x|  4
    |      0 1 x x                |     |           |     |x|  5
    |      0 0 1 x                |     |           |     |x|  6
    |      0 0 0 1 x x x          |     |           |     |x|  7
    |            0 1 0 0          | ... |           | ... |M|  8 sc
    |            0 0 1 0          |     |           |     |M|  9
    |            0 0 0 1 0 0 0    |     |           |     |M| 10
    |                  0 1 0 0    |     |           |     |M| 11
    |                  0 0 1 0    |     |           |     |M| 12
    |                  0 0 0 1 0 0|     |      0    |     |M| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 7
     *
     */

    pivot = sc_to_sc_matrix[33];

    // sc-row-7 = sc-row-7 - sc-row-10 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[33] = 0;
#endif

    sc_g_matrix[6] -= sc_g_matrix[9] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 x x x                      |     |           |     |x|  1
    |0 1 x x                      |     |           |     |x|  2
    |0 0 1 x                      |     |           |     |x|  3
    |0 0 0 1 x x x                |     |           |     |x|  4
    |      0 1 x x                |     |           |     |x|  5
    |      0 0 1 x                |     |           |     |x|  6
    |      0 0 0 1 x x 0          |     |           |     |M|  7
    |            0 1 0 0          | ... |           | ... |M|  8 sc
    |            0 0 1 0          |     |           |     |M|  9
    |            0 0 0 1 0 0 0    |     |           |     |M| 10
    |                  0 1 0 0    |     |           |     |M| 11
    |                  0 0 1 0    |     |           |     |M| 12
    |                  0 0 0 1 0 0|     |      0    |     |M| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[32];

    // sc-row-7 = sc-row-7 - sc-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[32] = 0;
#endif

    sc_g_matrix[6] -= sc_g_matrix[8] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 x x x                      |     |           |     |x|  1
    |0 1 x x                      |     |           |     |x|  2
    |0 0 1 x                      |     |           |     |x|  3
    |0 0 0 1 x x x                |     |           |     |x|  4
    |      0 1 x x                |     |           |     |x|  5
    |      0 0 1 x                |     |           |     |x|  6
    |      0 0 0 1 x 0 0          |     |           |     |M|  7
    |            0 1 0 0          | ... |           | ... |M|  8 sc
    |            0 0 1 0          |     |           |     |M|  9
    |            0 0 0 1 0 0 0    |     |           |     |M| 10
    |                  0 1 0 0    |     |           |     |M| 11
    |                  0 0 1 0    |     |           |     |M| 12
    |                  0 0 0 1 0 0|     |      0    |     |M| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[31];

    // sc-row-7 = sc-row-7 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[31] = 0;
#endif

    sc_g_matrix[6] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 x x x                      |     |           |     |x|  1
    |0 1 x x                      |     |           |     |x|  2
    |0 0 1 x                      |     |           |     |x|  3
    |0 0 0 1 x x x                |     |           |     |x|  4
    |      0 1 x x                |     |           |     |x|  5
    |      0 0 1 x                |     |           |     |x|  6
    |      0 0 0 1 0 0 0          |     |           |     |M|  7
    |            0 1 0 0          | ... |           | ... |M|  8 sc
    |            0 0 1 0          |     |           |     |M|  9
    |            0 0 0 1 0 0 0    |     |           |     |M| 10
    |                  0 1 0 0    |     |           |     |M| 11
    |                  0 0 1 0    |     |           |     |M| 12
    |                  0 0 0 1 0 0|     |      0    |     |M| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 6
     *
     */

    pivot = sc_to_sc_matrix[26];

    // sc-row-6 = sc-row-6 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[26] = 0;
#endif

    sc_g_matrix[5] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 x x x                      |     |           |     |x|  1
    |0 1 x x                      |     |           |     |x|  2
    |0 0 1 x                      |     |           |     |x|  3
    |0 0 0 1 x x x                |     |           |     |x|  4
    |      0 1 x x                |     |           |     |x|  5
    |      0 0 1 0                |     |           |     |M|  6
    |      0 0 0 1 0 0 0          |     |           |     |M|  7
    |            0 1 0 0          | ... |           | ... |M|  8 sc
    |            0 0 1 0          |     |           |     |M|  9
    |            0 0 0 1 0 0 0    |     |           |     |M| 10
    |                  0 1 0 0    |     |           |     |M| 11
    |                  0 0 1 0    |     |           |     |M| 12
    |                  0 0 0 1 0 0|     |      0    |     |M| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 5
     *
     */

    pivot = sc_to_sc_matrix[22];

    // sc-row-5 = sc-row-5 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[22] = 0;
#endif

    sc_g_matrix[4] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 x x x                      |     |           |     |x|  1
    |0 1 x x                      |     |           |     |x|  2
    |0 0 1 x                      |     |           |     |x|  3
    |0 0 0 1 x x x                |     |           |     |x|  4
    |      0 1 x 0                |     |           |     |M|  5
    |      0 0 1 0                |     |           |     |M|  6
    |      0 0 0 1 0 0 0          |     |           |     |M|  7
    |            0 1 0 0          | ... |           | ... |M|  8 sc
    |            0 0 1 0          |     |           |     |M|  9
    |            0 0 0 1 0 0 0    |     |           |     |M| 10
    |                  0 1 0 0    |     |           |     |M| 11
    |                  0 0 1 0    |     |           |     |M| 12
    |                  0 0 0 1 0 0|     |      0    |     |M| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[21];

    // sc-row-5 = sc-row-5 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[21] = 0;
#endif

    sc_g_matrix[4] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 x x x                      |     |           |     |x|  1
    |0 1 x x                      |     |           |     |x|  2
    |0 0 1 x                      |     |           |     |x|  3
    |0 0 0 1 x x x                |     |           |     |x|  4
    |      0 1 0 0                |     |           |     |M|  5
    |      0 0 1 0                |     |           |     |M|  6
    |      0 0 0 1 0 0 0          |     |           |     |M|  7
    |            0 1 0 0          | ... |           | ... |M|  8 sc
    |            0 0 1 0          |     |           |     |M|  9
    |            0 0 0 1 0 0 0    |     |           |     |M| 10
    |                  0 1 0 0    |     |           |     |M| 11
    |                  0 0 1 0    |     |           |     |M| 12
    |                  0 0 0 1 0 0|     |      0    |     |M| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 4
     *
     */

    pivot = sc_to_sc_matrix[18];

    // sc-row-4 = sc-row-4 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[18] = 0;
#endif

    sc_g_matrix[3] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 x x x                      |     |           |     |x|  1
    |0 1 x x                      |     |           |     |x|  2
    |0 0 1 x                      |     |           |     |x|  3
    |0 0 0 1 x x 0                |     |           |     |M|  4
    |      0 1 0 0                |     |           |     |M|  5
    |      0 0 1 0                |     |           |     |M|  6
    |      0 0 0 1 0 0 0          |     |           |     |M|  7
    |            0 1 0 0          | ... |           | ... |M|  8 sc
    |            0 0 1 0          |     |           |     |M|  9
    |            0 0 0 1 0 0 0    |     |           |     |M| 10
    |                  0 1 0 0    |     |           |     |M| 11
    |                  0 0 1 0    |     |           |     |M| 12
    |                  0 0 0 1 0 0|     |      0    |     |M| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[17];

    // sc-row-4 = sc-row-4 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[17] = 0;
#endif

    sc_g_matrix[3] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 x x x                      |     |           |     |x|  1
    |0 1 x x                      |     |           |     |x|  2
    |0 0 1 x                      |     |           |     |x|  3
    |0 0 0 1 x 0 0                |     |           |     |M|  4
    |      0 1 0 0                |     |           |     |M|  5
    |      0 0 1 0                |     |           |     |M|  6
    |      0 0 0 1 0 0 0          |     |           |     |M|  7
    |            0 1 0 0          | ... |           | ... |M|  8 sc
    |            0 0 1 0          |     |           |     |M|  9
    |            0 0 0 1 0 0 0    |     |           |     |M| 10
    |                  0 1 0 0    |     |           |     |M| 11
    |                  0 0 1 0    |     |           |     |M| 12
    |                  0 0 0 1 0 0|     |      0    |     |M| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[16];

    // sc-row-4 = sc-row-4 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[16] = 0;
#endif

    sc_g_matrix[3] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 x x x                      |     |           |     |x|  1
    |0 1 x x                      |     |           |     |x|  2
    |0 0 1 x                      |     |           |     |x|  3
    |0 0 0 1 0 0 0                |     |           |     |M|  4
    |      0 1 0 0                |     |           |     |M|  5
    |      0 0 1 0                |     |           |     |M|  6
    |      0 0 0 1 0 0 0          |     |           |     |M|  7
    |            0 1 0 0          | ... |           | ... |M|  8 sc
    |            0 0 1 0          |     |           |     |M|  9
    |            0 0 0 1 0 0 0    |     |           |     |M| 10
    |                  0 1 0 0    |     |           |     |M| 11
    |                  0 0 1 0    |     |           |     |M| 12
    |                  0 0 0 1 0 0|     |      0    |     |M| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 3
     *
     */

    pivot = sc_to_sc_matrix[11];

    // sc-row-3 = sc-row-3 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[11] = 0;
#endif

    sc_g_matrix[2] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 x x x                      |     |           |     |x|  1
    |0 1 x x                      |     |           |     |x|  2
    |0 0 1 0                      |     |           |     |M|  3
    |0 0 0 1 0 0 0                |     |           |     |M|  4
    |      0 1 0 0                |     |           |     |M|  5
    |      0 0 1 0                |     |           |     |M|  6
    |      0 0 0 1 0 0 0          |     |           |     |M|  7
    |            0 1 0 0          | ... |           | ... |M|  8 sc
    |            0 0 1 0          |     |           |     |M|  9
    |            0 0 0 1 0 0 0    |     |           |     |M| 10
    |                  0 1 0 0    |     |           |     |M| 11
    |                  0 0 1 0    |     |           |     |M| 12
    |                  0 0 0 1 0 0|     |      0    |     |M| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 2
     *
     */

    pivot = sc_to_sc_matrix[7];

    // sc-row-2 = sc-row-2 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[7] = 0;
#endif

    sc_g_matrix[1] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 x x x                      |     |           |     |x|  1
    |0 1 x 0                      |     |           |     |M|  2
    |0 0 1 0                      |     |           |     |M|  3
    |0 0 0 1 0 0 0                |     |           |     |M|  4
    |      0 1 0 0                |     |           |     |M|  5
    |      0 0 1 0                |     |           |     |M|  6
    |      0 0 0 1 0 0 0          |     |           |     |M|  7
    |            0 1 0 0          | ... |           | ... |M|  8 sc
    |            0 0 1 0          |     |           |     |M|  9
    |            0 0 0 1 0 0 0    |     |           |     |M| 10
    |                  0 1 0 0    |     |           |     |M| 11
    |                  0 0 1 0    |     |           |     |M| 12
    |                  0 0 0 1 0 0|     |      0    |     |M| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[6];

    // sc-row-2 = sc-row-2 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[6] = 0;
#endif

    sc_g_matrix[1] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 x x x                      |     |           |     |x|  1
    |0 1 0 0                      |     |           |     |M|  2
    |0 0 1 0                      |     |           |     |M|  3
    |0 0 0 1 0 0 0                |     |           |     |M|  4
    |      0 1 0 0                |     |           |     |M|  5
    |      0 0 1 0                |     |           |     |M|  6
    |      0 0 0 1 0 0 0          |     |           |     |M|  7
    |            0 1 0 0          | ... |           | ... |M|  8 sc
    |            0 0 1 0          |     |           |     |M|  9
    |            0 0 0 1 0 0 0    |     |           |     |M| 10
    |                  0 1 0 0    |     |           |     |M| 11
    |                  0 0 1 0    |     |           |     |M| 12
    |                  0 0 0 1 0 0|     |      0    |     |M| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 1
     *
     */

    pivot = sc_to_sc_matrix[3];

    // sc-row-1 = sc-row-1 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[3] = 0;
#endif

    sc_g_matrix[0] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 x x 0                      |     |           |     |M|  1
    |0 1 0 0                      |     |           |     |M|  2
    |0 0 1 0                      |     |           |     |M|  3
    |0 0 0 1 0 0 0                |     |           |     |M|  4
    |      0 1 0 0                |     |           |     |M|  5
    |      0 0 1 0                |     |           |     |M|  6
    |      0 0 0 1 0 0 0          |     |           |     |M|  7
    |            0 1 0 0          | ... |           | ... |M|  8 sc
    |            0 0 1 0          |     |           |     |M|  9
    |            0 0 0 1 0 0 0    |     |           |     |M| 10
    |                  0 1 0 0    |     |           |     |M| 11
    |                  0 0 1 0    |     |           |     |M| 12
    |                  0 0 0 1 0 0|     |      0    |     |M| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[2];

    // sc-row-1 = sc-row-1 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[2] = 0;
#endif

    sc_g_matrix[0] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 x 0 0                      |     |           |     |M|  1
    |0 1 0 0                      |     |           |     |M|  2
    |0 0 1 0                      |     |           |     |M|  3
    |0 0 0 1 0 0 0                |     |           |     |M|  4
    |      0 1 0 0                |     |           |     |M|  5
    |      0 0 1 0                |     |           |     |M|  6
    |      0 0 0 1 0 0 0          |     |           |     |M|  7
    |            0 1 0 0          | ... |           | ... |M|  8 sc
    |            0 0 1 0          |     |           |     |M|  9
    |            0 0 0 1 0 0 0    |     |           |     |M| 10
    |                  0 1 0 0    |     |           |     |M| 11
    |                  0 0 1 0    |     |           |     |M| 12
    |                  0 0 0 1 0 0|     |      0    |     |M| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[1];

    // sc-row-1 = sc-row-1 - sc-row-2 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[1] = 0;
#endif

    sc_g_matrix[0] -= sc_g_matrix[1] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1 0 0 0                      |     |           |     |M|  1
    |0 1 0 0                      |     |           |     |M|  2
    |0 0 1 0                      |     |           |     |M|  3
    |0 0 0 1 0 0 0                |     |           |     |M|  4
    |      0 1 0 0                |     |           |     |M|  5
    |      0 0 1 0                |     |           |     |M|  6
    |      0 0 0 1 0 0 0          |     |           |     |M|  7
    |            0 1 0 0          | ... |           | ... |M|  8 sc
    |            0 0 1 0          |     |           |     |M|  9
    |            0 0 0 1 0 0 0    |     |           |     |M| 10
    |                  0 1 0 0    |     |           |     |M| 11
    |                  0 0 1 0    |     |           |     |M| 12
    |                  0 0 0 1 0 0|     |      0    |     |M| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */
}

void gmx::IlvesPC::solve_17_arginine(real *const sc_to_sc_matrix,
                                     real *const sc_g_matrix,
                                     __attribute__((unused))
                                     real *const sc_to_sc_fillins) {
    /*
     *
     * Row 16
     *
     */

    real pivot = sc_to_sc_matrix[67];

    // sc-row-16 = sc-row-16 - sc-row-17 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[67] = 0;
#endif

    sc_g_matrix[15] -= sc_g_matrix[16] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 x x                            |     |           |     |x|  1
    |0 1 x                            |     |           |     |x|  2
    |0 0 1     x x                    |     |           |     |x|  3
    |      1 x x                      |     |           |     |x|  4
    |      0 1 x                      |     |           |     |x|  5
    |    0 0 0 1 x                    |     |           |     |x|  6
    |    0     0 1 x x                |     |           |     |x|  7
    |            0 1 x                |     |           |     |x|  8
    |            0 0 1 x x x          | ... |           | ... |x|  9 sc
    |                0 1 x x          |     |           |     |x| 10
    |                0 0 1 x          |     |           |     |x| 11
    |                0 0 0 1 x x x    |     |           |     |x| 12
    |                      0 1 x x    |     |           |     |x| 13
    |                      0 0 1 x    |     |           |     |x| 14
    |                      0 0 0 1 x x|     |      0    |     |x| 15
    |                            0 1 0|     |      0    |     |M| 16
    |                            0 0 1|     |      0    |     |x| 17
    -----------------------------------     -------------
    */

    /*
     *
     * Row 15
     *
     */

    pivot = sc_to_sc_matrix[64];

    // sc-row-15 = sc-row-15 - sc-row-17 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[64] = 0;
#endif

    sc_g_matrix[14] -= sc_g_matrix[16] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 x x                            |     |           |     |x|  1
    |0 1 x                            |     |           |     |x|  2
    |0 0 1     x x                    |     |           |     |x|  3
    |      1 x x                      |     |           |     |x|  4
    |      0 1 x                      |     |           |     |x|  5
    |    0 0 0 1 x                    |     |           |     |x|  6
    |    0     0 1 x x                |     |           |     |x|  7
    |            0 1 x                |     |           |     |x|  8
    |            0 0 1 x x x          | ... |           | ... |x|  9 sc
    |                0 1 x x          |     |           |     |x| 10
    |                0 0 1 x          |     |           |     |x| 11
    |                0 0 0 1 x x x    |     |           |     |x| 12
    |                      0 1 x x    |     |           |     |x| 13
    |                      0 0 1 x    |     |           |     |x| 14
    |                      0 0 0 1 x 0|     |      0    |     |M| 15
    |                            0 1 0|     |      0    |     |M| 16
    |                            0 0 1|     |      0    |     |x| 17
    -----------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[63];

    // sc-row-15 = sc-row-15 - sc-row-16 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[63] = 0;
#endif

    sc_g_matrix[14] -= sc_g_matrix[15] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 x x                            |     |           |     |x|  1
    |0 1 x                            |     |           |     |x|  2
    |0 0 1     x x                    |     |           |     |x|  3
    |      1 x x                      |     |           |     |x|  4
    |      0 1 x                      |     |           |     |x|  5
    |    0 0 0 1 x                    |     |           |     |x|  6
    |    0     0 1 x x                |     |           |     |x|  7
    |            0 1 x                |     |           |     |x|  8
    |            0 0 1 x x x          | ... |           | ... |x|  9 sc
    |                0 1 x x          |     |           |     |x| 10
    |                0 0 1 x          |     |           |     |x| 11
    |                0 0 0 1 x x x    |     |           |     |x| 12
    |                      0 1 x x    |     |           |     |x| 13
    |                      0 0 1 x    |     |           |     |x| 14
    |                      0 0 0 1 0 0|     |      0    |     |M| 15
    |                            0 1 0|     |      0    |     |M| 16
    |                            0 0 1|     |      0    |     |x| 17
    -----------------------------------     -------------
    */

    /*
     *
     * Row 14
     *
     */

    pivot = sc_to_sc_matrix[58];

    // sc-row-14 = sc-row-14 - sc-row-15 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[58] = 0;
#endif

    sc_g_matrix[13] -= sc_g_matrix[14] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 x x                            |     |           |     |x|  1
    |0 1 x                            |     |           |     |x|  2
    |0 0 1     x x                    |     |           |     |x|  3
    |      1 x x                      |     |           |     |x|  4
    |      0 1 x                      |     |           |     |x|  5
    |    0 0 0 1 x                    |     |           |     |x|  6
    |    0     0 1 x x                |     |           |     |x|  7
    |            0 1 x                |     |           |     |x|  8
    |            0 0 1 x x x          | ... |           | ... |x|  9 sc
    |                0 1 x x          |     |           |     |x| 10
    |                0 0 1 x          |     |           |     |x| 11
    |                0 0 0 1 x x x    |     |           |     |x| 12
    |                      0 1 x x    |     |           |     |x| 13
    |                      0 0 1 0    |     |           |     |M| 14
    |                      0 0 0 1 0 0|     |      0    |     |M| 15
    |                            0 1 0|     |      0    |     |M| 16
    |                            0 0 1|     |      0    |     |x| 17
    -----------------------------------     -------------
    */

    /*
     *
     * Row 13
     *
     */

    pivot = sc_to_sc_matrix[54];

    // sc-row-13 = sc-row-13 - sc-row-15 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[54] = 0;
#endif

    sc_g_matrix[12] -= sc_g_matrix[14] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 x x                            |     |           |     |x|  1
    |0 1 x                            |     |           |     |x|  2
    |0 0 1     x x                    |     |           |     |x|  3
    |      1 x x                      |     |           |     |x|  4
    |      0 1 x                      |     |           |     |x|  5
    |    0 0 0 1 x                    |     |           |     |x|  6
    |    0     0 1 x x                |     |           |     |x|  7
    |            0 1 x                |     |           |     |x|  8
    |            0 0 1 x x x          | ... |           | ... |x|  9 sc
    |                0 1 x x          |     |           |     |x| 10
    |                0 0 1 x          |     |           |     |x| 11
    |                0 0 0 1 x x x    |     |           |     |x| 12
    |                      0 1 x 0    |     |           |     |M| 13
    |                      0 0 1 0    |     |           |     |M| 14
    |                      0 0 0 1 0 0|     |      0    |     |M| 15
    |                            0 1 0|     |      0    |     |M| 16
    |                            0 0 1|     |      0    |     |x| 17
    -----------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[53];

    // sc-row-13 = sc-row-13 - sc-row-14 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[53] = 0;
#endif

    sc_g_matrix[12] -= sc_g_matrix[13] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 x x                            |     |           |     |x|  1
    |0 1 x                            |     |           |     |x|  2
    |0 0 1     x x                    |     |           |     |x|  3
    |      1 x x                      |     |           |     |x|  4
    |      0 1 x                      |     |           |     |x|  5
    |    0 0 0 1 x                    |     |           |     |x|  6
    |    0     0 1 x x                |     |           |     |x|  7
    |            0 1 x                |     |           |     |x|  8
    |            0 0 1 x x x          | ... |           | ... |x|  9 sc
    |                0 1 x x          |     |           |     |x| 10
    |                0 0 1 x          |     |           |     |x| 11
    |                0 0 0 1 x x x    |     |           |     |x| 12
    |                      0 1 0 0    |     |           |     |M| 13
    |                      0 0 1 0    |     |           |     |M| 14
    |                      0 0 0 1 0 0|     |      0    |     |M| 15
    |                            0 1 0|     |      0    |     |M| 16
    |                            0 0 1|     |      0    |     |x| 17
    -----------------------------------     -------------
    */

    /*
     *
     * Row 12
     *
     */

    pivot = sc_to_sc_matrix[50];

    // sc-row-12 = sc-row-12 - sc-row-15 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[50] = 0;
#endif

    sc_g_matrix[11] -= sc_g_matrix[14] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 x x                            |     |           |     |x|  1
    |0 1 x                            |     |           |     |x|  2
    |0 0 1     x x                    |     |           |     |x|  3
    |      1 x x                      |     |           |     |x|  4
    |      0 1 x                      |     |           |     |x|  5
    |    0 0 0 1 x                    |     |           |     |x|  6
    |    0     0 1 x x                |     |           |     |x|  7
    |            0 1 x                |     |           |     |x|  8
    |            0 0 1 x x x          | ... |           | ... |x|  9 sc
    |                0 1 x x          |     |           |     |x| 10
    |                0 0 1 x          |     |           |     |x| 11
    |                0 0 0 1 x x 0    |     |           |     |M| 12
    |                      0 1 0 0    |     |           |     |M| 13
    |                      0 0 1 0    |     |           |     |M| 14
    |                      0 0 0 1 0 0|     |      0    |     |M| 15
    |                            0 1 0|     |      0    |     |M| 16
    |                            0 0 1|     |      0    |     |x| 17
    -----------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[49];

    // sc-row-12 = sc-row-12 - sc-row-14 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[49] = 0;
#endif

    sc_g_matrix[11] -= sc_g_matrix[13] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 x x                            |     |           |     |x|  1
    |0 1 x                            |     |           |     |x|  2
    |0 0 1     x x                    |     |           |     |x|  3
    |      1 x x                      |     |           |     |x|  4
    |      0 1 x                      |     |           |     |x|  5
    |    0 0 0 1 x                    |     |           |     |x|  6
    |    0     0 1 x x                |     |           |     |x|  7
    |            0 1 x                |     |           |     |x|  8
    |            0 0 1 x x x          | ... |           | ... |x|  9 sc
    |                0 1 x x          |     |           |     |x| 10
    |                0 0 1 x          |     |           |     |x| 11
    |                0 0 0 1 x 0 0    |     |           |     |M| 12
    |                      0 1 0 0    |     |           |     |M| 13
    |                      0 0 1 0    |     |           |     |M| 14
    |                      0 0 0 1 0 0|     |      0    |     |M| 15
    |                            0 1 0|     |      0    |     |M| 16
    |                            0 0 1|     |      0    |     |x| 17
    -----------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[48];

    // sc-row-12 = sc-row-12 - sc-row-13 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[48] = 0;
#endif

    sc_g_matrix[11] -= sc_g_matrix[12] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 x x                            |     |           |     |x|  1
    |0 1 x                            |     |           |     |x|  2
    |0 0 1     x x                    |     |           |     |x|  3
    |      1 x x                      |     |           |     |x|  4
    |      0 1 x                      |     |           |     |x|  5
    |    0 0 0 1 x                    |     |           |     |x|  6
    |    0     0 1 x x                |     |           |     |x|  7
    |            0 1 x                |     |           |     |x|  8
    |            0 0 1 x x x          | ... |           | ... |x|  9 sc
    |                0 1 x x          |     |           |     |x| 10
    |                0 0 1 x          |     |           |     |x| 11
    |                0 0 0 1 0 0 0    |     |           |     |M| 12
    |                      0 1 0 0    |     |           |     |M| 13
    |                      0 0 1 0    |     |           |     |M| 14
    |                      0 0 0 1 0 0|     |      0    |     |M| 15
    |                            0 1 0|     |      0    |     |M| 16
    |                            0 0 1|     |      0    |     |x| 17
    -----------------------------------     -------------
    */

    /*
     *
     * Row 11
     *
     */

    pivot = sc_to_sc_matrix[43];

    // sc-row-11 = sc-row-11 - sc-row-12 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[43] = 0;
#endif

    sc_g_matrix[10] -= sc_g_matrix[11] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 x x                            |     |           |     |x|  1
    |0 1 x                            |     |           |     |x|  2
    |0 0 1     x x                    |     |           |     |x|  3
    |      1 x x                      |     |           |     |x|  4
    |      0 1 x                      |     |           |     |x|  5
    |    0 0 0 1 x                    |     |           |     |x|  6
    |    0     0 1 x x                |     |           |     |x|  7
    |            0 1 x                |     |           |     |x|  8
    |            0 0 1 x x x          | ... |           | ... |x|  9 sc
    |                0 1 x x          |     |           |     |x| 10
    |                0 0 1 0          |     |           |     |M| 11
    |                0 0 0 1 0 0 0    |     |           |     |M| 12
    |                      0 1 0 0    |     |           |     |M| 13
    |                      0 0 1 0    |     |           |     |M| 14
    |                      0 0 0 1 0 0|     |      0    |     |M| 15
    |                            0 1 0|     |      0    |     |M| 16
    |                            0 0 1|     |      0    |     |x| 17
    -----------------------------------     -------------
    */

    /*
     *
     * Row 10
     *
     */

    pivot = sc_to_sc_matrix[39];

    // sc-row-10 = sc-row-10 - sc-row-12 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[39] = 0;
#endif

    sc_g_matrix[9] -= sc_g_matrix[11] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 x x                            |     |           |     |x|  1
    |0 1 x                            |     |           |     |x|  2
    |0 0 1     x x                    |     |           |     |x|  3
    |      1 x x                      |     |           |     |x|  4
    |      0 1 x                      |     |           |     |x|  5
    |    0 0 0 1 x                    |     |           |     |x|  6
    |    0     0 1 x x                |     |           |     |x|  7
    |            0 1 x                |     |           |     |x|  8
    |            0 0 1 x x x          | ... |           | ... |x|  9 sc
    |                0 1 x 0          |     |           |     |M| 10
    |                0 0 1 0          |     |           |     |M| 11
    |                0 0 0 1 0 0 0    |     |           |     |M| 12
    |                      0 1 0 0    |     |           |     |M| 13
    |                      0 0 1 0    |     |           |     |M| 14
    |                      0 0 0 1 0 0|     |      0    |     |M| 15
    |                            0 1 0|     |      0    |     |M| 16
    |                            0 0 1|     |      0    |     |x| 17
    -----------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[38];

    // sc-row-10 = sc-row-10 - sc-row-11 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[38] = 0;
#endif

    sc_g_matrix[9] -= sc_g_matrix[10] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 x x                            |     |           |     |x|  1
    |0 1 x                            |     |           |     |x|  2
    |0 0 1     x x                    |     |           |     |x|  3
    |      1 x x                      |     |           |     |x|  4
    |      0 1 x                      |     |           |     |x|  5
    |    0 0 0 1 x                    |     |           |     |x|  6
    |    0     0 1 x x                |     |           |     |x|  7
    |            0 1 x                |     |           |     |x|  8
    |            0 0 1 x x x          | ... |           | ... |x|  9 sc
    |                0 1 0 0          |     |           |     |M| 10
    |                0 0 1 0          |     |           |     |M| 11
    |                0 0 0 1 0 0 0    |     |           |     |M| 12
    |                      0 1 0 0    |     |           |     |M| 13
    |                      0 0 1 0    |     |           |     |M| 14
    |                      0 0 0 1 0 0|     |      0    |     |M| 15
    |                            0 1 0|     |      0    |     |M| 16
    |                            0 0 1|     |      0    |     |x| 17
    -----------------------------------     -------------
    */

    /*
     *
     * Row 9
     *
     */

    pivot = sc_to_sc_matrix[35];

    // sc-row-9 = sc-row-9 - sc-row-12 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[35] = 0;
#endif

    sc_g_matrix[8] -= sc_g_matrix[11] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 x x                            |     |           |     |x|  1
    |0 1 x                            |     |           |     |x|  2
    |0 0 1     x x                    |     |           |     |x|  3
    |      1 x x                      |     |           |     |x|  4
    |      0 1 x                      |     |           |     |x|  5
    |    0 0 0 1 x                    |     |           |     |x|  6
    |    0     0 1 x x                |     |           |     |x|  7
    |            0 1 x                |     |           |     |x|  8
    |            0 0 1 x x 0          | ... |           | ... |M|  9 sc
    |                0 1 0 0          |     |           |     |M| 10
    |                0 0 1 0          |     |           |     |M| 11
    |                0 0 0 1 0 0 0    |     |           |     |M| 12
    |                      0 1 0 0    |     |           |     |M| 13
    |                      0 0 1 0    |     |           |     |M| 14
    |                      0 0 0 1 0 0|     |      0    |     |M| 15
    |                            0 1 0|     |      0    |     |M| 16
    |                            0 0 1|     |      0    |     |x| 17
    -----------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[34];

    // sc-row-9 = sc-row-9 - sc-row-11 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[34] = 0;
#endif

    sc_g_matrix[8] -= sc_g_matrix[10] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 x x                            |     |           |     |x|  1
    |0 1 x                            |     |           |     |x|  2
    |0 0 1     x x                    |     |           |     |x|  3
    |      1 x x                      |     |           |     |x|  4
    |      0 1 x                      |     |           |     |x|  5
    |    0 0 0 1 x                    |     |           |     |x|  6
    |    0     0 1 x x                |     |           |     |x|  7
    |            0 1 x                |     |           |     |x|  8
    |            0 0 1 x 0 0          | ... |           | ... |M|  9 sc
    |                0 1 0 0          |     |           |     |M| 10
    |                0 0 1 0          |     |           |     |M| 11
    |                0 0 0 1 0 0 0    |     |           |     |M| 12
    |                      0 1 0 0    |     |           |     |M| 13
    |                      0 0 1 0    |     |           |     |M| 14
    |                      0 0 0 1 0 0|     |      0    |     |M| 15
    |                            0 1 0|     |      0    |     |M| 16
    |                            0 0 1|     |      0    |     |x| 17
    -----------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[33];

    // sc-row-9 = sc-row-9 - sc-row-10 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[33] = 0;
#endif

    sc_g_matrix[8] -= sc_g_matrix[9] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 x x                            |     |           |     |x|  1
    |0 1 x                            |     |           |     |x|  2
    |0 0 1     x x                    |     |           |     |x|  3
    |      1 x x                      |     |           |     |x|  4
    |      0 1 x                      |     |           |     |x|  5
    |    0 0 0 1 x                    |     |           |     |x|  6
    |    0     0 1 x x                |     |           |     |x|  7
    |            0 1 x                |     |           |     |x|  8
    |            0 0 1 0 0 0          | ... |           | ... |M|  9 sc
    |                0 1 0 0          |     |           |     |M| 10
    |                0 0 1 0          |     |           |     |M| 11
    |                0 0 0 1 0 0 0    |     |           |     |M| 12
    |                      0 1 0 0    |     |           |     |M| 13
    |                      0 0 1 0    |     |           |     |M| 14
    |                      0 0 0 1 0 0|     |      0    |     |M| 15
    |                            0 1 0|     |      0    |     |M| 16
    |                            0 0 1|     |      0    |     |x| 17
    -----------------------------------     -------------
    */

    /*
     *
     * Row 8
     *
     */

    pivot = sc_to_sc_matrix[29];

    // sc-row-8 = sc-row-8 - sc-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[29] = 0;
#endif

    sc_g_matrix[7] -= sc_g_matrix[8] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 x x                            |     |           |     |x|  1
    |0 1 x                            |     |           |     |x|  2
    |0 0 1     x x                    |     |           |     |x|  3
    |      1 x x                      |     |           |     |x|  4
    |      0 1 x                      |     |           |     |x|  5
    |    0 0 0 1 x                    |     |           |     |x|  6
    |    0     0 1 x x                |     |           |     |x|  7
    |            0 1 0                |     |           |     |M|  8
    |            0 0 1 0 0 0          | ... |           | ... |M|  9 sc
    |                0 1 0 0          |     |           |     |M| 10
    |                0 0 1 0          |     |           |     |M| 11
    |                0 0 0 1 0 0 0    |     |           |     |M| 12
    |                      0 1 0 0    |     |           |     |M| 13
    |                      0 0 1 0    |     |           |     |M| 14
    |                      0 0 0 1 0 0|     |      0    |     |M| 15
    |                            0 1 0|     |      0    |     |M| 16
    |                            0 0 1|     |      0    |     |x| 17
    -----------------------------------     -------------
    */

    /*
     *
     * Row 7
     *
     */

    pivot = sc_to_sc_matrix[26];

    // sc-row-7 = sc-row-7 - sc-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[26] = 0;
#endif

    sc_g_matrix[6] -= sc_g_matrix[8] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 x x                            |     |           |     |x|  1
    |0 1 x                            |     |           |     |x|  2
    |0 0 1     x x                    |     |           |     |x|  3
    |      1 x x                      |     |           |     |x|  4
    |      0 1 x                      |     |           |     |x|  5
    |    0 0 0 1 x                    |     |           |     |x|  6
    |    0     0 1 x 0                |     |           |     |M|  7
    |            0 1 0                |     |           |     |M|  8
    |            0 0 1 0 0 0          | ... |           | ... |M|  9 sc
    |                0 1 0 0          |     |           |     |M| 10
    |                0 0 1 0          |     |           |     |M| 11
    |                0 0 0 1 0 0 0    |     |           |     |M| 12
    |                      0 1 0 0    |     |           |     |M| 13
    |                      0 0 1 0    |     |           |     |M| 14
    |                      0 0 0 1 0 0|     |      0    |     |M| 15
    |                            0 1 0|     |      0    |     |M| 16
    |                            0 0 1|     |      0    |     |x| 17
    -----------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[25];

    // sc-row-7 = sc-row-7 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[25] = 0;
#endif

    sc_g_matrix[6] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 x x                            |     |           |     |x|  1
    |0 1 x                            |     |           |     |x|  2
    |0 0 1     x x                    |     |           |     |x|  3
    |      1 x x                      |     |           |     |x|  4
    |      0 1 x                      |     |           |     |x|  5
    |    0 0 0 1 x                    |     |           |     |x|  6
    |    0     0 1 0 0                |     |           |     |M|  7
    |            0 1 0                |     |           |     |M|  8
    |            0 0 1 0 0 0          | ... |           | ... |M|  9 sc
    |                0 1 0 0          |     |           |     |M| 10
    |                0 0 1 0          |     |           |     |M| 11
    |                0 0 0 1 0 0 0    |     |           |     |M| 12
    |                      0 1 0 0    |     |           |     |M| 13
    |                      0 0 1 0    |     |           |     |M| 14
    |                      0 0 0 1 0 0|     |      0    |     |M| 15
    |                            0 1 0|     |      0    |     |M| 16
    |                            0 0 1|     |      0    |     |x| 17
    -----------------------------------     -------------
    */

    /*
     *
     * Row 6
     *
     */

    pivot = sc_to_sc_matrix[21];

    // sc-row-6 = sc-row-6 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[21] = 0;
#endif

    sc_g_matrix[5] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 x x                            |     |           |     |x|  1
    |0 1 x                            |     |           |     |x|  2
    |0 0 1     x x                    |     |           |     |x|  3
    |      1 x x                      |     |           |     |x|  4
    |      0 1 x                      |     |           |     |x|  5
    |    0 0 0 1 0                    |     |           |     |M|  6
    |    0     0 1 0 0                |     |           |     |M|  7
    |            0 1 0                |     |           |     |M|  8
    |            0 0 1 0 0 0          | ... |           | ... |M|  9 sc
    |                0 1 0 0          |     |           |     |M| 10
    |                0 0 1 0          |     |           |     |M| 11
    |                0 0 0 1 0 0 0    |     |           |     |M| 12
    |                      0 1 0 0    |     |           |     |M| 13
    |                      0 0 1 0    |     |           |     |M| 14
    |                      0 0 0 1 0 0|     |      0    |     |M| 15
    |                            0 1 0|     |      0    |     |M| 16
    |                            0 0 1|     |      0    |     |x| 17
    -----------------------------------     -------------
    */

    /*
     *
     * Row 5
     *
     */

    pivot = sc_to_sc_matrix[16];

    // sc-row-5 = sc-row-5 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[16] = 0;
#endif

    sc_g_matrix[4] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 x x                            |     |           |     |x|  1
    |0 1 x                            |     |           |     |x|  2
    |0 0 1     x x                    |     |           |     |x|  3
    |      1 x x                      |     |           |     |x|  4
    |      0 1 0                      |     |           |     |M|  5
    |    0 0 0 1 0                    |     |           |     |M|  6
    |    0     0 1 0 0                |     |           |     |M|  7
    |            0 1 0                |     |           |     |M|  8
    |            0 0 1 0 0 0          | ... |           | ... |M|  9 sc
    |                0 1 0 0          |     |           |     |M| 10
    |                0 0 1 0          |     |           |     |M| 11
    |                0 0 0 1 0 0 0    |     |           |     |M| 12
    |                      0 1 0 0    |     |           |     |M| 13
    |                      0 0 1 0    |     |           |     |M| 14
    |                      0 0 0 1 0 0|     |      0    |     |M| 15
    |                            0 1 0|     |      0    |     |M| 16
    |                            0 0 1|     |      0    |     |x| 17
    -----------------------------------     -------------
    */

    /*
     *
     * Row 4
     *
     */

    pivot = sc_to_sc_matrix[13];

    // sc-row-4 = sc-row-4 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[13] = 0;
#endif

    sc_g_matrix[3] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 x x                            |     |           |     |x|  1
    |0 1 x                            |     |           |     |x|  2
    |0 0 1     x x                    |     |           |     |x|  3
    |      1 x 0                      |     |           |     |M|  4
    |      0 1 0                      |     |           |     |M|  5
    |    0 0 0 1 0                    |     |           |     |M|  6
    |    0     0 1 0 0                |     |           |     |M|  7
    |            0 1 0                |     |           |     |M|  8
    |            0 0 1 0 0 0          | ... |           | ... |M|  9 sc
    |                0 1 0 0          |     |           |     |M| 10
    |                0 0 1 0          |     |           |     |M| 11
    |                0 0 0 1 0 0 0    |     |           |     |M| 12
    |                      0 1 0 0    |     |           |     |M| 13
    |                      0 0 1 0    |     |           |     |M| 14
    |                      0 0 0 1 0 0|     |      0    |     |M| 15
    |                            0 1 0|     |      0    |     |M| 16
    |                            0 0 1|     |      0    |     |x| 17
    -----------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[12];

    // sc-row-4 = sc-row-4 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[12] = 0;
#endif

    sc_g_matrix[3] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 x x                            |     |           |     |x|  1
    |0 1 x                            |     |           |     |x|  2
    |0 0 1     x x                    |     |           |     |x|  3
    |      1 0 0                      |     |           |     |M|  4
    |      0 1 0                      |     |           |     |M|  5
    |    0 0 0 1 0                    |     |           |     |M|  6
    |    0     0 1 0 0                |     |           |     |M|  7
    |            0 1 0                |     |           |     |M|  8
    |            0 0 1 0 0 0          | ... |           | ... |M|  9 sc
    |                0 1 0 0          |     |           |     |M| 10
    |                0 0 1 0          |     |           |     |M| 11
    |                0 0 0 1 0 0 0    |     |           |     |M| 12
    |                      0 1 0 0    |     |           |     |M| 13
    |                      0 0 1 0    |     |           |     |M| 14
    |                      0 0 0 1 0 0|     |      0    |     |M| 15
    |                            0 1 0|     |      0    |     |M| 16
    |                            0 0 1|     |      0    |     |x| 17
    -----------------------------------     -------------
    */

    /*
     *
     * Row 3
     *
     */

    pivot = sc_to_sc_matrix[10];

    // sc-row-3 = sc-row-3 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[10] = 0;
#endif

    sc_g_matrix[2] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 x x                            |     |           |     |x|  1
    |0 1 x                            |     |           |     |x|  2
    |0 0 1     x 0                    |     |           |     |M|  3
    |      1 0 0                      |     |           |     |M|  4
    |      0 1 0                      |     |           |     |M|  5
    |    0 0 0 1 0                    |     |           |     |M|  6
    |    0     0 1 0 0                |     |           |     |M|  7
    |            0 1 0                |     |           |     |M|  8
    |            0 0 1 0 0 0          | ... |           | ... |M|  9 sc
    |                0 1 0 0          |     |           |     |M| 10
    |                0 0 1 0          |     |           |     |M| 11
    |                0 0 0 1 0 0 0    |     |           |     |M| 12
    |                      0 1 0 0    |     |           |     |M| 13
    |                      0 0 1 0    |     |           |     |M| 14
    |                      0 0 0 1 0 0|     |      0    |     |M| 15
    |                            0 1 0|     |      0    |     |M| 16
    |                            0 0 1|     |      0    |     |x| 17
    -----------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[9];

    // sc-row-3 = sc-row-3 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[9] = 0;
#endif

    sc_g_matrix[2] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 x x                            |     |           |     |x|  1
    |0 1 x                            |     |           |     |x|  2
    |0 0 1     0 0                    |     |           |     |M|  3
    |      1 0 0                      |     |           |     |M|  4
    |      0 1 0                      |     |           |     |M|  5
    |    0 0 0 1 0                    |     |           |     |M|  6
    |    0     0 1 0 0                |     |           |     |M|  7
    |            0 1 0                |     |           |     |M|  8
    |            0 0 1 0 0 0          | ... |           | ... |M|  9 sc
    |                0 1 0 0          |     |           |     |M| 10
    |                0 0 1 0          |     |           |     |M| 11
    |                0 0 0 1 0 0 0    |     |           |     |M| 12
    |                      0 1 0 0    |     |           |     |M| 13
    |                      0 0 1 0    |     |           |     |M| 14
    |                      0 0 0 1 0 0|     |      0    |     |M| 15
    |                            0 1 0|     |      0    |     |M| 16
    |                            0 0 1|     |      0    |     |x| 17
    -----------------------------------     -------------
    */

    /*
     *
     * Row 2
     *
     */

    pivot = sc_to_sc_matrix[5];

    // sc-row-2 = sc-row-2 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[5] = 0;
#endif

    sc_g_matrix[1] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 x x                            |     |           |     |x|  1
    |0 1 0                            |     |           |     |M|  2
    |0 0 1     0 0                    |     |           |     |M|  3
    |      1 0 0                      |     |           |     |M|  4
    |      0 1 0                      |     |           |     |M|  5
    |    0 0 0 1 0                    |     |           |     |M|  6
    |    0     0 1 0 0                |     |           |     |M|  7
    |            0 1 0                |     |           |     |M|  8
    |            0 0 1 0 0 0          | ... |           | ... |M|  9 sc
    |                0 1 0 0          |     |           |     |M| 10
    |                0 0 1 0          |     |           |     |M| 11
    |                0 0 0 1 0 0 0    |     |           |     |M| 12
    |                      0 1 0 0    |     |           |     |M| 13
    |                      0 0 1 0    |     |           |     |M| 14
    |                      0 0 0 1 0 0|     |      0    |     |M| 15
    |                            0 1 0|     |      0    |     |M| 16
    |                            0 0 1|     |      0    |     |x| 17
    -----------------------------------     -------------
    */

    /*
     *
     * Row 1
     *
     */

    pivot = sc_to_sc_matrix[2];

    // sc-row-1 = sc-row-1 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[2] = 0;
#endif

    sc_g_matrix[0] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 x 0                            |     |           |     |M|  1
    |0 1 0                            |     |           |     |M|  2
    |0 0 1     0 0                    |     |           |     |M|  3
    |      1 0 0                      |     |           |     |M|  4
    |      0 1 0                      |     |           |     |M|  5
    |    0 0 0 1 0                    |     |           |     |M|  6
    |    0     0 1 0 0                |     |           |     |M|  7
    |            0 1 0                |     |           |     |M|  8
    |            0 0 1 0 0 0          | ... |           | ... |M|  9 sc
    |                0 1 0 0          |     |           |     |M| 10
    |                0 0 1 0          |     |           |     |M| 11
    |                0 0 0 1 0 0 0    |     |           |     |M| 12
    |                      0 1 0 0    |     |           |     |M| 13
    |                      0 0 1 0    |     |           |     |M| 14
    |                      0 0 0 1 0 0|     |      0    |     |M| 15
    |                            0 1 0|     |      0    |     |M| 16
    |                            0 0 1|     |      0    |     |x| 17
    -----------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[1];

    // sc-row-1 = sc-row-1 - sc-row-2 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[1] = 0;
#endif

    sc_g_matrix[0] -= sc_g_matrix[1] * pivot;

    /*
    Resulting matrix:

                    sc                           bb            g
     1 2 3 4 5 6 7 8 91011121314151617       1 2 3 4 5 6
    -----------------------------------     -------------
    |1 0 0                            |     |           |     |M|  1
    |0 1 0                            |     |           |     |M|  2
    |0 0 1     0 0                    |     |           |     |M|  3
    |      1 0 0                      |     |           |     |M|  4
    |      0 1 0                      |     |           |     |M|  5
    |    0 0 0 1 0                    |     |           |     |M|  6
    |    0     0 1 0 0                |     |           |     |M|  7
    |            0 1 0                |     |           |     |M|  8
    |            0 0 1 0 0 0          | ... |           | ... |M|  9 sc
    |                0 1 0 0          |     |           |     |M| 10
    |                0 0 1 0          |     |           |     |M| 11
    |                0 0 0 1 0 0 0    |     |           |     |M| 12
    |                      0 1 0 0    |     |           |     |M| 13
    |                      0 0 1 0    |     |           |     |M| 14
    |                      0 0 0 1 0 0|     |      0    |     |M| 15
    |                            0 1 0|     |      0    |     |M| 16
    |                            0 0 1|     |      0    |     |x| 17
    -----------------------------------     -------------
    */
}

void gmx::IlvesPC::solve_17_serine(real *const sc_to_sc_matrix,
                                   real *const sc_g_matrix,
                                   __attribute__((unused))
                                   real *const sc_to_sc_fillins) {
    /*
     *
     * Row 3
     *
     */

    real pivot = sc_to_sc_matrix[8];

    // sc-row-3 = sc-row-3 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[8] = 0;
#endif

    sc_g_matrix[2] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

       sc              bb            g
     1 2 3 4       1 2 3 4 5 6
    ---------     -------------
    |1 x    |     |           |     |x|  1
    |0 1 x x|     |      0    |     |x|  2
    |  0 1 0| ... |      0    | ... |M|  3 sc
    |  0 0 1|     |      0    |     |x|  4
    ---------     -------------
    */

    /*
     *
     * Row 2
     *
     */

    pivot = sc_to_sc_matrix[5];

    // sc-row-2 = sc-row-2 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[5] = 0;
#endif

    sc_g_matrix[1] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

       sc              bb            g
     1 2 3 4       1 2 3 4 5 6
    ---------     -------------
    |1 x    |     |           |     |x|  1
    |0 1 x 0|     |      0    |     |M|  2
    |  0 1 0| ... |      0    | ... |M|  3 sc
    |  0 0 1|     |      0    |     |x|  4
    ---------     -------------
    */

    pivot = sc_to_sc_matrix[4];

    // sc-row-2 = sc-row-2 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[4] = 0;
#endif

    sc_g_matrix[1] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

       sc              bb            g
     1 2 3 4       1 2 3 4 5 6
    ---------     -------------
    |1 x    |     |           |     |x|  1
    |0 1 0 0|     |      0    |     |M|  2
    |  0 1 0| ... |      0    | ... |M|  3 sc
    |  0 0 1|     |      0    |     |x|  4
    ---------     -------------
    */

    /*
     *
     * Row 1
     *
     */

    pivot = sc_to_sc_matrix[1];

    // sc-row-1 = sc-row-1 - sc-row-2 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[1] = 0;
#endif

    sc_g_matrix[0] -= sc_g_matrix[1] * pivot;

    /*
    Resulting matrix:

       sc              bb            g
     1 2 3 4       1 2 3 4 5 6
    ---------     -------------
    |1 0    |     |           |     |M|  1
    |0 1 0 0|     |      0    |     |M|  2
    |  0 1 0| ... |      0    | ... |M|  3 sc
    |  0 0 1|     |      0    |     |x|  4
    ---------     -------------
    */
}

void gmx::IlvesPC::solve_17_phenylaline(real *const sc_to_sc_matrix,
                                        real *const sc_g_matrix,
                                        real *const sc_to_sc_fillins) {
    /*
     *
     * Row 13
     *
     */

    real pivot = sc_to_sc_matrix[52];

    // sc-row-13 = sc-row-13 - sc-row-14 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[52] = 0;
#endif

    sc_g_matrix[12] -= sc_g_matrix[13] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   x             x        |     |           |     |x|  1
    |  1 x   x                  |     |           |     |x|  2
    |0 0 1   x         x        |     |           |     |x|  3
    |      1 x   x              |     |           |     |x|  4
    |  0 0 0 1   x     f        |     |           |     |x|  5
    |          1 x   x          |     |           |     |x|  6
    |      0 0 0 1   x f        |     |           |     |x|  7
    |              1 x   x      | ... |           | ... |x|  8 sc
    |          0 0 0 1 f x      |     |           |     |x|  9
    |0   0   0   0   0 1 x x    |     |           |     |x| 10
    |              0 0 0 1 x    |     |           |     |x| 11
    |                  0 0 1 x x|     |      0    |     |x| 12
    |                      0 1 0|     |      0    |     |M| 13
    |                      0 0 1|     |      0    |     |x| 14
    -----------------------------     -------------
    */

    /*
     *
     * Row 12
     *
     */

    pivot = sc_to_sc_matrix[49];

    // sc-row-12 = sc-row-12 - sc-row-14 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[49] = 0;
#endif

    sc_g_matrix[11] -= sc_g_matrix[13] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   x             x        |     |           |     |x|  1
    |  1 x   x                  |     |           |     |x|  2
    |0 0 1   x         x        |     |           |     |x|  3
    |      1 x   x              |     |           |     |x|  4
    |  0 0 0 1   x     f        |     |           |     |x|  5
    |          1 x   x          |     |           |     |x|  6
    |      0 0 0 1   x f        |     |           |     |x|  7
    |              1 x   x      | ... |           | ... |x|  8 sc
    |          0 0 0 1 f x      |     |           |     |x|  9
    |0   0   0   0   0 1 x x    |     |           |     |x| 10
    |              0 0 0 1 x    |     |           |     |x| 11
    |                  0 0 1 x 0|     |      0    |     |M| 12
    |                      0 1 0|     |      0    |     |M| 13
    |                      0 0 1|     |      0    |     |x| 14
    -----------------------------     -------------
    */

    pivot = sc_to_sc_matrix[48];

    // sc-row-12 = sc-row-12 - sc-row-13 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[48] = 0;
#endif

    sc_g_matrix[11] -= sc_g_matrix[12] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   x             x        |     |           |     |x|  1
    |  1 x   x                  |     |           |     |x|  2
    |0 0 1   x         x        |     |           |     |x|  3
    |      1 x   x              |     |           |     |x|  4
    |  0 0 0 1   x     f        |     |           |     |x|  5
    |          1 x   x          |     |           |     |x|  6
    |      0 0 0 1   x f        |     |           |     |x|  7
    |              1 x   x      | ... |           | ... |x|  8 sc
    |          0 0 0 1 f x      |     |           |     |x|  9
    |0   0   0   0   0 1 x x    |     |           |     |x| 10
    |              0 0 0 1 x    |     |           |     |x| 11
    |                  0 0 1 0 0|     |      0    |     |M| 12
    |                      0 1 0|     |      0    |     |M| 13
    |                      0 0 1|     |      0    |     |x| 14
    -----------------------------     -------------
    */

    /*
     *
     * Row 11
     *
     */

    pivot = sc_to_sc_matrix[44];

    // sc-row-11 = sc-row-11 - sc-row-12 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[44] = 0;
#endif

    sc_g_matrix[10] -= sc_g_matrix[11] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   x             x        |     |           |     |x|  1
    |  1 x   x                  |     |           |     |x|  2
    |0 0 1   x         x        |     |           |     |x|  3
    |      1 x   x              |     |           |     |x|  4
    |  0 0 0 1   x     f        |     |           |     |x|  5
    |          1 x   x          |     |           |     |x|  6
    |      0 0 0 1   x f        |     |           |     |x|  7
    |              1 x   x      | ... |           | ... |x|  8 sc
    |          0 0 0 1 f x      |     |           |     |x|  9
    |0   0   0   0   0 1 x x    |     |           |     |x| 10
    |              0 0 0 1 0    |     |           |     |M| 11
    |                  0 0 1 0 0|     |      0    |     |M| 12
    |                      0 1 0|     |      0    |     |M| 13
    |                      0 0 1|     |      0    |     |x| 14
    -----------------------------     -------------
    */

    /*
     *
     * Row 10
     *
     */

    pivot = sc_to_sc_matrix[39];

    // sc-row-10 = sc-row-10 - sc-row-12 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[39] = 0;
#endif

    sc_g_matrix[9] -= sc_g_matrix[11] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   x             x        |     |           |     |x|  1
    |  1 x   x                  |     |           |     |x|  2
    |0 0 1   x         x        |     |           |     |x|  3
    |      1 x   x              |     |           |     |x|  4
    |  0 0 0 1   x     f        |     |           |     |x|  5
    |          1 x   x          |     |           |     |x|  6
    |      0 0 0 1   x f        |     |           |     |x|  7
    |              1 x   x      | ... |           | ... |x|  8 sc
    |          0 0 0 1 f x      |     |           |     |x|  9
    |0   0   0   0   0 1 x 0    |     |           |     |M| 10
    |              0 0 0 1 0    |     |           |     |M| 11
    |                  0 0 1 0 0|     |      0    |     |M| 12
    |                      0 1 0|     |      0    |     |M| 13
    |                      0 0 1|     |      0    |     |x| 14
    -----------------------------     -------------
    */

    pivot = sc_to_sc_matrix[38];

    // sc-row-10 = sc-row-10 - sc-row-11 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[38] = 0;
#endif

    sc_g_matrix[9] -= sc_g_matrix[10] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   x             x        |     |           |     |x|  1
    |  1 x   x                  |     |           |     |x|  2
    |0 0 1   x         x        |     |           |     |x|  3
    |      1 x   x              |     |           |     |x|  4
    |  0 0 0 1   x     f        |     |           |     |x|  5
    |          1 x   x          |     |           |     |x|  6
    |      0 0 0 1   x f        |     |           |     |x|  7
    |              1 x   x      | ... |           | ... |x|  8 sc
    |          0 0 0 1 f x      |     |           |     |x|  9
    |0   0   0   0   0 1 0 0    |     |           |     |M| 10
    |              0 0 0 1 0    |     |           |     |M| 11
    |                  0 0 1 0 0|     |      0    |     |M| 12
    |                      0 1 0|     |      0    |     |M| 13
    |                      0 0 1|     |      0    |     |x| 14
    -----------------------------     -------------
    */

    /*
     *
     * Row 9
     *
     */

    pivot = sc_to_sc_matrix[34];

    // sc-row-9 = sc-row-9 - sc-row-11 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[34] = 0;
#endif

    sc_g_matrix[8] -= sc_g_matrix[10] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   x             x        |     |           |     |x|  1
    |  1 x   x                  |     |           |     |x|  2
    |0 0 1   x         x        |     |           |     |x|  3
    |      1 x   x              |     |           |     |x|  4
    |  0 0 0 1   x     f        |     |           |     |x|  5
    |          1 x   x          |     |           |     |x|  6
    |      0 0 0 1   x f        |     |           |     |x|  7
    |              1 x   x      | ... |           | ... |x|  8 sc
    |          0 0 0 1 f 0      |     |           |     |M|  9
    |0   0   0   0   0 1 0 0    |     |           |     |M| 10
    |              0 0 0 1 0    |     |           |     |M| 11
    |                  0 0 1 0 0|     |      0    |     |M| 12
    |                      0 1 0|     |      0    |     |M| 13
    |                      0 0 1|     |      0    |     |x| 14
    -----------------------------     -------------
    */

    pivot = sc_to_sc_fillins[2];

    // sc-row-9 = sc-row-9 - sc-row-10 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_fillins[2] = 0;
#endif

    sc_g_matrix[8] -= sc_g_matrix[9] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   x             x        |     |           |     |x|  1
    |  1 x   x                  |     |           |     |x|  2
    |0 0 1   x         x        |     |           |     |x|  3
    |      1 x   x              |     |           |     |x|  4
    |  0 0 0 1   x     f        |     |           |     |x|  5
    |          1 x   x          |     |           |     |x|  6
    |      0 0 0 1   x f        |     |           |     |x|  7
    |              1 x   x      | ... |           | ... |x|  8 sc
    |          0 0 0 1 0 0      |     |           |     |M|  9
    |0   0   0   0   0 1 0 0    |     |           |     |M| 10
    |              0 0 0 1 0    |     |           |     |M| 11
    |                  0 0 1 0 0|     |      0    |     |M| 12
    |                      0 1 0|     |      0    |     |M| 13
    |                      0 0 1|     |      0    |     |x| 14
    -----------------------------     -------------
    */

    /*
     *
     * Row 8
     *
     */

    pivot = sc_to_sc_matrix[29];

    // sc-row-8 = sc-row-8 - sc-row-11 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[29] = 0;
#endif

    sc_g_matrix[7] -= sc_g_matrix[10] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   x             x        |     |           |     |x|  1
    |  1 x   x                  |     |           |     |x|  2
    |0 0 1   x         x        |     |           |     |x|  3
    |      1 x   x              |     |           |     |x|  4
    |  0 0 0 1   x     f        |     |           |     |x|  5
    |          1 x   x          |     |           |     |x|  6
    |      0 0 0 1   x f        |     |           |     |x|  7
    |              1 x   0      | ... |           | ... |M|  8 sc
    |          0 0 0 1 0 0      |     |           |     |M|  9
    |0   0   0   0   0 1 0 0    |     |           |     |M| 10
    |              0 0 0 1 0    |     |           |     |M| 11
    |                  0 0 1 0 0|     |      0    |     |M| 12
    |                      0 1 0|     |      0    |     |M| 13
    |                      0 0 1|     |      0    |     |x| 14
    -----------------------------     -------------
    */

    pivot = sc_to_sc_matrix[28];

    // sc-row-8 = sc-row-8 - sc-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[28] = 0;
#endif

    sc_g_matrix[7] -= sc_g_matrix[8] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   x             x        |     |           |     |x|  1
    |  1 x   x                  |     |           |     |x|  2
    |0 0 1   x         x        |     |           |     |x|  3
    |      1 x   x              |     |           |     |x|  4
    |  0 0 0 1   x     f        |     |           |     |x|  5
    |          1 x   x          |     |           |     |x|  6
    |      0 0 0 1   x f        |     |           |     |x|  7
    |              1 0   0      | ... |           | ... |M|  8 sc
    |          0 0 0 1 0 0      |     |           |     |M|  9
    |0   0   0   0   0 1 0 0    |     |           |     |M| 10
    |              0 0 0 1 0    |     |           |     |M| 11
    |                  0 0 1 0 0|     |      0    |     |M| 12
    |                      0 1 0|     |      0    |     |M| 13
    |                      0 0 1|     |      0    |     |x| 14
    -----------------------------     -------------
    */

    /*
     *
     * Row 7
     *
     */

    pivot = sc_to_sc_fillins[1];

    // sc-row-7 = sc-row-7 - sc-row-10 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_fillins[1] = 0;
#endif

    sc_g_matrix[6] -= sc_g_matrix[9] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   x             x        |     |           |     |x|  1
    |  1 x   x                  |     |           |     |x|  2
    |0 0 1   x         x        |     |           |     |x|  3
    |      1 x   x              |     |           |     |x|  4
    |  0 0 0 1   x     f        |     |           |     |x|  5
    |          1 x   x          |     |           |     |x|  6
    |      0 0 0 1   x 0        |     |           |     |M|  7
    |              1 0   0      | ... |           | ... |M|  8 sc
    |          0 0 0 1 0 0      |     |           |     |M|  9
    |0   0   0   0   0 1 0 0    |     |           |     |M| 10
    |              0 0 0 1 0    |     |           |     |M| 11
    |                  0 0 1 0 0|     |      0    |     |M| 12
    |                      0 1 0|     |      0    |     |M| 13
    |                      0 0 1|     |      0    |     |x| 14
    -----------------------------     -------------
    */

    pivot = sc_to_sc_matrix[26];

    // sc-row-7 = sc-row-7 - sc-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[26] = 0;
#endif

    sc_g_matrix[6] -= sc_g_matrix[8] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   x             x        |     |           |     |x|  1
    |  1 x   x                  |     |           |     |x|  2
    |0 0 1   x         x        |     |           |     |x|  3
    |      1 x   x              |     |           |     |x|  4
    |  0 0 0 1   x     f        |     |           |     |x|  5
    |          1 x   x          |     |           |     |x|  6
    |      0 0 0 1   0 0        |     |           |     |M|  7
    |              1 0   0      | ... |           | ... |M|  8 sc
    |          0 0 0 1 0 0      |     |           |     |M|  9
    |0   0   0   0   0 1 0 0    |     |           |     |M| 10
    |              0 0 0 1 0    |     |           |     |M| 11
    |                  0 0 1 0 0|     |      0    |     |M| 12
    |                      0 1 0|     |      0    |     |M| 13
    |                      0 0 1|     |      0    |     |x| 14
    -----------------------------     -------------
    */

    /*
     *
     * Row 6
     *
     */

    pivot = sc_to_sc_matrix[21];

    // sc-row-6 = sc-row-6 - sc-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[21] = 0;
#endif

    sc_g_matrix[5] -= sc_g_matrix[8] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   x             x        |     |           |     |x|  1
    |  1 x   x                  |     |           |     |x|  2
    |0 0 1   x         x        |     |           |     |x|  3
    |      1 x   x              |     |           |     |x|  4
    |  0 0 0 1   x     f        |     |           |     |x|  5
    |          1 x   0          |     |           |     |M|  6
    |      0 0 0 1   0 0        |     |           |     |M|  7
    |              1 0   0      | ... |           | ... |M|  8 sc
    |          0 0 0 1 0 0      |     |           |     |M|  9
    |0   0   0   0   0 1 0 0    |     |           |     |M| 10
    |              0 0 0 1 0    |     |           |     |M| 11
    |                  0 0 1 0 0|     |      0    |     |M| 12
    |                      0 1 0|     |      0    |     |M| 13
    |                      0 0 1|     |      0    |     |x| 14
    -----------------------------     -------------
    */

    pivot = sc_to_sc_matrix[20];

    // sc-row-6 = sc-row-6 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[20] = 0;
#endif

    sc_g_matrix[5] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   x             x        |     |           |     |x|  1
    |  1 x   x                  |     |           |     |x|  2
    |0 0 1   x         x        |     |           |     |x|  3
    |      1 x   x              |     |           |     |x|  4
    |  0 0 0 1   x     f        |     |           |     |x|  5
    |          1 0   0          |     |           |     |M|  6
    |      0 0 0 1   0 0        |     |           |     |M|  7
    |              1 0   0      | ... |           | ... |M|  8 sc
    |          0 0 0 1 0 0      |     |           |     |M|  9
    |0   0   0   0   0 1 0 0    |     |           |     |M| 10
    |              0 0 0 1 0    |     |           |     |M| 11
    |                  0 0 1 0 0|     |      0    |     |M| 12
    |                      0 1 0|     |      0    |     |M| 13
    |                      0 0 1|     |      0    |     |x| 14
    -----------------------------     -------------
    */

    /*
     *
     * Row 5
     *
     */

    pivot = sc_to_sc_fillins[0];

    // sc-row-5 = sc-row-5 - sc-row-10 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_fillins[0] = 0;
#endif

    sc_g_matrix[4] -= sc_g_matrix[9] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   x             x        |     |           |     |x|  1
    |  1 x   x                  |     |           |     |x|  2
    |0 0 1   x         x        |     |           |     |x|  3
    |      1 x   x              |     |           |     |x|  4
    |  0 0 0 1   x     0        |     |           |     |M|  5
    |          1 0   0          |     |           |     |M|  6
    |      0 0 0 1   0 0        |     |           |     |M|  7
    |              1 0   0      | ... |           | ... |M|  8 sc
    |          0 0 0 1 0 0      |     |           |     |M|  9
    |0   0   0   0   0 1 0 0    |     |           |     |M| 10
    |              0 0 0 1 0    |     |           |     |M| 11
    |                  0 0 1 0 0|     |      0    |     |M| 12
    |                      0 1 0|     |      0    |     |M| 13
    |                      0 0 1|     |      0    |     |x| 14
    -----------------------------     -------------
    */

    pivot = sc_to_sc_matrix[18];

    // sc-row-5 = sc-row-5 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[18] = 0;
#endif

    sc_g_matrix[4] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   x             x        |     |           |     |x|  1
    |  1 x   x                  |     |           |     |x|  2
    |0 0 1   x         x        |     |           |     |x|  3
    |      1 x   x              |     |           |     |x|  4
    |  0 0 0 1   0     0        |     |           |     |M|  5
    |          1 0   0          |     |           |     |M|  6
    |      0 0 0 1   0 0        |     |           |     |M|  7
    |              1 0   0      | ... |           | ... |M|  8 sc
    |          0 0 0 1 0 0      |     |           |     |M|  9
    |0   0   0   0   0 1 0 0    |     |           |     |M| 10
    |              0 0 0 1 0    |     |           |     |M| 11
    |                  0 0 1 0 0|     |      0    |     |M| 12
    |                      0 1 0|     |      0    |     |M| 13
    |                      0 0 1|     |      0    |     |x| 14
    -----------------------------     -------------
    */

    /*
     *
     * Row 4
     *
     */

    pivot = sc_to_sc_matrix[13];

    // sc-row-4 = sc-row-4 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[13] = 0;
#endif

    sc_g_matrix[3] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   x             x        |     |           |     |x|  1
    |  1 x   x                  |     |           |     |x|  2
    |0 0 1   x         x        |     |           |     |x|  3
    |      1 x   0              |     |           |     |M|  4
    |  0 0 0 1   0     0        |     |           |     |M|  5
    |          1 0   0          |     |           |     |M|  6
    |      0 0 0 1   0 0        |     |           |     |M|  7
    |              1 0   0      | ... |           | ... |M|  8 sc
    |          0 0 0 1 0 0      |     |           |     |M|  9
    |0   0   0   0   0 1 0 0    |     |           |     |M| 10
    |              0 0 0 1 0    |     |           |     |M| 11
    |                  0 0 1 0 0|     |      0    |     |M| 12
    |                      0 1 0|     |      0    |     |M| 13
    |                      0 0 1|     |      0    |     |x| 14
    -----------------------------     -------------
    */

    pivot = sc_to_sc_matrix[12];

    // sc-row-4 = sc-row-4 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[12] = 0;
#endif

    sc_g_matrix[3] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   x             x        |     |           |     |x|  1
    |  1 x   x                  |     |           |     |x|  2
    |0 0 1   x         x        |     |           |     |x|  3
    |      1 0   0              |     |           |     |M|  4
    |  0 0 0 1   0     0        |     |           |     |M|  5
    |          1 0   0          |     |           |     |M|  6
    |      0 0 0 1   0 0        |     |           |     |M|  7
    |              1 0   0      | ... |           | ... |M|  8 sc
    |          0 0 0 1 0 0      |     |           |     |M|  9
    |0   0   0   0   0 1 0 0    |     |           |     |M| 10
    |              0 0 0 1 0    |     |           |     |M| 11
    |                  0 0 1 0 0|     |      0    |     |M| 12
    |                      0 1 0|     |      0    |     |M| 13
    |                      0 0 1|     |      0    |     |x| 14
    -----------------------------     -------------
    */

    /*
     *
     * Row 3
     *
     */

    pivot = sc_to_sc_matrix[10];

    // sc-row-3 = sc-row-3 - sc-row-10 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[10] = 0;
#endif

    sc_g_matrix[2] -= sc_g_matrix[9] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   x             x        |     |           |     |x|  1
    |  1 x   x                  |     |           |     |x|  2
    |0 0 1   x         0        |     |           |     |M|  3
    |      1 0   0              |     |           |     |M|  4
    |  0 0 0 1   0     0        |     |           |     |M|  5
    |          1 0   0          |     |           |     |M|  6
    |      0 0 0 1   0 0        |     |           |     |M|  7
    |              1 0   0      | ... |           | ... |M|  8 sc
    |          0 0 0 1 0 0      |     |           |     |M|  9
    |0   0   0   0   0 1 0 0    |     |           |     |M| 10
    |              0 0 0 1 0    |     |           |     |M| 11
    |                  0 0 1 0 0|     |      0    |     |M| 12
    |                      0 1 0|     |      0    |     |M| 13
    |                      0 0 1|     |      0    |     |x| 14
    -----------------------------     -------------
    */

    pivot = sc_to_sc_matrix[9];

    // sc-row-3 = sc-row-3 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[9] = 0;
#endif

    sc_g_matrix[2] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   x             x        |     |           |     |x|  1
    |  1 x   x                  |     |           |     |x|  2
    |0 0 1   0         0        |     |           |     |M|  3
    |      1 0   0              |     |           |     |M|  4
    |  0 0 0 1   0     0        |     |           |     |M|  5
    |          1 0   0          |     |           |     |M|  6
    |      0 0 0 1   0 0        |     |           |     |M|  7
    |              1 0   0      | ... |           | ... |M|  8 sc
    |          0 0 0 1 0 0      |     |           |     |M|  9
    |0   0   0   0   0 1 0 0    |     |           |     |M| 10
    |              0 0 0 1 0    |     |           |     |M| 11
    |                  0 0 1 0 0|     |      0    |     |M| 12
    |                      0 1 0|     |      0    |     |M| 13
    |                      0 0 1|     |      0    |     |x| 14
    -----------------------------     -------------
    */

    /*
     *
     * Row 2
     *
     */

    pivot = sc_to_sc_matrix[5];

    // sc-row-2 = sc-row-2 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[5] = 0;
#endif

    sc_g_matrix[1] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   x             x        |     |           |     |x|  1
    |  1 x   0                  |     |           |     |M|  2
    |0 0 1   0         0        |     |           |     |M|  3
    |      1 0   0              |     |           |     |M|  4
    |  0 0 0 1   0     0        |     |           |     |M|  5
    |          1 0   0          |     |           |     |M|  6
    |      0 0 0 1   0 0        |     |           |     |M|  7
    |              1 0   0      | ... |           | ... |M|  8 sc
    |          0 0 0 1 0 0      |     |           |     |M|  9
    |0   0   0   0   0 1 0 0    |     |           |     |M| 10
    |              0 0 0 1 0    |     |           |     |M| 11
    |                  0 0 1 0 0|     |      0    |     |M| 12
    |                      0 1 0|     |      0    |     |M| 13
    |                      0 0 1|     |      0    |     |x| 14
    -----------------------------     -------------
    */

    pivot = sc_to_sc_matrix[4];

    // sc-row-2 = sc-row-2 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[4] = 0;
#endif

    sc_g_matrix[1] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   x             x        |     |           |     |x|  1
    |  1 0   0                  |     |           |     |M|  2
    |0 0 1   0         0        |     |           |     |M|  3
    |      1 0   0              |     |           |     |M|  4
    |  0 0 0 1   0     0        |     |           |     |M|  5
    |          1 0   0          |     |           |     |M|  6
    |      0 0 0 1   0 0        |     |           |     |M|  7
    |              1 0   0      | ... |           | ... |M|  8 sc
    |          0 0 0 1 0 0      |     |           |     |M|  9
    |0   0   0   0   0 1 0 0    |     |           |     |M| 10
    |              0 0 0 1 0    |     |           |     |M| 11
    |                  0 0 1 0 0|     |      0    |     |M| 12
    |                      0 1 0|     |      0    |     |M| 13
    |                      0 0 1|     |      0    |     |x| 14
    -----------------------------     -------------
    */

    /*
     *
     * Row 1
     *
     */

    pivot = sc_to_sc_matrix[2];

    // sc-row-1 = sc-row-1 - sc-row-10 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[2] = 0;
#endif

    sc_g_matrix[0] -= sc_g_matrix[9] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   x             0        |     |           |     |M|  1
    |  1 0   0                  |     |           |     |M|  2
    |0 0 1   0         0        |     |           |     |M|  3
    |      1 0   0              |     |           |     |M|  4
    |  0 0 0 1   0     0        |     |           |     |M|  5
    |          1 0   0          |     |           |     |M|  6
    |      0 0 0 1   0 0        |     |           |     |M|  7
    |              1 0   0      | ... |           | ... |M|  8 sc
    |          0 0 0 1 0 0      |     |           |     |M|  9
    |0   0   0   0   0 1 0 0    |     |           |     |M| 10
    |              0 0 0 1 0    |     |           |     |M| 11
    |                  0 0 1 0 0|     |      0    |     |M| 12
    |                      0 1 0|     |      0    |     |M| 13
    |                      0 0 1|     |      0    |     |x| 14
    -----------------------------     -------------
    */

    pivot = sc_to_sc_matrix[1];

    // sc-row-1 = sc-row-1 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[1] = 0;
#endif

    sc_g_matrix[0] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

                 sc                        bb            g
     1 2 3 4 5 6 7 8 91011121314       1 2 3 4 5 6
    -----------------------------     -------------
    |1   0             0        |     |           |     |M|  1
    |  1 0   0                  |     |           |     |M|  2
    |0 0 1   0         0        |     |           |     |M|  3
    |      1 0   0              |     |           |     |M|  4
    |  0 0 0 1   0     0        |     |           |     |M|  5
    |          1 0   0          |     |           |     |M|  6
    |      0 0 0 1   0 0        |     |           |     |M|  7
    |              1 0   0      | ... |           | ... |M|  8 sc
    |          0 0 0 1 0 0      |     |           |     |M|  9
    |0   0   0   0   0 1 0 0    |     |           |     |M| 10
    |              0 0 0 1 0    |     |           |     |M| 11
    |                  0 0 1 0 0|     |      0    |     |M| 12
    |                      0 1 0|     |      0    |     |M| 13
    |                      0 0 1|     |      0    |     |x| 14
    -----------------------------     -------------
    */
}

void gmx::IlvesPC::solve_17_tyrosine(real *const sc_to_sc_matrix,
                                     real *const sc_g_matrix,
                                     real *const sc_to_sc_fillins) {
    /*
     *
     * Row 14
     *
     */

    real pivot = sc_to_sc_matrix[55];

    // sc-row-14 = sc-row-14 - sc-row-15 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[55] = 0;
#endif

    sc_g_matrix[13] -= sc_g_matrix[14] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       x                    |     |           |     |x|  1
    |  1   x             x        |     |           |     |x|  2
    |    1 x   x                  |     |           |     |x|  3
    |  0 0 1   x         x        |     |           |     |x|  4
    |0       1 x   x              |     |           |     |x|  5
    |    0 0 0 1   x     f        |     |           |     |x|  6
    |            1 x   x          |     |           |     |x|  7
    |        0 0 0 1   x f        | ... |           | ... |x|  8 sc
    |                1 x   x      |     |           |     |x|  9
    |            0 0 0 1 f x      |     |           |     |x| 10
    |  0   0   0   0   0 1 x x    |     |           |     |x| 11
    |                0 0 0 1 x    |     |           |     |x| 12
    |                    0 0 1 x x|     |      0    |     |x| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 13
     *
     */

    pivot = sc_to_sc_matrix[52];

    // sc-row-13 = sc-row-13 - sc-row-15 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[52] = 0;
#endif

    sc_g_matrix[12] -= sc_g_matrix[14] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       x                    |     |           |     |x|  1
    |  1   x             x        |     |           |     |x|  2
    |    1 x   x                  |     |           |     |x|  3
    |  0 0 1   x         x        |     |           |     |x|  4
    |0       1 x   x              |     |           |     |x|  5
    |    0 0 0 1   x     f        |     |           |     |x|  6
    |            1 x   x          |     |           |     |x|  7
    |        0 0 0 1   x f        | ... |           | ... |x|  8 sc
    |                1 x   x      |     |           |     |x|  9
    |            0 0 0 1 f x      |     |           |     |x| 10
    |  0   0   0   0   0 1 x x    |     |           |     |x| 11
    |                0 0 0 1 x    |     |           |     |x| 12
    |                    0 0 1 x 0|     |      0    |     |M| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[51];

    // sc-row-13 = sc-row-13 - sc-row-14 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[51] = 0;
#endif

    sc_g_matrix[12] -= sc_g_matrix[13] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       x                    |     |           |     |x|  1
    |  1   x             x        |     |           |     |x|  2
    |    1 x   x                  |     |           |     |x|  3
    |  0 0 1   x         x        |     |           |     |x|  4
    |0       1 x   x              |     |           |     |x|  5
    |    0 0 0 1   x     f        |     |           |     |x|  6
    |            1 x   x          |     |           |     |x|  7
    |        0 0 0 1   x f        | ... |           | ... |x|  8 sc
    |                1 x   x      |     |           |     |x|  9
    |            0 0 0 1 f x      |     |           |     |x| 10
    |  0   0   0   0   0 1 x x    |     |           |     |x| 11
    |                0 0 0 1 x    |     |           |     |x| 12
    |                    0 0 1 0 0|     |      0    |     |M| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 12
     *
     */

    pivot = sc_to_sc_matrix[47];

    // sc-row-12 = sc-row-12 - sc-row-13 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[47] = 0;
#endif

    sc_g_matrix[11] -= sc_g_matrix[12] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       x                    |     |           |     |x|  1
    |  1   x             x        |     |           |     |x|  2
    |    1 x   x                  |     |           |     |x|  3
    |  0 0 1   x         x        |     |           |     |x|  4
    |0       1 x   x              |     |           |     |x|  5
    |    0 0 0 1   x     f        |     |           |     |x|  6
    |            1 x   x          |     |           |     |x|  7
    |        0 0 0 1   x f        | ... |           | ... |x|  8 sc
    |                1 x   x      |     |           |     |x|  9
    |            0 0 0 1 f x      |     |           |     |x| 10
    |  0   0   0   0   0 1 x x    |     |           |     |x| 11
    |                0 0 0 1 0    |     |           |     |M| 12
    |                    0 0 1 0 0|     |      0    |     |M| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 11
     *
     */

    pivot = sc_to_sc_matrix[42];

    // sc-row-11 = sc-row-11 - sc-row-13 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[42] = 0;
#endif

    sc_g_matrix[10] -= sc_g_matrix[12] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       x                    |     |           |     |x|  1
    |  1   x             x        |     |           |     |x|  2
    |    1 x   x                  |     |           |     |x|  3
    |  0 0 1   x         x        |     |           |     |x|  4
    |0       1 x   x              |     |           |     |x|  5
    |    0 0 0 1   x     f        |     |           |     |x|  6
    |            1 x   x          |     |           |     |x|  7
    |        0 0 0 1   x f        | ... |           | ... |x|  8 sc
    |                1 x   x      |     |           |     |x|  9
    |            0 0 0 1 f x      |     |           |     |x| 10
    |  0   0   0   0   0 1 x 0    |     |           |     |M| 11
    |                0 0 0 1 0    |     |           |     |M| 12
    |                    0 0 1 0 0|     |      0    |     |M| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[41];

    // sc-row-11 = sc-row-11 - sc-row-12 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[41] = 0;
#endif

    sc_g_matrix[10] -= sc_g_matrix[11] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       x                    |     |           |     |x|  1
    |  1   x             x        |     |           |     |x|  2
    |    1 x   x                  |     |           |     |x|  3
    |  0 0 1   x         x        |     |           |     |x|  4
    |0       1 x   x              |     |           |     |x|  5
    |    0 0 0 1   x     f        |     |           |     |x|  6
    |            1 x   x          |     |           |     |x|  7
    |        0 0 0 1   x f        | ... |           | ... |x|  8 sc
    |                1 x   x      |     |           |     |x|  9
    |            0 0 0 1 f x      |     |           |     |x| 10
    |  0   0   0   0   0 1 0 0    |     |           |     |M| 11
    |                0 0 0 1 0    |     |           |     |M| 12
    |                    0 0 1 0 0|     |      0    |     |M| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 10
     *
     */

    pivot = sc_to_sc_matrix[37];

    // sc-row-10 = sc-row-10 - sc-row-12 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[37] = 0;
#endif

    sc_g_matrix[9] -= sc_g_matrix[11] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       x                    |     |           |     |x|  1
    |  1   x             x        |     |           |     |x|  2
    |    1 x   x                  |     |           |     |x|  3
    |  0 0 1   x         x        |     |           |     |x|  4
    |0       1 x   x              |     |           |     |x|  5
    |    0 0 0 1   x     f        |     |           |     |x|  6
    |            1 x   x          |     |           |     |x|  7
    |        0 0 0 1   x f        | ... |           | ... |x|  8 sc
    |                1 x   x      |     |           |     |x|  9
    |            0 0 0 1 f 0      |     |           |     |M| 10
    |  0   0   0   0   0 1 0 0    |     |           |     |M| 11
    |                0 0 0 1 0    |     |           |     |M| 12
    |                    0 0 1 0 0|     |      0    |     |M| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_fillins[2];

    // sc-row-10 = sc-row-10 - sc-row-11 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_fillins[2] = 0;
#endif

    sc_g_matrix[9] -= sc_g_matrix[10] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       x                    |     |           |     |x|  1
    |  1   x             x        |     |           |     |x|  2
    |    1 x   x                  |     |           |     |x|  3
    |  0 0 1   x         x        |     |           |     |x|  4
    |0       1 x   x              |     |           |     |x|  5
    |    0 0 0 1   x     f        |     |           |     |x|  6
    |            1 x   x          |     |           |     |x|  7
    |        0 0 0 1   x f        | ... |           | ... |x|  8 sc
    |                1 x   x      |     |           |     |x|  9
    |            0 0 0 1 0 0      |     |           |     |M| 10
    |  0   0   0   0   0 1 0 0    |     |           |     |M| 11
    |                0 0 0 1 0    |     |           |     |M| 12
    |                    0 0 1 0 0|     |      0    |     |M| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 9
     *
     */

    pivot = sc_to_sc_matrix[32];

    // sc-row-9 = sc-row-9 - sc-row-12 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[32] = 0;
#endif

    sc_g_matrix[8] -= sc_g_matrix[11] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       x                    |     |           |     |x|  1
    |  1   x             x        |     |           |     |x|  2
    |    1 x   x                  |     |           |     |x|  3
    |  0 0 1   x         x        |     |           |     |x|  4
    |0       1 x   x              |     |           |     |x|  5
    |    0 0 0 1   x     f        |     |           |     |x|  6
    |            1 x   x          |     |           |     |x|  7
    |        0 0 0 1   x f        | ... |           | ... |x|  8 sc
    |                1 x   0      |     |           |     |M|  9
    |            0 0 0 1 0 0      |     |           |     |M| 10
    |  0   0   0   0   0 1 0 0    |     |           |     |M| 11
    |                0 0 0 1 0    |     |           |     |M| 12
    |                    0 0 1 0 0|     |      0    |     |M| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[31];

    // sc-row-9 = sc-row-9 - sc-row-10 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[31] = 0;
#endif

    sc_g_matrix[8] -= sc_g_matrix[9] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       x                    |     |           |     |x|  1
    |  1   x             x        |     |           |     |x|  2
    |    1 x   x                  |     |           |     |x|  3
    |  0 0 1   x         x        |     |           |     |x|  4
    |0       1 x   x              |     |           |     |x|  5
    |    0 0 0 1   x     f        |     |           |     |x|  6
    |            1 x   x          |     |           |     |x|  7
    |        0 0 0 1   x f        | ... |           | ... |x|  8 sc
    |                1 0   0      |     |           |     |M|  9
    |            0 0 0 1 0 0      |     |           |     |M| 10
    |  0   0   0   0   0 1 0 0    |     |           |     |M| 11
    |                0 0 0 1 0    |     |           |     |M| 12
    |                    0 0 1 0 0|     |      0    |     |M| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 8
     *
     */

    pivot = sc_to_sc_fillins[1];

    // sc-row-8 = sc-row-8 - sc-row-11 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_fillins[1] = 0;
#endif

    sc_g_matrix[7] -= sc_g_matrix[10] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       x                    |     |           |     |x|  1
    |  1   x             x        |     |           |     |x|  2
    |    1 x   x                  |     |           |     |x|  3
    |  0 0 1   x         x        |     |           |     |x|  4
    |0       1 x   x              |     |           |     |x|  5
    |    0 0 0 1   x     f        |     |           |     |x|  6
    |            1 x   x          |     |           |     |x|  7
    |        0 0 0 1   x 0        | ... |           | ... |M|  8 sc
    |                1 0   0      |     |           |     |M|  9
    |            0 0 0 1 0 0      |     |           |     |M| 10
    |  0   0   0   0   0 1 0 0    |     |           |     |M| 11
    |                0 0 0 1 0    |     |           |     |M| 12
    |                    0 0 1 0 0|     |      0    |     |M| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[29];

    // sc-row-8 = sc-row-8 - sc-row-10 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[29] = 0;
#endif

    sc_g_matrix[7] -= sc_g_matrix[9] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       x                    |     |           |     |x|  1
    |  1   x             x        |     |           |     |x|  2
    |    1 x   x                  |     |           |     |x|  3
    |  0 0 1   x         x        |     |           |     |x|  4
    |0       1 x   x              |     |           |     |x|  5
    |    0 0 0 1   x     f        |     |           |     |x|  6
    |            1 x   x          |     |           |     |x|  7
    |        0 0 0 1   0 0        | ... |           | ... |M|  8 sc
    |                1 0   0      |     |           |     |M|  9
    |            0 0 0 1 0 0      |     |           |     |M| 10
    |  0   0   0   0   0 1 0 0    |     |           |     |M| 11
    |                0 0 0 1 0    |     |           |     |M| 12
    |                    0 0 1 0 0|     |      0    |     |M| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 7
     *
     */

    pivot = sc_to_sc_matrix[24];

    // sc-row-7 = sc-row-7 - sc-row-10 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[24] = 0;
#endif

    sc_g_matrix[6] -= sc_g_matrix[9] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       x                    |     |           |     |x|  1
    |  1   x             x        |     |           |     |x|  2
    |    1 x   x                  |     |           |     |x|  3
    |  0 0 1   x         x        |     |           |     |x|  4
    |0       1 x   x              |     |           |     |x|  5
    |    0 0 0 1   x     f        |     |           |     |x|  6
    |            1 x   0          |     |           |     |M|  7
    |        0 0 0 1   0 0        | ... |           | ... |M|  8 sc
    |                1 0   0      |     |           |     |M|  9
    |            0 0 0 1 0 0      |     |           |     |M| 10
    |  0   0   0   0   0 1 0 0    |     |           |     |M| 11
    |                0 0 0 1 0    |     |           |     |M| 12
    |                    0 0 1 0 0|     |      0    |     |M| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[23];

    // sc-row-7 = sc-row-7 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[23] = 0;
#endif

    sc_g_matrix[6] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       x                    |     |           |     |x|  1
    |  1   x             x        |     |           |     |x|  2
    |    1 x   x                  |     |           |     |x|  3
    |  0 0 1   x         x        |     |           |     |x|  4
    |0       1 x   x              |     |           |     |x|  5
    |    0 0 0 1   x     f        |     |           |     |x|  6
    |            1 0   0          |     |           |     |M|  7
    |        0 0 0 1   0 0        | ... |           | ... |M|  8 sc
    |                1 0   0      |     |           |     |M|  9
    |            0 0 0 1 0 0      |     |           |     |M| 10
    |  0   0   0   0   0 1 0 0    |     |           |     |M| 11
    |                0 0 0 1 0    |     |           |     |M| 12
    |                    0 0 1 0 0|     |      0    |     |M| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 6
     *
     */

    pivot = sc_to_sc_fillins[0];

    // sc-row-6 = sc-row-6 - sc-row-11 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_fillins[0] = 0;
#endif

    sc_g_matrix[5] -= sc_g_matrix[10] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       x                    |     |           |     |x|  1
    |  1   x             x        |     |           |     |x|  2
    |    1 x   x                  |     |           |     |x|  3
    |  0 0 1   x         x        |     |           |     |x|  4
    |0       1 x   x              |     |           |     |x|  5
    |    0 0 0 1   x     0        |     |           |     |M|  6
    |            1 0   0          |     |           |     |M|  7
    |        0 0 0 1   0 0        | ... |           | ... |M|  8 sc
    |                1 0   0      |     |           |     |M|  9
    |            0 0 0 1 0 0      |     |           |     |M| 10
    |  0   0   0   0   0 1 0 0    |     |           |     |M| 11
    |                0 0 0 1 0    |     |           |     |M| 12
    |                    0 0 1 0 0|     |      0    |     |M| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[21];

    // sc-row-6 = sc-row-6 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[21] = 0;
#endif

    sc_g_matrix[5] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       x                    |     |           |     |x|  1
    |  1   x             x        |     |           |     |x|  2
    |    1 x   x                  |     |           |     |x|  3
    |  0 0 1   x         x        |     |           |     |x|  4
    |0       1 x   x              |     |           |     |x|  5
    |    0 0 0 1   0     0        |     |           |     |M|  6
    |            1 0   0          |     |           |     |M|  7
    |        0 0 0 1   0 0        | ... |           | ... |M|  8 sc
    |                1 0   0      |     |           |     |M|  9
    |            0 0 0 1 0 0      |     |           |     |M| 10
    |  0   0   0   0   0 1 0 0    |     |           |     |M| 11
    |                0 0 0 1 0    |     |           |     |M| 12
    |                    0 0 1 0 0|     |      0    |     |M| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 5
     *
     */

    pivot = sc_to_sc_matrix[16];

    // sc-row-5 = sc-row-5 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[16] = 0;
#endif

    sc_g_matrix[4] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       x                    |     |           |     |x|  1
    |  1   x             x        |     |           |     |x|  2
    |    1 x   x                  |     |           |     |x|  3
    |  0 0 1   x         x        |     |           |     |x|  4
    |0       1 x   0              |     |           |     |M|  5
    |    0 0 0 1   0     0        |     |           |     |M|  6
    |            1 0   0          |     |           |     |M|  7
    |        0 0 0 1   0 0        | ... |           | ... |M|  8 sc
    |                1 0   0      |     |           |     |M|  9
    |            0 0 0 1 0 0      |     |           |     |M| 10
    |  0   0   0   0   0 1 0 0    |     |           |     |M| 11
    |                0 0 0 1 0    |     |           |     |M| 12
    |                    0 0 1 0 0|     |      0    |     |M| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[15];

    // sc-row-5 = sc-row-5 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[15] = 0;
#endif

    sc_g_matrix[4] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       x                    |     |           |     |x|  1
    |  1   x             x        |     |           |     |x|  2
    |    1 x   x                  |     |           |     |x|  3
    |  0 0 1   x         x        |     |           |     |x|  4
    |0       1 0   0              |     |           |     |M|  5
    |    0 0 0 1   0     0        |     |           |     |M|  6
    |            1 0   0          |     |           |     |M|  7
    |        0 0 0 1   0 0        | ... |           | ... |M|  8 sc
    |                1 0   0      |     |           |     |M|  9
    |            0 0 0 1 0 0      |     |           |     |M| 10
    |  0   0   0   0   0 1 0 0    |     |           |     |M| 11
    |                0 0 0 1 0    |     |           |     |M| 12
    |                    0 0 1 0 0|     |      0    |     |M| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 4
     *
     */

    pivot = sc_to_sc_matrix[12];

    // sc-row-4 = sc-row-4 - sc-row-11 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[12] = 0;
#endif

    sc_g_matrix[3] -= sc_g_matrix[10] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       x                    |     |           |     |x|  1
    |  1   x             x        |     |           |     |x|  2
    |    1 x   x                  |     |           |     |x|  3
    |  0 0 1   x         0        |     |           |     |M|  4
    |0       1 0   0              |     |           |     |M|  5
    |    0 0 0 1   0     0        |     |           |     |M|  6
    |            1 0   0          |     |           |     |M|  7
    |        0 0 0 1   0 0        | ... |           | ... |M|  8 sc
    |                1 0   0      |     |           |     |M|  9
    |            0 0 0 1 0 0      |     |           |     |M| 10
    |  0   0   0   0   0 1 0 0    |     |           |     |M| 11
    |                0 0 0 1 0    |     |           |     |M| 12
    |                    0 0 1 0 0|     |      0    |     |M| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[11];

    // sc-row-4 = sc-row-4 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[11] = 0;
#endif

    sc_g_matrix[3] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       x                    |     |           |     |x|  1
    |  1   x             x        |     |           |     |x|  2
    |    1 x   x                  |     |           |     |x|  3
    |  0 0 1   0         0        |     |           |     |M|  4
    |0       1 0   0              |     |           |     |M|  5
    |    0 0 0 1   0     0        |     |           |     |M|  6
    |            1 0   0          |     |           |     |M|  7
    |        0 0 0 1   0 0        | ... |           | ... |M|  8 sc
    |                1 0   0      |     |           |     |M|  9
    |            0 0 0 1 0 0      |     |           |     |M| 10
    |  0   0   0   0   0 1 0 0    |     |           |     |M| 11
    |                0 0 0 1 0    |     |           |     |M| 12
    |                    0 0 1 0 0|     |      0    |     |M| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 3
     *
     */

    pivot = sc_to_sc_matrix[7];

    // sc-row-3 = sc-row-3 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[7] = 0;
#endif

    sc_g_matrix[2] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       x                    |     |           |     |x|  1
    |  1   x             x        |     |           |     |x|  2
    |    1 x   0                  |     |           |     |M|  3
    |  0 0 1   0         0        |     |           |     |M|  4
    |0       1 0   0              |     |           |     |M|  5
    |    0 0 0 1   0     0        |     |           |     |M|  6
    |            1 0   0          |     |           |     |M|  7
    |        0 0 0 1   0 0        | ... |           | ... |M|  8 sc
    |                1 0   0      |     |           |     |M|  9
    |            0 0 0 1 0 0      |     |           |     |M| 10
    |  0   0   0   0   0 1 0 0    |     |           |     |M| 11
    |                0 0 0 1 0    |     |           |     |M| 12
    |                    0 0 1 0 0|     |      0    |     |M| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[6];

    // sc-row-3 = sc-row-3 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[6] = 0;
#endif

    sc_g_matrix[2] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       x                    |     |           |     |x|  1
    |  1   x             x        |     |           |     |x|  2
    |    1 0   0                  |     |           |     |M|  3
    |  0 0 1   0         0        |     |           |     |M|  4
    |0       1 0   0              |     |           |     |M|  5
    |    0 0 0 1   0     0        |     |           |     |M|  6
    |            1 0   0          |     |           |     |M|  7
    |        0 0 0 1   0 0        | ... |           | ... |M|  8 sc
    |                1 0   0      |     |           |     |M|  9
    |            0 0 0 1 0 0      |     |           |     |M| 10
    |  0   0   0   0   0 1 0 0    |     |           |     |M| 11
    |                0 0 0 1 0    |     |           |     |M| 12
    |                    0 0 1 0 0|     |      0    |     |M| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 2
     *
     */

    pivot = sc_to_sc_matrix[4];

    // sc-row-2 = sc-row-2 - sc-row-11 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[4] = 0;
#endif

    sc_g_matrix[1] -= sc_g_matrix[10] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       x                    |     |           |     |x|  1
    |  1   x             0        |     |           |     |M|  2
    |    1 0   0                  |     |           |     |M|  3
    |  0 0 1   0         0        |     |           |     |M|  4
    |0       1 0   0              |     |           |     |M|  5
    |    0 0 0 1   0     0        |     |           |     |M|  6
    |            1 0   0          |     |           |     |M|  7
    |        0 0 0 1   0 0        | ... |           | ... |M|  8 sc
    |                1 0   0      |     |           |     |M|  9
    |            0 0 0 1 0 0      |     |           |     |M| 10
    |  0   0   0   0   0 1 0 0    |     |           |     |M| 11
    |                0 0 0 1 0    |     |           |     |M| 12
    |                    0 0 1 0 0|     |      0    |     |M| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[3];

    // sc-row-2 = sc-row-2 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[3] = 0;
#endif

    sc_g_matrix[1] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       x                    |     |           |     |x|  1
    |  1   0             0        |     |           |     |M|  2
    |    1 0   0                  |     |           |     |M|  3
    |  0 0 1   0         0        |     |           |     |M|  4
    |0       1 0   0              |     |           |     |M|  5
    |    0 0 0 1   0     0        |     |           |     |M|  6
    |            1 0   0          |     |           |     |M|  7
    |        0 0 0 1   0 0        | ... |           | ... |M|  8 sc
    |                1 0   0      |     |           |     |M|  9
    |            0 0 0 1 0 0      |     |           |     |M| 10
    |  0   0   0   0   0 1 0 0    |     |           |     |M| 11
    |                0 0 0 1 0    |     |           |     |M| 12
    |                    0 0 1 0 0|     |      0    |     |M| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */

    /*
     *
     * Row 1
     *
     */

    pivot = sc_to_sc_matrix[1];

    // sc-row-1 = sc-row-1 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[1] = 0;
#endif

    sc_g_matrix[0] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

                  sc                         bb            g
     1 2 3 4 5 6 7 8 9101112131415       1 2 3 4 5 6
    -------------------------------     -------------
    |1       0                    |     |           |     |M|  1
    |  1   0             0        |     |           |     |M|  2
    |    1 0   0                  |     |           |     |M|  3
    |  0 0 1   0         0        |     |           |     |M|  4
    |0       1 0   0              |     |           |     |M|  5
    |    0 0 0 1   0     0        |     |           |     |M|  6
    |            1 0   0          |     |           |     |M|  7
    |        0 0 0 1   0 0        | ... |           | ... |M|  8 sc
    |                1 0   0      |     |           |     |M|  9
    |            0 0 0 1 0 0      |     |           |     |M| 10
    |  0   0   0   0   0 1 0 0    |     |           |     |M| 11
    |                0 0 0 1 0    |     |           |     |M| 12
    |                    0 0 1 0 0|     |      0    |     |M| 13
    |                        0 1 0|     |      0    |     |M| 14
    |                        0 0 1|     |      0    |     |x| 15
    -------------------------------     -------------
    */
}

void gmx::IlvesPC::solve_17_tryptophan(real *const sc_to_sc_matrix,
                                       real *const sc_g_matrix,
                                       __attribute__((unused))
                                       real *const sc_to_sc_fillins) {
    /*
     *
     * Row 18
     *
     */

    real pivot = sc_to_sc_matrix[75];

    // sc-row-18 = sc-row-18 - sc-row-19 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[75] = 0;
#endif

    sc_g_matrix[17] -= sc_g_matrix[18] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   x           x                    |     |           |     |x|  1
    |  1 x   x                            |     |           |     |x|  2
    |0 0 1   x       x                    |     |           |     |x|  3
    |      1 x   x                        |     |           |     |x|  4
    |  0 0 0 1   x   f                    |     |           |     |x|  5
    |          1 x x                      |     |           |     |x|  6
    |      0 0 0 1 x f                    |     |           |     |x|  7
    |          0 0 1 f         x   x      |     |           |     |x|  8
    |0   0   0   0 0 1       x x   f      |     |           |     |x|  9
    |                  1   x x            | ... |           | ... |x| 10 sc
    |                    1 x     x        |     |           |     |x| 11
    |                  0 0 1 x   x        |     |           |     |x| 12
    |                0 0   0 1 x f f      |     |           |     |x| 13
    |              0 0       0 1 f x      |     |           |     |x| 14
    |                    0 0 0 0 1 x x    |     |           |     |x| 15
    |              0 0       0 0 0 1 x    |     |           |     |x| 16
    |                            0 0 1 x x|     |      0    |     |x| 17
    |                                0 1 0|     |      0    |     |M| 18
    |                                0 0 1|     |      0    |     |x| 19
    ---------------------------------------     -------------
    */

    /*
     *
     * Row 17
     *
     */

    pivot = sc_to_sc_matrix[72];

    // sc-row-17 = sc-row-17 - sc-row-19 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[72] = 0;
#endif

    sc_g_matrix[16] -= sc_g_matrix[18] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   x           x                    |     |           |     |x|  1
    |  1 x   x                            |     |           |     |x|  2
    |0 0 1   x       x                    |     |           |     |x|  3
    |      1 x   x                        |     |           |     |x|  4
    |  0 0 0 1   x   f                    |     |           |     |x|  5
    |          1 x x                      |     |           |     |x|  6
    |      0 0 0 1 x f                    |     |           |     |x|  7
    |          0 0 1 f         x   x      |     |           |     |x|  8
    |0   0   0   0 0 1       x x   f      |     |           |     |x|  9
    |                  1   x x            | ... |           | ... |x| 10 sc
    |                    1 x     x        |     |           |     |x| 11
    |                  0 0 1 x   x        |     |           |     |x| 12
    |                0 0   0 1 x f f      |     |           |     |x| 13
    |              0 0       0 1 f x      |     |           |     |x| 14
    |                    0 0 0 0 1 x x    |     |           |     |x| 15
    |              0 0       0 0 0 1 x    |     |           |     |x| 16
    |                            0 0 1 x 0|     |      0    |     |M| 17
    |                                0 1 0|     |      0    |     |M| 18
    |                                0 0 1|     |      0    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[71];

    // sc-row-17 = sc-row-17 - sc-row-18 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[71] = 0;
#endif

    sc_g_matrix[16] -= sc_g_matrix[17] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   x           x                    |     |           |     |x|  1
    |  1 x   x                            |     |           |     |x|  2
    |0 0 1   x       x                    |     |           |     |x|  3
    |      1 x   x                        |     |           |     |x|  4
    |  0 0 0 1   x   f                    |     |           |     |x|  5
    |          1 x x                      |     |           |     |x|  6
    |      0 0 0 1 x f                    |     |           |     |x|  7
    |          0 0 1 f         x   x      |     |           |     |x|  8
    |0   0   0   0 0 1       x x   f      |     |           |     |x|  9
    |                  1   x x            | ... |           | ... |x| 10 sc
    |                    1 x     x        |     |           |     |x| 11
    |                  0 0 1 x   x        |     |           |     |x| 12
    |                0 0   0 1 x f f      |     |           |     |x| 13
    |              0 0       0 1 f x      |     |           |     |x| 14
    |                    0 0 0 0 1 x x    |     |           |     |x| 15
    |              0 0       0 0 0 1 x    |     |           |     |x| 16
    |                            0 0 1 0 0|     |      0    |     |M| 17
    |                                0 1 0|     |      0    |     |M| 18
    |                                0 0 1|     |      0    |     |x| 19
    ---------------------------------------     -------------
    */

    /*
     *
     * Row 16
     *
     */

    pivot = sc_to_sc_matrix[67];

    // sc-row-16 = sc-row-16 - sc-row-17 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[67] = 0;
#endif

    sc_g_matrix[15] -= sc_g_matrix[16] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   x           x                    |     |           |     |x|  1
    |  1 x   x                            |     |           |     |x|  2
    |0 0 1   x       x                    |     |           |     |x|  3
    |      1 x   x                        |     |           |     |x|  4
    |  0 0 0 1   x   f                    |     |           |     |x|  5
    |          1 x x                      |     |           |     |x|  6
    |      0 0 0 1 x f                    |     |           |     |x|  7
    |          0 0 1 f         x   x      |     |           |     |x|  8
    |0   0   0   0 0 1       x x   f      |     |           |     |x|  9
    |                  1   x x            | ... |           | ... |x| 10 sc
    |                    1 x     x        |     |           |     |x| 11
    |                  0 0 1 x   x        |     |           |     |x| 12
    |                0 0   0 1 x f f      |     |           |     |x| 13
    |              0 0       0 1 f x      |     |           |     |x| 14
    |                    0 0 0 0 1 x x    |     |           |     |x| 15
    |              0 0       0 0 0 1 0    |     |           |     |M| 16
    |                            0 0 1 0 0|     |      0    |     |M| 17
    |                                0 1 0|     |      0    |     |M| 18
    |                                0 0 1|     |      0    |     |x| 19
    ---------------------------------------     -------------
    */

    /*
     *
     * Row 15
     *
     */

    pivot = sc_to_sc_matrix[62];

    // sc-row-15 = sc-row-15 - sc-row-17 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[62] = 0;
#endif

    sc_g_matrix[14] -= sc_g_matrix[16] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   x           x                    |     |           |     |x|  1
    |  1 x   x                            |     |           |     |x|  2
    |0 0 1   x       x                    |     |           |     |x|  3
    |      1 x   x                        |     |           |     |x|  4
    |  0 0 0 1   x   f                    |     |           |     |x|  5
    |          1 x x                      |     |           |     |x|  6
    |      0 0 0 1 x f                    |     |           |     |x|  7
    |          0 0 1 f         x   x      |     |           |     |x|  8
    |0   0   0   0 0 1       x x   f      |     |           |     |x|  9
    |                  1   x x            | ... |           | ... |x| 10 sc
    |                    1 x     x        |     |           |     |x| 11
    |                  0 0 1 x   x        |     |           |     |x| 12
    |                0 0   0 1 x f f      |     |           |     |x| 13
    |              0 0       0 1 f x      |     |           |     |x| 14
    |                    0 0 0 0 1 x 0    |     |           |     |M| 15
    |              0 0       0 0 0 1 0    |     |           |     |M| 16
    |                            0 0 1 0 0|     |      0    |     |M| 17
    |                                0 1 0|     |      0    |     |M| 18
    |                                0 0 1|     |      0    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[61];

    // sc-row-15 = sc-row-15 - sc-row-16 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[61] = 0;
#endif

    sc_g_matrix[14] -= sc_g_matrix[15] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   x           x                    |     |           |     |x|  1
    |  1 x   x                            |     |           |     |x|  2
    |0 0 1   x       x                    |     |           |     |x|  3
    |      1 x   x                        |     |           |     |x|  4
    |  0 0 0 1   x   f                    |     |           |     |x|  5
    |          1 x x                      |     |           |     |x|  6
    |      0 0 0 1 x f                    |     |           |     |x|  7
    |          0 0 1 f         x   x      |     |           |     |x|  8
    |0   0   0   0 0 1       x x   f      |     |           |     |x|  9
    |                  1   x x            | ... |           | ... |x| 10 sc
    |                    1 x     x        |     |           |     |x| 11
    |                  0 0 1 x   x        |     |           |     |x| 12
    |                0 0   0 1 x f f      |     |           |     |x| 13
    |              0 0       0 1 f x      |     |           |     |x| 14
    |                    0 0 0 0 1 0 0    |     |           |     |M| 15
    |              0 0       0 0 0 1 0    |     |           |     |M| 16
    |                            0 0 1 0 0|     |      0    |     |M| 17
    |                                0 1 0|     |      0    |     |M| 18
    |                                0 0 1|     |      0    |     |x| 19
    ---------------------------------------     -------------
    */

    /*
     *
     * Row 14
     *
     */

    pivot = sc_to_sc_matrix[57];

    // sc-row-14 = sc-row-14 - sc-row-16 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[57] = 0;
#endif

    sc_g_matrix[13] -= sc_g_matrix[15] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   x           x                    |     |           |     |x|  1
    |  1 x   x                            |     |           |     |x|  2
    |0 0 1   x       x                    |     |           |     |x|  3
    |      1 x   x                        |     |           |     |x|  4
    |  0 0 0 1   x   f                    |     |           |     |x|  5
    |          1 x x                      |     |           |     |x|  6
    |      0 0 0 1 x f                    |     |           |     |x|  7
    |          0 0 1 f         x   x      |     |           |     |x|  8
    |0   0   0   0 0 1       x x   f      |     |           |     |x|  9
    |                  1   x x            | ... |           | ... |x| 10 sc
    |                    1 x     x        |     |           |     |x| 11
    |                  0 0 1 x   x        |     |           |     |x| 12
    |                0 0   0 1 x f f      |     |           |     |x| 13
    |              0 0       0 1 f 0      |     |           |     |M| 14
    |                    0 0 0 0 1 0 0    |     |           |     |M| 15
    |              0 0       0 0 0 1 0    |     |           |     |M| 16
    |                            0 0 1 0 0|     |      0    |     |M| 17
    |                                0 1 0|     |      0    |     |M| 18
    |                                0 0 1|     |      0    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_fillins[9];

    // sc-row-14 = sc-row-14 - sc-row-15 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_fillins[9] = 0;
#endif

    sc_g_matrix[13] -= sc_g_matrix[14] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   x           x                    |     |           |     |x|  1
    |  1 x   x                            |     |           |     |x|  2
    |0 0 1   x       x                    |     |           |     |x|  3
    |      1 x   x                        |     |           |     |x|  4
    |  0 0 0 1   x   f                    |     |           |     |x|  5
    |          1 x x                      |     |           |     |x|  6
    |      0 0 0 1 x f                    |     |           |     |x|  7
    |          0 0 1 f         x   x      |     |           |     |x|  8
    |0   0   0   0 0 1       x x   f      |     |           |     |x|  9
    |                  1   x x            | ... |           | ... |x| 10 sc
    |                    1 x     x        |     |           |     |x| 11
    |                  0 0 1 x   x        |     |           |     |x| 12
    |                0 0   0 1 x f f      |     |           |     |x| 13
    |              0 0       0 1 0 0      |     |           |     |M| 14
    |                    0 0 0 0 1 0 0    |     |           |     |M| 15
    |              0 0       0 0 0 1 0    |     |           |     |M| 16
    |                            0 0 1 0 0|     |      0    |     |M| 17
    |                                0 1 0|     |      0    |     |M| 18
    |                                0 0 1|     |      0    |     |x| 19
    ---------------------------------------     -------------
    */

    /*
     *
     * Row 13
     *
     */

    pivot = sc_to_sc_fillins[8];

    // sc-row-13 = sc-row-13 - sc-row-16 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_fillins[8] = 0;
#endif

    sc_g_matrix[12] -= sc_g_matrix[15] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   x           x                    |     |           |     |x|  1
    |  1 x   x                            |     |           |     |x|  2
    |0 0 1   x       x                    |     |           |     |x|  3
    |      1 x   x                        |     |           |     |x|  4
    |  0 0 0 1   x   f                    |     |           |     |x|  5
    |          1 x x                      |     |           |     |x|  6
    |      0 0 0 1 x f                    |     |           |     |x|  7
    |          0 0 1 f         x   x      |     |           |     |x|  8
    |0   0   0   0 0 1       x x   f      |     |           |     |x|  9
    |                  1   x x            | ... |           | ... |x| 10 sc
    |                    1 x     x        |     |           |     |x| 11
    |                  0 0 1 x   x        |     |           |     |x| 12
    |                0 0   0 1 x f 0      |     |           |     |M| 13
    |              0 0       0 1 0 0      |     |           |     |M| 14
    |                    0 0 0 0 1 0 0    |     |           |     |M| 15
    |              0 0       0 0 0 1 0    |     |           |     |M| 16
    |                            0 0 1 0 0|     |      0    |     |M| 17
    |                                0 1 0|     |      0    |     |M| 18
    |                                0 0 1|     |      0    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_fillins[7];

    // sc-row-13 = sc-row-13 - sc-row-15 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_fillins[7] = 0;
#endif

    sc_g_matrix[12] -= sc_g_matrix[14] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   x           x                    |     |           |     |x|  1
    |  1 x   x                            |     |           |     |x|  2
    |0 0 1   x       x                    |     |           |     |x|  3
    |      1 x   x                        |     |           |     |x|  4
    |  0 0 0 1   x   f                    |     |           |     |x|  5
    |          1 x x                      |     |           |     |x|  6
    |      0 0 0 1 x f                    |     |           |     |x|  7
    |          0 0 1 f         x   x      |     |           |     |x|  8
    |0   0   0   0 0 1       x x   f      |     |           |     |x|  9
    |                  1   x x            | ... |           | ... |x| 10 sc
    |                    1 x     x        |     |           |     |x| 11
    |                  0 0 1 x   x        |     |           |     |x| 12
    |                0 0   0 1 x 0 0      |     |           |     |M| 13
    |              0 0       0 1 0 0      |     |           |     |M| 14
    |                    0 0 0 0 1 0 0    |     |           |     |M| 15
    |              0 0       0 0 0 1 0    |     |           |     |M| 16
    |                            0 0 1 0 0|     |      0    |     |M| 17
    |                                0 1 0|     |      0    |     |M| 18
    |                                0 0 1|     |      0    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[52];

    // sc-row-13 = sc-row-13 - sc-row-14 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[52] = 0;
#endif

    sc_g_matrix[12] -= sc_g_matrix[13] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   x           x                    |     |           |     |x|  1
    |  1 x   x                            |     |           |     |x|  2
    |0 0 1   x       x                    |     |           |     |x|  3
    |      1 x   x                        |     |           |     |x|  4
    |  0 0 0 1   x   f                    |     |           |     |x|  5
    |          1 x x                      |     |           |     |x|  6
    |      0 0 0 1 x f                    |     |           |     |x|  7
    |          0 0 1 f         x   x      |     |           |     |x|  8
    |0   0   0   0 0 1       x x   f      |     |           |     |x|  9
    |                  1   x x            | ... |           | ... |x| 10 sc
    |                    1 x     x        |     |           |     |x| 11
    |                  0 0 1 x   x        |     |           |     |x| 12
    |                0 0   0 1 0 0 0      |     |           |     |M| 13
    |              0 0       0 1 0 0      |     |           |     |M| 14
    |                    0 0 0 0 1 0 0    |     |           |     |M| 15
    |              0 0       0 0 0 1 0    |     |           |     |M| 16
    |                            0 0 1 0 0|     |      0    |     |M| 17
    |                                0 1 0|     |      0    |     |M| 18
    |                                0 0 1|     |      0    |     |x| 19
    ---------------------------------------     -------------
    */

    /*
     *
     * Row 12
     *
     */

    pivot = sc_to_sc_matrix[47];

    // sc-row-12 = sc-row-12 - sc-row-15 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[47] = 0;
#endif

    sc_g_matrix[11] -= sc_g_matrix[14] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   x           x                    |     |           |     |x|  1
    |  1 x   x                            |     |           |     |x|  2
    |0 0 1   x       x                    |     |           |     |x|  3
    |      1 x   x                        |     |           |     |x|  4
    |  0 0 0 1   x   f                    |     |           |     |x|  5
    |          1 x x                      |     |           |     |x|  6
    |      0 0 0 1 x f                    |     |           |     |x|  7
    |          0 0 1 f         x   x      |     |           |     |x|  8
    |0   0   0   0 0 1       x x   f      |     |           |     |x|  9
    |                  1   x x            | ... |           | ... |x| 10 sc
    |                    1 x     x        |     |           |     |x| 11
    |                  0 0 1 x   0        |     |           |     |M| 12
    |                0 0   0 1 0 0 0      |     |           |     |M| 13
    |              0 0       0 1 0 0      |     |           |     |M| 14
    |                    0 0 0 0 1 0 0    |     |           |     |M| 15
    |              0 0       0 0 0 1 0    |     |           |     |M| 16
    |                            0 0 1 0 0|     |      0    |     |M| 17
    |                                0 1 0|     |      0    |     |M| 18
    |                                0 0 1|     |      0    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[46];

    // sc-row-12 = sc-row-12 - sc-row-13 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[46] = 0;
#endif

    sc_g_matrix[11] -= sc_g_matrix[12] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   x           x                    |     |           |     |x|  1
    |  1 x   x                            |     |           |     |x|  2
    |0 0 1   x       x                    |     |           |     |x|  3
    |      1 x   x                        |     |           |     |x|  4
    |  0 0 0 1   x   f                    |     |           |     |x|  5
    |          1 x x                      |     |           |     |x|  6
    |      0 0 0 1 x f                    |     |           |     |x|  7
    |          0 0 1 f         x   x      |     |           |     |x|  8
    |0   0   0   0 0 1       x x   f      |     |           |     |x|  9
    |                  1   x x            | ... |           | ... |x| 10 sc
    |                    1 x     x        |     |           |     |x| 11
    |                  0 0 1 0   0        |     |           |     |M| 12
    |                0 0   0 1 0 0 0      |     |           |     |M| 13
    |              0 0       0 1 0 0      |     |           |     |M| 14
    |                    0 0 0 0 1 0 0    |     |           |     |M| 15
    |              0 0       0 0 0 1 0    |     |           |     |M| 16
    |                            0 0 1 0 0|     |      0    |     |M| 17
    |                                0 1 0|     |      0    |     |M| 18
    |                                0 0 1|     |      0    |     |x| 19
    ---------------------------------------     -------------
    */

    /*
     *
     * Row 11
     *
     */

    pivot = sc_to_sc_matrix[42];

    // sc-row-11 = sc-row-11 - sc-row-15 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[42] = 0;
#endif

    sc_g_matrix[10] -= sc_g_matrix[14] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   x           x                    |     |           |     |x|  1
    |  1 x   x                            |     |           |     |x|  2
    |0 0 1   x       x                    |     |           |     |x|  3
    |      1 x   x                        |     |           |     |x|  4
    |  0 0 0 1   x   f                    |     |           |     |x|  5
    |          1 x x                      |     |           |     |x|  6
    |      0 0 0 1 x f                    |     |           |     |x|  7
    |          0 0 1 f         x   x      |     |           |     |x|  8
    |0   0   0   0 0 1       x x   f      |     |           |     |x|  9
    |                  1   x x            | ... |           | ... |x| 10 sc
    |                    1 x     0        |     |           |     |M| 11
    |                  0 0 1 0   0        |     |           |     |M| 12
    |                0 0   0 1 0 0 0      |     |           |     |M| 13
    |              0 0       0 1 0 0      |     |           |     |M| 14
    |                    0 0 0 0 1 0 0    |     |           |     |M| 15
    |              0 0       0 0 0 1 0    |     |           |     |M| 16
    |                            0 0 1 0 0|     |      0    |     |M| 17
    |                                0 1 0|     |      0    |     |M| 18
    |                                0 0 1|     |      0    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[41];

    // sc-row-11 = sc-row-11 - sc-row-12 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[41] = 0;
#endif

    sc_g_matrix[10] -= sc_g_matrix[11] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   x           x                    |     |           |     |x|  1
    |  1 x   x                            |     |           |     |x|  2
    |0 0 1   x       x                    |     |           |     |x|  3
    |      1 x   x                        |     |           |     |x|  4
    |  0 0 0 1   x   f                    |     |           |     |x|  5
    |          1 x x                      |     |           |     |x|  6
    |      0 0 0 1 x f                    |     |           |     |x|  7
    |          0 0 1 f         x   x      |     |           |     |x|  8
    |0   0   0   0 0 1       x x   f      |     |           |     |x|  9
    |                  1   x x            | ... |           | ... |x| 10 sc
    |                    1 0     0        |     |           |     |M| 11
    |                  0 0 1 0   0        |     |           |     |M| 12
    |                0 0   0 1 0 0 0      |     |           |     |M| 13
    |              0 0       0 1 0 0      |     |           |     |M| 14
    |                    0 0 0 0 1 0 0    |     |           |     |M| 15
    |              0 0       0 0 0 1 0    |     |           |     |M| 16
    |                            0 0 1 0 0|     |      0    |     |M| 17
    |                                0 1 0|     |      0    |     |M| 18
    |                                0 0 1|     |      0    |     |x| 19
    ---------------------------------------     -------------
    */

    /*
     *
     * Row 10
     *
     */

    pivot = sc_to_sc_matrix[39];

    // sc-row-10 = sc-row-10 - sc-row-13 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[39] = 0;
#endif

    sc_g_matrix[9] -= sc_g_matrix[12] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   x           x                    |     |           |     |x|  1
    |  1 x   x                            |     |           |     |x|  2
    |0 0 1   x       x                    |     |           |     |x|  3
    |      1 x   x                        |     |           |     |x|  4
    |  0 0 0 1   x   f                    |     |           |     |x|  5
    |          1 x x                      |     |           |     |x|  6
    |      0 0 0 1 x f                    |     |           |     |x|  7
    |          0 0 1 f         x   x      |     |           |     |x|  8
    |0   0   0   0 0 1       x x   f      |     |           |     |x|  9
    |                  1   x 0            | ... |           | ... |M| 10 sc
    |                    1 0     0        |     |           |     |M| 11
    |                  0 0 1 0   0        |     |           |     |M| 12
    |                0 0   0 1 0 0 0      |     |           |     |M| 13
    |              0 0       0 1 0 0      |     |           |     |M| 14
    |                    0 0 0 0 1 0 0    |     |           |     |M| 15
    |              0 0       0 0 0 1 0    |     |           |     |M| 16
    |                            0 0 1 0 0|     |      0    |     |M| 17
    |                                0 1 0|     |      0    |     |M| 18
    |                                0 0 1|     |      0    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[38];

    // sc-row-10 = sc-row-10 - sc-row-12 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[38] = 0;
#endif

    sc_g_matrix[9] -= sc_g_matrix[11] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   x           x                    |     |           |     |x|  1
    |  1 x   x                            |     |           |     |x|  2
    |0 0 1   x       x                    |     |           |     |x|  3
    |      1 x   x                        |     |           |     |x|  4
    |  0 0 0 1   x   f                    |     |           |     |x|  5
    |          1 x x                      |     |           |     |x|  6
    |      0 0 0 1 x f                    |     |           |     |x|  7
    |          0 0 1 f         x   x      |     |           |     |x|  8
    |0   0   0   0 0 1       x x   f      |     |           |     |x|  9
    |                  1   0 0            | ... |           | ... |M| 10 sc
    |                    1 0     0        |     |           |     |M| 11
    |                  0 0 1 0   0        |     |           |     |M| 12
    |                0 0   0 1 0 0 0      |     |           |     |M| 13
    |              0 0       0 1 0 0      |     |           |     |M| 14
    |                    0 0 0 0 1 0 0    |     |           |     |M| 15
    |              0 0       0 0 0 1 0    |     |           |     |M| 16
    |                            0 0 1 0 0|     |      0    |     |M| 17
    |                                0 1 0|     |      0    |     |M| 18
    |                                0 0 1|     |      0    |     |x| 19
    ---------------------------------------     -------------
    */

    /*
     *
     * Row 9
     *
     */

    pivot = sc_to_sc_fillins[6];

    // sc-row-9 = sc-row-9 - sc-row-16 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_fillins[6] = 0;
#endif

    sc_g_matrix[8] -= sc_g_matrix[15] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   x           x                    |     |           |     |x|  1
    |  1 x   x                            |     |           |     |x|  2
    |0 0 1   x       x                    |     |           |     |x|  3
    |      1 x   x                        |     |           |     |x|  4
    |  0 0 0 1   x   f                    |     |           |     |x|  5
    |          1 x x                      |     |           |     |x|  6
    |      0 0 0 1 x f                    |     |           |     |x|  7
    |          0 0 1 f         x   x      |     |           |     |x|  8
    |0   0   0   0 0 1       x x   0      |     |           |     |M|  9
    |                  1   0 0            | ... |           | ... |M| 10 sc
    |                    1 0     0        |     |           |     |M| 11
    |                  0 0 1 0   0        |     |           |     |M| 12
    |                0 0   0 1 0 0 0      |     |           |     |M| 13
    |              0 0       0 1 0 0      |     |           |     |M| 14
    |                    0 0 0 0 1 0 0    |     |           |     |M| 15
    |              0 0       0 0 0 1 0    |     |           |     |M| 16
    |                            0 0 1 0 0|     |      0    |     |M| 17
    |                                0 1 0|     |      0    |     |M| 18
    |                                0 0 1|     |      0    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[36];

    // sc-row-9 = sc-row-9 - sc-row-14 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[36] = 0;
#endif

    sc_g_matrix[8] -= sc_g_matrix[13] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   x           x                    |     |           |     |x|  1
    |  1 x   x                            |     |           |     |x|  2
    |0 0 1   x       x                    |     |           |     |x|  3
    |      1 x   x                        |     |           |     |x|  4
    |  0 0 0 1   x   f                    |     |           |     |x|  5
    |          1 x x                      |     |           |     |x|  6
    |      0 0 0 1 x f                    |     |           |     |x|  7
    |          0 0 1 f         x   x      |     |           |     |x|  8
    |0   0   0   0 0 1       x 0   0      |     |           |     |M|  9
    |                  1   0 0            | ... |           | ... |M| 10 sc
    |                    1 0     0        |     |           |     |M| 11
    |                  0 0 1 0   0        |     |           |     |M| 12
    |                0 0   0 1 0 0 0      |     |           |     |M| 13
    |              0 0       0 1 0 0      |     |           |     |M| 14
    |                    0 0 0 0 1 0 0    |     |           |     |M| 15
    |              0 0       0 0 0 1 0    |     |           |     |M| 16
    |                            0 0 1 0 0|     |      0    |     |M| 17
    |                                0 1 0|     |      0    |     |M| 18
    |                                0 0 1|     |      0    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[35];

    // sc-row-9 = sc-row-9 - sc-row-13 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[35] = 0;
#endif

    sc_g_matrix[8] -= sc_g_matrix[12] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   x           x                    |     |           |     |x|  1
    |  1 x   x                            |     |           |     |x|  2
    |0 0 1   x       x                    |     |           |     |x|  3
    |      1 x   x                        |     |           |     |x|  4
    |  0 0 0 1   x   f                    |     |           |     |x|  5
    |          1 x x                      |     |           |     |x|  6
    |      0 0 0 1 x f                    |     |           |     |x|  7
    |          0 0 1 f         x   x      |     |           |     |x|  8
    |0   0   0   0 0 1       0 0   0      |     |           |     |M|  9
    |                  1   0 0            | ... |           | ... |M| 10 sc
    |                    1 0     0        |     |           |     |M| 11
    |                  0 0 1 0   0        |     |           |     |M| 12
    |                0 0   0 1 0 0 0      |     |           |     |M| 13
    |              0 0       0 1 0 0      |     |           |     |M| 14
    |                    0 0 0 0 1 0 0    |     |           |     |M| 15
    |              0 0       0 0 0 1 0    |     |           |     |M| 16
    |                            0 0 1 0 0|     |      0    |     |M| 17
    |                                0 1 0|     |      0    |     |M| 18
    |                                0 0 1|     |      0    |     |x| 19
    ---------------------------------------     -------------
    */

    /*
     *
     * Row 8
     *
     */

    pivot = sc_to_sc_matrix[31];

    // sc-row-8 = sc-row-8 - sc-row-16 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[31] = 0;
#endif

    sc_g_matrix[7] -= sc_g_matrix[15] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   x           x                    |     |           |     |x|  1
    |  1 x   x                            |     |           |     |x|  2
    |0 0 1   x       x                    |     |           |     |x|  3
    |      1 x   x                        |     |           |     |x|  4
    |  0 0 0 1   x   f                    |     |           |     |x|  5
    |          1 x x                      |     |           |     |x|  6
    |      0 0 0 1 x f                    |     |           |     |x|  7
    |          0 0 1 f         x   0      |     |           |     |M|  8
    |0   0   0   0 0 1       0 0   0      |     |           |     |M|  9
    |                  1   0 0            | ... |           | ... |M| 10 sc
    |                    1 0     0        |     |           |     |M| 11
    |                  0 0 1 0   0        |     |           |     |M| 12
    |                0 0   0 1 0 0 0      |     |           |     |M| 13
    |              0 0       0 1 0 0      |     |           |     |M| 14
    |                    0 0 0 0 1 0 0    |     |           |     |M| 15
    |              0 0       0 0 0 1 0    |     |           |     |M| 16
    |                            0 0 1 0 0|     |      0    |     |M| 17
    |                                0 1 0|     |      0    |     |M| 18
    |                                0 0 1|     |      0    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[30];

    // sc-row-8 = sc-row-8 - sc-row-14 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[30] = 0;
#endif

    sc_g_matrix[7] -= sc_g_matrix[13] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   x           x                    |     |           |     |x|  1
    |  1 x   x                            |     |           |     |x|  2
    |0 0 1   x       x                    |     |           |     |x|  3
    |      1 x   x                        |     |           |     |x|  4
    |  0 0 0 1   x   f                    |     |           |     |x|  5
    |          1 x x                      |     |           |     |x|  6
    |      0 0 0 1 x f                    |     |           |     |x|  7
    |          0 0 1 f         0   0      |     |           |     |M|  8
    |0   0   0   0 0 1       0 0   0      |     |           |     |M|  9
    |                  1   0 0            | ... |           | ... |M| 10 sc
    |                    1 0     0        |     |           |     |M| 11
    |                  0 0 1 0   0        |     |           |     |M| 12
    |                0 0   0 1 0 0 0      |     |           |     |M| 13
    |              0 0       0 1 0 0      |     |           |     |M| 14
    |                    0 0 0 0 1 0 0    |     |           |     |M| 15
    |              0 0       0 0 0 1 0    |     |           |     |M| 16
    |                            0 0 1 0 0|     |      0    |     |M| 17
    |                                0 1 0|     |      0    |     |M| 18
    |                                0 0 1|     |      0    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_fillins[2];

    // sc-row-8 = sc-row-8 - sc-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_fillins[2] = 0;
#endif

    sc_g_matrix[7] -= sc_g_matrix[8] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   x           x                    |     |           |     |x|  1
    |  1 x   x                            |     |           |     |x|  2
    |0 0 1   x       x                    |     |           |     |x|  3
    |      1 x   x                        |     |           |     |x|  4
    |  0 0 0 1   x   f                    |     |           |     |x|  5
    |          1 x x                      |     |           |     |x|  6
    |      0 0 0 1 x f                    |     |           |     |x|  7
    |          0 0 1 0         0   0      |     |           |     |M|  8
    |0   0   0   0 0 1       0 0   0      |     |           |     |M|  9
    |                  1   0 0            | ... |           | ... |M| 10 sc
    |                    1 0     0        |     |           |     |M| 11
    |                  0 0 1 0   0        |     |           |     |M| 12
    |                0 0   0 1 0 0 0      |     |           |     |M| 13
    |              0 0       0 1 0 0      |     |           |     |M| 14
    |                    0 0 0 0 1 0 0    |     |           |     |M| 15
    |              0 0       0 0 0 1 0    |     |           |     |M| 16
    |                            0 0 1 0 0|     |      0    |     |M| 17
    |                                0 1 0|     |      0    |     |M| 18
    |                                0 0 1|     |      0    |     |x| 19
    ---------------------------------------     -------------
    */

    /*
     *
     * Row 7
     *
     */

    pivot = sc_to_sc_fillins[1];

    // sc-row-7 = sc-row-7 - sc-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_fillins[1] = 0;
#endif

    sc_g_matrix[6] -= sc_g_matrix[8] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   x           x                    |     |           |     |x|  1
    |  1 x   x                            |     |           |     |x|  2
    |0 0 1   x       x                    |     |           |     |x|  3
    |      1 x   x                        |     |           |     |x|  4
    |  0 0 0 1   x   f                    |     |           |     |x|  5
    |          1 x x                      |     |           |     |x|  6
    |      0 0 0 1 x 0                    |     |           |     |M|  7
    |          0 0 1 0         0   0      |     |           |     |M|  8
    |0   0   0   0 0 1       0 0   0      |     |           |     |M|  9
    |                  1   0 0            | ... |           | ... |M| 10 sc
    |                    1 0     0        |     |           |     |M| 11
    |                  0 0 1 0   0        |     |           |     |M| 12
    |                0 0   0 1 0 0 0      |     |           |     |M| 13
    |              0 0       0 1 0 0      |     |           |     |M| 14
    |                    0 0 0 0 1 0 0    |     |           |     |M| 15
    |              0 0       0 0 0 1 0    |     |           |     |M| 16
    |                            0 0 1 0 0|     |      0    |     |M| 17
    |                                0 1 0|     |      0    |     |M| 18
    |                                0 0 1|     |      0    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[26];

    // sc-row-7 = sc-row-7 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[26] = 0;
#endif

    sc_g_matrix[6] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   x           x                    |     |           |     |x|  1
    |  1 x   x                            |     |           |     |x|  2
    |0 0 1   x       x                    |     |           |     |x|  3
    |      1 x   x                        |     |           |     |x|  4
    |  0 0 0 1   x   f                    |     |           |     |x|  5
    |          1 x x                      |     |           |     |x|  6
    |      0 0 0 1 0 0                    |     |           |     |M|  7
    |          0 0 1 0         0   0      |     |           |     |M|  8
    |0   0   0   0 0 1       0 0   0      |     |           |     |M|  9
    |                  1   0 0            | ... |           | ... |M| 10 sc
    |                    1 0     0        |     |           |     |M| 11
    |                  0 0 1 0   0        |     |           |     |M| 12
    |                0 0   0 1 0 0 0      |     |           |     |M| 13
    |              0 0       0 1 0 0      |     |           |     |M| 14
    |                    0 0 0 0 1 0 0    |     |           |     |M| 15
    |              0 0       0 0 0 1 0    |     |           |     |M| 16
    |                            0 0 1 0 0|     |      0    |     |M| 17
    |                                0 1 0|     |      0    |     |M| 18
    |                                0 0 1|     |      0    |     |x| 19
    ---------------------------------------     -------------
    */

    /*
     *
     * Row 6
     *
     */

    pivot = sc_to_sc_matrix[21];

    // sc-row-6 = sc-row-6 - sc-row-8 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[21] = 0;
#endif

    sc_g_matrix[5] -= sc_g_matrix[7] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   x           x                    |     |           |     |x|  1
    |  1 x   x                            |     |           |     |x|  2
    |0 0 1   x       x                    |     |           |     |x|  3
    |      1 x   x                        |     |           |     |x|  4
    |  0 0 0 1   x   f                    |     |           |     |x|  5
    |          1 x 0                      |     |           |     |M|  6
    |      0 0 0 1 0 0                    |     |           |     |M|  7
    |          0 0 1 0         0   0      |     |           |     |M|  8
    |0   0   0   0 0 1       0 0   0      |     |           |     |M|  9
    |                  1   0 0            | ... |           | ... |M| 10 sc
    |                    1 0     0        |     |           |     |M| 11
    |                  0 0 1 0   0        |     |           |     |M| 12
    |                0 0   0 1 0 0 0      |     |           |     |M| 13
    |              0 0       0 1 0 0      |     |           |     |M| 14
    |                    0 0 0 0 1 0 0    |     |           |     |M| 15
    |              0 0       0 0 0 1 0    |     |           |     |M| 16
    |                            0 0 1 0 0|     |      0    |     |M| 17
    |                                0 1 0|     |      0    |     |M| 18
    |                                0 0 1|     |      0    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[20];

    // sc-row-6 = sc-row-6 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[20] = 0;
#endif

    sc_g_matrix[5] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   x           x                    |     |           |     |x|  1
    |  1 x   x                            |     |           |     |x|  2
    |0 0 1   x       x                    |     |           |     |x|  3
    |      1 x   x                        |     |           |     |x|  4
    |  0 0 0 1   x   f                    |     |           |     |x|  5
    |          1 0 0                      |     |           |     |M|  6
    |      0 0 0 1 0 0                    |     |           |     |M|  7
    |          0 0 1 0         0   0      |     |           |     |M|  8
    |0   0   0   0 0 1       0 0   0      |     |           |     |M|  9
    |                  1   0 0            | ... |           | ... |M| 10 sc
    |                    1 0     0        |     |           |     |M| 11
    |                  0 0 1 0   0        |     |           |     |M| 12
    |                0 0   0 1 0 0 0      |     |           |     |M| 13
    |              0 0       0 1 0 0      |     |           |     |M| 14
    |                    0 0 0 0 1 0 0    |     |           |     |M| 15
    |              0 0       0 0 0 1 0    |     |           |     |M| 16
    |                            0 0 1 0 0|     |      0    |     |M| 17
    |                                0 1 0|     |      0    |     |M| 18
    |                                0 0 1|     |      0    |     |x| 19
    ---------------------------------------     -------------
    */

    /*
     *
     * Row 5
     *
     */

    pivot = sc_to_sc_fillins[0];

    // sc-row-5 = sc-row-5 - sc-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_fillins[0] = 0;
#endif

    sc_g_matrix[4] -= sc_g_matrix[8] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   x           x                    |     |           |     |x|  1
    |  1 x   x                            |     |           |     |x|  2
    |0 0 1   x       x                    |     |           |     |x|  3
    |      1 x   x                        |     |           |     |x|  4
    |  0 0 0 1   x   0                    |     |           |     |M|  5
    |          1 0 0                      |     |           |     |M|  6
    |      0 0 0 1 0 0                    |     |           |     |M|  7
    |          0 0 1 0         0   0      |     |           |     |M|  8
    |0   0   0   0 0 1       0 0   0      |     |           |     |M|  9
    |                  1   0 0            | ... |           | ... |M| 10 sc
    |                    1 0     0        |     |           |     |M| 11
    |                  0 0 1 0   0        |     |           |     |M| 12
    |                0 0   0 1 0 0 0      |     |           |     |M| 13
    |              0 0       0 1 0 0      |     |           |     |M| 14
    |                    0 0 0 0 1 0 0    |     |           |     |M| 15
    |              0 0       0 0 0 1 0    |     |           |     |M| 16
    |                            0 0 1 0 0|     |      0    |     |M| 17
    |                                0 1 0|     |      0    |     |M| 18
    |                                0 0 1|     |      0    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[18];

    // sc-row-5 = sc-row-5 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[18] = 0;
#endif

    sc_g_matrix[4] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   x           x                    |     |           |     |x|  1
    |  1 x   x                            |     |           |     |x|  2
    |0 0 1   x       x                    |     |           |     |x|  3
    |      1 x   x                        |     |           |     |x|  4
    |  0 0 0 1   0   0                    |     |           |     |M|  5
    |          1 0 0                      |     |           |     |M|  6
    |      0 0 0 1 0 0                    |     |           |     |M|  7
    |          0 0 1 0         0   0      |     |           |     |M|  8
    |0   0   0   0 0 1       0 0   0      |     |           |     |M|  9
    |                  1   0 0            | ... |           | ... |M| 10 sc
    |                    1 0     0        |     |           |     |M| 11
    |                  0 0 1 0   0        |     |           |     |M| 12
    |                0 0   0 1 0 0 0      |     |           |     |M| 13
    |              0 0       0 1 0 0      |     |           |     |M| 14
    |                    0 0 0 0 1 0 0    |     |           |     |M| 15
    |              0 0       0 0 0 1 0    |     |           |     |M| 16
    |                            0 0 1 0 0|     |      0    |     |M| 17
    |                                0 1 0|     |      0    |     |M| 18
    |                                0 0 1|     |      0    |     |x| 19
    ---------------------------------------     -------------
    */

    /*
     *
     * Row 4
     *
     */

    pivot = sc_to_sc_matrix[13];

    // sc-row-4 = sc-row-4 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[13] = 0;
#endif

    sc_g_matrix[3] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   x           x                    |     |           |     |x|  1
    |  1 x   x                            |     |           |     |x|  2
    |0 0 1   x       x                    |     |           |     |x|  3
    |      1 x   0                        |     |           |     |M|  4
    |  0 0 0 1   0   0                    |     |           |     |M|  5
    |          1 0 0                      |     |           |     |M|  6
    |      0 0 0 1 0 0                    |     |           |     |M|  7
    |          0 0 1 0         0   0      |     |           |     |M|  8
    |0   0   0   0 0 1       0 0   0      |     |           |     |M|  9
    |                  1   0 0            | ... |           | ... |M| 10 sc
    |                    1 0     0        |     |           |     |M| 11
    |                  0 0 1 0   0        |     |           |     |M| 12
    |                0 0   0 1 0 0 0      |     |           |     |M| 13
    |              0 0       0 1 0 0      |     |           |     |M| 14
    |                    0 0 0 0 1 0 0    |     |           |     |M| 15
    |              0 0       0 0 0 1 0    |     |           |     |M| 16
    |                            0 0 1 0 0|     |      0    |     |M| 17
    |                                0 1 0|     |      0    |     |M| 18
    |                                0 0 1|     |      0    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[12];

    // sc-row-4 = sc-row-4 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[12] = 0;
#endif

    sc_g_matrix[3] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   x           x                    |     |           |     |x|  1
    |  1 x   x                            |     |           |     |x|  2
    |0 0 1   x       x                    |     |           |     |x|  3
    |      1 0   0                        |     |           |     |M|  4
    |  0 0 0 1   0   0                    |     |           |     |M|  5
    |          1 0 0                      |     |           |     |M|  6
    |      0 0 0 1 0 0                    |     |           |     |M|  7
    |          0 0 1 0         0   0      |     |           |     |M|  8
    |0   0   0   0 0 1       0 0   0      |     |           |     |M|  9
    |                  1   0 0            | ... |           | ... |M| 10 sc
    |                    1 0     0        |     |           |     |M| 11
    |                  0 0 1 0   0        |     |           |     |M| 12
    |                0 0   0 1 0 0 0      |     |           |     |M| 13
    |              0 0       0 1 0 0      |     |           |     |M| 14
    |                    0 0 0 0 1 0 0    |     |           |     |M| 15
    |              0 0       0 0 0 1 0    |     |           |     |M| 16
    |                            0 0 1 0 0|     |      0    |     |M| 17
    |                                0 1 0|     |      0    |     |M| 18
    |                                0 0 1|     |      0    |     |x| 19
    ---------------------------------------     -------------
    */

    /*
     *
     * Row 3
     *
     */

    pivot = sc_to_sc_matrix[10];

    // sc-row-3 = sc-row-3 - sc-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[10] = 0;
#endif

    sc_g_matrix[2] -= sc_g_matrix[8] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   x           x                    |     |           |     |x|  1
    |  1 x   x                            |     |           |     |x|  2
    |0 0 1   x       0                    |     |           |     |M|  3
    |      1 0   0                        |     |           |     |M|  4
    |  0 0 0 1   0   0                    |     |           |     |M|  5
    |          1 0 0                      |     |           |     |M|  6
    |      0 0 0 1 0 0                    |     |           |     |M|  7
    |          0 0 1 0         0   0      |     |           |     |M|  8
    |0   0   0   0 0 1       0 0   0      |     |           |     |M|  9
    |                  1   0 0            | ... |           | ... |M| 10 sc
    |                    1 0     0        |     |           |     |M| 11
    |                  0 0 1 0   0        |     |           |     |M| 12
    |                0 0   0 1 0 0 0      |     |           |     |M| 13
    |              0 0       0 1 0 0      |     |           |     |M| 14
    |                    0 0 0 0 1 0 0    |     |           |     |M| 15
    |              0 0       0 0 0 1 0    |     |           |     |M| 16
    |                            0 0 1 0 0|     |      0    |     |M| 17
    |                                0 1 0|     |      0    |     |M| 18
    |                                0 0 1|     |      0    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[9];

    // sc-row-3 = sc-row-3 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[9] = 0;
#endif

    sc_g_matrix[2] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   x           x                    |     |           |     |x|  1
    |  1 x   x                            |     |           |     |x|  2
    |0 0 1   0       0                    |     |           |     |M|  3
    |      1 0   0                        |     |           |     |M|  4
    |  0 0 0 1   0   0                    |     |           |     |M|  5
    |          1 0 0                      |     |           |     |M|  6
    |      0 0 0 1 0 0                    |     |           |     |M|  7
    |          0 0 1 0         0   0      |     |           |     |M|  8
    |0   0   0   0 0 1       0 0   0      |     |           |     |M|  9
    |                  1   0 0            | ... |           | ... |M| 10 sc
    |                    1 0     0        |     |           |     |M| 11
    |                  0 0 1 0   0        |     |           |     |M| 12
    |                0 0   0 1 0 0 0      |     |           |     |M| 13
    |              0 0       0 1 0 0      |     |           |     |M| 14
    |                    0 0 0 0 1 0 0    |     |           |     |M| 15
    |              0 0       0 0 0 1 0    |     |           |     |M| 16
    |                            0 0 1 0 0|     |      0    |     |M| 17
    |                                0 1 0|     |      0    |     |M| 18
    |                                0 0 1|     |      0    |     |x| 19
    ---------------------------------------     -------------
    */

    /*
     *
     * Row 2
     *
     */

    pivot = sc_to_sc_matrix[5];

    // sc-row-2 = sc-row-2 - sc-row-5 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[5] = 0;
#endif

    sc_g_matrix[1] -= sc_g_matrix[4] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   x           x                    |     |           |     |x|  1
    |  1 x   0                            |     |           |     |M|  2
    |0 0 1   0       0                    |     |           |     |M|  3
    |      1 0   0                        |     |           |     |M|  4
    |  0 0 0 1   0   0                    |     |           |     |M|  5
    |          1 0 0                      |     |           |     |M|  6
    |      0 0 0 1 0 0                    |     |           |     |M|  7
    |          0 0 1 0         0   0      |     |           |     |M|  8
    |0   0   0   0 0 1       0 0   0      |     |           |     |M|  9
    |                  1   0 0            | ... |           | ... |M| 10 sc
    |                    1 0     0        |     |           |     |M| 11
    |                  0 0 1 0   0        |     |           |     |M| 12
    |                0 0   0 1 0 0 0      |     |           |     |M| 13
    |              0 0       0 1 0 0      |     |           |     |M| 14
    |                    0 0 0 0 1 0 0    |     |           |     |M| 15
    |              0 0       0 0 0 1 0    |     |           |     |M| 16
    |                            0 0 1 0 0|     |      0    |     |M| 17
    |                                0 1 0|     |      0    |     |M| 18
    |                                0 0 1|     |      0    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[4];

    // sc-row-2 = sc-row-2 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[4] = 0;
#endif

    sc_g_matrix[1] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   x           x                    |     |           |     |x|  1
    |  1 0   0                            |     |           |     |M|  2
    |0 0 1   0       0                    |     |           |     |M|  3
    |      1 0   0                        |     |           |     |M|  4
    |  0 0 0 1   0   0                    |     |           |     |M|  5
    |          1 0 0                      |     |           |     |M|  6
    |      0 0 0 1 0 0                    |     |           |     |M|  7
    |          0 0 1 0         0   0      |     |           |     |M|  8
    |0   0   0   0 0 1       0 0   0      |     |           |     |M|  9
    |                  1   0 0            | ... |           | ... |M| 10 sc
    |                    1 0     0        |     |           |     |M| 11
    |                  0 0 1 0   0        |     |           |     |M| 12
    |                0 0   0 1 0 0 0      |     |           |     |M| 13
    |              0 0       0 1 0 0      |     |           |     |M| 14
    |                    0 0 0 0 1 0 0    |     |           |     |M| 15
    |              0 0       0 0 0 1 0    |     |           |     |M| 16
    |                            0 0 1 0 0|     |      0    |     |M| 17
    |                                0 1 0|     |      0    |     |M| 18
    |                                0 0 1|     |      0    |     |x| 19
    ---------------------------------------     -------------
    */

    /*
     *
     * Row 1
     *
     */

    pivot = sc_to_sc_matrix[2];

    // sc-row-1 = sc-row-1 - sc-row-9 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[2] = 0;
#endif

    sc_g_matrix[0] -= sc_g_matrix[8] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   x           0                    |     |           |     |M|  1
    |  1 0   0                            |     |           |     |M|  2
    |0 0 1   0       0                    |     |           |     |M|  3
    |      1 0   0                        |     |           |     |M|  4
    |  0 0 0 1   0   0                    |     |           |     |M|  5
    |          1 0 0                      |     |           |     |M|  6
    |      0 0 0 1 0 0                    |     |           |     |M|  7
    |          0 0 1 0         0   0      |     |           |     |M|  8
    |0   0   0   0 0 1       0 0   0      |     |           |     |M|  9
    |                  1   0 0            | ... |           | ... |M| 10 sc
    |                    1 0     0        |     |           |     |M| 11
    |                  0 0 1 0   0        |     |           |     |M| 12
    |                0 0   0 1 0 0 0      |     |           |     |M| 13
    |              0 0       0 1 0 0      |     |           |     |M| 14
    |                    0 0 0 0 1 0 0    |     |           |     |M| 15
    |              0 0       0 0 0 1 0    |     |           |     |M| 16
    |                            0 0 1 0 0|     |      0    |     |M| 17
    |                                0 1 0|     |      0    |     |M| 18
    |                                0 0 1|     |      0    |     |x| 19
    ---------------------------------------     -------------
    */

    pivot = sc_to_sc_matrix[1];

    // sc-row-1 = sc-row-1 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[1] = 0;
#endif

    sc_g_matrix[0] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

                      sc                             bb            g
     1 2 3 4 5 6 7 8 910111213141516171819       1 2 3 4 5 6
    ---------------------------------------     -------------
    |1   0           0                    |     |           |     |M|  1
    |  1 0   0                            |     |           |     |M|  2
    |0 0 1   0       0                    |     |           |     |M|  3
    |      1 0   0                        |     |           |     |M|  4
    |  0 0 0 1   0   0                    |     |           |     |M|  5
    |          1 0 0                      |     |           |     |M|  6
    |      0 0 0 1 0 0                    |     |           |     |M|  7
    |          0 0 1 0         0   0      |     |           |     |M|  8
    |0   0   0   0 0 1       0 0   0      |     |           |     |M|  9
    |                  1   0 0            | ... |           | ... |M| 10 sc
    |                    1 0     0        |     |           |     |M| 11
    |                  0 0 1 0   0        |     |           |     |M| 12
    |                0 0   0 1 0 0 0      |     |           |     |M| 13
    |              0 0       0 1 0 0      |     |           |     |M| 14
    |                    0 0 0 0 1 0 0    |     |           |     |M| 15
    |              0 0       0 0 0 1 0    |     |           |     |M| 16
    |                            0 0 1 0 0|     |      0    |     |M| 17
    |                                0 1 0|     |      0    |     |M| 18
    |                                0 0 1|     |      0    |     |x| 19
    ---------------------------------------     -------------
    */
}

void gmx::IlvesPC::solve_17_threonine(real *const sc_to_sc_matrix,
                                      real *const sc_g_matrix,
                                      __attribute__((unused))
                                      real *const sc_to_sc_fillins) {
    /*
     *
     * Row 6
     *
     */

    real pivot = sc_to_sc_matrix[23];

    // sc-row-6 = sc-row-6 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[23] = 0;
#endif

    sc_g_matrix[5] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 x x x      |     |           |     |x|  1
    |0 1 x x      |     |           |     |x|  2
    |0 0 1 x      |     |           |     |x|  3
    |0 0 0 1   x x| ... |      0    | ... |x|  4 sc
    |        1 x  |     |           |     |x|  5
    |      0 0 1 0|     |      0    |     |M|  6
    |      0   0 1|     |      0    |     |x|  7
    ---------------     -------------
    */

    /*
     *
     * Row 5
     *
     */

    pivot = sc_to_sc_matrix[19];

    // sc-row-5 = sc-row-5 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[19] = 0;
#endif

    sc_g_matrix[4] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 x x x      |     |           |     |x|  1
    |0 1 x x      |     |           |     |x|  2
    |0 0 1 x      |     |           |     |x|  3
    |0 0 0 1   x x| ... |      0    | ... |x|  4 sc
    |        1 0  |     |           |     |M|  5
    |      0 0 1 0|     |      0    |     |M|  6
    |      0   0 1|     |      0    |     |x|  7
    ---------------     -------------
    */

    /*
     *
     * Row 4
     *
     */

    pivot = sc_to_sc_matrix[17];

    // sc-row-4 = sc-row-4 - sc-row-7 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[17] = 0;
#endif

    sc_g_matrix[3] -= sc_g_matrix[6] * pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 x x x      |     |           |     |x|  1
    |0 1 x x      |     |           |     |x|  2
    |0 0 1 x      |     |           |     |x|  3
    |0 0 0 1   x 0| ... |      0    | ... |M|  4 sc
    |        1 0  |     |           |     |M|  5
    |      0 0 1 0|     |      0    |     |M|  6
    |      0   0 1|     |      0    |     |x|  7
    ---------------     -------------
    */

    pivot = sc_to_sc_matrix[16];

    // sc-row-4 = sc-row-4 - sc-row-6 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[16] = 0;
#endif

    sc_g_matrix[3] -= sc_g_matrix[5] * pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 x x x      |     |           |     |x|  1
    |0 1 x x      |     |           |     |x|  2
    |0 0 1 x      |     |           |     |x|  3
    |0 0 0 1   0 0| ... |      0    | ... |M|  4 sc
    |        1 0  |     |           |     |M|  5
    |      0 0 1 0|     |      0    |     |M|  6
    |      0   0 1|     |      0    |     |x|  7
    ---------------     -------------
    */

    /*
     *
     * Row 3
     *
     */

    pivot = sc_to_sc_matrix[11];

    // sc-row-3 = sc-row-3 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[11] = 0;
#endif

    sc_g_matrix[2] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 x x x      |     |           |     |x|  1
    |0 1 x x      |     |           |     |x|  2
    |0 0 1 0      |     |           |     |M|  3
    |0 0 0 1   0 0| ... |      0    | ... |M|  4 sc
    |        1 0  |     |           |     |M|  5
    |      0 0 1 0|     |      0    |     |M|  6
    |      0   0 1|     |      0    |     |x|  7
    ---------------     -------------
    */

    /*
     *
     * Row 2
     *
     */

    pivot = sc_to_sc_matrix[7];

    // sc-row-2 = sc-row-2 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[7] = 0;
#endif

    sc_g_matrix[1] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 x x x      |     |           |     |x|  1
    |0 1 x 0      |     |           |     |M|  2
    |0 0 1 0      |     |           |     |M|  3
    |0 0 0 1   0 0| ... |      0    | ... |M|  4 sc
    |        1 0  |     |           |     |M|  5
    |      0 0 1 0|     |      0    |     |M|  6
    |      0   0 1|     |      0    |     |x|  7
    ---------------     -------------
    */

    pivot = sc_to_sc_matrix[6];

    // sc-row-2 = sc-row-2 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[6] = 0;
#endif

    sc_g_matrix[1] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 x x x      |     |           |     |x|  1
    |0 1 0 0      |     |           |     |M|  2
    |0 0 1 0      |     |           |     |M|  3
    |0 0 0 1   0 0| ... |      0    | ... |M|  4 sc
    |        1 0  |     |           |     |M|  5
    |      0 0 1 0|     |      0    |     |M|  6
    |      0   0 1|     |      0    |     |x|  7
    ---------------     -------------
    */

    /*
     *
     * Row 1
     *
     */

    pivot = sc_to_sc_matrix[3];

    // sc-row-1 = sc-row-1 - sc-row-4 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[3] = 0;
#endif

    sc_g_matrix[0] -= sc_g_matrix[3] * pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 x x 0      |     |           |     |M|  1
    |0 1 0 0      |     |           |     |M|  2
    |0 0 1 0      |     |           |     |M|  3
    |0 0 0 1   0 0| ... |      0    | ... |M|  4 sc
    |        1 0  |     |           |     |M|  5
    |      0 0 1 0|     |      0    |     |M|  6
    |      0   0 1|     |      0    |     |x|  7
    ---------------     -------------
    */

    pivot = sc_to_sc_matrix[2];

    // sc-row-1 = sc-row-1 - sc-row-3 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[2] = 0;
#endif

    sc_g_matrix[0] -= sc_g_matrix[2] * pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 x 0 0      |     |           |     |M|  1
    |0 1 0 0      |     |           |     |M|  2
    |0 0 1 0      |     |           |     |M|  3
    |0 0 0 1   0 0| ... |      0    | ... |M|  4 sc
    |        1 0  |     |           |     |M|  5
    |      0 0 1 0|     |      0    |     |M|  6
    |      0   0 1|     |      0    |     |x|  7
    ---------------     -------------
    */

    pivot = sc_to_sc_matrix[1];

    // sc-row-1 = sc-row-1 - sc-row-2 * pivot

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    sc_to_sc_matrix[1] = 0;
#endif

    sc_g_matrix[0] -= sc_g_matrix[1] * pivot;

    /*
    Resulting matrix:

          sc                 bb            g
     1 2 3 4 5 6 7       1 2 3 4 5 6
    ---------------     -------------
    |1 0 0 0      |     |           |     |M|  1
    |0 1 0 0      |     |           |     |M|  2
    |0 0 1 0      |     |           |     |M|  3
    |0 0 0 1   0 0| ... |      0    | ... |M|  4 sc
    |        1 0  |     |           |     |M|  5
    |      0 0 1 0|     |      0    |     |M|  6
    |      0   0 1|     |      0    |     |x|  7
    ---------------     -------------
    */
}

// Array of pointer to step 17 solvers.
void (gmx::IlvesPC::*gmx::IlvesPC::step_17_solvers[NUM_TYPES])(real *const,
                                                               real *const,
                                                               real *const) =
    {&gmx::IlvesPC::solve_17_glycine,
     &gmx::IlvesPC::solve_17_proline,
     &gmx::IlvesPC::solve_17_cysteine,
     &gmx::IlvesPC::solve_17_methionine,
     &gmx::IlvesPC::solve_17_alaline,
     &gmx::IlvesPC::solve_17_valine,
     &gmx::IlvesPC::solve_17_leucine,
     &gmx::IlvesPC::solve_17_isoleucine,
     &gmx::IlvesPC::solve_17_aspartic_acid,
     &gmx::IlvesPC::solve_17_glutamic_acid,
     &gmx::IlvesPC::solve_17_asparagine,
     &gmx::IlvesPC::solve_17_glutamine,
     &gmx::IlvesPC::solve_17_histidine,
     &gmx::IlvesPC::solve_17_lysine,
     &gmx::IlvesPC::solve_17_arginine,
     &gmx::IlvesPC::solve_17_serine,
     &gmx::IlvesPC::solve_17_phenylaline,
     &gmx::IlvesPC::solve_17_tyrosine,
     &gmx::IlvesPC::solve_17_tryptophan,
     &gmx::IlvesPC::solve_17_threonine};

void gmx::IlvesPC::solve_17(const int thread) {
    // Pointers to private data.
    private_data_t *pd = &private_data[thread];

    real *sc_to_sc_matrix = pd->sc_to_sc_matrix.data;

    real *sc_g_matrix = pd->sc_g_matrix.data;

    real *sc_to_sc_fillins = pd->sc_to_sc_fillins.data;

    // Loop through the side-chains assigned to thread.
    for (int i = 0; i < pd->num_side_chains; i++) {
        side_chain_type_t type = mol->side_chain_types[pd->first_side_chain + i];

        // Call current side-chain step 2 solver.
        (this->*step_17_solvers[type])(sc_to_sc_matrix, sc_g_matrix, sc_to_sc_fillins);

        // Update pointers.
        sc_to_sc_matrix += sc_to_sc_matrix_sizes[type];

        sc_g_matrix += sc_g_matrix_sizes[type];

        sc_to_sc_fillins += sc_to_sc_fillins_sizes[type];
    }
}

void gmx::IlvesPC::solve_18_spl_ends_A(real *const bb_g_matrix) {
    /*
     *
     * Row 1.
     *
     */

    real pivot = special_data->spl_to_all_matrix.data[1];

    // spl-row-1 = spl-row-1 - (bb-row-1 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    special_data->spl_to_all_matrix.data[1] = 0;
#endif

    special_data->spl_g_matrix.data[0] -= bb_g_matrix[0] * pivot;

    /*
    Resulting matrix:

    spl           bb             sep       g
    -----     -------------     -----
    |1  | ... |0 x        | ... |   | ... |M| sp    1
    -----     -------------     -----
                    .
                    .
                    .
    -----     -------------     -----
    |0  |     |1 0        |     |0  |     |x|       1
    |0  | ... |0 1 0 0 0  | ... |0  |     |x|       2
    -----     |  0 1 0 0  |     |   | ... |x| bb    3
              |  0 0 1 0  |     |   |     |x|       4
              |  0 0 0 1 0|     |  0|     |x|       5
              |        0 1|     |  0|     |x|       6
              -------------     -----
    */

    pivot = special_data->spl_to_all_matrix.data[2];

    // spl-row-1 = spl-row-1 - (bb-row-2 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    special_data->spl_to_all_matrix.data[2] = 0;
#endif

    special_data->spl_g_matrix.data[0] -= bb_g_matrix[1] * pivot;

    /*
    Resulting matrix:

    spl           bb             sep       g
    -----     -------------     -----
    |1  | ... |0 0        | ... |   | ... |M| sp    1
    -----     -------------     -----
                    .
                    .
                    .
    -----     -------------     -----
    |0  |     |1 0        |     |0  |     |x|       1
    |0  | ... |0 1 0 0 0  | ... |0  |     |x|       2
    -----     |  0 1 0 0  |     |   | ... |x| bb    3
              |  0 0 1 0  |     |   |     |x|       4
              |  0 0 0 1 0|     |  0|     |x|       5
              |        0 1|     |  0|     |x|       6
              -------------     -----
    */
}

void gmx::IlvesPC::solve_18_spl_ends_B(real *const bb_g_matrix) {
    /*
     *
     * Row 2.
     *
     */

    real pivot = special_data->spl_to_all_matrix.data[4];

    // spl-row-2 = spl-row-2 - (bb-row-1 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    special_data->spl_to_all_matrix.data[4] = 0;
#endif

    special_data->spl_g_matrix.data[1] -= bb_g_matrix[0] * pivot;

    /*
    Resulting matrix:

     sp          bb              sep       g
    -----     -------------     -----
    |1 x| ... |           | ... |   | ... |x| spl   1
    |0 1|     |0 x        |     |   |     |M|       2
    -----     -------------     -----
                    .
                    .
                    .
    -----     -------------     -----
    |  0|     |1 0        |     |x  |     |x|       1
    |  0| ... |0 1 0 0 0  | ... |x  |     |x|       2
    -----     |  0 1 0 0  |     |   | ... |x| bb    3 First block.
              |  0 0 1 0  |     |   |     |x|       4
              |  0 0 0 1 0|     |  x|     |x|       5
              |        0 1|     |  x|     |x|       6
              -------------     -----
    */

    pivot = special_data->spl_to_all_matrix.data[5];

    // spl-row-2 = spl-row-2 - (bb-row-2 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    special_data->spl_to_all_matrix.data[5] = 0;
#endif

    special_data->spl_g_matrix.data[1] -= bb_g_matrix[1] * pivot;

    /*
    Resulting matrix:

     sp          bb              sep       g
    -----     -------------     -----
    |1 x| ... |           | ... |   | ... |x| spl   1
    |0 1|     |0 0        |     |   |     |M|       2
    -----     -------------     -----
                    .
                    .
                    .
    -----     -------------     -----
    |  0|     |1 0        |     |x  |     |x|       1
    |  0| ... |0 1 0 0 0  | ... |x  |     |x|       2
    -----     |  0 1 0 0  |     |   | ... |x| bb    3 First block.
              |  0 0 1 0  |     |   |     |x|       4
              |  0 0 0 1 0|     |  x|     |x|       5
              |        0 1|     |  x|     |x|       6
              -------------     -----
    */

    /*
     *
     * Row 1.
     *
     */

    pivot = special_data->spl_to_all_matrix.data[1];

    // spl-row-1 = spl-row-1 - (spl-row-2 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    special_data->spl_to_all_matrix.data[1] = 0;
#endif

    special_data->spl_g_matrix.data[0] -= special_data->spl_g_matrix.data[1] * pivot;

    /*
    Resulting matrix:

     sp          bb              sep       g
    -----     -------------     -----
    |1 0| ... |           | ... |   | ... |M| spl   1
    |0 1|     |0 0        |     |   |     |M|       2
    -----     -------------     -----
                    .
                    .
                    .
    -----     -------------     -----
    |  0|     |1 0        |     |x  |     |x|       1
    |  0| ... |0 1 0 0 0  | ... |x  |     |x|       2
    -----     |  0 1 0 0  |     |   | ... |x| bb    3 First block.
              |  0 0 1 0  |     |   |     |x|       4
              |  0 0 0 1 0|     |  x|     |x|       5
              |        0 1|     |  x|     |x|       6
              -------------     -----
    */
}

void gmx::IlvesPC::solve_18_spr_proline(real *const sc_g_matrix,
                                        real *const bb_g_matrix,
                                        real *const sep_g_matrix) {
    /*
     *
     * Row 1.
     *
     */

    real pivot = special_data->spr_to_all_matrix.data[1];

    // spr-row-1 = spr-row-1 - (sc-row-9 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    special_data->spr_to_all_matrix.data[1] = 0;
#endif

    special_data->spr_g_matrix.data[0] -= sc_g_matrix[8] * pivot;

    /*
    Resulting matrix:

    sp                sc                   bb            sep       g
    -----     -------------------     -------------     -----
    |  1| ... |                0| ... |        x  | ... |  x| ... |M| spr  1
    -----     -------------------     -------------     -----
                       .
                       .
                       .
              -------------------     -------------     -----
              |1 0         0    |     |      0    |     |   |     |x|      1
              |0 1         0    |     |      0    |     |   |     |x|      2
              |    1 0     0 0  |     |           |     |   |     |x|      3
              |    0 1     0 0  |     |           |     |   |     |x|      4
              |        1 0   0 0| ... |           | ... |   | ... |x| sc   5
              |        0 1   0 0|     |           |     |   |     |x|      6
              |0 0 0 0     1 0  |     |      0    |     |   |     |x|      7
    -----     |    0 0 0 0 0 1 0|     |           |     |   |     |x|      8
    |  0| ... |        0 0   0 1|     |        0  |     |  0|     |x|      9
    -----     -------------------     -------------     -----
                                             .
                                             .
                                             .
              -------------------     -------------
              |                 |     |1 0        |     |0  |     |x|      1
              |                 |     |0 1 0 0 0  | ... |0  |     |x|      2
              |                 | ... |  0 1 0 0  |     |   | ... |x| bb   3
    -----     |0 0         0    |     |  0 0 1 0  |     |  0|     |x|      4
    |  0| ... |                0|     |  0 0 0 1  |     |  0|     |x|      5
    -----     -------------------     -------------

    -----                             -------------     -----
    |  0|               ...           |        0 0|     |  1|     |x| sep  1
    -----                             -------------     -----
    */

    pivot = special_data->spr_to_all_matrix.data[2];

    // spr-row-1 = spr-row-1 - (bb-row-5 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    special_data->spr_to_all_matrix.data[2] = 0;
#endif

    special_data->spr_g_matrix.data[0] -= bb_g_matrix[4] * pivot;

    /*
    Resulting matrix:

    sp                sc                   bb            sep       g
    -----     -------------------     -------------     -----
    |  1| ... |                0| ... |        0  | ... |  x| ... |M| spr  1
    -----     -------------------     -------------     -----
                       .
                       .
                       .
              -------------------     -------------     -----
              |1 0         0    |     |      0    |     |   |     |x|      1
              |0 1         0    |     |      0    |     |   |     |x|      2
              |    1 0     0 0  |     |           |     |   |     |x|      3
              |    0 1     0 0  |     |           |     |   |     |x|      4
              |        1 0   0 0| ... |           | ... |   | ... |x| sc   5
              |        0 1   0 0|     |           |     |   |     |x|      6
              |0 0 0 0     1 0  |     |      0    |     |   |     |x|      7
    -----     |    0 0 0 0 0 1 0|     |           |     |   |     |x|      8
    |  0| ... |        0 0   0 1|     |        0  |     |  0|     |x|      9
    -----     -------------------     -------------     -----
                                             .
                                             .
                                             .
              -------------------     -------------
              |                 |     |1 0        |     |0  |     |x|      1
              |                 |     |0 1 0 0 0  | ... |0  |     |x|      2
              |                 | ... |  0 1 0 0  |     |   | ... |x| bb   3
    -----     |0 0         0    |     |  0 0 1 0  |     |  0|     |x|      4
    |  0| ... |                0|     |  0 0 0 1  |     |  0|     |x|      5
    -----     -------------------     -------------

    -----                             -------------     -----
    |  0|               ...           |        0 0|     |  1|     |x| sep  1
    -----                             -------------     -----
    */

    pivot = special_data->spr_to_all_matrix.data[3];

    // spr-row-1 = spr-row-1 - (sep-row-1 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    special_data->spr_to_all_matrix.data[3] = 0;
#endif

    special_data->spr_g_matrix.data[0] -= sep_g_matrix[0] * pivot;

    /*
    Resulting matrix:

    sp                sc                   bb            sep       g
    -----     -------------------     -------------     -----
    |  1| ... |                0| ... |        0  | ... |  0| ... |M| spr  1
    -----     -------------------     -------------     -----
                       .
                       .
                       .
              -------------------     -------------     -----
              |1 0         0    |     |      0    |     |   |     |x|      1
              |0 1         0    |     |      0    |     |   |     |x|      2
              |    1 0     0 0  |     |           |     |   |     |x|      3
              |    0 1     0 0  |     |           |     |   |     |x|      4
              |        1 0   0 0| ... |           | ... |   | ... |x| sc   5
              |        0 1   0 0|     |           |     |   |     |x|      6
              |0 0 0 0     1 0  |     |      0    |     |   |     |x|      7
    -----     |    0 0 0 0 0 1 0|     |           |     |   |     |x|      8
    |  0| ... |        0 0   0 1|     |        0  |     |  0|     |x|      9
    -----     -------------------     -------------     -----
                                             .
                                             .
                                             .
              -------------------     -------------
              |                 |     |1 0        |     |0  |     |x|      1
              |                 |     |0 1 0 0 0  | ... |0  |     |x|      2
              |                 | ... |  0 1 0 0  |     |   | ... |x| bb   3
    -----     |0 0         0    |     |  0 0 1 0  |     |  0|     |x|      4
    |  0| ... |                0|     |  0 0 0 1  |     |  0|     |x|      5
    -----     -------------------     -------------

    -----                             -------------     -----
    |  0|               ...           |        0 0|     |  1|     |x| sep  1
    -----                             -------------     -----
    */
}

void gmx::IlvesPC::solve_18_spr_general(real *const bb_g_matrix,
                                        real *const sep_g_matrix) {
    /*
     *
     * Row 1.
     *
     */

    real pivot = special_data->spr_to_all_matrix.data[1];

    // spr-row-1 = spr-row-1 - (bb-row-5 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    special_data->spr_to_all_matrix.data[1] = 0;
#endif

    special_data->spr_g_matrix.data[0] -= bb_g_matrix[4] * pivot;

    /*
    Resulting matrix:

      sp          bb              sep      g
    -----     -------------     -----
    |  1| ... |        0 x| ... |  x| ... |M| spr   1
    -----     -------------     -----
                    .
                    .
                    .
              -------------     -----
              |1 0        |     |0  |     |x|       1
              |0 1 0 0 0  | ... |0  |     |x|       2
              |  0 1 0 0  |     |   | ... |x| bb    3
    -----     |  0 0 1 0  |     |   |     |x|       4
    |  0|     |  0 0 0 1 0|     |  0|     |x|       5
    |  0|     |        0 1|     |  0|     |x|       6
    -----     -------------     -----

    -----     -------------     -----
    |  0|     |        0 0|     |  1|     |x| sep   1
    -----     -------------     -----
    */

    pivot = special_data->spr_to_all_matrix.data[2];

    // spr-row-1 = spr-row-1 - (bb-row-6 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    special_data->spr_to_all_matrix.data[2] = 0;
#endif

    special_data->spr_g_matrix.data[0] -= bb_g_matrix[5] * pivot;

    /*
    Resulting matrix:

      sp          bb              sep      g
    -----     -------------     -----
    |  1| ... |        0 0| ... |  x| ... |M| spr   1
    -----     -------------     -----
                    .
                    .
                    .
              -------------     -----
              |1 0        |     |0  |     |x|       1
              |0 1 0 0 0  | ... |0  |     |x|       2
              |  0 1 0 0  |     |   | ... |x| bb    3
    -----     |  0 0 1 0  |     |   |     |x|       4
    |  0|     |  0 0 0 1 0|     |  0|     |x|       5
    |  0|     |        0 1|     |  0|     |x|       6
    -----     -------------     -----

    -----     -------------     -----
    |  0|     |        0 0|     |  1|     |x| sep   1
    -----     -------------     -----
    */

    pivot = special_data->spr_to_all_matrix.data[3];

    // spr-row-1 = spr-row-1 - (sep-row-1 * pivot)

#if DEBUG
    // This write can be avoided, this entry will always be 0 after this.
    special_data->spr_to_all_matrix.data[3] = 0;
#endif

    special_data->spr_g_matrix.data[0] -= sep_g_matrix[0] * pivot;

    /*
    Resulting matrix:

      sp          bb              sep      g
    -----     -------------     -----
    |  1| ... |        0 0| ... |  0| ... |M| spr   1
    -----     -------------     -----
                    .
                    .
                    .
              -------------     -----
              |1 0        |     |0  |     |x|       1
              |0 1 0 0 0  | ... |0  |     |x|       2
              |  0 1 0 0  |     |   | ... |x| bb    3
    -----     |  0 0 1 0  |     |   |     |x|       4
    |  0|     |  0 0 0 1 0|     |  0|     |x|       5
    |  0|     |        0 1|     |  0|     |x|       6
    -----     -------------     -----

    -----     -------------     -----
    |  0|     |        0 0|     |  1|     |x| sep   1
    -----     -------------     -----
    */
}

void gmx::IlvesPC::solve_18(const int thread) {
    // Reference to thread private data.

    // Clean data assigned to first thread
    if (thread == 0) {
        private_data_t *pd = &private_data[0];

        if (mol->ends_type == TYPE_A) {
            solve_18_spl_ends_A(pd->bb_g_matrix.data);
        }
        else {   // Type B
            solve_18_spl_ends_B(pd->bb_g_matrix.data);
        }
    }
    if (thread == nthreads - 1 && mol->ends_type == TYPE_A) {   // Only on
                                                                // molecules
                                                                // with ends
                                                                // type A.
        private_data_t *pd = &private_data[nthreads - 1];

        side_chain_type_t
            last_side_chain = mol->side_chain_types[pd->first_side_chain +
                                                    pd->num_side_chains - 1];

        real *last_sc_g_matrix = &pd->sc_g_matrix
                                      .data[pd->sc_g_matrix.size -
                                            sc_g_matrix_sizes[last_side_chain]];

        real *last_sep_g_matrix = &pd->sep_g_matrix.data[pd->sep_g_matrix.size -
                                                         SEP_G_MATRIX_SIZE];

        if (last_side_chain == PROLINE) {
            real *last_bb_g_matrix = &pd->bb_g_matrix.data[pd->bb_g_matrix.size -
                                                           BB_G_PROLINE_MATRIX_SIZE];

            solve_18_spr_proline(last_sc_g_matrix,
                                 last_bb_g_matrix,
                                 last_sep_g_matrix);
        }
        else {
            real *last_bb_g_matrix = &pd->bb_g_matrix.data[pd->bb_g_matrix.size -
                                                           BB_G_MATRIX_SIZE];

            solve_18_spr_general(last_bb_g_matrix, last_sep_g_matrix);
        }
    }
}

void gmx::IlvesPC::update_positions_loop(const size_t first_element,
                                         const size_t num_elements,
                                         const int first_row,
                                         const g_t *const __restrict__ g,
                                         const ArrayRef<RVec> xprime,
                                         const bool reset_current_lagr) {
    for (size_t i = first_element; i < first_element + num_elements; ++i) {
        // rab previously calculated in evaluate_constraint_function().
        int row = first_row + i;

        int a = g->a[i];
        int b = g->b[i];

        // Current approximation of the lagrange multipliers
        g->current_lagr[i] = (reset_current_lagr)
                                 ? g->data[i]
                                 : g->current_lagr[i] + g->data[i];

        // Update the components of y which correspond to atom a
        for (int d = 0; d < DIM; ++d) {
            xprime[a][d] += g->data[i] * x_ab[row][d] * mol->invmass[a];
        }

        // Update the components of y which correspond to atom b
        for (int d = 0; d < DIM; ++d) {
            xprime[b][d] -= g->data[i] * x_ab[row][d] * mol->invmass[b];
        }
    }
}

void gmx::IlvesPC::update_positions_inm(const int thread,
                                        const g_t *const __restrict__ g,
                                        const ArrayRef<RVec> xprime,
                                        const bool reset_current_lagr,
                                        const bool lock_start,
                                        const bool lock_end) {
    if (g->size == 0) {
        return;
    }

    if (lock_start) {
        pthread_mutex_lock(&shared_data[thread - 1].lock);
    }
    // Only when 1 side-chain / CPU.
    if (lock_end && g->size < 3) {
        pthread_mutex_lock(&shared_data[thread].lock);
    }

    update_positions_loop(0,
                          std::min(g->size, (size_t)2),
                          g->first_row,
                          g,
                          xprime,
                          reset_current_lagr);

    if (lock_start) {
        pthread_mutex_unlock(&shared_data[thread - 1].lock);
        // No more shared data with thread - 1 is modified.
        sem_post(&boundary_sems[thread - 1].right);
    }

    update_positions_loop(2,
                          (g->size > 2 + 1) ? g->size - (2 + 1) : 0,
                          g->first_row,
                          g,
                          xprime,
                          reset_current_lagr);

    // Only when 1 side-chain / CPU.
    if (lock_end && g->size >= 3) {
        pthread_mutex_lock(&shared_data[thread].lock);
    }

    update_positions_loop(g->size - 1,
                          std::min((size_t)1, ((g->size > 2) ? g->size - 2 : 0)),
                          g->first_row,
                          g,
                          xprime,
                          reset_current_lagr);

    if (lock_end) {
        pthread_mutex_unlock(&shared_data[thread].lock);
        // No more shared data with thread + 1 is modified.
        sem_post(&boundary_sems[thread + 1].left);
    }
}

void gmx::IlvesPC::update_positions(const int thread,
                                    const ArrayRef<RVec> xprime,
                                    const bool reset_current_lagr) {
    // Reference to thread private data.
    private_data_t *pd = &private_data[thread];

    // SC jacobian.
    update_positions_inm(thread,
                         &pd->sc_g_matrix,
                         xprime,
                         reset_current_lagr,
                         false,
                         false);

    // BB jacobian.
    update_positions_inm(thread,
                         &pd->bb_g_matrix,
                         xprime,
                         reset_current_lagr,
                         thread > 0,
                         false);

    // SEP jacobian.
    update_positions_inm(thread,
                         &pd->sep_g_matrix,
                         xprime,
                         reset_current_lagr,
                         false,
                         thread < nthreads - 1);

    // spl jacobian.
    if (thread == 0) {
        update_positions_inm(thread,
                             &special_data->spl_g_matrix,
                             xprime,
                             reset_current_lagr,
                             false,
                             false);
    }
    // spr jacobian.
    if (thread == nthreads - 1) {
        update_positions_inm(thread,
                             &special_data->spr_g_matrix,
                             xprime,
                             reset_current_lagr,
                             false,
                             false);
    }
}

void gmx::IlvesPC::update_virial_loop(const g_t *const __restrict__ g,
                                      tensor virial) {
    for (size_t i = 0; i < g->size; ++i) {
        int row = g->first_row + i;

        for (int d1 = 0; d1 < DIM; ++d1) {
            const auto tmp = -g->current_lagr[i] * x_ab[row][d1];

            for (int d2 = 0; d2 < DIM; d2++) {
                virial[d1][d2] += tmp * x_ab[row][d2];
            }
        }
    }
}

void gmx::IlvesPC::update_virial(const int thread, tensor virial) {
    tensor priv_virial = {0};

    // Reference to thread private data.
    private_data_t *pd = &private_data[thread];

    // SC virial.
    update_virial_loop(&pd->sc_g_matrix, priv_virial);

    // BB virial.
    update_virial_loop(&pd->bb_g_matrix, priv_virial);

    // SEP virial.
    update_virial_loop(&pd->sep_g_matrix, priv_virial);

    // spl virial.
    if (thread == 0) {
        update_virial_loop(&special_data->spl_g_matrix, priv_virial);
    }
    // spr virial.
    if (thread == nthreads - 1) {
        update_virial_loop(&special_data->spr_g_matrix, priv_virial);
    }

    #pragma omp critical
    {
        for (int d1 = 0; d1 < DIM; ++d1) {
            for (int d2 = 0; d2 < DIM; d2++) {
                virial[d1][d2] -= priv_virial[d1][d2];
            }
        }
    }
}

void gmx::IlvesPC::update_velocities_loop(const size_t first_element,
                                          const size_t num_elements,
                                          const int first_row,
                                          const g_t *const __restrict__ g,
                                          const ArrayRef<RVec> vprime,
                                          const real invdt) {
    for (size_t i = first_element; i < first_element + num_elements; ++i) {
        // rab previously calculated in evaluate_constraint_function().
        int row = first_row + i;

        int a = g->a[i];
        int b = g->b[i];

        // Update the components of y which correspond to atom a
        for (int d = 0; d < DIM; ++d) {
            vprime[a][d] += g->current_lagr[i] * x_ab[row][d] *
                            mol->invmass[a] * invdt;
        }

        // Update the components of y which correspond to atom b
        for (int d = 0; d < DIM; ++d) {
            vprime[b][d] -= g->current_lagr[i] * x_ab[row][d] *
                            mol->invmass[b] * invdt;
        }
    }
}

void gmx::IlvesPC::update_velocities_inm(const int thread,
                                         const g_t *const __restrict__ g,
                                         const ArrayRef<RVec> vprime,
                                         const real invdt,
                                         const bool lock_start,
                                         const bool lock_end) {
    if (g->size == 0) {
        return;
    }

    if (lock_start) {
        pthread_mutex_lock(&shared_data[thread - 1].lock);
    }
    // Only when 1 side-chain / CPU.
    if (lock_end && g->size < 3) {
        pthread_mutex_lock(&shared_data[thread].lock);
    }

    update_velocities_loop(0, std::min(g->size, (size_t)2), g->first_row, g, vprime, invdt);

    if (lock_start) {
        pthread_mutex_unlock(&shared_data[thread - 1].lock);
    }

    update_velocities_loop(2,
                           (g->size > 2 + 1) ? g->size - (2 + 1) : 0,
                           g->first_row,
                           g,
                           vprime,
                           invdt);

    // Only when 1 side-chain / CPU.
    if (lock_end && g->size >= 3) {
        pthread_mutex_lock(&shared_data[thread].lock);
    }

    update_velocities_loop(g->size - 1,
                           std::min((size_t)1, ((g->size > 2) ? g->size - 2 : 0)),
                           g->first_row,
                           g,
                           vprime,
                           invdt);

    if (lock_end) {
        pthread_mutex_unlock(&shared_data[thread].lock);
    }
}

void gmx::IlvesPC::update_velocities(const int thread,
                                     const ArrayRef<RVec> vprime,
                                     const real invdt) {
    // Reference to thread private data.
    private_data_t *pd = &private_data[thread];

    // SC velocities.
    update_velocities_inm(thread, &pd->sc_g_matrix, vprime, invdt, false, false);

    // BB velocities.
    update_velocities_inm(thread, &pd->bb_g_matrix, vprime, invdt, thread > 0, false);

    // SEP velocities.
    update_velocities_inm(thread,
                          &pd->sep_g_matrix,
                          vprime,
                          invdt,
                          false,
                          thread < nthreads - 1);

    // spl velocities.
    if (thread == 0) {
        update_velocities_inm(thread,
                              &special_data->spl_g_matrix,
                              vprime,
                              invdt,
                              false,
                              false);
    }
    // spr velocities.
    if (thread == nthreads - 1) {
        update_velocities_inm(thread,
                              &special_data->spr_g_matrix,
                              vprime,
                              invdt,
                              false,
                              false);
    }
}

/*
 * Debug functions.
 */

void gmx::IlvesPC::print_array(const real *const array, const size_t size) {
    printf("[");
    for (size_t i = 0; i < size; ++i) {
        real entry = array[i];
        printf(ARRAY_ENTRY_SPEC, entry);
    }
    printf("]\n");
}

void gmx::IlvesPC::print_data() {
    printf(HLINE1 "\n");

    // Loop through the data of each thread.
    for (int i = 0; i < nthreads; ++i) {
        private_data_t *pd = &private_data[i];

        printf(HLINE3 "\n");
        printf("Thread %d:\n", i);
        printf(HLINE3 "\n");

        printf("num_side_chains: %d\n", pd->num_side_chains);
        printf("first_side_chain: %d\n", pd->first_side_chain);
        printf("first_sc_bond: %d\n", pd->first_sc_bond);
        printf("first_bb_bond: %d\n", pd->first_bb_bond);
        printf("first_sep_bond: %d\n", pd->first_sep_bond);
        printf("sc_num_bonds: %d\n", pd->sc_num_bonds);
        printf("bb_num_bonds: %d\n", pd->bb_num_bonds);
        printf("num_bonds: %d\n", pd->num_bonds);

        printf("\ng:\n" HLINE2);

        // SC to g.
        printf("\nsc_g_matrix =>\n");
        print_array(pd->sc_g_matrix.data, pd->sc_g_matrix.size);

        // BB to g.
        printf("bb_g_matrix =>\n");
        print_array(pd->bb_g_matrix.data, pd->bb_g_matrix.size);

        // SEP to g.
        printf("sep_g_matrix =>\n");
        print_array(pd->sep_g_matrix.data, pd->sep_g_matrix.size);

        if (nthreads > 1) {
            // Schur row g.
            if (i < nthreads - 1) {
                shared_data_t *sd = &shared_data[i];

                printf("g_schur =>\n");
                print_array(sd->sep_g_matrix.data, sd->sep_g_matrix.size);
            }
        }

        if (i == 0) {
            // spl g.
            printf("spl_g_matrix =>\n");
            print_array(special_data->spl_g_matrix.data,
                        special_data->spl_g_matrix.size);
        }
        if (i == nthreads - 1) {
            // spr g.
            printf("spr_g_matrix =>\n");
            print_array(special_data->spr_g_matrix.data,
                        special_data->spr_g_matrix.size);
        }

        printf("\n");

        printf("A:\n" HLINE2);

        printf("\n");

        // SC to SC sub-matrix.
        printf("sc_to_sc_matrix =>\n");
        print_array(pd->sc_to_sc_matrix.data, pd->sc_to_sc_matrix.size);

        // SC to BB sub-matrix.
        printf("sc_to_bb_matrix =>\n");
        print_array(pd->sc_to_bb_matrix.data, pd->sc_to_bb_matrix.size);

        // SC to SEP sub-matrix.
        printf("sc_to_sep_matrix =>\n");
        print_array(pd->sc_to_sep_matrix.data, pd->sc_to_sep_matrix.size);

        // SC to SC fillins sub-matrix.
        printf("sc_to_bb_fillins =>\n");
        print_array(pd->sc_to_bb_fillins.data, pd->sc_to_bb_fillins.size);

        // SC to BB fillins sub-matrix.
        printf("sc_to_bb_fillins =>\n");
        print_array(pd->sc_to_bb_fillins.data, pd->sc_to_bb_fillins.size);

        // BB to SC sub-matrix.
        printf("bb_to_sc_matrix =>\n");
        print_array(pd->bb_to_sc_matrix.data, pd->bb_to_sc_matrix.size);

        // BB to BB sub-matrix.
        printf("bb_to_bb_matrix =>\n");
        print_array(pd->bb_to_bb_matrix.data, pd->bb_to_bb_matrix.size);

        // BB to SEP sub-matrix.
        printf("bb_to_sep_matrix =>\n");
        print_array(pd->bb_to_sep_matrix.data, pd->bb_to_sep_matrix.size);

        // BB to SC fillins sub-matrix.
        printf("bb_to_sc_fillins =>\n");
        print_array(pd->bb_to_sc_fillins.data, pd->bb_to_sc_fillins.size);

        // BB to SEP fillins sub-matrix.
        printf("bb_to_sep_fillins =>\n");
        print_array(pd->bb_to_sep_fillins.data, pd->bb_to_sep_fillins.size);

        // SEP to SC sub-matrix.
        printf("sep_to_sc_matrix =>\n");
        print_array(pd->sep_to_sc_matrix.data, pd->sep_to_sc_matrix.size);

        // SEP to BB sub-matrix.
        printf("sep_to_bb_matrix =>\n");
        print_array(pd->sep_to_bb_matrix.data, pd->sep_to_bb_matrix.size);

        // SEP to SEP sub-matrix.
        printf("sep_to_sep_matrix =>\n");
        print_array(pd->sep_to_sep_matrix.data, pd->sep_to_sep_matrix.size);

        // SEP to BB fillins sub-matrix.
        printf("sep_to_bb_fillins =>\n");
        print_array(pd->sep_to_bb_fillins.data, pd->sep_to_bb_fillins.size);

        // SEP to SEP fillins sub-matrix.
        printf("sep_to_sep_fillins =>\n");
        print_array(pd->sep_to_sep_fillins.data, pd->sep_to_sep_fillins.size);

        if (nthreads > 1) {
            if (i < nthreads - 1) {
                shared_data_t *sd = &shared_data[i];

                // SEP to SC sub-matrix.
                printf("schur_sep_to_sc_matrix =>\n");
                print_array(sd->sep_to_sc_matrix.data, sd->sep_to_sc_matrix.size);

                // SEP to BB sub-matrix.
                printf("schur_sep_to_bb_matrix =>\n");
                print_array(sd->sep_to_bb_fillins.data, sd->sep_to_bb_fillins.size);

                // SEP to SEP sub-matrix.
                printf("schur_sep_to_sep_matrix =>\n");
                print_array(sd->sep_to_sep_matrix.data, sd->sep_to_sep_matrix.size);

                // SEP to BB fillins sub-matrix.
                printf("schur_sep_to_bb_fillins =>\n");
                print_array(sd->sep_to_bb_fillins.data, sd->sep_to_bb_fillins.size);

                // SEP to SEP fillins sub-matrix.
                printf("schur_sep_to_sep_fillins =>\n");
                print_array(sd->sep_to_sep_fillins.data,
                            sd->sep_to_sep_fillins.size);
            }
        }

        if (i == 0) {
            // all to spl sub-matrix.
            printf("all_to_spl_matrix =>\n");
            print_array(special_data->all_to_spl_matrix.data,
                        special_data->all_to_spl_matrix.size);

            // spl to all sub-matrix.
            printf("spl_to_all_matrix =>\n");
            print_array(special_data->spl_to_all_matrix.data,
                        special_data->spl_to_all_matrix.size);
        }
        if (i == nthreads - 1) {
            // all to spr sub-matrix.
            printf("all_to_spr_matrix =>\n");
            print_array(special_data->all_to_spr_matrix.data,
                        special_data->all_to_spr_matrix.size);

            // spr to all sub-matrix.
            printf("spr_to_all_matrix =>\n");
            print_array(special_data->spr_to_all_matrix.data,
                        special_data->spr_to_all_matrix.size);
        }
    }
    printf(HLINE1 "\n\n");
}

void gmx::IlvesPC::sparse_to_dense_A(const A_t *const A_src, const int n, real *A_dst) {
    for (size_t i = 0; i < A_src->size; i++) {
        int row = A_src->row[i];
        int col = A_src->col[i];

        if (row >= 0 && col >= 0) {
            A_dst[row * n + col] = A_src->data[i];
        }
    }
}

void gmx::IlvesPC::sparse_to_dense_g(const g_t *const g_src, real g_dst[]) {
    int row = g_src->first_row;
    for (size_t i = 0; i < g_src->size; i++, row++) {
        if (row >= 0) {
            g_dst[row] = g_src->data[i];
        }
    }
}

void gmx::IlvesPC::print_data_prettified() {
    int n = mol->n;

    // Avoid stack overflow.
    if (n > MAX_N_PRINT_DATA_PRETTIFIED) {
        print_data();
        return;
    }

    real A[n][n];
    real g[n];

    // A = {0}, g = {0}
    for (int i = 0; i < n; i++) {
        g[i] = 0;
        for (int j = 0; j < n; j++) {
            A[i][j] = 0;
        }
    }

    // Populate dense matrix
    for (int i = 0; i < nthreads; i++) {
        private_data_t *pd = &private_data[i];

        // SC to g.
        sparse_to_dense_g(&pd->sc_g_matrix, g);

        // BB to g.
        sparse_to_dense_g(&pd->bb_g_matrix, g);

        // SEP to g.
        sparse_to_dense_g(&pd->sep_g_matrix, g);

        if (i == nthreads - 1) {
            // special g.
            sparse_to_dense_g(&special_data->spl_g_matrix, g);
            sparse_to_dense_g(&special_data->spr_g_matrix, g);
        }

        // SC to SC sub-matrix.
        sparse_to_dense_A(&pd->sc_to_sc_matrix, n, (real *)A);

        // SC to BB sub-matrix.
        sparse_to_dense_A(&pd->sc_to_bb_matrix, n, (real *)A);

        // SC to SEP sub-matrix.
        sparse_to_dense_A(&pd->sc_to_sep_matrix, n, (real *)A);

        // BB to SC sub-matrix.
        sparse_to_dense_A(&pd->bb_to_sc_matrix, n, (real *)A);

        // BB to BB sub-matrix.
        sparse_to_dense_A(&pd->bb_to_bb_matrix, n, (real *)A);

        // BB to SEP sub-matrix.
        sparse_to_dense_A(&pd->bb_to_sep_matrix, n, (real *)A);

        // SEP to SC sub-matrix.
        sparse_to_dense_A(&pd->sep_to_sc_matrix, n, (real *)A);

        // SEP to BB sub-matrix.
        sparse_to_dense_A(&pd->sep_to_bb_matrix, n, (real *)A);

        // SEP to SEP sub-matrix.
        sparse_to_dense_A(&pd->sep_to_sep_matrix, n, (real *)A);

        // Computed last to avoid being overwritten by the made-up entries
        // (row/col = 0).
        if (i == nthreads - 1) {
            // spl to all sub-matrix.
            sparse_to_dense_A(&special_data->spl_to_all_matrix, n, (real *)A);

            // spr to all sub-matrix.
            sparse_to_dense_A(&special_data->spr_to_all_matrix, n, (real *)A);

            // all to spl sub-matrix.
            sparse_to_dense_A(&special_data->all_to_spl_matrix, n, (real *)A);

            // all to spr sub-matrix.
            sparse_to_dense_A(&special_data->all_to_spr_matrix, n, (real *)A);
        }
    }

    printf(HLINE1 "\n");

    printf("A + g (no fillins/Schur row):\n\n");

    // Print matrix
    for (int i = 0; i < n; i++) {
        for (int j = 0; j < n; j++) {
            printf(ARRAY_ENTRY_SPEC, A[i][j]);
        }
        printf("  |");
        printf(ARRAY_ENTRY_SPEC, g[i]);
        printf("\n");
    }

    printf("\n");

    // Print thread-specific data.
    for (int i = 0; i < nthreads; ++i) {
        private_data_t *pd = &private_data[i];

        printf(HLINE3 "\n");
        printf("Thread %d:\n", i);
        printf(HLINE3 "\n");

        printf("num_side_chains: %d\n", pd->num_side_chains);
        printf("first_side_chain: %d\n", pd->first_side_chain);
        printf("first_sc_bond: %d\n", pd->first_sc_bond);
        printf("first_bb_bond: %d\n", pd->first_bb_bond);
        printf("first_sep_bond: %d\n", pd->first_sep_bond);
        printf("sc_num_bonds: %d\n", pd->sc_num_bonds);
        printf("bb_num_bonds: %d\n", pd->bb_num_bonds);
        printf("num_bonds: %d\n", pd->num_bonds);

        if (nthreads > 1) {
            if (i < nthreads - 1) {
                shared_data_t *sd = &shared_data[i];

                printf("\ng (Schur row):\n" HLINE2);

                // Schur row g.
                printf("g_schur =>\n");
                print_array(sd->sep_g_matrix.data, sd->sep_g_matrix.size);
            }
        }

        printf("\n");

        printf("A (fillins and Schur row):\n" HLINE2);

        printf("\n");

        // SC to SC fillins sub-matrix.
        printf("sc_to_bb_fillins =>\n");
        print_array(pd->sc_to_bb_fillins.data, pd->sc_to_bb_fillins.size);

        // SC to BB fillins sub-matrix.
        printf("sc_to_bb_fillins =>\n");
        print_array(pd->sc_to_bb_fillins.data, pd->sc_to_bb_fillins.size);

        // BB to SC fillins sub-matrix.
        printf("bb_to_sc_fillins =>\n");
        print_array(pd->bb_to_sc_fillins.data, pd->bb_to_sc_fillins.size);

        // BB to SEP fillins sub-matrix.
        printf("bb_to_sep_fillins =>\n");
        print_array(pd->bb_to_sep_fillins.data, pd->bb_to_sep_fillins.size);

        // SEP to BB fillins sub-matrix.
        printf("sep_to_bb_fillins =>\n");
        print_array(pd->sep_to_bb_fillins.data, pd->sep_to_bb_fillins.size);

        // SEP to SEP fillins sub-matrix.
        printf("sep_to_sep_fillins =>\n");
        print_array(pd->sep_to_sep_fillins.data, pd->sep_to_sep_fillins.size);

        if (nthreads > 1) {
            if (i < nthreads - 1) {
                shared_data_t *sd = &shared_data[i];

                // SEP to SC sub-matrix.
                printf("schur_sep_to_sc_matrix =>\n");
                print_array(sd->sep_to_sc_matrix.data, sd->sep_to_sc_matrix.size);

                // SEP to BB sub-matrix.
                printf("schur_sep_to_bb_matrix =>\n");
                print_array(sd->sep_to_bb_matrix.data, sd->sep_to_bb_matrix.size);

                // SEP to SEP sub-matrix.
                printf("schur_sep_to_sep_matrix =>\n");
                print_array(sd->sep_to_sep_matrix.data, sd->sep_to_sep_matrix.size);

                // SEP to BB fillins sub-matrix.
                printf("schur_sep_to_bb_fillins =>\n");
                print_array(sd->sep_to_bb_fillins.data, sd->sep_to_bb_fillins.size);

                // SEP to SEP fillins sub-matrix.
                printf("schur_sep_to_sep_fillins =>\n");
                print_array(sd->sep_to_sep_fillins.data,
                            sd->sep_to_sep_fillins.size);
            }
        }
    }
    printf(HLINE1 "\n\n");
}